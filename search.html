<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"edd5e4a0e020daf319294756ce26dff981b2ad82efb121806821a75f823292b020d9d4862dc158eed7f7d5dab32cb062587bf1b506cb1ee987f278ba22c2711befe685659585598d3ef199259b428af2138cb016f2218e73efec9009d3177a0d26bc55966ee8947810ef596b7c97db871097ec606c034e04f2abb7b1331ff9d6b36fe76e05889b73759a727aeb59fbe1063267cf40b39fa1a1d9a8de2553d5b4b3820b9a039f6b02656eb290fce0188933b8f3070f75672620866a8bd282ed2550024c8c2a86c251270f6d90a6cb2ee971eefbf730b5e6b43af3bec38efc57b06c4a94697936b19bc9b2e336cc1d84ae5a6e24265eef3be46b0b3ad296dbf62a1cf4fe6aca452c32cf60156cb8359a938a9b13196294743e735f98120e7ddd308b4e24a43a86e537f64930c86bde34a984a8f98f758374f92aedb1bd58165a2979786055368c1665d1c00e6d81353edb04b3aaf5634b611c005d6a5a071ce8ee9a65e7dda9000150f3415801c68f5c0487899923b1e0d0948ebaab3bc07e6dcf0da6d04796fe3e32fd2cbaf79f93d4c3d1817d3f97b275e3c02b7097dbc63b71c9e5fe2983a540e68ba21ae971aaa059a1ee7c6aa2d6c24bf995ff95eaaa4047d4195742463e1ff0145a19ecee8de11df7d0e6aa0540fd77771fc7640c84b076b5003c070b5d8da5a6e20d4c2be3bc437cbc4ad4904062d9a7de2d61eaf2d482ca8b5e3ccfb656d8e1ed21b4ca344de2e157e49fa3b5f86901dc750398124b75df06ba50b675ed0739ee1d4587360f12b0fdfb9d62cc8d845ec1df1ecaa8d23f5ac2ef89bb25eb1905770e542b31feed3271ec70c2eadbc31e26ef10cd49835aaab3e601815a221998f836043e9fac90a41c93c1d313963914a9a3f365375610caff248f253ef25bfa4e9afda3e6460e850396e23230ba13f37440be2f075d815730d73803039c4393a23a109437673d658daf07d272e2a1cf33f66e53410b2a11593c9fe8997e9ee2b9d74360cd7a158a09ec76234e694143eb1a2b71bdde406aa92195a52bdd3c1b45cdc55f90d640e5d47e91b959d6abbc12d7ec2d2bfbf329d2230860076f87e8107ae750a2d476c85c1e00080ff9f31a57b977a977999072438207bfb8b5307347f90876820bcb627d0359b4dddce80dbe78a9db7fd37b3c476a0c770cc8d8e6ab93fa17c4f06c5b9bff9e9cb394343abdcd4f73f3428a8f08afbbb5c2f692f83e537ccc8978bd5f92c4bc295dddd51c032c5306554b71503688b33a18c7aff153121ea7a99961a57d3a656f81a1ff8be40bc0be36add583566cb2760559db64c05ef8ee7707c229fa911b36972e04c2cf908a852ee106520fa12fdf795cd0f41a11fa3f5cbd190def83f2c8c0ce603671029458544f7249f758deb4578df9df5a80fea36fc3eec2a087918f1bf37188fdfbd69462ef551ada3473171951c9e0a7d8ec764d0564c67a71babb366ae7dd415306e1524ca7a4444bde953d4b692191b6619a4b9b90b2d4e975b7ef5f071c581296c99b6449c24a989c25addd1995c44ea7e1ac17e6cc21ac54c878056af1a115f06f9c49575086543ed8cfc95726a79300dbe5edad0c1892fc623655244019d732a65e6c56e2732a59524a75a545def9f479412353125a0302d3fa28795611d27153cc9185956aa9da24a1c583cc2428531598ffdee0bdc68609d12c81a05188f3b9cbf2bbfde1cf565132eeb7b12fdfdfea72b4a5c799dfb2a2520b64bcd8e185139ae7839ce28966c384b28c78f9106a616e7aa7e407580b3a7520fdc61444d4cee0895ec17c9024e282d127add6f41e40e05c6425a7cdb3fcb4b373d77bb62104101c8f1bced03c795327b0bb25eb657bdbfa92a7375bc77cedd48765b051355eaadce48791947b967514c78a53004051841e4b96ba941587207e1f92a45ccf497b32411e403e817b4c240daa5875cbad2a5c72a6e91c760836d102d7412863a86322291d85d89b8b92f165956e9d8199d4fae22620fcaffd9b86037e74f00a2f629965c5c0475432e30ee1a1bfb33f010481b8c710897a6c3eb5abe26cccff2c14d3582e8e8879e63c7c14d947703aa3ee503c7ff1c9a4219760e285763145e9d69cae92c8528aa47e60b28cfb585d03c6dad6788e4bf1b69712fc2553befc0cd610307253448c05d6762401863a67f85564bd83d34d647bf834726073294990f8621e4590fe2c04e02b68802282ca872d506b4cebb080bfe882142499705503a868b514e9a174eb053147d82b9d0ea82a0b34bce0e94e513cf5d5ccf535272947d44eaffb9faa93402a1a5c81b58a0e5c3502ae3976986327611124fabab555b8fc92afabc9c0138eb7dd19cab650d8100167455d4950e824769d578f721037e0eb14d22b99db0e123874c909ae0dc162504fa0038907586df43cc0c6dafadb5cd470f644b923cfeb52e8d5fce461b167ffa5f278ff040f277b68d223ac3e7f488fe245f1b110d12285ec402ee8eb052ef86082252d7f585c92fcf772ce6ac3a3a6e967c13550160a9dcec85bca98bc31fa43851e992a16b936129b197aeba5a06d8559c1f4e2e41ff4b981407fd280755be2520ed361d2acdd1cd68a23282c846af46510d916e9efe636a043208ea1db991b3fea30085c697f6339fb31999681d82bb54fe3df752cc44114b561e8c633d81bb527e1b650294464f6b96ffa771ab5fd3e9d8ad8f4459117d0e31bf1d4dc1d4f3ae22d902a573c5193f26e7ab9c10bd178a1f530725c8b0d5f3d2d152543c95a1599bee6344319a9ddfda85caf7ab6287aff1b2c162ff28e876cfe16589ed08966f61a58fde2554a1b32c002c4c3d1b0371f3acfd97196233f22077217ae9a4ae768caa4357da4183921c849ff1065c52aba30b171919a6f16c4b61cb56876b24c1020bd07f9a8ea3962804ec9d18d0139742bfddaf8565c31571cbf69f752a4cb506ee8b6459fe39e3c495ab2b274bd2f7d0453f3d396d24b97a3dc5d7431e964f881530b3f1e7c84395b12a5e8fc63bc7312ae7d78d926f7d480fbff14af220caf3655bcda3b376f53d8702c592b1e0376e94dda96e928460a458ff1852b89316f8d6da439d3a986ee46fd1e56ebc2bb0cace735413dd4a871ea26d6a7617a0fb64dbc53dadb1f253d6dce10a5ac2fd9fa587db12d615da8c9d9662f956809e407e41863de2888909f146692e6f9afa4b06656b26dc7908f2b906cd59066673178921f3e236d37bce8bfd82f4db692f0340effab2f09ac38c4450e668d80b53ec0f6fb599e5bfbfd6796b0e7f59c661c42542baa760aa03c0c69f94bd4c483b605912f311c656a727b095bc174692e4299bd7ce835837310cf6e17f91b1835f08a42baaf233961c522fc300e3b14b3c12950a96feb67bda86baf98dd17d791cd5407d1ef64c0b47a932b895927520110fec3d300c673c6e018fb0b41a295e957ab4d3c0f9cf7abdf2eee4f467145f71dd4dc024ee13c553c9078314f72056e3e6156c1f62b4426aac4a683ec91f0edfe05e01ee6e89b6ede5b901c807e31b1651d7f5bd29eedead2c0846461365501a51b05cb9adf4cd9ad816114fe2ba7da2cacf20a5ed4ac7e8bfd606043213092de73266071bf3e8b5f815891c1b849ec03b8a4c5c1f8dcd50d9b477315d25a4b828f5e567a65e4e2b07c5fab1011fb8be0892ce4dea847c4c682dbaf480b8339517f225d6ec41d11da7a40d3aa0332feb4623257dec5dd151b3a916e09f93fe6ef67df9e54f76aaf38f8e85eb2650490c936037e523eb814f19aa439563cb2131e3d9c236f43e9128a14fd1d6d2af5384e26e1930ca4a337be93d9d857adf254b9cf0c7e9f296c9e70c0423aa0868d1bcc1ef769a4f922ec4c559d2430f8c5d2146054fcd15cde5500805684e4ea89b2048e049aef12657368b45d769cb82a8f82bb07fdbe56f94c5f6b105899b3241414fe85d83b527bbe89fadd9240e4c4991a8382fb0a67e91de8f4c3b1bfc2c141a648e6967da18eec706c23f13dfb0ac529c47b720ca64683cc8c21b8438e5331157f8fa37bd93236439d7f71a695194624214f30f73c78322a3031894b296cca74a847b4c806431a5c1cb1599e0bf4d231c393d283b3745fa2a5af7afa0c0475ae97f7f11963ad76c16a5552acaa39b8b4d108b229834b48150874e7f7cbea4d68f75db90862e7189d2e2c4d1453d80ccdbc7fc74830624e252b0ad7df1f8e3967cd3a07cce177615eba84964c0f11d42f9f898cdf120a4148f2313addf8e431f1c68dc1ab22d862ccde925b5bad06ae1ed894c7b68e08cdfdf60803a0bcb969cbd16293474f2df68faca24d6df1486bb52b76ba2e81c563d95500fdc3c8783d84f190c647633a77faa386a366d0b8792af8dd867d3ff21f9eea0edf71b285d064cf4fbcd2e69c18ced4ffebe2d546107b370a6ca0ca94a3fec6aaaf1e843bc075d8f7c2876d72a0cd600fb58d11f945ddc3ebeebd3d6bd555a8909298ca52d6e05bff93e2c8e29716e83e23cf4a4411fce33d36e0b90da696e9d8f9282bb65a868d33069a5c9d36d5f239c74182bdd90eda046e827a2539ebf9ba5eb6d704a548263fc6d6f31dc500e52867d66580c9e1383ed134332e91876a9547b7a167250ade46535259f3c007c28ce54a5f1450eb7492d5aa4e133224b7e0e7803a794ef706e160e90474498eee8fb151ee8a8fa7a582129ed6b853f71ea0add03c4f423360da02074a1952c7341b5650990774f044e33c62ccbf04b4327332b7b03fc8086fb948b69b31a43c5f3148f6c9b3dd7173256e26732d58a2a7398da17478dbb4fec75741e32ae49323ff6640f6ee4ac8933929198621619dd340f23cf6a183a8fb12c360db730643872b0802947961fad29e5f156c4546725ae629f95f5e27ec7e4282d081d6ede4b26d61bf6c9bd7b0d4b3a93811aaab464268d9aaeec52df8e560dd1c516b0699995b912e8386e5caf127b0a909fb09123d71aab522794fdff3c8df61dea41b7d8a747e141328e5532d6d2fe2e55f016deab136fa04742e1587e803bcbc1d8eed2ba1b01ebcf4e65a2776c9d4536e926179a3932d8793f062e63798940c28ea1c81846cd041f460d2c08788b7fb65700c94ca10a60b178667644584d9616f3c8406883d23556f318056c898fadc924a44d0ea6123b0910edcb8648737bf5ecb2a37ff3c8cf5b65cbf111980ef651c6ace569c25d883341399ed189932fa37f1cf28774a24cc96a3f6b1567506f5305a84ebec11160caf0f42bc8d428dd1029466fdf0d481f26d44b8933da706d3bd75d1a63f23f9066f7bdefd89add16c646b586eecef05fa7e39900c35ba9cb779e41f8dd6531ef159ed73026a56f7ac60e03331911d9d7f8b5ea11543805e9f5d142bc1e0216c1f1bff0e377390cf216df04770736957703148a20c3e7eb094f0b16a41b11e0f17fd41fbc4dd67d0a654379c12e8d9b4db81a2019bd65d016454b6746f38d03d022db7112717a7c0d3029ddb4154ca2c7936f2bfd59a7bf4f40739077d248c5128c6be205483823e21bb25bf0af8ee1ac408fc3640c2c02fbfc6a77c8f65c8ebe584cf5c4aeaff5c749313d2ecf6e9b64c695cb81e3dc721f82c8f755d49be5c68919e1172372fd0e2188fcaaa848ba20de1749aaf106b7b8e83b9d7315c77a213049ba19eb57f100a2f88996a40f0d7a11456c08eef5fbb4fe0c86e3eea3ce472ec8b1cd241260d19d2b926254cbd651c576575acf64fd1da278da77750cc8b9ed0d8636fa919f8abc8380bc97d5285ae0b78ebad5c5e3f162c2d07bbe2de11c76cbc858671e7449df861d0bebeec33784cbc44e98d8890d2942f504b9a2e92a78c7116f005eaafcf514a90bc54748dd2a78ae7095745488bdfa54097bc7dd1c1a6b064bbdb622eab3c74209ecde36b603d088d6691c292ac6db698c2f37edd1afff91901253faf688905e0f1980f90286b74f7582568d1968463757b9c31ee344a06da75057a5a313354e9445f4284413ef442f01c8770d1ba8a794f9fbfeda9373ccb19599f8e67c8e9ba89500dc71df44f4c9613cc063aba1eb6531f742a4039afef25e22ae83440a97e15db1a736901c3fa131ef3bcbef21a785ef1cc95c30f1fa7c441e15ed91b94001019e42fa310701e5197f292349851da24e3d82d66e55d08f1705597c3e3199393308151516666524501e5fff1544d0808cf2e7cd61d7e98d265ca46fe914c854b9adc23845f153cf3c9c377093803ac9ea94f2ac5b6bb4dbafc15a4a1507dc5dffa0112f20f23faf3b4fd4ab7ddaef24f06a7c2a9c4ff5448a6cd5076a39c48393f666b619bab2ec192acc9cc95caab445d5e500a59791f5d36fcfb4bf9cfb6a2b2b586cb8a738adb3cd170e2832bfcdc90cc2c9617fe82bdcec519455693a7327edb5b60f87c941a86aec589c5b285a9f574d2d5760ae4ebc724f9446dd9e03d96f29065a67ccd8a9986ebf6bc292ddec7b3b7d0637e76eae70c80c9082975a85bf27513a749c9e58446b7ee9314eba6ba7e3c19da1483f2adcd326206c9874f6011aebb5786592c0aa47fd214c352dc9c489eb0996a286cdec253b8a4013e8e2aaf5e46e76d1bde3cfc7ed02185f372e24cf831fa0928ce5809ab657a2c6d18d372e0ba58b719f95751af23ca627704a3e134e3c7ab1a33c50b2477b196374e427772715055f4538f27b50a7cc463f21448f2e4378d8f685e571c79d47e5b6211417dfbd23e9c0e4fe3bbdd9cf86b2ee9a4ba0b66d13d562fc7b8bc80c10f45627ecfa5d8b56d1a65a8706d8034630a91ff72e9ebdbbd201324a7216e82dd37456502059ae8ff2c7753578bfe89b7838d6ef4d1943a031b60cb98697d4a946462caf39a5dfc6fc7dff133ea3b1585eee91019643de185bbd7c05f03b89c1b37174cd8a8e72aa0cf71a9acc1981161203f38b37f9d35473ecc4642520014d71457d7525d4d042392d376f9c9e97bfdc264ce37217814f42b9a10d7c41b2d7e34a976db6cd5dfdd291f0f809d90b2c13463502e90058c42fc4735d602f29330744639a44436e0dd4297956f5f4051e3d87b160000e2a6b4655be89625e02fae5bc5198bb7b758f926d7495c2069873bf05f1c6f29ecb3d7c83b1aa5ae048ca73b4f47120b4fa487b42052a1b3e4a4daba069b4f60e586d3766ed07341a311675ff596b5bfbaf09d8961d1285bda90315a8d662e6eb028e0f7c1a7f49ff56bce9c36ad30772de78603e6c2ac9d9598d4d6c4cc710e58e55bcbe496bed313542b412184e723865259fa36737e2b717a6d5bda2002522964198f7a2e0658871f43b0ab7a796f1a0822c566e29d32be65624f7ce249103596064a12b73c6b48a22ae2395154165e366c91f47885c3a6abf173fd63cb59fb6106938adffdb228fae4181b9e18e374bf483d7ab03cb1570d9dff1d6f0c99528d9b143209735bd193a8f675d6185f12317a539ec21f092273225fb5120876280f74c165570ab6c3dfd43cd5c9f8b4a3e3717396d8af42b34af1fd47cf3a86c3ccc9d63af2d4b2c41e4798d1c8f06a6651c85a6cad7e82ce21172c4853a721d8ef57560f101e09c3df757b40c38206c0d9e2981b2d0584e3102300fefb10bcde13e16d15e4c6b457eadca3f2ee34f5c31bd5a4c78335feb9942038d9a896de20d5fd877ac617e9b4a9c971730feeb7f4f642dd0c95b0a1f66225f7c3ec85e8a04d40e3ee0b2116b25187bd34885d00009331730f038086d85624da777e702723ea5b215d2c6e6ba06697ec6def7fda6e9d04faa2485ddedf0fbe6065f69e38faeffc37ad55293b5edb18cb74f82f2bcd70e2c0bd38b301790bb90728c5f567a8cc16e5b00d0a513cdad897a5900e2a19f785b6f8969117de0877669936051f813ab222694ca69684b8e29e93c9a85b5fadddaa89ed76931090beb5b528c1b7f8e22b0b092fc3bf840648ba862a8d8cacfc1a5c732f10a9a7175957200a0d7fa2810c74b8bfc6e5fe90c961d8563a1d0fd0ddc0873767eed5a75d72f978a55a6131e97596ee59a0025e0c9209eb52586c0ed55c39c69d6ced172cf449d78bb4e9fe6be92f1554dfa039c72ef5650ac91d1d4f122c4352067307c4e4a2f079a81efad6bdb8ef6fad39331a52ea470ebdd21f0e116b22fe56bcd556916d6c989f08a5dc16446d9989836c1682a0a455c6b97e52d64ee1c14485f8501584a96f879f49b68646faad32fdde346785bc9f4cfa2563c27c4baabc856744cc776a8d654f7eb331e3c824a895e7c7070f0dfcfd66ccc977ea1022fa7187810bf937248ad4ec3d0058cbd6a4eab60c5986a87cb5bb207f509b85cabfdcebb0f81ce54850d53ea4c95171b1bd7a60525f4cec9de9d40ec9e35a8edd39a63f5c0c063808ad11058bcb534f559754dd6f8692128a31eba94aa40f2e28388062f2bd1bd32ed3a102170dd6820ce6901465c933d4256f74ac8163063b48c9628acd103e138c6155e304bff630b2ae3b378e0899d2240a0469dca236b356050b9bb71709e623ad64f80408932e4c850ec86df31533ed7ad5d79f55b3022127351aebee12f9574c1537b18916dceb0598c0aed837d041fd93476ef41cdccb5664a0b658b1ecc7f82eca7ee34bc420acefbc328d77d36746022db32c3e4bf5acc08ade82ed2a0eb4541d1b253cd1e4fde5fe00a0a1b612b7a67c40dd4900948cbcbf081d6370c8a0e3ae28f25c2067f6ffb35c46082d4359af6342d8a0c45a0631872bff0ec21e72f6c3d572da8fe1b621ecee9a3fd0990109e0e36dee3ed86c10f6f5beec65da9ebe15db57faa9ab92b95dbb2ae9cf9670017a22f8abbbdd853cd8ca3d3b283a2e13fa1b371949f2acaaf79d05ad2254a90d7bf8327c4597f01c3028ad5fa116bbe80631d6f821e9f2ae1501b31925ca840cd50b42b0d48fc7c16d93b7926ab9e7c359d3909326a565fadc13001372bc27d3625487986aff1a614b5538c55951254f3279a73a1d9c7bd1b3d75b7e46f4c5fabf6c20d66c41c0588f9e2ea473f5eacd3231a9fdc15784bf465af0e995aeb1ed3789b9e9692f83edcd6bf238d2e762d1a7e1c57e68b5971105bb52c11fa32bd2536f0ab6acb4a8b3f69dffca3a1944e6f99557df67d60358bf672b7062064bb1e794b871a5e3d1adc28fd1a7a45312da2e63759f68b17bcaf1fe2824ec3bf4000cfe8516b10a99bca50a9f2c9bc3955d13ce544a19147d00ff6db336d52b519693b9221c5e236553c830840aac5f7282827cb274c547b7d6385826915be5ddd79197a1f9cb92ca5edc785e6eac4a423c9e69a4c95ebdbdb7cca86bad437fcaa4aff5d4c2a64bd261155229998e426e3fe1d8dbe2e24c42c824ef37f9c26d8518c8d7ad41ed5815923565a2697c679dde3a834d7fdc07c44ab79d8e11b0ca3847dcbf5c5aab8bcd06c00a7dc6d5302e603c4412b4574873e75928caaa8e071ff49e8b48234a81c6ae1cd37c46e06f8e0b7826eef42e612f2f3a898e21c79b122073be9c2a6f23a6229a3354c6f6af46ab547883b2cd8a8d666fecbf9c38ee46871b860213efedc90482e28122f79d0a55858ea101db62e4541cf84ffb953f3c75aac1dc2c2dcf573ea753f408135e04f2ea0075629c63bf678c2b45dd8364a2d86ea758428b1ad686474c733e5630060f34789c45a8ae9cffbc78ba4f8ec96c41a69dcbc2f08d358dc62d648f899138cb459fe37ce57e2eec9b9d4acb499810aa84f4d174a8ee20ee29ecc640abb72b48ced7a5c725f9b8706b8048d839469a3c75392e0cf26d2a4aae3f02ba6823e193b121f6666661b99b5a20bf1c0e56f4c867eae8e3ea58e023ed02ecc9757a945389fc3f822d5354c151028bd4db075f717569d1233a62a8576f9d9d0f136cc095dfa7c718b1e34fc9219bb030f29cfcff82a7bb36de25556e06594317fb72565fda214eb4eadab10bc7d8957d092e8676d4f68406db72e8308fe511f2871eb7fdf09060ec8f299acb3663cf06471545b1615999f9a6d933423d6e55af0e203ae560fa1de0d37a26440efc93f8481418598c1d3e6f60a38703dc60591ad9287a526a7b639562b50a61d6adff432b75c0138248c44a070baa443e7a71a10899e55eaa0840256caace2844c0901ce3c59fd66db2826cbfb11d6578c7c8c8b06bfd094fb2fc90138cf335f3c8e2816a01f9bb1508c7914bf097ed75ee2ce2ef68728f5fee8d65aa9ea8efcfa12051e93c2f0eecd730ebf8a9e36615563f63cb2f40a9e596b8d741832291c7020ebf0c9281106127e6a97650236c253d7fee1bcaf14ced858e62f4bab1a3868495bff9776c79e6385efa89e89645a7022a44034dfae5d0c67ee35a82bb2075d03be7693cb98cb523c1d708f90f9dc5ca6500eef99a1042ed8e6e0a73c0b999d7e74c728be77a0cd13576292a38898998f047049b27627c2b662e02cf964e75b91612a12470e8ba8e0512624bb0fc526285eb80732bdc31dd24e5382736afe5f719a71868b112ef59c3461049c9f43f86bba6348befb96c087f7d07b4a421535df2894ddfae4aad18c512dadd0a97b53cfedb39680983db538b6f4916a19fb25a6ecf025bfd5ce99c9535fa93b3c6b0998ef2d0e4f89ff30bf234fb4b1f7032730ac3b65b3bc6ba41a580d63650244c55721b5a392e3168ad08c65ba2b2c5541766c34db76adce32114a2e99e18ad445934e6af7c05e94462bf483a239dfe08ef0a907258ee160c053a57ac595496a64699fe7657a71da3ebb240198d6261dd7819828ccf4d9c330d96cc7716cd5421d548b265e20219ba284dc0c385dc2c73ddf7d3bd1316c91b69b09df45a4a995571ec221d20c620f59df6f8082a907f39c221940f99ef52ede9c01bf7f84fcdb96e864de65749932f3ff86c6d31a58eb86d96f641df80e1494047bed0a01dbabfbee1f6ada47eb586597c199d23b66e17c10643f6e06b54cf048546cb0736a30c9ebf91e013ce91525b719fac8665f71f978a55b84ea8e107394e529f18499136c4338bea85e42e7831e6273e35b2fa351b627cf40c6ed2a80d32043f74ff88a27d1bc5e395afc0e73564f8d415d026128a4a905c79bcf97a3e969e72a3f92ddb177cf1838efa5e26608d7bef1a1a4903b306c45db754b32257e0908b1b5c7b68afe02d01094b6c36c4bca27807d0ff37adac092daaaa32a2e078990827179a66609653090fc8a367a56a30064875377a4a80696cee557d9a50a54917916aea4bceea163ad21a1c9b460ffcce21ab2964735d4456b2408f1584006f13e492b26a7d83d3ccd3c8d1416834d246ec39ad5dbbd62e68c3f69d87e2739bfd5b8aacf0c0c1b1ccbf7114663a01bfa3e44360a29d3477a5fd28e86091dd6f03814e458f6ae253acf9f319f595b1d1b861a22e61ad3eed38bf68ddf1435f39d4787bd5049f47f456a17022fcbc9a6876a9c6ebd23707f9c6f161625f9ad87ed31ec05ae9c7f3cef202e5bfb50f3efacc89eb550247a40a30087f7c930c41c64f8b53f1ed79ab50f186f82b63ed9b6c071f46f90dca1c40ccd12dbfaadf0b872476d510ef80f2fda6e3da4c828aaf0f5d9a8b8c77e4b542a6e2c5b3e385c4f9eb8f406458c92f764888569be9569e2536951cf056f64abbc42b37ebca0c4adeac6410a0e4cdc0814b8fb63027330c1074ca4dfedc1c079df96f7cfea0110ec83af01236e6f88f3a08d06ca0cde9f870eb560d6f86d1111c0f68fcdc341917adf236592173fa3786ccd77ce281e12bd0932cc9e5e1e4423866de97f906b16721abc3e8b3a2807285152c3657de533c4da589e7ac9a345a22a42117013f933867dc6c880f4cba94b8dcce5f78c4d81f675826756667cde99373d67a92075c2f208d318510e460827fb51175e9a5f9489d04a8c4466e04647e15465bc65e12358ef38f39ba7a1427b4d7357b4cd40e15f1af4b490ef3914986555472dc8f5eade6a29d76408bab337b7b7a9facc9d5f437782b236e540519f7350d1c3f38f147c71f303aa45aad5beced099cf9fc4187c6683e869cfab8a60a9d44a7968797c2333b8bf51df75793661849545ed47cab076879d49ba096aa01d6c8a5b2cc12f8cd64108e4781c1ded8125980a0c4adedc6abb4010e9e1804d22bd6264fa41b5932967e3b93fb583b36af18b0a742952e313adac7706628da2b82c4ca313d12050eb4d7f10f98d1df450e90706c639c94af3d3e796f3c0244b7b743f2c54586c916f9a3bf96d4f9727fa7769622470f7de54b904c92f9c62840385194e374a7b6b3253bbdab006342ef6580b6da4cd3dcac0a6eeef678f0756837a539d5253cc74b0198f432462a05567f85dbf229c2ba6d718955c7c270575059470cbaad2ea747402780b474fdf994fd7ae81cc13263798c80cab5e98147691dfa8ebc37e41fe58cf735a32859d98d74d994ede45810c93d08999deca642717219414e8a985f6f676997ae27c50326dfca30ebb113354272f640abe300dc8647e2fbf1d70b485c200b5b15dac4cbb6aca4035f7241dc59c4d0f964a50c0afffafb9b8edee3240896eb0f08caa2319e5fd92a5dd15f7d5732ecd9f8fc33c0a395c0731bcc111302bf891315c9ee090a73d091a9194c19242c8a0ea71e2eb1348023efab9314401e1b1888bb6cd925f78d095cbd2e20e48f9bcce15d369b5387fb29c7884f3d56083edaf8e6886fafef8601ae6a5b5810f05642f2494ed1126c251e1e1f40fd9ba1c26fea623101cdbf1fc78aece045e93aeaae828f46488ffc5190b12d480c80020015560a688d444d0029a2f39caaedcfc098cdcf97c2dca1ae5227c8a3ea7c325aff00c76f62f5bb43bec8bbde18a33a71443b0ce3ca011563797fdffac020e4880b06db3964d4ee0a36b7f8924ff661213812d4c26dd0d7bebe6a7ca90bce9dee83edbfc2848bb01784bd38cf572744c63111655ffc100fda4d4535df88c2e0e12a3656dd90fa3da0b80d88f35e3b873517cadc1e4cce25c5a9e4022fe1bc11084b9fd3021e755a9fbaa45b8fe03d6dcf7651ce5e666b5c14079590f18cf19a80bfeed969a777ce943997884f60a0e49870c1e59483b372bde07c2a986731289bdcc3214edc66326c482755826a3f9c4c077ed975a873a62173f4ce38a3993fb9d5baeb0226bbf0c851d6a26a3f35e8f530f9317846df1c5a788f59a13e6de8b177d15fdfc302e94d08fb864c355569cb104e0923761a27c2d15a75983e8c5851085c9713174f2182659247b66510741d320ed6ed995500d89b07612414e07538fe1f2cef43eef6bacab9cfa876ae016ab918a1fb90dc508ec8e68161a141e78bc320f227bc1a27449066837a093512926a8d90c3b01c88a61d875dc535f02046ae11d19522179e61fc3908527434d063f5535099a325e3b33255d44139122d8ac153196006b8610bc83780d1f5f6806fb524d8f3d849422e05231c11edba2d4623355655223edfb362965970cedbf4fa95f1fa6f03fde5672ef94e01c480f452690fc46c4621a4f7c49fc788ea2d56cdfc4294d7a1e8d0eea7a39d13349fb79146373464e039972a8c766256c32adc954d694d62e36f0a2653d176f3cbcd77bffccc5359932812b44c1e7ba566fc6d03145d0655f523e71e3a57e26f9973d7374dce9cf16c809213b7b98aace1f9bbb4685fe7a849191f43e8c346fed651b2e9d594e823d02adc93846bfc4a32a293c8f829d0b307c82d604c2d7708700901d1ae212cdc728fe156688fe1cc359e6fbc6790499f82418691a3109c4b721e8d69e261398f45730adf0aeff0a810e1223b71732e437bafa50c0d7883c14543c5d9a4b476fc1564f6213d5d8286af7e8524f088dc1b80a1e83673cec72c30280e0c153846e68b276447e4af8fb4b7899da7cfd796452d01cf2245ece153eddfc58f0d1ce92d82e9e88f172999abbfcf47dc8c59c885b322c6626f181e8b921fdc9b62d53b96562588c0e12920705004663a01178dae439a6af5363e9d212fabb7710376ed885622fc1e4c4f19fb0727a5c36af73c3271664df400e1c6ce4d7d89509285e407b3b2d246066d124c00261e400109f5ec8764b334b724ddfe88a47976b5358c59203a789bae18f0035e68e5c10472d9c4bc5ce194275270fc4ce79fdd2e2c6c5181d68b4c8c17aacf5f49fe693eadc34249e07b4c99116f32a2c85c7131a658c1bcc640ced652472fee49d1c78baddba14076334831641e25c009e7c45bc4d9639ff57709881d3aa18d6fb6d5762eef43586cd22f0982c0399a69e326e43d511fb1906d632ffc5aa3b63c6d270fa4263b09737441723f3c4cdd97f2087f596599c30e0c62712e64026a85c8c8040026aec650e993117d5e5f958a5ac1a7fb257bcef1be101f39beec947362305f8259e36203784a5681fed34b09a1d5a9e46d828e21f91213357b4b74801d806ebc95808b57a8c112f8a350f87ba819bb650f5e233096a4340b4a69b2948e6357492510f6a59821dcba91f6bae2dfca5374f35fa0505766b304c253423525248b1b1b3ce1a2920bb2c1fccb0197317f46379e50b10a9fc31e531656e476b95415f94bda54da096a8dbcfe4a66827cd9528f1830e0651110ba5bf655e2c6c15753d5f53444b5b22bee281a13f3b6f6411a419ce55b332dbd4141bb2acb4746c02c5c67e86866d9f613cadbc032d0f90b7f4a3f5e4871983282d50350b3f43f6f024594d558a1231a7c5cf12ad4a83e288140e9ebc51bf1d4da7d54c654ae789e9d8de7f1aa34889a77cfe70548f82161a27db25dc050032f580ca344b1fa395c8b92d997bdf1b84492625e7bb6e08fda2c809c403f7d464929fd1a21f933b7884397d8baf6c6a64bd9605b216e323e134408ad23660911bde8f49710ce7186cb210ecbb971bc0166664a530cefdf8fd4132a2cc568186ce326180c9db6dbbdc341509926d911297a0dcce164cbf97302311dad193bb520352f011a9d2063c2c22ccbb1f8cfd4191e287e841b58e82b609c209e24773df8570585de0cfef519472438acdc901177f6eab02acd086d29085525482c7b79b3549a5082b57d906ecaf4ff7ed8c158cb954bb27e070c78e53e971908a45c6fff91bfda3a4dab34a293a3b9012eb6826f27f806ccac43f9f55b77072cff2d96a410388fc699371b089f671eeeafd46f723077f47d25bf3177471043ac604384119513c70a435df08c6c062e26041917a5082a72d8ce668c41330cf4a8c98b4c672984c035cd01d5d833dfa3daae675fa13aebd4f0368b1f99f09451db137a036afd145038c7442f747f8dfc658a9ae2f188463dc03920018981060128a3e8f011f9c27399a457ad3823fedddea9b58e40351c355a28a642217a7683a841a09dddbb6df43fbdf5cdf135d8ab6261086d7e46a5840b262ab2bae6713f4a742c7b6377f16c5845d26ce01ad63d2c6d2753d9137b96d6350e87c8012e25dca607ca0cc5e56668e4f2cd7351f4592d5bf10b13c3c3415bc80dc32fa3af09af2d080924921dddf0ee7a132c2689ec58bf15a7e39644111fe1452a33b8db9f295df54c61592721e90340723145b555019b6aa17f583ac74c7e3cd37ae0df296592f2423bc2df9f9939b833e238171199fa00e49cf397be474c6821829363c38bb6f5cfa037ed6d60d7a421f23527aeddcb1b11edf41d0ffbbbbb86e95466919ca873f13e11289421f49139bd31e417b65831f968ef29e56b72f9bca6aa61ff8da32869582ab9877a352c573ceed849fda04bd59c070677cdfa971a66ca479f25b162ef275f50937a0d7f3e502a32480c6093ab9c1f353539d7655508dfd9797c442de397ef034ccebee2e7f96a21b7a0ba09f1cd2aeb29c8897f9b7d49d1a7b37804e81e280f1462a49db9c30f10400bf69019e8f6b5119ecc82dbbed34720858f35f187ed037feef4bbe0e1a21188d1572214b95823ff58c06fbbed57404f26bfdbfc232994fae63ad8874ac3a45cf4444f264c6bc0ec7a813abfcc089f8253e8cce984e1725af521cc3a846e6e41f5acc441d37e544629059edb726bf490dbd0075901636188a44c9ca463526015698610cbc4361a168a18fa4b1105b2ff2859cdc69e729f3aaa958d0f5024644496adfd59ad7bb032dc7b38d6c707aa7e7d203478c6525e86b98c2b0221def7173296c73ca83a73f3c1c1f5721545554e8ae2cf8732e50b40e695c4bfa1a301241cba7e0195dee889b4abb5ecdd3f45116eeb76cb91aafb73c6df56a8e0508415912c5ad4326a211cf3e4f4531fee444a19fe69e7035d2d08775b18b27b6aaa08d5b5306bef7cf4074c54b8bc4e323c35c7232ffd5204a82b69bddebcf74d1652de2beddf518b2f38ce1d30af664a3c72699d17ab99a5477f51fe09d6ab91368a35ee894caff917e2fb0b6adc5347e88e3f962d7610ad1abe413b00514fe915c6ab7d8e1bac1ed3a54671660105d088e0799f54f31b7d5c20a315785bd3b8021da6910c15e7223657232830a12fc5eb3bc305dd814f5fc93c25610caea43dbbb3b66e3822999e0903df0e3e8a3ed702feab63bb58a6b5f606dc0d96f9783bdf5eb2c2f0d897cbe578b0c52af6090e7f2f99e574eba060c11c250655173c5bf8b0994d638e01bed3e3ee1ed4f08ae176552cc9d5b9a338dfc7d43d5e1d1a53c75160fc6f7b11ce9256457344bc8c16b2a8708a1ad199c85055344c6e62c558f8a7f23b34a4fdfd9abf1a27585bb007ac08b09cc24c707ef5eccb6c2687f706dc0a6bfa47f3076d5bfc8d8c47bc0d5f8fb7021f9d470aeb9a188d976a396c20b6d2869456815b2463b702b2f46d0c9d58b9c4b843ab86ec950f35edc0c5fb28303a86e6052de0026be8136bf77edff8b1386af41c2abedb4cdecd3d2215f53576074979e10663d6c62d354adb9380fbd6aa91c7ec3c56df8de87a9cae91d30f65cb4fd39674a693f5ec583df6d14a2d6d2c0fc34ba76494efa9dc42de996a860a42586689c91fc8046ee4fd0c8cea9b11d057a09cbb5d5ba2356cbb5c4dd885bf9475abb1c120077e833bab0d07880f39e9b1700fc8e7ad116acef862496cbf2af9753798ac929d05ee42e7760524258fee1aed9780664e2fdf7b0d9618d962f5d3122293cd113678d88f7a4b49763c32b247659d5186b8170641a337cc8a9b5884127c29a0d1969a793c4517183b27a50d5dd119ac52fbc5f7ed48c297a19ab92b29b92cff726edacbaaa171b9c556fbfd72318815df71abd14a2538da21c98eea3bcb6a16bf6656b7a2caaabceeffe17af039d3bc2c3a651549630df6793347bb5f0baeb29fe3e61379b101cc1d3ef11660d1d923cf3e15a4d7a36077688baac06dd93914a196710c3e2c75da12b8e4d36d86131df21f70ff9e2e22a9d3aaee04a8e4b9669cfaf73d52456f9a4d53ed5e58f2b7ff0687330bf7400b8e4f0383e81dcd2f54bfde85d9b38517db02041fba9fd7b1fc6be5e9fc111199f09be8e89e759895169a38fe245d12c20cda0d27715eda8dce1d1a21525be41c8d525e75e8605b7e097f41bc8c9a8630829d3f8105a5f8832a399dced179bdb7cf1c1442264478727bee4244d22f58cf08570540dda1b9484a490f860a5b8d29e11e73d3f28ec4d4550286a55258e8615b44f8e7c118cbae53a18cb3d67c4e4f3b165b4b48956b2c91894585a7831be95c4d951a016c6baab7d766bf90e0d87bfef1358f650455a03d97b8acb57d521832f54d8e65630271351a35481033880cb81dafeddfe6ac83c489492c9d210b40fd7e0ff9d1ee519e5c60ed571b2b0beab88efa7795c7cfd33df00d37f4aa7900417a7d8ac8b185a1c7a65328095600645aebdbecb2ec3dfc0050e02b0238c2bac96c2164baa3f9ef8d6bf99a2c1230eb04765e9fb19f0ae610869a5145e2b979300580d6482ef442a0b70516f033b198a4c71146a0189893a89a11a99c0910be9a66ce7f3dc5eac81f5733645dffab65dbd11018e0521ff63c134bdacd38138ce7a0a9a9d6ca2b23d01a78ec876a001372c448d57d788b5f2513cf34ce85564d4a96f1431827962ccd673940d6eb3fb871c4adea9bac2022898b13110f10d5c57eb4b1dac625536ef68278363f44a305d3454a1ece4fedb44586c8f54d7191435583547abf6f2413e5262f6623da0fed7dbf807264416fc6087b47318b9e4f34af2d3394b2a2dc05e7eb23cf857487e16616711bf0198a2541ba82abea225f47f9bdbbde2d8ab2061a01170b577861beece16daac8f0a18c63ad325fb19a16cf7d10d7313f7a162c7b523350bf44d6db76fee24b0e8e7bfd33ed39b281365e829f3177d2ee95e8b255234fc5224754213437bf82a6edb2e90135c181b36d8cb0f69acae81304d3caa8b63c2ccfa5831afe35d2f13f18b82dfd79a73ab30d7dfaed1f6c834362dc0438e859452291932d21f2e3ff9419bbf26d32b92b320dc9cc4da8be2f1f21a5a18dafd058b6f9c2266107400e72a62315871973c71c97f87d7964487aea33c6275fbff7de14aabeabc4ede15c9557e23ea2c50e6838bec1ac5a95fd6d6e1d0ffdc2982fbaa4039cacb9c6511e64eef48b470acb0c9bc99b787211a0a1f96307dd068d88ef12fe9a3a180add97c2a30e5f0f708522d48a9c6d65f1a73eb14344dadb062192d081e5133c1ca284e01bad1a0975693ee4f2624f9a95307c6ff553ca8dafbe48b057b47f9b1afa7bede93d6956564f709dde876e3139155c7b28c309df492fbbe8da4f205bfa8e6b2cd572605d819e8ad3d1c868d048ca3363bfadc370a2994b33f1fc5786e504325634e6324aef2c92879a9e38d4ec4d4b1483de6721d1976f50abf4ea19510ca9b7b380fdbab9e1ea97fbaa0db381b1d71a388a5a8fead1671da6fb3487924d9b745a956cd363d66a8e9bcde280a6f24c28f843407d8f33e84c5fa026b1fb79029a4a62c9be020065b52b0b18ea61287004d107f3b0982f091d0b0c947219994795175e13cd931504e3d3601fa9dcbe930305737f40201d24025a0642df440cae1f43461a3a2cf349a1c68c3ef9e3bf550ba6989b2047f53163af5106bfe9b39a1a720580c8031f52e496e6adcedcde7614af42c72eeaf4c595a64eb49b0a2e38175823f587200acd1e6c302a3a6865d67d4d4018ccc21008d8262df09819911066da798020f01b356b872a07e796b3b36c6cf6c32a9c1711d29d0dbdb38f1f24e4f59073f306a7718c4b0a4f3670fc81211e411f94ed7052ff9cb1b3fc2f6574818035fe3c10c8bef37ca1742be7d3476ea8ac33c826af30931d7eb8aebac0ed5b53a39613d968579afe9d995ea492ff749b62c3256ea0dbe5635a51ee0bf61af307365a0fe7d8bbb8415bf45058fb9c3da1a955f6aff555fd85934bba0a168a4db11886c2d906c079b2f8b853fc74d199a6ac6ddf7f3944049439e5c19455d4d5848d5c77028c51f25bc56c893ce9c5d7285e827fb6bbfc7107e6eaeae5a862815b999a1c89b306fcb8d0539bfda942febfad819ed926a0b20742943ea3778970cc3f668ffac6eb88940c2ceb59faa56667c97686a528d54ef5ca2cdb75ab83782657f5fb50708ead5a8fe508d52b04b87a7375a194331219bf1383b3afdb86179f8070c732e2865a4518f7637dc6606155661296a379d27e83a6aa35f3c377db19ed8e355dc0a5c1ed1844492726db10f3c0c8ff684127f16007d39a311ac9ecfa1c7d19aa17d6e02b21bc927bc48b9af9b5e30934f38dd74dc3c3fab53ea1aaa4c3d04ce29677e378aa1fbb2f1e43e0cde2b9d5392a51bca3b6ff5f4d33fbda780ad0d013eaff0d8dbe9379586d1b385509df8824785b24a29d0bdfe811559be51a6ff6ff4065cb2202a3eacbf86979648d9bd8fc8a9b29828eb4397bf3f50c991d52dfb5823ebf383dacab51a920b239758f73d63956d63dbd8109805e24bd22a69608d97e684db1c38cd348d1ace961f180071fab1326030602f00f808b69a90c043e4b1635a0ffcd101408c634d614fb73b05c162144d03cff519c86606cf9b14cb096caf8638b5b68e1034dac68e1181d0a26323ab1e4d7acd66dafb67a8ab18b1399642dea3f5382ec8cd849351b9281f57b1b06a98e125c78d036ddb1ad72b356dabbe2dd440a96bc6754174557f28d31033e1b2920aa028b6b18c32a43f494aea47a301392e37185ba5dbb11e8b4bcc139a7703785b3f7aee4f0a1f1977bdbdacf5e2856c89b48ab98f3f5f4f7a87a5e21cd3a2181792130fa15038122c82d910ccdac170e3330016e30c0bd3ebf9afbfe55cf735dd0e767808ecf579d65abce8de7844c0a3c2d3365c4b956d47078136d671d500a1ec6b5b7a4a38f7425270cc0a7f0951a628cf293e88eef2d30a2874618efe914c5a2ad6679f980e71dc1b04b602eda71e9739988a42974cccf4f1b7e44ea5186ebfedc6ce7d540f59268daa01d5bb052bba186c034d25455c1fbfbff383cb9eaa17025fc9f7f7d36a594569922e617120a9947e6234d78e7600c50a56d48c5650b4ed75de65c95f15ce18c86319fd955c9c869e07d98a21e76c9f2e2a2827959a70abf1262ddbcf5d820b1a8f3c22cf7dad83546bddbf09e104d89e44ccb96b6cb43bf18b6ec6cf375d22741f8b4aeabeb2a3495bb43f2cf5f42c30f5cad84f7ef505b641ce3c0077bbec3aab6878ee25abd329e34163d24e4b84eedbaf1a70a121acc910054bcc4ee83061219cff5a8859abe80252951321fb14e749295c72018","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

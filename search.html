<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"e5bc71d1b80d872c5e90e073cbf76eb57fc033b0005d7ec199ce9b95e38bb70f5e50491791fc6aecd9486e590f79b59dbbdb30b68c3755a581edcc189d9bce2b78fd9ad51329463ef7ebfab421ac4a4decb1633c2303bfb57a164970d9c5d2b3c238e8c3d52052138ee0c912c82d3533c1c7413e037944d2e8700826207390df027505a3fbb6edcc373c7c10ed6757869336179f0cf7d965dee4d7857ff005254728643192e801485f00fd9532cf5888d25b18ce77ca3a0d2161fc655bf63858da5da472bdd275e343018959c849cac18b708711ca7b9754d061acbbb34df25be0bb0fadb05c7e0e7c25112c7d7b46d0a7f58aac62d2e1d3f5abc879f5c18ae3e2bc6dd236136f8441e5b3382357fcb96c5cce94b0b2d83a2ea64ea91eb81c5df19ea040a3afa6b108e63ec497b22f24e3c3811090f40ccafab51e0c46bdbcae78ff2dab396489385298c8bf8f95916593e7158a17a464cd3af88fc9b1ee7b7952258530570054d102fe0ffe741e1d9fc4491f1c2270c48838ac7603a22723084c605f8e7f26cd5a5ad734de71c8a8b2d1c2270fec9745213c67072850a98c5d92b5a02e81d8405a0b8ed013a242483565ab032fc69078287ddbb640fd746fd72bd861f2158000153010581e28dd30758117c6f2931abcc9166e82ee43e4a62da2741b001c89845c1b5a7939776cb9139793f0d454ec9797e5d545d266f348936d3ddd8b6994c0e15096013f815c7441178a271e12ae39b6ec66d4d9a57938a79b79677c68831f0a5c697d808c82ad5b33cd00f83f9481a30f416f3d3d76e33c3b0561826aff42348de14fb2109b8acb0130a21047f008b97ccf1a8c50f646f173c93620f5458ce8753d7ce5aa1fc35cd9837ffc303d5e1fd95de5115f2e9d41e40882ccf0875354a92f3a4d8cb5fec7c42715ae3e2011b389c05c925437fb104d17e44b152ef7c1a881a519bc529bf5d716fbb23e448d31150fb79527df2f178f2acea7e410d9e33bb9de3c4b04b710fdfd51770ce3a593e1021f35ed7378da26502595b32989716e6e7cfde63e8d154d2279ca1b5184be7379c0f43e2d0426f8c60d8505db0b390392db95e981a3c71e02bed297583089fc31aa00b3e7df46d1e8591eb194a5d24973d45b8f7175ce51ae358dca69832ead85c75891ac464aab1c3a32459c600cd54f62902a39e7c32fe947c1324a750ef37e70e74514c1e545d4ea368a30977fd3544542c1220f2cdfddefd3b73bd0c38f3f9d91692a6dd68253eb6a476b23022569509e421423f6ff1364ede989dafed86c4ca03df8c1b3ca703e8d3bd0577f42b214f5f46ab076c2e2db020c1593e83eb59cffdf1e7b74a9208a8f50a8bbdbc026ca9311ff4555279a048e5fe900478d28e71040237d7aa34c2bbe823a4421d5076560b3a0f5885a8fc9bdcc3174f69a48f4d0137109ef269a20e380cd409008ddcfdf93d1c08268067e02a4fb77db4492b48075fc565e70b479f42a680b190a28733a25029039c716f841c9c9c38190d78561eb61a4fe820616b3a942cfe311df9bfd8e4910d82dc67f2300a193aaf0a5ab63b75d982060511eb85d33c94daa5e8d3d091d9a72e89849635a0fa3c17388077ba14eea718f819065d9d77d6aee6a5d02fd1600d10e453ff87ced9cfbf2c0e755a6ed952c9be4a9ad9be92dee39e31eca8ac21f14fb3eeec66637849665428de6b370191c29b9d208188947ad8b6a2e7d25143e2fa29d1fc3f09b1e2945014c2ea30938be13ecae62cab8dff3c402b88fbf7915f8cb818f1d3cd27dfc1f0a6f3cab4e4503d36bf6db0bf22c189f95e6736229ff835b42830ce31a9a24b1c76905f4aa9177023313c207a9db243399c0aad2c1a46b42ad8ab8de17a48ef5690acc908a559bbe69765fddfb777ddecd3a5caa30da1899a588c8823bf3af2ef5ec5c338277d8f48c545013d277b2cd14f5eecbc712352b083b33d209eb1e732b11a8c4ccd879cde2c2e004172c8c3a4ee94e1a6c4b7b7b5f36cd705903375388c45630ca45bc38a972d352edb6fc53451b1ce51058f4825605b236d28c6e4269126afc8fe6c7e67fd065e6d0b28c2e0735d72caaed3e0737a043fd1edb915c9ba2aecb5a50528672f782bba5a7373044a163e0a3d9acd0c043559df2bba68e6a841a1e7474dbb72d137061eda4f17c2fe7a88bef501d3c43fb921f0740170adf53dee72b6c13b55027fe4b3b60a5a7e948383f7805bcf4ab0b226163a3dc0b4c7ace29fa5e426c3d04055de9afa29d8d0a4412b07ec1842cc95e8ecc59c460a3fa82887cd61baf6b0ef8596d205c3af43d9abd617abea0cf2ec0ecd4dab359413f4974afe4aa9a14c1e2aee2ec893e960d4d3f25f6584b0ba840156c3548362be6de05e6289a452d1aa94aca19e01e76a48f7f2f2a1c764ea3069a3c4a0bc04a698e5005ec7f7213ae3934929f9484d0e76d30d60664d83e35c4f78562a7b621574a31cbd482f4c9f959037744dbd0966eac4ab54d24d2ae552d67c5e7acfb31934a8e7d63d41f452c08922253a2b4545f55295ce63d8f935665f33c5fd785ff06cf2e1fd413f8c26e7d328756d73a9dc907fb8f5b11186b80a5596516c11b878194bc41d8c24c0f5055ff31a0b1e33b2e09d28f18a90096a70de27183bd1d390c9ff55cb7ac3d97dfcea162acc2b31e2244af007da36d078b58e09237c86f1036680a27a04a8dd457fab44c951c9996e5ec8609bb5db8f62a16dd607f7c5b67acd28e034bff8b1bc2ea4e5525e0ec05fb683d39bb10231609b7b886d121f9ebd40f70fcadcdbf4d2ebf9a9d820ffc7316277e5b1431a943be9059cf00865ad57e222ff1f2cae38cdc3636c0558484a5da200721fd6090b0337fee1220b2106d2e0126f09d8c2b4041f236f3624090337efb799cf3ba86f9e29494597992b9e022081e27f9ef4c14fbcb8ee00eb52fbd6ba6e0b0cb1f793c5730eff1bff94b937657acb68b81e4edbd86335b6a5314b37a7f1ed84c0984ea942d73725b8e36e33306838887c7d8b3efe2c955211fa88f301ba9440e725976ce6159ab7848a9b1adfe449291967963e86335621093e3513a2cb254d580eab2cadb105ffc9fbd39c1974b885baf0d30f2b38ff36a19a6a19afaeaa603a8d7f99ffe91d6b175955912988db84d897c78d6416e1c01137aa8c7d04fea11749eaa4cc93c93c647f007fa6dcace0d713ea881eb185f8e608ceb7b538b7f9e140b950871790978023d26c3b61e785b8f67030970afaf6f1d73c02395c06da011345076ba04bb44a7c2a27d5e96fccd71ee1ab71106e3eee9ea2a661664b8a36615d8d5da1d88fc98fdfe830f7e5ea33cf40208fc7493c865f6ee82fffc67d274a7a3acd0d8be08d000bb391a094ba6ef2f6ac8448025138404e64831c01447ee431091dc6c5b019bdf81a4b1b6338551eb9e39825ffcf59f61e8d80514b233034bdefbb2a8bbaf0a42676e27b863d4121caf442b688150ec18367bd17fc46d619dba0255c08ae806bee91b591e95edff867f731346e7fbc2e6b5a00414b2d742bd2916b007cedf1fc7652ec1fc0a876167815147ed3b8b8a971a3f04bf19da92c23cd51d05cf4e73494a757e6c6d3ffe019194bdd81c79dfb7e499ae84bc8269bc5b911418ba74987d9f115d3ef6cc42392f8e4dd4903deef70270e8a87e779916d71cafb8f08f63bf880b77dc3cb73c640b262d67682a2449d0d0348b996bee26b5bbdd9959f5ecafed87da80ca4174dd94e31e27ad17fea3c573c51467fda9cb5172f106a436b8878fa7abebc9aecaec16f7e1cbdc19076bdf8efa23006344e51891e4c7d5a3a71c9b3bcc58fb6d3244d7450cfcf11d47bf865db0e29d3713f331699cdc0271f64e5fbbdf9b5b8153fc761179d08a4badb5f7525d547b583a48d7e0d34b4ffc8eec295ae46b157613f46d0e3ba0c02c4b8a0c0086a4f944a41b8dddaf74b00f26cae2f0c174ba79fd4513e101b0955dec934e8f87f17780284ada8ba6be2e2d9659491279400eb3d1d9ee8c9f5459bf3804161fad625c64dabf6e6dbb486803736603df3cbb6bc783d4d7260c62fb38c1aade10b2976fb0bd2705741e05dab4b1a7a3ea2432d0550bfd2b936e2baed3fa1c3f1fff21cc0bee64e4a97786d03928c894fe172fcdeea7bf75f182645f141e9a8c2589b246ac16859ff4154590794911da292f50f1f5662479b6bef700b3569c352a3a7a1b5fdb7f3c53420800ca33595e648421b121a18fe40148607fab963391cf80d39c839892c7115f443b912de1b3b78987008793bf78973e7345a2be3c8ec78ace20ceb68be6aa2ebc5ed6ccbd8d217aafd6ac91f6b4369f5358cac7c5a0845e161b9290fa0814217fe22f68918f6590f282684221a1349cfcb0af54b9472ce6a9f288ca58eb682f90b148a830b840db58862b2c0803c1f73b4a223d93e545576ede0a7751db4d0c8cd1515ee3cff198ad35cbd551333a1345278670d5c99ca267a4bbd7e36a4c6f053b031b30aa6d13099716acbc108bfede849f428c1d5bcad53a54f3298aefb9ddc54253e0f0bc4a80e106472df96f281ac98b18cd5a9501a5970182283f2e3ee25c879b3a13801e2c9c8074c4cb86fe11777ed225ff8ab035794e6d101675e54b1eff60050fb1cb09e41398d43f8fdecb026a61baf629ad4931779b941d1f6cfc1923a1e71b4a96a155cd7808aaed6236117bbfc5c56c784011de484fd0bcd82afa95df744cf189ba45635dbae70142d1f3152c0ddc2c7121cd86011d2a4f67101230e66fc3f20e5d09581a95866791f9c0736356afa003e25146c3e4d1f4ec141a755906eb82258fe84ece8ac970e7f7e5354e2f09015df7e5385c212bb99c1674612e11ce55c5a691d58b424bd593aa3c9ed1ff67fda301bd47a7cb24483f8ab2233d321b816c6281e7a1ccfd36e6c383edaa6cd9f530f1a6aa73389d37a153da8cf7e831c2eff64dd8b2cc6518cec70c11d5437ed986e607359c3bdd961907d88c28e4a677cf2df057cd18b7bab8195812c833091a6a72d2258d1b4ab34e5de669ba21dd9fc8f4208a4c060beb88dbe21253fb125c0a73216a6f6f6b412f189327c98d88ff7dbc50f48956ca6e7eee24127e59798b2e3afe06863bc2ac142bf3e2ccef52754b6f5ba733d912db5d69341d7e861adc1df312a5b24b447acec6dc7a8acb472a878262e6ddc2cb069f531838c7cab25913ca7d5eb77ce10676c178ed8d55b3cdc19b80c7a898aad01d6dac40538d3895e7061e9fd6ce2e5a03dbafa6193e0eb0ea1f9fe394ab959d711a1bdd0a435010abcddc4f34ead97d4bb7e6f004acd6cd5d0840c06ba21b80905f97ed93d1dc8882671216398023c1e992aaa5df211e08b660ad1adb22c3e1159ed3715d44889371734f609ba9511f93c54a3af56d9b9e12c5616e2caf594c15b5f738e3116142595d84ee41f64659ac9698539d3b17366ae9a6681ac2fd0aa529d15b4bb38456dd9f3f31509b014da925b56ad4cbbcb3743c229f00010d7a47708907251d1989879c2c0f493b4a63af1f9576d955f0d4a8aa3eb4e5119d7b2d5fb67490cacddea9b5e598f7a94820b621ef9f6341cfe082a1e55c83289c140e98defaeee3b1af3924b04d860f2a872fc77680a5a23faf7fdcc7fdb6625780ca19eabc424f8ebed21915c2faef22417a4dcd2b7a61ac26a085cb05416e8ff2f436c2f14884e81abba2722cbbc8de850a36ef37dc432766d4e96c4ce8c0c9c83dc6afc33c2ba7d67315c5e155107c593609a47276d2492bcb3e6f7d446cc795a10ba2ab979b38e16d16a5de2797267bc276ca8760c250d3f7938b2c10ad9ad76459ab2664e6545fb032a57238ce66794880db559981105f8cd577db6ca7c2ecf89f00681cb6d5e57c5c9ea273121168eb8d5d3c061a158dc47eb730a45793f3d5492e9fc256e44f90dd41406acf891f1759086ec687210bd335628620a091e38fb9b2c39e86ebf1e9945aed2a94925a72a27d2bdb1fca37966bf9b69f96a71cdb90c2d475d79f7a75e97c8ebdd30888607360a6aae2b2f038df7cd37b15f4ce4105a1167f645e286c9a958efee8d22762826bd742915ca1c5ffe11496be532b358b69b7d18bd435bfcafc4a55c2199946fc019c3bf7b7e9d42a83858e7efa15984e460915655fab1b85362672400a6a0b0658fce09aa380876c8a313952b8a878f7bf43d83835806770baae48070a4f3b7ef74d7c4764e198b6f70546cf1619084f7050debeb222df745a5d70bef12e274ce05ae9a891cf79d8c1c2e5b1f97053386896e1866c0c45409aefcc8d23bdf71cf1f05810396894d495e072882e1073b2a692fad3ebbe5662950354f546fa89b0a19e1962aec92058acc554db0823b290e7b97db2557dcee70c51c1547765fd2e19a3f641dbec1e55e3dc620545bb0b1351d954b75ea7d66c95dc9ad50b56861275a78e22ca8b37627d725a59173eb0601a56fccd7f28294357b058ee29b417baa8256a6e2e5e0f34ed06b577ae638d4997b22d41dbe66ee417cbd2edb47c1900b8cc0f865203c5672e8ba709d2594bd3aa74f2471fbb9591cf7efa7007720ad90b290402c68008e6719d66485f6dcb58697145487d9323760488f1f26a39c7f64a0baf939b653a280c8f94cdf0c3b311e141f7a7a43a7aea9f0d26be66142bb6b67f17a53476bb566dbb54500ac5533c5d8929355a2b4044c7208142992e0e3718d5fdca75c5aeaf0f8bad194a9844e28d27d594780e7fa5b334280bfc70024862f9a7bf0ce6cb7db35416908765f50cd023886cd160632a720d8b9e60b5799b98de7acf32d149d46d20b3e98900335b2290e6ddcb1350ff0ab347e0356445383e96784425041524cbaf17f9eafe5d301520439d688af3a7c546560eb2f26c3201718ef7d051cbd611085684fcd724697a363e51c2eb27fe489f881fed50cb4f259055220bb26ec524b0f75dbda53c65fca81ca7270bd57b4bf1f34e509b0add4b1b83eaf33950e8ad408615c167925bce9935a3692ad2499164872a0622b30cf000206d909fe58bbed7b780da9a64f6bd1685d59bad745ad4c3c979dbe15b86c3c5cec415d781f8c7015855678d575e7bf6a3e9ea81d93a788940e49874edb2bdee05d89c8dbc016cf7d177a310b2c1019a83e536e1ed7632c2e64ffb4ee4c7bc4e78ed739785d873e0c354cbefa9498ea11058d396c5aba70caaa6d2e14f2e4af590cb43ec1661106aec4b6aa80398e1bf96e5abc09b221a1844f5863359fcae34afbb314a240ad0a79312e50aa9c55669ed9eab27027d509d5abc8e9460a2a9472d1be310ed6558bd873b5ab45611c90bbf81e31a992050e02c9d919970127bd7d37e827754ce3ff470cdd896b0154c315f6c35bc689f36cea04a8aae5f16e495168faa701b4a4c25037f9b2fa24236e0e9be9de71e1a4a0d0bd0fd4fe65d0120ef0ddf25baac8804b368dbb066c03d70fa4b54fd03261cea8ec969395375d25d396121389f34125d106bd37df6af9363a54a09888d66b4c551f71110307dd0d6d6041f2e6be69efa0e176b56aa217844feb2979ffd003ec135663ddfe119501c690f6afcb1a1acb2f94a83667f4b261f40ec532c85f568dd10804a379ee7a207a4ff217e172b080d1bd7bb2e8011b415d896bced6a6a4b76ee4dc51b87eda249a9439c1263b6e8bf4590d8b8315b141a79f511dc0b0ab6251ef4a3b9c382a90fd7d6fab375f15689fcf6aaa8255cc893fefb5cdb4b0b7efdba91616089d3598df1a682507bfd53d95b2683870c506858761c985157231b88ead543eda273bbb8dd849e96dbf2341008b92e073584dd88ed1d69ae47720a4cf96df381063a06c3453174c43a36f695e8e32242a65497c9063951110b46482e88a9e4b04754c80980227396e8b60eba1ed9c45dcaf291f707da7cc098d8b10a56fe972814cd9d2aba5157e4bfe5e1203bd94576eafbf39841e7548a98f5fdae343d511ec9dcd67d4fe2619c3f061fc6e40fc5a8f9cfdbb52fc0639201020bb197821114c93715c1e6070b50080e12d728510c37c6017be8d8296e6ee28142f7b53aaebc6c8507459e3007cc68fe47b00d5941dc5cf369c4257f54b5ee8bc16daaacd70818404d659de9b87fdcedfeddf126cfe1a5c5b932f1c269f741ec28c5485fbd3c39acf26eee4986e3dc9b02f37cb492660f7b545c929e51e9e5461dab3cae13d466171099e17792e10dfd363521188f25ed10502d65bf156060791303868b762eacd4c0f901128397870ae49a14148dbce4d407ca27c9bd5d4c68d520b6ed533574a73abec6c215a0741a25364f814bae52ab42e75aba6b800d18457547bb27f845e743dca2c15d484bf079b507dfa2cb38a0973213292e9866c1d00ed324f7349bd174410928b4ad447414478f881ea1454ef62503ed0e1a01cbeb9134cd7aee51bd45e3949d53b0edc571df8509e73f9752f2da2b8f347eb7fb1cc04880c9ece356fd3fb4a4f49af78b2897fb194a9dd0b2e34eb005ff780c421b062b3a03b70c0d828275e5316b22a696b0c3c3c2aef111d84431aab75e3d608f4941ffd14b89ed42410838bb82d11e6f46bb3b5a6faad3783c9df442551b6610d5e26c6c23cb3e714840f260b5861bcfae9843cf317189eb91500ca78e15302215864cad556071cceaa9a0fc11ce94101e4f7786a1d0f4cc55a5a2ad91dca74e882292ec0edb35dd72de17d160f0700b83839d2fc3d299e5cef244cf23150f9bca0aa268fa3efcac7add964f3a21d130674fb4f30762196c571e573460203e5ed363813b3a624e5ad114f716e8b04dfba0eb633344c268838821cfa37ff6e3b028ca19376c3b1c91521a0972eecb5cd3049f782324beadf9b05fc6ed7da28f077ba69c85d0da18a4daa4909f45795aa2472cf0605798a7fe5d779f5f2bd4e3fa8556a68a1322fbfbe725432df31c0ba43de8123933e1aa9f6af119d76b52fd13eb026ef4734c837fb8cecdbef5f064c70be56c99dc04d5c201114c24288053ad43841c9f327460458e822ea61d7ec4422273c8a437db4064b0a2f52a284be9ff1c92aefe1402e4e02b99ed9ed63a0ef104291d21c107e82a15e734cc8c4498848db6b2f89e9805f10751e7b7e622ff545a3822d9c781fe46a5523bef4ed8bf4f100072339877ba38ad53ff3ed2d1add6f6770ab68916439ac02111098b1f2917a2a835ce101660c524e3e3e09936b1a473980a2c5efa2039993ccdae5a52bfd627ab7e54a9ea3e20c51d4fef040a26a8baa6e8d901b68589805ca87e6f98e47ce8793cb1f18dbc3f3b61c059471f9b98bc62e2983fb826e79957383c106945170ff9b28374e5338b8148d1a63c7c617805e44ef9d0a0fb6f2ba875ce1203f16db891a502bf25dab92254ceb8db91c4df28727f18125dcbc057c077a16b39ae0e34cddefa1fc685c5fbd7c40759eb03e27ae48c2a829b367e864fb5ee217d17889efa6eb34d83358dbc56f532abd2a4460cf557e8618b72fa27e4297f92204a456b95c9e3dc062c65e43f607747a1ad174dd897428494d59d28533a2e104826bb35431e40464a90eceb12f7bbc367635f6886ac5485fc234b3e62b3f64f635574777e5c10f448e057ff2fa567e12a83dafbe35bd9fa608ce2b02be68507bdea7475e006fbcb6edcae0d1de5f1e58dbf0ee05d7f8e0ee88e479c37995d0e22db4662250bb1f29122b957ae74f74f2e2e892fda6180ab50a075a4b8c396276ca5d951e57fe15518581a59be32047ebf861f866f1532840f26f7236606738658f06a76013556beb6bb1800a1624b5c9750671dda58c7fc632327e21b22f7b2379f62060d2e408f1d3d910459bccf10811d0709264709b5ee7a6382f39e9dbfe0c9b6e522febb694b510a37bae93816fe6c0346e2b61767cb6e63f176368070182e5f66f68f6341f2bbe339a22508267acc5d06c94ce7ab50be412af5fc745e23a53fb528ee86fa3265441222332b23ff8d8c3d13e66f51ace60f8b023b9daad564f151c16ef14c00efceb0bc53059151486fbbe38f0ec2d69eccbffa22246bac373f29cfb5e8ceed20050c06a78b93d80c97d4791ee204ae334fb0c70f2c2e775bac3de685733c112c542f22b8226af5e3fc0d299b7cc2b0595c018f212f112b5c9f56dc7dd8dfd7d9ba0aff36f1e7f273ae0bf96258b62e19a7ca9f8d42e133fe28ece5cda8812ce5589347d99d78ea0688926e94ad798ae9645155efa4940be6fb988eca440321362c29e53b073edd650d050e0ffaa00425946ed39ec273857ee8d979b0dec0dc4bbab58011e25aab1d1e4d35aa8419c910952a93a83bb5b5af4fd7951aff13d9d17c41490d46d3ec35b59a4322810b4a25bf040a5593399f5f84f9c7327a564fd4251f4d3195a759312e65297634a3f1878966d40c67d9b18b0d4fe6051bf63735c54359ab8dc9a98de6d31377637d4c4f96bf7c8a507b7a1b6b7b7329446464fab62b4cb2062b25ccdac9bc0bf8e3bd17e43eb0b4c728ce488073caa05253960f4b0c998400bc93095a1a14ed7208e36513e485a2e8f5ad082876c82d33db9c1a271b841169e3f712582b5aa11a087b5843fabdc37a1494d29c9d196107df9ad5546ec5ac20ab466e705fa51cc6b02c1a1519ba0ebbdd770895a981a1951707d5d32c13b07984c914e581c3c68e260f859e15419b066ffb642f74effb70262a37a81ec4cd67f820fe6354b0a028ad2de0002e4d6d98c9ddf5c7d23b8139b55ffb597ca0db91e6240360f39918a11744a51f5089fe3b84eb5edfe3bc055515c1a29917409011b9a41ce97bfa78f85ed8d19e5873775aa80cf665e6155094761a235cdb3e4b532526f9b845f74308859d23de585953fb49b6931bee62965a51e4b5b3e3b630cb3a3617d30fabd064c4bf91c5e85f0791e7c035e221ea6fe63073718099d628fabcb1cebad534952bec2e2a228eb4a5ae36cb7878acad3b08bda8950e20303d83e3a06823ae91040b99129076c302c2b058ad6b2b3a2ebe8b267899ea72bac6f32a5bb302c3112b4d6dad21cca0092f5bf76cdeb8028643e624c7d9b6875b4fc84cca3a61bd55f8a0b9693c1918aec5c089300af2f38a49785e6d304bc733ed0a838861d4ace9785666c544c1a73c13c51d8345806d8e3a343de9406570159cdb11e5f4fc1b95ad06fe6e2d62afdd9fc46fe58e3125fe8f183ad440f0e203a4d790c9532aa0ac6883d2a592e519ace632fca0ca03067e4bf5238113ad4d27306ecaa5d5f128516401da878c972f2c8f280d588d53a98272a11790ac7ba1a3c0ac8375c7c0fd8688a562f3c3e67c8e714d50da9cbcfd6a6f3e3f1a0c955f428f515f42ed82c4ae34c0de4518d6ff000cde466c78d0767a2a1aa27205005764874df938f1cf3280bfbc7cfacf0a9b6d955d30163fe362b7423b2831319d4e61d76fa62fcabc22f787e026fa381a9dbc7fc6b7f0f975af1723f84711fa095242b5849381de799c781b00053b19ff789124a989c909d58f5eeed92275f88d5430d404220a862d3bee16c3ff7276dacf3fb5ffcc43218c6f8c51623687b0ea539da737b30aa0ad3ea8872de77ca4eeec447b45c8f0cde2b40d99231414ad5b75a0081ef76fcda919ba9f7d225d4da0e09e617b4fa6819010f9a1c045335b2bbc11caa19c2930e063a5e4235b540bb202324e8bbeedfd504211ede3af48d0e98cf51ac881872e812ed69550b9ff6968b81a68e7311eaf5d92349b7f527cabeaefc51ea4a4b3f4532c590ee6f2a289d13511d39e443c4bc274c71546c1129faabb9e1085266f03636e4baea3a2b4fe296d506e65dbfc151b3fdaf5f67a607c5a6ff387aa0f78fd23de94f19f1ee6cca7c3980347d0ad28cd64ae6c8c2bbf2d2a3ea3a330f6b6113cacdeaa7d1a45c27dd7ccb02caf3579b560ad4ccd49f94c9fdfc7fe31a617552fabf9e7b64ae0d043e5ef7c364f05f9f14bc37ec847156f68ddbfd300ec8d89a8eeabc15d0a5457f748f75d7c6a8b35271bb324bc69f512ac2e868f5baf07e61ee18e316721b03db40521d7ebb17441363fc239e58b118d7d26fdb2c962001180db9cdd4ecb19913dda8b7f401c1e834ddc4c53a4a6d693eadc8d325e49ac6b1eedde2282ea5ee6f882cd62fcdd0bacd17a3d5953306e9614be8923605351fe0f0b8e326cd8d778e6da4e3d352acf5ce343bc3baf4233fb571c003ad1e64542a8aca012685491568db44ef7e423ba0c6b77df46a9bbb3bfe1fd5a7f858c3f548050c032455d42bf3e762cfea1ffb6a697a55c240525a75a1e9f7748f215bb98d18dbdf906a6b073a05852191431411d294768261aeee27e6a92288a2011a125efcec6b3ac6c404323f8ce0d30dd4edc50ce4af54f78b3b8e52b0b4af0e4c4f1b9abb4539124bd933110f6a0113140ba5fe75eb7e373672a5e9e1b6ad9b13b6f52be68c3d0141c20f66ebd8112c1f6a1b7c006c4b96e956a7c398ccc390ec24e489a4b07c688a919f8f3e9dff900a7d59ecd5e56e7599033e20972242c71895e892d9e46eacb9e9bbab56f35a5c0950a19bded015056c4b88dee92093f5674ca33c3005f4be85c13a32f587003cc604f371a0f969b6fc0a99b2c6e52238da36538406be004ae130289443a4613a2877503b958983ce8b8fc04a1e9edde76cbe39d54dbab7cd500053a64e4540e3634c86c644fd781dfae08d9bb991333c7b064bf5ffb17bc66cae77d8d0389ecfe343d48af16b60b77827f607bef7c83b210864209d90fcaafec407c712d845e3026b5c2c34fea1d552397886afda510d7a842984604c46259a01cc0e22839845e5676ce112ddbd22d28d1d961588d491e51f19c94ec2f58d672430cc86587e1d06a0eea9030bfe7081294df9c32f58d7ce34a206b0dcad938cfa38a2b9507409ac7a3d98cd9b8bfa6487d78a35c4dcf194e8b6b4b1398cee3324413f35f33e08dc76d9f320021a07e11f811b15ad3c948f264e1175da7d6c129b473884128b90da2afceb0513a7a818e066135ef765f56a3ef412881ac705846b88e5d2853511096694613b6e53e3b77f4c80400bea438a6eb6718980651e215727e9c83652b916bd49ed946fd0a938ba10e582f4dbb5d74d2f7029aef3d59413710048279c6dd7ec0fb8ae9dc8c60728b2b1ccac066aec9cf400134eed2bea40c9561f2b3a9cf13c46a4d7566f64a48a1621305ab0fc964cbd97d6a0611ef4ebd86e5463bd5201b154278ac88ec573892c1f1ae4c8f48e52d9688e56c113153dda6373ac840e23e9bbca36c1fec6d609709a8e0d388db59e2636b222c1dbe0aa8a01b6263b7332cf719d2abc877949759d4cc6afe1ac4c91e188c92ae95d95659755e55564e1a4d12d7d1c7b0fc36c73703a9a3d2b88c4581e3cc6c46c2de18a938365c233fffade59332ad9a52842af249c64ef5885483700ffae8792c577b1478a252ab5449b7905a1013a51a5973e3048d21dda119691371b043cf46cfe12e18859a8012835259b0409a69e63ecd7a53bbf943f36150bf86b3510194e8e642de271b0a033f03fa2b9f38a63b70154a782dc70bac32b43f4b32eec01712b538db0d06b8116fea03d6469eec19537598b6ec48af69b26e345da83fc1ff422565a424d562b94f2693b7d9bd7ecd491f523e3e55cc414eb4a605d84593cd101582805c5c11591dd3699cf576129fba771f9ca26a4850f5ae530ac828517486c18a379af31a406ebe29a7962f126c1f5d42d0c266d449b625c9e005fc8d0b1438e95a77e2d07d8de764f0ca6be5f4c233ce3837d87343c3fe627370fec65f2647168f8e2567f6e13bcb9c64c5475d64b410f13813223c46d732657e7fad5b47d086a5788389039f6caa558ac2e8e0dce81ad743f596325f54110c0917870a1b8fb3a32279ba153438c177387d2ddb9717049da0fc2b91d4ffa17294899428774f7c0a1db5b1e716c90c301a02d066a96de5f47403d024fbdb0701fc509a5b6dde06191737b4326dedf02f31d0036176d755b772bf6bc6b8be457b1ff2cf9e6e7f3ac0a6f624b11167b5f3c70b016e5e81be9e0d817f65c9d6091207422d3087e3dd86f11e14cd71a3112f2782072d4be0257531c3bb0c7f0d5256ef062ec1076167fd5d6dfe794b1496182ed7c48971d27e44aa166c91e4dffc4b0a5ed01a617c1e9ff8ccb54a5711246bce3eb37b66ebffbfa33677fb8db88ec191b4c4051ec8fc4e960f88c8badc36b7e0b653d9a18d1069a59aebbde477dfb3c37acac02eae07b67d70571e76adfaca8e7bd2d2d5526559bbde8ab3958c4c4ec343e8e1e1c3b05c549bd6e1c2b89079679485330babeec3c327c8c4f3a49c9ac4b03cacc0e33cb2678dc40e13306f96b4f8249280a430865d7c0782d728e1ebf94545b9f62c6a52db2e80fe7c60c8d84fc47f8a279358844bda0db2559871d5cd3ada967425ae644de2f472ce74f4b78e19c4f576d78c934fd0d09d42b771556d1f951adf7912a5dc4ec37342f75ae3f9ab0a87ef95b7f271e17d18b58f566be631f35c1ea652aff9865d709bfd923d858c867c0c9c4eb4399994880523df77e409b6790d2bf01b5fc801460e9053ef6582b33793b221e2752f21a1a6c990a568f30916c3445789aec69b4993c8861ab60e87573253efaa3384dd948bc9263e90bad9dec8d7f132043a07249afa84f891921d9d03c012a791a03808214b7d451b2cf1c2fbc413c38fe772f75e1eef3c82b001ee9c561ded0849b351d851d59bf26c1d898cf95366ce44c237bbf565fe21f3762e2b9a50cb6e3b83c6e639bc4cbd607ff732f4bb46f8122cf8014c373b78a082a7fd15a9f0e1ccdff38873bacd58aab155a3be35901462a76be70b295ac9f93e490d750c70111c4145ff53e81571f0f76f1e39aae5789276fcd73c7be8c68c1e9488706b178dda28b33581ee960edcc505dcf4a0eab9d4e171585097997ce443d8d9697847a443928cab987298450e00023d51e143bba1bf1691d9b701304e1676fc2db84f695647c01be1287d026fbb3f12d2cb68a12d8f48ba93ff00c10f30df587999a365105c4c67fc12df754c4a9d524d7f3c424998e415989645a5d2721425787445269b5a1502c3eb3e1c974592b3fff54c803346e90f47f8144106747c0df795d5342656d81a395e5490e1de7f20cb5016ae851330758f9a0103e8da1177b787698d93130eabb2a1bef754ec988b32505ece29ef958a98da8244a6e3efe1af47cf6497239606d5dfdc6e139b145529d5865eda31fb38de0bf3dd32d1127b610849907572c95f4105756c6f9e4125a4cb31f38b0bdf9f85dd6dab50ac0358f4b51c0050078c8c767e3c7944b115b2bd4c69fed1f1d22779ea3fb30e59a22ad611b102b9115f261a90ffd30b584217fe245e8f6d4a0a654083f89ea1f7d0f03f698bfec0fbd86ac78fcf08698dbaf0ea294832b54a903d9c8268a9a17e5d24a7029ef914c56bc8d5f420b97665121fe2ad205f6c7fa661e6ff8a5a0e71fac03ad601ebb95629c27762f52c9ee1f1e9b41ee532fb90bb897ec8ef8e927a9057f914f042cca4b21475cb5d6a0a6aacd6264ec0168dfce7b415490b28eb854bcffa4b9f13f31bb6ae7480645e6d380fa85f95ac7907a8a991850598cd822f58ec2f6775dd9aa9807dbc60bd2f8debc4a9e2a48348a690f7f202e122c9564d7e560677d86863c1aa46fd7bc187c46167baeb74f9494f9952abcea7ce3fe218101c8f647e74dac4f97cc3ab6f1ddf83974c1f9ad919635fb036b0eb57d852857e2ff2d57b7d29d2d28b9532a676a2fad28ccd36a2bbfb6aa6e0e0b3c9c8bdc74a80f440877c8883f69a70757f2a5e10545b6d5d6448b42988f9179e321caf2118810705e85481074874b7a67945a7e063ac96d8c6330765e0e04e1ea081ebcda8020af7be24285dc76807987238ad80cdd80fc4f155b1baad715a3cbe6f871f611de0a6ee79c2250816095c52276f0bd28a390902829610d69c94b3c9d885c231a7936a20362dac85be066f4df57c3c5088cbdf7887d10a854e0d31eb6824a49e1fbbeb2d2c1873602c777a7c0be774a91558edac2949981646b93c9281a84c29df55781732220363d8c7ca8bcf92fa8c4168c9e92df7b32dfc519c3d34ab9fe404114c21e3195391dd2f1157fc7fc0f3bc70895060fa9b4dafcd76be8f57c2ef81a832751cc2cb65ba20b4a1bff1aedb8a1286fa644a175e82bf82349120d2c83d7041c13e0bc4278f7e40261011824e1b3720c25cf5fd06c539a07f8c9a6244ffcb62afa287fa0399f634636163183e6bc21fd1abdbf42f1de87585fbc69a2590dbf72cb8783e74a6715729dec3e69bfb5df7caccb5a2e6afaa82211616b03a1b8e820dc7f183720d15a0ed57ea3d7b7be47c56440eda9ab6fe9928785d8c8c9e1bd946260e407b243ece08e38c8a2b07c604845c5c8c88e2f7da60d8ed9ed699e530a543602b1d6ebc396a4b3cdd6d40f874771909957a73dc88208cf85c7f59d0d89eba8d6c34688f42b28923eb8b27bf5df97419b04e9dae2295e937b7f7ebc81d65bddabedba723b637501707aea6cc825fed8574e5999d0ad8dbfbcf72003d92f643bf29f3c65909b4657e87cb45600c1a0ac8119adafe6d2b2e99aa2a684bfc0f3017fc45e60102020a2155cf933d21003e97227706095c02b49ef606180527a7de9ffaf7693b2544d51c452f0b8c2086c079694bf95cf3da67cd8937d13ec524e1eeeb8f14c672c8c2a9ec206f1949ae161d1256c7cb7ab15be969cdf2f79b84d6e081119d421c6cfa5b8fea47a84ffbb798bfe255c99dce258e9ab763bea93da6d412851eeab2a1c2dacb1c98b0cf265dc3cba73c47ab5231a35b3076f6b689542e6762053102fd34bc9133f821d713d1c12a952ced7e0e822790250e962c38123eb8decf01501f15f95a974c492bebd6c94992dde53e477d53dcf3fcb0d501bb6877255804005cd1741d925cddfb958692064d39db58fd6f68e399f5f0384a8cc3537438b729121936d17db606ad126c711465d322f22ae58d67c083e730be11227d45a46c65345609c0f2c5cb0566ca088e63353d560387c9273b843d8a25aa2dc0a1f13fbcbac8858e7718d057dd8888bbe7821880b44e8f94e765a9ed3730fd80f813ecbc7e89bb044eb7ccd18ab91183aa1071179a9c159e68668111dc37e175b471d5afdb0d56b15954178c11f687f18542cdf82ceca092a2cfd9d59866d7973774b0f2f84712c75cb4ecd01cffa094214cb6482873b28d0a3da47997cf6160911f9d920c6be4e5caa82bca36e7d1c0d96a293e06fd951a814a3fbfa939a979ffa3d3e461899fb0b0ffd50e3991d45dcd67a8f376e8cae20f447e44686dcb8fe425accc342b681c6300551e7748c2b90c51179ae29a231927cb0505f635892d0bec8b1575f68d0abf767fb7a469f3839ea3ce6f620387a24701522d3f1bef616b1e3f6758af65e9cd658496632ad0db8ae0256d89506e0e26b89817e6cfe4a0faaced2d21c250cccb641ac4e7f1abb573916af49a9954abe18063adf5e82bafc03f4543789485598bd6f327b872201141e9bd822ce831a4acf9daaedfc0917c74ff7bd12a78168be75e4ec787335ff6677b1813383785f24a1035adb1f416cbf7b671ce063684d5e0ee1ebd4d58133987256e8760e8ec01fd5eb7a61ea38abf8142e720438b811b8fdf0d5302917ce7308011004c28c3f2bbdf4e2290006e2314605bfa81e346861755ed90c85690c71cabaa207d0cf5e8b8b432a638d1fb5f5bb8f094c3585aa94d82a7eb363998964d1413dfce702dcfc8ac8ae5a7386dbbecece4dc8b37f9153d0bb60545b0d4a3e24a6aa5f805595f9fd26f239ec4cbcb5d734d5156be94a0ee6b4aadecca5ffcf2b48bed862c73313a39434ac2290cf34bc6a695bc2f864cf28759cdc53e649d7d1dfe13a4915d10bf28e2d398b16fe021658661894b1de4bc9e896a1da50b259fec8dd1e8906fa5be7ab7134a9ee9edf2b7ce3a41bf9b52b71b30070a576756e8cc5ebd85eb1dc6177e43ed851a0b7ac6e78158ac05b4d4a44229d48c7b0edad3c9e3433d7520ecba908df49020b6c976649ee6413f90f7e39509f199b70aaa2b395894a039a2dbf19f52bded74ff4bc5edc74d178856c38ba5d755743f071ffdce82879ec7b2190f9f395d540ada8970fcf40e8bfb7d4319bb344d7198c325a9514750b7a52a515c63de9bc9f700f88820db46317a35dff07db63ee398482bb6331495906a9d066962a756d5bf33e6a4cbc003812088d25e8b08edb508af6e849f3f96363856d0ceab6c7a3b3801df4e08cba3dad09a705e3726ae03cacdab8eba2ad5a6cca615331bd2d09246355e148118d7fe18440f051f28039b95f07adf164773e0ac1f031050146ffcabe32a1b9b1d57a9ad2f46f7716d4a80ae2449864de2a4d914e4ccd582e61175db33be787aecd9ff08686eddf8954662b246e574771c8e1bd23c17df092eaf37260ea40e262f7aba525bf483d015135baddda4dee31665b14d9b911c1ed4a6b787e588e02042a3feb1d2a27a0c43dee9db1e1d3a5243563a590412899c181d636dfed521fb8c3866edef05da2794ff432a1fdeb04ad5e8dbbfbce63fc0b60ab0e6b56356c530180c2bc2a57f49c19abfb5900699d4e21727d9a4ce6da18b1bf562f400423c6e62847b8660230a834dc6858d362822c97f069122787c9c99588372c6418ccaeeffdff1ee9e7e60c2dd6f9796d2973a712e12c7d891b109c5822457e693f4b5daedd5da1c408e33c1bb140fdc07947f2468b3f8b1229ff729db5f92a5d9ef852221aa43aa0a8a5964060b9cc5d72a0ed6232d689118510cb84e35534005b865f4c3e11e1164e4dc3260f7e9c20b2e43aecd4a3d9f87ee5cdde7f1ab82e8ce26b8ed4eb20dc70ec43d87d447de17cb2ca565299f23652c57a7520b80a222e8677b4e90480f3d18e2bc894359947ebbf3ee4c480acabb2628960fb1ec0bd0737fba2eff0c3cd8f228386d1267f47b6f975fc1031f501d3819abc2c052fe8a4f369756d536c99519c552695166fe2c41cd14adc8acd63ca81ff49b9c840870b45638c3c905dd36a3e48da4fde785acadaff0900a19fa3f28303caea74e1abc758ca3a857faed9941d53b5a1bed975cf49dac9e96a55f3b085a11b9a1f35208492b5c0715371147fdff6738efab7b90d5dcf7c9dc1f6601b8a1805c40a28ca09e53bb3ba2ed03d0af6601843776377bb09cee6551ec47eeb138ebb40da50ab36d76e71b6078896cca98573902fbed69dc7c490a7c3af59a160d929049fd1a8c95b2c4c146814e55abf33577bc5b0e8f8ea3ffaaef3f67a7755c69e93a498a2366afd5f64cea89ac24e9b6cf46ce8e64c81c62171089ae2f7230cb6642c975e0c0b4b82a73aa9b930e81e1627697186515e07c3324de96b46280795e46fe514a972e20f5ee4a571f46d879c4a1901e2cd2bdf427f778a4dee1e0e159f1b825cb03bdd32ac98a8bb6889ed17fa69187aea5a7c9ff596071762ee7a9c3f1799cfeecbbaf41b1919d9b18ab3132ca42a8d66254c80df6eb8a609e7275d023c2761209fc180aaeebba5f31554555387693f296d65d14c81cf2348d621b2b8e84138a2695aa11a4ebf4436ebef2a35e4e46302064775e26dc97467720f97fce1d9c3555120c52924af4ede4cc0d6cc0964304bf95bfea87ef13f7d974ff4c937ab70d747c4bafbf53895576c914f9a00378bf62174dee16a1c7dfd947e3e397163caabe536cadcbacae115a9387ae906ea603ef8ea8e1b1a659d0b36de7fbc327a849ac6473c283300881abcb0b0ee054acfef6e2c754a55a71f9949961ba58ae0366a4174d961f4ec45b28de62ca54fd694a31889170250f0ee436c3504c4a7911236976cbbd6faf776a538e2aad2bbc64ec6e018b07eee576472287da8a66e1db818e84b27931b2e16b08a101d6554d60d18a2003244650c06d8d8867b124fd5a0649eafc7e1dfbe11b2b86a8c8141188258d6c8189de2b72772d84f3b418cd461273c02eeee6511e4a00121b7fb83dff1a30d586b370030896f02f930a8b8c8ff60e55fa448a65163999908e4f65a718e57eda23b8efb0139502e640c0c121e77ada4b158d1a417d95535d27dfbfafdb819ed22bf0b1e8340382d80bae40dfc34ff9a298fe7778c133c42a07e1dcc8e4e72e61222a3c8e8a4994bad6287311b24882b03e6465b5e18239de539a628723138d3b49d3e0f4eadc436155baa5d23bfaadcfb8d10177f31ed0271d118226e6d82903669e9be3eb4bd88c7476027a7d79d251ee2ce7c115092d9a1e35ebb98da458d11430ce0ee5802b41faf843e6e974c1afe0511c92029921da59ca0adbbcf4a2967f1391540f7d43c2ab8d601428b97dc1bc44f0efff9dc7b0c4b064fa5bf42feaa530cb9ed0c243d3c1defc9079f747dd684696eab8b406a6930de98e7655268f22b0cbe439ad11790e7ffd8d623b82d1c257efdd25edaea340972906f8554bad8a66f5e2ca00d1527354ba46aa60fe5110e0d2826f35497fb1f25b1759283829c42b4b7b3babd13931de2f8a5736a06f514ad33fcd3da81482ed78194b1b83cfe495c433258db8f1a5482ab12147baeab9039ea93675962eefad790c84430f8d551849eceb82d39354aec1b82944bad49092cd6b15738430216ec44664e62adcce0c2c48c2","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"18a196d1f19b5a89fd95c5821d944d155e4207ceb9b4e6f211268acbdf5adfc3ac78362d4b3a0ad0c196c2e9c8c244fb70b621a39fabbe44f387818ffc83a382a70c572e4b5fd7e7cd0fa348be6e55ab66e2af86fee52d20cb3f986ad18fc8a75a028a0b5e237c2a8344752cf4d0011d2574b217a4b7bac83007760265b82a9108ef9ccc4e8941e05e4080355031ffeb963ad3bf9aa7c1a856b75b7a0a9a55a5fdb7064f9eb5d6e1ee379d210d541fa35354c7eb8386e0c393adfceb3583d71c89ca8f914a1c8eb26cb55564ff4b374334aa4c07cd37aec93932f78640932a9a8ba852230993013d23f9d56639cc6b41f038422cc36ddf3570f8078519cbb2c82cd9008c84f8c0dc20679f5c508107ea81d504dc28c558940fc4ac8b06015fccddac7fc198774075d3d75cc3c28916cc19af590e64854aed3133c5256af49414ae9d9406850d94e68eee6c47780860d1858e13e79776aa921aa85961036253729df8ce7b06bcb2243f9aaffd13456955ad27358939af30dcbe16c083d9301031bedb8424738b472aa5699c86ac3409221bbbda8a2bdd20b609860c00c47d2ed07100078b78f4b08cd0cf6aee5075500850e1d50b366e579056cb4a61a0d7498fb8bca32fd16a9a01175fe77aa3ec5f9cb4dd375bfcecd84b0d7f5c6e8d89b703f81dd353d037a315938b56b9f3331bb4eb595cb6c84df8616848861eabe5e0b272c46747e0829ab674314333e6a5334de50cb36b81e7a8e5ce2e21cf42449f52c539a6e59a33f7669efa673b2687006b6c07886a5c09b017b3d9b4c789498604941e91f52e4bfdd49c36756f97598934a3423f0a4ed9b138ef24ce615cbbf2e0e9df4506065ce747f5be6ccce4c2abf3aad6cb3f6ef29ea0c2e6dfe1b1254fe4181a7fc572c546435552c9614c92ff5e11d32796c579968e7d7f1de3ec3ed228f05ab5e7949a2885b2cc8be4c4e549e39040fbaaa4900739aaa3c86e595193ce0ea1faf8a066c4669e214cf75c22d64c031f82e11021cf751989fe01241351311b26d6bc970be3bdaac9212012c294760753e4666fc056439bb334523965d9b525d80516787bf65fd659089062cb0305c10bf5b74324764a8ac5719d0a3a98fc28222935a8cb94441f7b0be60ed222658523bab614aac93b8a9605069d02e05053682fdc1cea35df9516f50d94db97662d8895681036d83919f3ab3164425dd12702e1704ed3afb93ca6782ba551b9e12bb02771edd8223e1e92c39b799a11725b4587b96a408295c17f43cac6c04be15fd6e543d125195d2e956a0dabccb50ef7f7eef777d9a8df571a2a5181729c71e1009eead0fccfd4224a9a3eb293eb76b2d8e1f163fffdac7cba7ef1c50eeb48e70ae90dafb82fb1c39843f11ad3319a9e0dcd508ed29b2a1e107c141f42b38e09c3256a5d1dc77bc46949ad62d98d224f8ab3594173c7a1cd667728398c13205d2c12575fa7dddcabf5b1a67dff4b0ad5fe08d422860935f3eed160904dcbc87010f14726c8e3b62a4af6b9a07ab9b408dbafa589febe1f30b37eaf9bb598cd3dcc3e7d0185a8ec564e271e391e415c32a70280edfc574ba9ff3a1b156c13c8b40ba84f039fa35ed98ca134b7ac3b6101e70c80745673217947b68bece564689e9efd7719e361a02f1c0a152bc03f7c103ca28bfe60a0eecbc4d22553e3449c4bf14292989bd2eb530df4965cbeffb64461fe10443b3a2ff46f4a11cd58ea1ca1acf2cd1238977b301d8347b4170ce8ebf9ce504c6933c11717dec795a64d92b3dda2e01871ce2c6ae0cc1473230c25c9ac19c67db3705e9c212073e77523393ea8af797441d8a0a364e1f7848f0d20342ef11781d96475faad85e9b96bfc070cf5138c3f56e2bae8fdc699965af945849706830d370a56125cef16993f6e7eee26fe114643cb910882a7d7093e89a016997982ee54db9f58be3374faddcf3d69028057dc21027a0317a1221394b1e9b45365573d3f544f2ed5369b65f2573f3533e053d9c32fd9946247a52f89ad050a82a633450a5f4a86adb04de41e3d53b74e318fcb0f0e0bc9eb49cd93da648352ce216f7a501aa247e50c2d27adc62e7d9c9eb7ff1b453fee7cb2e4366954094fba8acc2f014ea3f58ab622058fa536bed5d27b965310b569789a028844ac35a981aa0d384e72dcbfb1173393d98532a747814e271ddb4f54c70ed40b117c42a5ee9ced9149284b0b33f8bfa47b65b6b5a0540feb8afa8641216e336f149c1d3d4821c2309411f44c6942f6cfdcba23bff3cf73fb24fe87785f6be4dbbe0b0eb40a9d092c8637776da37efed93024ae8c32e07be8b53878542b348aecb574a2efa9ab989c3461871bd1da87bcc9dabe7b2df4000ea4a3c96c5ecc0b58274847beb7a43a55a08ab930f2d9b49af26bc02c82bd3e4b1043f375127dff8f47af94f42a5664f60f68bf29e86bff988a13603c166f4672ea06702cd75bf6863a35ba74269fd451617fffec9a6a54923eb1ee412b2ffb0c4145f0e351646feebe43025f3af8342089a52362005dbe12e0fe36b1587cf093086f9b562339f06966172d2b520782fc115b6f26fde3f0e92a4698eda274077d6a7f5556d6c8925ebd014198caff0ec977026a29c41aeef37d9f669ac323ab4eff10073130b6e4f3e27968d16b51d9ff5c660a2d15dda4b98cd7155b015cfcb1028c898ae361782857c1f3feca82d88a0c07908f29cb82f69a2db965411ab7a2f8c1540cf3fc01bd5a58b46d06dd208aa9b4a8536f2ac384fd9d4a1cec73f32d63a343d1f50c690a9760a284f8fa2f950d71c8d852ebffd66b07747c2ffed49bc382ae3c877c502ee6ecceb0b203224918b3f1129907f936a06e11e6efa98442bd6119401c605560b12d055b062ce6af19781c76fcf128c26a098d877b0a562148b18baf845c5373757580a25c1ee0b3adcf2d3f5d9effd7df8d17d8ddf6ce33dd22704a38478ed038850da22eb5f1dfff0e03c1df3d52ef22f1dfb6a7eeeeaa7298d4ee21ce101a26648f1787ea08fc5da90a4196963becd104e024342f84a6a5dc3a44b752caf6c0edfa1ce2a3899c957398f8e0e671ffacc718358760d6f0e59a0a602faf31dc0f652f6103a07e8468e5129872937a356a3eb7677f308dddc2c3b57a784b4c31bc76a4f990ca162861df496361f62861093964d40a6db5583eea17cd857a30a78401dbe207a08269f0293da71df4b0f9ea276884070824567ebe4c1b8df92723551e2660f83bf42533802fb984124dbf980deecf87e141a772da7e2ab56533a27f7bed936fae40386b8737b5636b3bf9b481f07aea49a0b9b5582c32adfde98ec4bc61f61fe0fa52b8ebfce3055a03bf28b21cf61ec1da74df15fbb09d20e8107142614f0ef860d140d3b78a9702cc13a3edce17080c3607977ab4f39c95a4daeba54a4639833e5a647bb67f15d9dce5986ccfe51acd6bba05c387205aef27f6c807574c41546b35999caba4c9ea47a84ab44efe3c6ff9acce8965d7b51e095f38049f6b83561e488e0e0b84ce394a2b31d309c455dcb1a05cc305111ae38c7fe6df549730e0bb9f5b0cd185446a4de9e0a1340bf21e551a1a829f0ceda8e92c80178624fec62795db21a5abec82d6e1ab1a378bf4d7f1f09185cf566af37970b0becd1c90d224eb82c5da5b436eb0d3740b554afbc0c8f7b171bf68532f3a7d2cc179f52d00279d22ab4e7be712b6413d4a04e7872ff6755039e7153c57bb032ede4158ac310ea1210f60396988817084487f0b617285e72d4391411c93d1cdd2400a056893e302a261f200758d642872abb332090c3d7e93c106e461fb6ca07b7223a8b61c94494812ccc7cacf834b932158bb57626bef3f40eb074e01c71b3f7b77a224aa90e535737be59f6be27a5803cb753d29c106e9208272e5aecc0cea7905acbfa0771479506b65d81149d4abf3aa0c341974d043d7d3ed59df2c78973ec4a59baf2d0605ae09aaac2384e26da55418250f938c7aa5b947708908576ab76818831ebda95f34a65d8c71ccecc6ba2e4db80c827fa4f2fd076959b2f4f8c82766177864cd41ad5d6e32282215ead99e3079be4dd439c77e7fb2a9a855f954cd67f3fde686aed33226b0efda64c905bbe1ac75642503f689a97924c06361566c9af2598a329e97195970f11b940df8936f333fecf7f9546784f8b61f06885067d73390a4db02449b32ba21ff69b7d39a692000341666f489c99f3d8b95a70e71da7bf6d191985ff52626ce3a285ae45c083046ca1bf97364a7221a04daa0393c1de7f4dec592734e7b91bf17a93cb2e688449a3258bac174f00b034f9b74037ffd8942134eda5b0f2dcf4f5bc290ee7bd7536b48b72a849d40a6d7c98aec3258d8820c7253112b1dc8621032f4cba7e2e9e6c516344cea91245b08f478495de9a34647e2193c12b1607b7257bba7c08a7cffd4e352cea8df8888ade3546aaf7d41a5e65e51c5e68b8d497ee9f8df8dfd55aa3c00f6b27d4bd33977e4a546410f883f29372678acca2686b3abd19cdf777409a3685dd073a3132a39226ad203ed7c535fb81fd333329dfa1eade2bdddab7d49d1ff7dd9ed0a021d7432765d2b4fc0b5cdf69d67b05eaa4d8ec89ed06277ecebf1fdb6cb5d9cd8005868c4103d8f809946946f61943510f8a950d7fc496ba7eb76326156bdfabe1d00bd4b4bfce76e5af9f1c9aee01ea3c1a23cd971a0e1c2bd6976ae5182dab29b6a44d25fa77970b9bd61818f67262709682ab41c110b239da69c13f748248b81f776feffcb4b24c445011746dcb418bbc2ec88a732b43dc71983f622c2852328475649110c18c4eca60750d6f22af56576022d58dd0105624d176d0c7d7519e719815c6b942b48ae76ea5d9c647c5d3bf1dcdd673a3791f513a81a37c5a0d43ce2f3d9b0ec35fc83be96a4309ec73552994362f36b4be413a5bbb2dd76c77de072a54371f07bb5a330b1fc9e4d4c1ed7fdd9417af1af212d64df0b38a9202679cbca14ca6300d72fc4b9e82548194757fc05113f78e3424a39f2b5b513c7071a34987b6e2afe04180776f20c140e4f57cca44548bd8a575b2adadfc40fdda8ea41e34b1b6286e19419498a95af312cdb78f2452bd2e917cf88c39035b2bd3ce5ba5904b1be8b818ead47aff0553a4dd2f9841e273696e53d61b771171f32ce9544993eee238b3ddc94ef9e7c2663a167d821f72b03f64cf53f67a7b54795deb965249a6549774064ca4eb897adc576223504cce1704de72c6f61ea64867a116750f5f482f0e37c043eacb6bacf2cebeb3db05de013f53dab4f60c7953dfbf37e04bdba3942b1f7318621090f1d5e278420b4c0dcf8f691b40f85a64fcd22b3cef916c296c88ab41bfe23c573d605139364927a087a0e19b8e4518ab4c175c4005abe483c370a742d283046ff222b3f33b5bbac35e7ece833347e5a06c52b22e97246eedc9596d4be6cb5289de38fabe2146dbeb135f9a44633eac3845edcf08a778e24d74be061c922055971dcae96ac85fb07cf69854a9cf3e23fbb7cf437d1a30ef5c5f8623af48dce6454e1e26efe26f9dba2ec0cbe1ccb5464549641321ba5ecd7b28f7a0cfeb74be12f6336753521dbe1bc98cca671945aaaca59ff3a31fa1a5a09acd644c363a41f3a0d863550df8b649c225c5da7ee282f066c34f4956c50afd487c22aa16d82a04b011533b7df410fafeb5933f74dfc6a41126a7a621872d18a2c896e99a006de8c138334102e1444d54bbb9e11a26f28de7aec0ce29ea50f44606df3d5f62ec721fb08e8474a5a7189eed6535ea58bf6a912475c0126cd9b9c0d50883559036d0f1b3033baa45e4af84a3079a88cb529893d75e12ee338cf03ea3fe8d7cb8431155ddc885efabe920fbfa31272ea08385dc43c4f558a61ef8f390b6181cd2308acabf3639e8917b61217cfc6a41aba95201eee30aef3750980e18f18afbcc3611b0e9eb5da6c7ef40f9a46439f0fc62a75ae7e22d25b0097c7afd707078f68c3994ff1f6072f20668b54244234fe2d6ea50719ce94d514abbf743f4de04e949a0f3b78e812ec80c52dbd881e4fec8adec4fe38abd8aa026c0111b57fb7dc167eda87ebfa4cae091389a018d44e0a0033fa3d1d8bb5d4b66fce323fcdd9963885888a8c443adf2fc9b93b77f887112d7a8a24a84889935367e809ed68c3143021f50f054ec7b0cef0cb53af417a7754fdbefb434edb388c616fd4c1a8df9b30bee42a843772a86f163d7cbb092de7e263295c81e2b87ab72b3ca002f33a7fb86a0e3f8a88876e98898f0652d6a9b22a06b7565249d26a99e034b3533f94e50d0f8ee5395c6fe5f1167a38baadd832727d1016ca85cae8198ec58ad076d6dfcfb9ae3f264e9655d41a8e80d2f1cd200c6145011751e8e2e8e10d755789c5e0378f7aea67409c412732ee35f044d50d5e86dfbd56f4aaa09ee58e0dbd419300d0529b02f52b17a9acb64ba3ad0f1ff089c462d16b265b15cb3e7b7a87f346334262727ce05ebda75a0d57df1730b2d42c36d6be6db6cee70962fbe578add8962ec211eef034a4768267af589fde0a4c654f4d522f369b05e51bc212ff7b853377bc6913535e36894b093f56dbcee23ea4c7822f4fe4d739321480e3b274b084b3213fd9dde98b4fd3b969435622306f0505089e1a8d83ab1130669f7a840513dd4162d82c2295ff0099804388ac6f59d4e7e127b8abccb8656dca5a6ced5fd19e01d810a108447c52a4b0131f1e3b250fd420beeac1e4e893f65322309f2a1cd167d79fc6b6f919b158dfc22b895380dac6d8eda6922c987646ede7d560292611580615d9e25d0e8d3dfb91f98f69a45a1600de3da74218c44934cc0886822b52d665e7febff3c8075b08ba69e6a720b26e5ea2e049be81353424d8498f96a418783ada79fbba2547a8f180927011edb7d020c166f625e6274555a2be36ff9d60d2020e91f9783d21779fd68679641646632367632c2761ee09eaf986bfffb866deb4070b063607bc7dbccc609cd902ae2153f37971b92a7523762286215978e518dead9478bd18dd879158b3c7ccf57c263f2120f321780eb95b28cce87b68016d1668c75402249d40ba7e8364f83abe3fa868ec755f0b8335ac4d1b8bcb3d01135258b4625ee8028be8480cc4814329c5bbf3e3b9fb81e9cf00e5c49b8b31ddc4ec6a99928131b3c1f3bb52afc61f6933d90dd808e4628b18baf5705472450de278b822468da3685b7e8dba6fbaaa01e28542b3cb12a2a972fce05ef03445761408854d9a1c621d06819c48bbf8a038f1ed7e57918854a80e74a267b1a7b92a3cd1b9c320c06f7ad6a5dfb461bd55e7d465d3e95254f5b58b014a366bf67346c763955d44dfae10618c64d46c2bf1278d9ca560dcb8985adf7b64952d0b5a733ab44265a26822b468b14a182b816bfb374048bc78a3f3380113d885a4fb4ff682a8fe9a2f44005418beba280aa388e86d4fec90c8060b4f852cc5b11f855ea018e45ae1186464168c940826c766b00753212ee0a95f4928813806b686862b57edf416542d2c9dce93cf25e9364362bc5cea367a12b6942033a91ad19c25b0762e6080b54d6f39b083131166a6f08c951db174fc41986353129c9a7ffd4cc23c3e3724e8c4364a220599e2feeb78ec96ed67066a3ab0e4d863099c2a5444d4cb7c324bf239a8b692b150d95aadef6ecdc29685675b51147a6bc69b7f4a10e6301e47fa9b59ca06befbe210e686090963b24bae10e05ae76097b4a41b33d4a15cfae3aa1f33b240327cdee6796588c98637790b15a5dbe6652d7c37b919271b52a25e22d524da3551a3724b0059b0dcf86790719e590d67ce0cf28dfaa5cb309160f0c63c8b17a1f77da9c30100f82ee24f388959fcc2f5b4ebc10fe1f82393b32a1982544d3f47a17d09e63ebe3346087c65335f11b69b59d86166b0ff50ef4069ee10524655cedb4e4a05d2d8c4fd9d7c26023f99aaa81a575d13cf8bbd1c0a2e1ae41178532bdc5842362e350960e3b40beb0e17b2b4bc8beed61e1077ba3178124db012fd47c12c6cc99cbabb402f215b0a4a43db5dff3b8f8cc2d49145f80ceac4f73ad9642cc449bb97fbe2ef135eea317a44a78ddd43b6ab715b23eebe659b7815823c2b078eaedbc47235543a308da8b3291fc5c9f8a3ba07157c8f0784dd86f2d493f59aeba36f8358f76306e89fb9aa6d1e3d6949af664416ba780fc5241d21bcb686a7b9d1e3f0226add5e83d40077de6dff68901f8e9680bfc4cd7fa036267586da439d195a402a4e36cd68ff75ade3e49465208c421dd9e2045a991d97c727fd913711cccf8462b2863fa3cde606a45c64a245b3434572b482ac243ad9e37ad8864d1daa656eec7f2415f7652642f4e3b32a2b213c449e938c1ac767dcbbe6f72d87d44c21323bfbe6a188d3d4b6fc7de9870af0f77acf761c313d8cdd314be636e0e56fdafcf71a9e09cc9650309fdb6047e35793cc34ad2859054719e00c80c1df33618ab9ac899d3feaeccacf564da8db853f18df44ae23c4e74004b1c8ee5252c2f1eb5017bb19a8349a7b1478499a84622203cde53559d0c3143620a4c0b63f16098b1ce74bd41a55937537dd7e6f096dea343946cb574f676f994668146422c0d9eddc94187256f0d292b9fa70d84dad046afeeda8267a162cc8b65f6c66a559578e2ba47ab451c8114a543f9825f2963972080104294a546e37bc91d89a90bb0be428847c0cbc8c08292de0924006e0e61c5cff63fd69922d33f76a6a1a7aea1b650da082580459ba672ee9fc5b6a7c253ebd3581e361404fc708308f6e41e7b67aa245f6a9efa5834e2226b5d84a4a2eae7ee5ea972da4e540a71540c46815a06fa56b8347f82a254b839255f2128e23efd0cfeb53032f561a10fc87d7d1a993667592b5002e16bd00a0c3e1cf5794fb9619e0e3cf41fd3727bce0f82be32f6b93c4ce932f5538c35fbbf720774f66d1c3afa4c291d9b38a8df1bd0eed322fd8dfce0b58be17f076ce30755d7106a597c2803a825d24b8dec0bd64d15d75a721174f1fade6c79e13aa33ee075b1f6346f7f8e4fc4328bbf224173618383dd9e4067186f2d8c38486050af9b77ae77c7c402627df9864280a23d1b4478f73399e0f5122d671b04b15f5f1d21689aa4e9364e4e0248e0ddcccecac170a4266597dc38882de8797fe89af5c3615b4a0df012ea763088f9b0bae7b5f9797c1a0f194f13dfedcf9fc55f1c6da791382c6b0d6f28e25050966931b9c0e2619e1b3f3968972ae9c51e6336623947245ac1fae09fb699e28ec9c9981ee312092f435e2bb64cf994752c0c130720d502e89d1a33ae23e486f52670fefacbb185dbe5e641d6d1d0718d9183b29b60d7b72d75e0dd5e1aae657f16456f6c3e9e248c76d867ab8eb9b1d3b038d63d3a2c80495220da3755e4a5ead0e4aaf80a51bfdf77da8f0bf3f9074c69da1df6fdaa3a22323a6c8d33cb7d15660d7ec570bc1e042b68d359914a9473fbbd2061edbee9a0ce7b0872110cb1d03df05a58d3d95bed27e144b72f371909c0726c468c7fcdf064387247ff49c2d38628fd509c8c1ec50d8dd2edec7f088212c25a3e7c6368cfb136c6efb162ac0d51f3a3fde5eeed7c5994a2a8b5fc486153310cf958992b72d5a70e086867714c1a658b4e18d90f8c1e8b556686d28fd4be25b4aae6110be5b7cf4bafba2fac5efbc57c93e028e9617cdae9baced100fdf0c5a3819275b56e80802203a8100240d0f2d34767fdc1769fc321111f1887260cd2cc3bb1c0291c7b273128f929bf3c6219db9e35f67a5d72ea0953ad76693a53d7cb47b5e267fe1df5e6622fa2f26a1ebef1275b36e158815629c9259546cbfe7548a39441222bcf7e011265813a976046d7e448856561c045c89166a8cdf159b3710cb2ce55ac774950b6cdc71d1259f3c5b23b9dd84c34c834a3724983950020b5d89b0628dbdf25f65b118ed907c817898609bc45ee751cfdf17257c188f6b77c0ba809f705e557061728c37b0655e8e375afae0d3e63279028d9540e351ba80a2efbced4b6873ab44c41db4bcefa3bae69c5cf5912578d9471befd969eb5b1d3a5e5e7a259336ee44678a69a0d4ef88f4d34d48c41b27fb008c2b3f1a9c99be3c17459714456c6986e505532169d2939d36f4502589fed78361d42614bea564e7621791895975fd0c96c963616f83a8d5a16e9cdb65074a30c4edeb2913a9876989001f17ed2118360e7200bd6908bad80f7fcd1292121797171809e0b53c052833d7add4975a8d41df406e37a2d507fd4160fce7d750c0e157e2b99115834dd11c71cf46f22acee3d3e4f81f6bd6b41fe3df50c09a68f5f253e4ef2bc05ce58707ea7ddc4922177baa3e7bf0a13aef31f940cc479f79d73892a7cba7d1765af429305282f3ee31e7bd9293e8259410d70d14476e8d1a045e246c89895fb0f78afb507ab20d5fd691bb1d5f26748bafba6201a0c9dbcf68f458633d65c8f8760ddcf99240b9cd4be015e5116dc6aaa3f27b103d4ebb1e26ed60d790f2521d2a05f2c2a977bf1192c946277913a53e8ff86a404f8223bbaddf4b7be17f3f094a59069c2a1473cd1540b182a783722c98841e93ba5a4427fe3261db871d4fde271e538df15167b8c0501e51ffc06030dc1409849d6fc83836a04c0d4afe2c050cdd95f782b6d1106e5937a80faea001faecf4c3ee75ae3637653a16c74cb0c1204e52c58e337b3577513434cb9e6b04a010629db7e345c98c3a0a618778039a79264e818f09cccf8eae847d84721ccbedbcc412d74723bbd99e5184db528aa6e2c8584a9a652efac79271c08025dc1f685c31ad59cd8df65a23f70f4dd2644abd640da8775fcc85744f6f844e56d1af5507fc39f2b61d99e3dde579f43ad1ac6bb0cb958e121a14087bd6974b21e4174efe33a67d4f1ce0d628103162b40328cd85d15c723950d330deb5ed07f0c27e36287934b6cecd9c1ffe2b99dd127bc7d5abed9d8cf4984a80cf7d7ae4ab63bf9f8d5d1b2d4d7146397c2f2e6d261142f796168c6cb6277dffc7e4ff56baf74c4b495195773ec8f20806a6f7ff6af17c2b19a9f3b7bf68f8df8d0df0bc591776664f83f58a91d0bcc559c82c3b55edfeddf4518fe753b14a8cb0afb6853358e2c227fa7320b95b479075b0a6ff3b24363b6ce74402a8a508e907213a9e33ba88cce6cae4ca0c3e5af2320376f6131b0d7b9dd68a2f3728b35f984777fb528b3bd32335ff8f23528d3724b8400011be9b88e825a3ea11392bcbd00089c7e97dc29bdec1e845c713f7010d8590670e42a62255fc8acc5bd928d4bd9f0603c68768fd4aa209992ac31c267b046ac960d1c6096fa847f73886faad2eeab1abd12585c9ea0029cfeb28aeffcd85daf696be8a102179df2b5711caa75a730bab69470bf215aafc51e326b7176ff9a2e297edeae52b1a2d4a99a1d5c89fa23deef97b691b8a243317a297018757e1ed539ac9529e0987c9119d342bcd15320be217ba5f6a747d1d3db8685df0497178600b1cab8a1d0ebf8e010e0226a29a03bc32c292c8ca493acf11bb80c13d9255b3a0da1f72b13008bd26319482e97f14a532e502c125dbe93ebea1f1c9036d4f841db89416d295d11b5fe5209674d78e659d1d6b315b1da58093320528e4e36f4e817dcbdc343b7fb531b2373e8c88b0deaf0df907f53a4abc8cd60e4c61d95f509d3c18913a1a56615fee8f744e1f3bd294a377a813a934f13d249c030c6c4414704b42d7c0d64396855410f6e9ff7d2e068d63b6b033fee02ee4e5c60a411900de227c48d912c81c0f49020b3d0aa727e8c762a58407fac6bbf36d202463bf2d69f2cb4f58efe9d1fd8bbeb512aee7579a08e1ea2d250c8f0acbf29e1d0aa8fd17f6802f7e71a5ae17aedaee7e7971b5952fffd2deccf60cb8a8e517e6008318ef0eb45bdf1d71c70b78abcc8bd2f432b29777b00ee64faf17104a9fa05dcdb68c6fd8e82d6c1fd4b5a45105bcff4a8741974fd096df6576144dd38c4c5e8b360961a1efd45c4d97eeb4bf87baf86b92d24fff712b085f4cac803c3be4a611ec33c10e627c3e6d123d82eed9795b94309e2987d2853d8a26b1bfdd759bd67ed568d814d3a26f234ee3ca40b6d68cdf7a08b10eebd208e13735af9089accd93be7f7fa1db238165bbc0bcd22a4634d4f6400fb62f5c5d9dd25bce42570cedc7f9ba054ddf7dac031ef3431bf9bc74a5430ef441a174b860e0a06850d128bccb8ab2c6374553964cf7410e9d80badae18d139159578babadbad5084be4581780a9fd1f66bb3f51044e71b47965644dcf0a533f196d93ee9a43e955cb31d5218468390e49d0cd3a4406506727ae1568205f1b850f0bcc73a3e45ee6c3b4b4776b3fd88b6acd429d5804f6fb2a997366f08467acfe703d740cf771d9bb657c3deff8a1c8369148a98e5a3cd3087a1cd2a2a4aadcd7a41e8d2647a8b44c63bd48f910de0d45e6eb5fecbd8448c8a709fdfd84d38bae948aecda3c731f6b3f4cf38edd673d982775b5088979fcd70daecf713eb111e93175f192d7e7e213066765cd891e9f5308ce8b4f6decd44a2a7b882d4da3f5d554e2120bc1a586927e3419206ee838c3179241f575cc454fb2348f909c2316a6711ec9802a34dfeff5f6baed1fb3038f792bbe59239dc36218cccc6689175d417c052068a5a1273f07f6470d8e6f145de8da669b848fda884bee2e39a6327d50ae745dac5e86a9b7dcef9fada06db3ac87ed90725c466342c4383c4c5ba69fa5538cc34d97fd79906abdbefaf578af52e2cd381bdcc13f5d418bf2ffc2560655be52c1cb7866239a5b7b608bc82011b3fb157132ac8bed31cfc532d25dd6bd4216f94bc80afe92848c2fd8c453f3a3ec2c2d9ec7724b85573b5d40901c563349331d6bfa8371da66029c53a6e1e81b74f411f872e9ef8588a70a3c8578c67b6a9cebe3bbbb91587fd011093f40809dbb24e80c1e7a4e41b99911f7bd775699d55052b87d5560436899fb6978134229de49097c6c9ef1629fd13141db4c988a7d53ab4d7791addb943a13254c0f33f09cc7ced3fa47bdefa5b75e30e733e8624c550fd94ce7f6deac3f5562c917a61191e5f6e6b47189f4a174ce0ea516630eb1367d2782f99218071cc9b17ef67e185d48b676454573012cda33932516ed0790a19e911c375f322020f54cb1e2f65a485afecf46f6d980dfbc6137ac3c91f7648b4833746a08170f014f5a1505ea90c544f0afa06057edfe8daa872009db333879ab30e37084451354428d56dabce3a9382dc6722a62f7404ffea71a1392f277e9581b29b6dde6497b53fb3c37971ba3c27ba8ee0cb2cb8e088e83dfe799e35bb8ebaa0eabe8bc4c0f3e8dbf3fc1fa971899201f456d526f5853a11ecf62700fc772a635771430068f81b6978fdceae107034dbc405dcc9a4d7f7e617ac4ecf20e10d1946c717c375ce64f75019e84ee54e40283c70259243ba5a8a2395ac0cf4a655935bb331af43d404094e46c43736957429659c6f3130d6a8d21575aede1ad2a8613bd60a6ad407023ef209307810808f5663d2daec3de2e6fb695e5aa4a20290219ae79f14cda8f4c555e5f7b92862f2133feccd2841e4ecaae6b99e16ca00462f72e4c8a6714d8cb0126ac9dfb77ba91b96ccc7f5929726e340faf155987c50cb61bc6b14e6b07241e29f5132a1de3b6b4392de206c1d830ce43bac4c1646c5d3c55983db1ed7ef2ce458254f28d88013f1f4f48b3028674c62b038192ab73b5d1c032aba5802c330e9c8da13ae1403e7a2a4104f1090a4ed68d1f0ab00814a8cf2ba702360ea22a1480d04a732461092ca87a2483988b6a69672e4ab0a6d4296375d896bd904077a4c2de76dacfda7e140cf52ff7e84cceb4334e4c8ed0c4d28e4c7f2da7731103b171d9683b0ee48706d9fd81099b4eea619cb526ac340d7d85257d6fa38d31d64ecaf502b6826a2fa3a8f2a995cace70ffef07f7b460aac99298170f79b99b94e40173f006d38f1aff827f0f322e5e391e6cc6ffd411f9db381528f0b0b5c0616e335acc4d071756509bfb8eaa4b249b10b7e1222078fba33e1d599fe4bf7dcfcfb79ccc74a29cc69cadd83946cf3523e7f4047fd05d8dfbcfc1a6952b74bbbc218f5417f0bcf1af00842593daae82fa5f90a6fd0491a981081c126c331c783fe0c534b53eac0e4373f73cb6d4a4b662c489558755d97a1ad6db5af71f07939cefe29e7175aefeed68463f4fcef72bd62802f204a999fe7e28c3e4e3dcbe8a69089b3982c195727e93d93f11f5c1a4fac8215b151864f3e1de64ad8a38f552a2806bfcf942d0cc99943bef7aec678e8722dbe7fe36a791df32424b882528e973541daec69ea598b5645a97471e5de373263986a2a7a6614c686ff585cad3223b5302f82308ccd6a71ec804e6702cbf0e735de29a63d19daa3dda3737a2ae5f28715ed7ee5b7d497b75c5a4ca016ad469c74975b0e12fa61bef5a33ff6c2cadd61505a5d57e060e2a235eda1712ed8a37861e765c7ddbd2338afbd67a585d408887021cbda6ef8a9a877369f7f099eb21e36c00bc4bccc9234afc2b1a4b7368bbf98f0cef91459cded3242a76f43fcce9fc80ade830217766c37d9878b590d128d65ad1361f6433409fafac08a1f9d8857a4d92c24e2f5ca13feacb9aab81ffedc722fe0a2e437018f2e69b896273e8f6420457a982e8d83f8eee50c3e7360ac2b40d138177b58200f835a7d74144f9e404912612218d585362aac65ca55426de67280c4a62ed148213755aff55f8b0dde46bd5e56880b7a0e0ada4bbc60ab9b5ea7a30b050699ceebb10941834da3cac21f76b62d69216a68a4786b90311036439ecf6fa1df53dc681388e73c4c0c2fa8b3126d29faab2d94b4c9d23a208c8d8b263c9e043a8ccb7c5174d39fdb0bbb0259e85c35fa95d8b9e08bb6cd3eba5052871ee882eaa16ac73d5296f5fabdd33ba55a89f801c4759eea0f60891893240b818bcda21355a83eab9ed2ab07bda5f467bf0d0b605be3fbbd98476fd8906ad645e0ba21858a03fa65dd18e797eefaac22ba11eb247062e1500a287b5f3b5643df7bbb0446a51b81c1afeda9e7fa02996d4779afc96ae7dad262251b119f16cc16b6c80c35baa8a3ca5a841eb2406251e271a7b6ce1a33dd591bc5a0e467313688b31934774c1fa6bac4890547eb62a7c7ef0eddbdbe418bb76ae932717669292895d00bd1495dd549b951ced91432105f3b1143a761fa4c2f81e1c34116c65d19b909e2624fd64698bdeab56debfc093d60bf2b27c9efef84d154a832e7740cc5f86770e667cab42cf15b615e767597c36b7e7262684e795a145c0819187dfab6f98b50e6cf1b0ea86f6d4261812cffe2f29eacbc00574412cba987eb3005df590fcca2426c294541a2a9912b51c7ef596e7fe3267c11908c24c8194ecdf26a328972a74020b78842d0c1699c33ef40eeea5a2ddeebb296ec537ef8c659022e5e264c1f3b2749a0237e6db8e0ac9b1ca934b49404ad4f2ddfeb6c2ca09a90ecac9a1d9b44418833d07efb46e829bf566545a3791cb32a7081ef2cd54b6265e47752086f36f45b9cfeff67d6ef05b33d746bfe647d891137a6ea982a56fe63bacb122580343d1cf3569349f2b2f03940d5bc171bb7f00222cf2940925bff23df93b266a429958298a02411a946b5138b5ae3808999b446718a8fea98f69b18ae5ce914f15e1423675bef3ed7519aa20b84aa6cc854d6296d56cd69df5a544341b42fa22e42ca016a165b312ca726fbbfbd8b5a98967a4fdab98bee1b979d2b0ef3bc5ad06b3f5e5f532956a0a31417b2177ba9ef1d82a889d768e1dff411adda18d7bb607ab013f97d58bee0d90eafffbf530c222d759962b39f2e265c3fe27a641fec1ba2c776a3513962a0b66199da95a3a2eff7d8046c384ee3f90c5869e667b0a14d5328b9ead6acec3268254f8e8e5ef77c830c89a6c2e459d878259755780e3c150702c912c9ec5bcddec262dc3ed47369c65affb54327c95eb2f7077d78541321670b11fe6f7fcf87ce420d399d83b6a0cd1594f3b3319462bc9ff436c5a3593e65f02dff76944fe0ef0ca14d9aec6ade8bf69e6c4ae2fcb59e564fce87ffb7b7c661bffdeb7901fae4432ec62edaf8241dfa1995c85004cf7965d16ac0164682f299d6a68a84c4fb17eae9f01762e0a639fcbb72407f473005819ce4e49e0f86b2a268f5457d2998dc3ac1bb264afa6764114f48bc2a3a511a5a6ed964bed51435c2790ed3a821545ec3963f4ed968427d243891afe388b3b3a03e323592434ded0083fdb8d747278a05e0434ce5c727b2a0c24bacf07705cce3097a3bafcad5bc538edf34d0304de4e4316e364d8786f99dcc9220ca7987b23ed2998a9eb39ee3b08c53c7d4f5669ebb8d94705194aa5b76fa8f2ebc902b0aea016b8976034182e03e2103aa0efc22b40a8186978da45f36a8371ee4add44c4388a739fc09d284e6f5e3437af28fac09274ea8e628a038e0871db9edd076bda3d143ecf33b5a339b3601b50c8d5a625df54d0fb6a5b5edddb1c9368af5e40c6b8bed12b764d3c0b3ac863c7e2e5000f27854f6e15f878fcde8185c16ff56c316222f8fdacc1cc8e5b2d1e97d463e67433bf1f09158b2fadb5a012e79788193cebc17caeccafe3317e125177f07f5087e3721b273c13527b7f265f1ca50266966e2421360007a1a6bf9c4534d7a184ba1f81d71e2e4b5ea3fc0dba0e78b09f63f6e3d2fba38a3279d205fee1ef7bc36744695b3235848227c7fa0fec440f4a3b011627acee6f55f775d5081db3811402c8a7600c67ade57d746e303e284bb18e3c26e10efb510439944a039f0a06cac6bc98811ec7c5d3b26a3cfcb605fc14b7d19bfb48972aeb29fd149e05a75107091f5f669e4aeefad420f124df7d43bbdb76c33db0b4e35e2727269abb277434a55de6bd25fa07c033d7194e28604bc1f0a3f7551fea28efbe4197bed46746fbd4cff6f6b9236ea4042d9f9bbd4cd7420701cb83818aabab04f4e9c0fa9d5a23f06b2bba8ac5d2757cc90185adf5d1c6b215454161ab77add4e2fb4aa88bcc4c6ae350940f08ddbf0a88ea11c1926c49633745980b020fb05a41db425dda8af71d745cf4a10388f316af4d6b45b366b233696c003e1bb551969d15613db89864243ce211780f9440d2e8e085e4864bfe0077cf34d5914a5e46f415be0577ab1492a8d1cefe579ce7d96babe5098dc170e2103100183385f8c21bf680ad94b8eda528527c6b693c3d2e634a1683b0680a93d5360968db60ba4b0203b2653567a3397a237fc04789fa8570288bc17b9a65d70f62f26fc607a95c91e9ce60db2fe7ccac68f0fb004f9aab4ceb37581ff6849172dd4c1e0816a56957ef1f77030fd0653dbf8632b7c2d74b4d8b235a26d0bb6d7bac7bcc88084c5dbbc8eb46449f42fc7a591f47a0b177d027771daa171afb220ff3f34c5d16a339a0826993935a1b464261bc14d286814f5b292af809e4d1602b8c962c6ba792730cd0741700935ff15856b677421545697406acacaafa247b4e6ac7355b23d792e1f60a5f7c7d6d4da1cfdc21ced35175cebf50674dafefd570e6c9af9904d62b318ff7465d2d368ffb6eb0edead9416c54d286c5b639dabee9f5a9bfd9aa237a5e792ae534de1e0ea04771b765e42ac74b0564206bb6f00ec4858f4731445aa9524ae4d2e3600e0eb25a8a9be0a798f342310c10d478ce241ed96e9c641be2dbe82271e61f9189f25a2a6b55665f478c1eb51b43f9dde977d94fb789f140d3a8671163250e4eca602d9405818522d0ac0f6b4ebd72e2e9cb9dfd98b5ffefa8acb7c03e8e4fdb8d64d599f7de5d95318460763f31651c08524f9da6213a024d21170dffdd2f4d71770b41356e76d3a50e1d611db00f09adc55da2fcb77386ff944087073f93c945b2611f706c251985c419493562a006ff544c15d214d07c52a89672178625b691291845e800813c4ff917cfb9ec012d2bc6bf6ab7f0b56a6e7263ed44295445d650d4ff773e88757687c25d444bd6a07710fa054b66e45f605ad1cdf3b4ef6ec8d3d8168d5036bcea363cd7280cae4e88f0d676741bf1a673f8322afa6f4a394dfea7675d4eaa8c4233fba3ec5d646f814908e71610dd2166a8c2fd77de73adeed184182bf2a3d82a63fe359d14034362fc690a5bf90c6a2df4c6eb81af0f4b1070ca39ead1d05b7f296b7d3f7e752c43d84a06433409ea970c7b49692b85c8299972857577b3f0297f4eaa1892a460007eb84cca77160240dc2aca27dac7e3fab7f14876eea58529b63deb63ac65bb95bd49759100bf725c2e5a9f15496e8b0b989d2d305c458f393ad9b60199645eff1b78528e649e2e96fb531ba7a51ce3b4735bb3accff4a64a693a1ba4f18a2bd33dd98eff6df35485cd59d5e9ccd40cb20a19fca8ca2ec24754a7cba02c68f9dc05ac4a356d98c713d687f420fc09e81c0a114e02faa5c3db3e5b03abbc38da4bd17d8418dfbc9e7314cba6eae744d223a0665e8715be847b5caef62a1d2ef5ac698d39a0af886ae574db7b66a3949a6e02b7837dc9b5735fab49746f76399808961fdedcb221357b7d7bac38311c6ebe1940a08bf9563406a53f92d0ff446b6bee8bb2f1b8119c1a2db3186208599b326dac0f53e0feff67d9fd5d4e13659d4040479d24cf317ed154c841a084732aecc8cdb9677a96579e782c59346a725b8d11e5bef042960c117c1d9d751bac9cd1d8c6f396a66cc68a558c555288d46be54bfc17e837f75c574dd61dc4f25138b9e1684103009c246ac0eb68717b8a92a5e7f963ebc849bbf2142b1b022d966c5ee5862cd6c4e83b46c75932158fdfc0bc6ea76047a071b4df8ec8195ddac3bfe4c8f0069b00bb97b55128dc08dd210712ca86b4283945da34c67eefb8b2189c8a0e0558fc021fdc63728312e2a6c62c9e37bb34c6b229e6cad5223a5dea31dfd3b5c7be21500a5ee9bbc3645567c829f5b189f898a26cd93c1985b9d0aff3e8234879e07dfb499465746164088943162f34fab7a32e7d45bcbb2a0c7a4581341da62c97d9fa029bd17504b9ee13887104984be225dca0db5895edd51041258c0c9afbe5dd3c4b891181d95fdf979648843af242de8ab47e69d30be3caabb88b5003f5548682a5818e2f7b4d542cace6816f4dd242ecd07538be9e69754946f9d3cb5230050ab281e1875a01aac3d276108297c27dfa99d6a9055fa4707378d0d3582b56e1847dc7e2024b407fc733ee7e48ef74633d3acef02744ad0567d614ee17847b4c09c3e37adaab61d0e8f2d3f95c8b61c798003e96da687295453a60cf7f266bba621126178a825ce5940126f1817cc96097468e7acb30fe3da17ad657e42fa93243440db596406913f13d286f265cf19a764027311be35a1a6e88ef522b487d3f83a2910a0b50c8b29d3e88d25ebe7c5d21f92b586e96e84daff58566f0b4d1d4b41508e0b52c6532d3baf31ab01c4af8c9ce571fe9a0cd344eb1f971cf56778feabc8118526480dd0c2be64785c9c2a9ca585b6b87e2a18cf686a108cbc6effebbd34ad434fa50b7014f2883c1fb9596b277421b2d472f621010e1964ae1b22161bdd7270d55345340539e33990c12273a2335b9b99158245ec32e33b1f9ab734ae3745c9edd4511bb0f64fe8bcc4db4d087f1e7b33eb5598279a9817cc9b361c4dd31a517204d636ebb9174e9146021e6a9cafcd7b3992dda2595b8b9e7455409b7779556bb4a87ec5976c571c7666594b7c1fdb963d55991839792922679a39b0dc19e1538bd83b53e5f4c99ec156d0a13e8007f833478c407e3bf1884892040a836e2e25c251139dcbf7c9a163ad99395b937a91fda2fcd22a23051a70afaf29259d1bb8386ae3869e660cff3bd1f786ff9e79ea3ae7f785a5df6985d87e32fd454e00ec99ef4879b475a177f5638aa2766c8fbcf2d2daec753bedbd5b7817c8bdc75b0e8dc7d8c4977b9e832bd6c6ede8b6099d1604508c2eff7eaaf03cd83c10538424d9eba585fd2a555b456486c519e4ec0b6bfe42e3001ea478e2c095188bfa9d1b5e808edb31ea2b6d70c076b2459d9d5cc7c37501af2c34a3b1adffed059137cdde86a5b61edf1482ba5bcd7825308a4783de1681989075a6b935a2fb62e54ccaa07ff78f0050f1e7ca8115d082ac62b906a79401590e27ed739ce77d8d43dfb741659e596f7bfab3140dad954ff302b321d0c592e71da122e65115135dce994efa068253bc4001bf9997d356031b31cabfa1b9436854ec854b03788baac31e6af182c226ff066c0f2ded3a7ba0e808a44b5597dfdc72514cc6748d4f43c6448b7c84540f33bb9a3eb4fcf36894a508897f482535cf54e0a42762719bae57d201ecb5890220a206735bd46486fc2a046b60fc1c78d4df1c65a46752304c79e11102d0031a012d9f1ff63d983f8df7296a20d190cc1ca399ce6acccc21600213739c65a515cdad373bde77c80a6e7cc0a313704ff23ae3a8cd5f0bbc036445591c8888766f3a7524f6ee2412ab15f32e4c01760860d102d2e1e2c75e5b7f2c15b3dde9a69448125931e74fb1ecafb963688b7ef27615af5bee22d3d2221cac9bc1bc0313eafb89adb5bd024","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

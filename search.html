<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2044b95ca6ae9e25ed0fb506b06ae547cc4df287217a90d5007908c8c907bac07200491a0de34e1804d938aa81a4df581f5bb44676dc4fce184538329351b946e864dd93d91c4f633d11f03a8cc5d94a2e69141fb5874444157c73f3a83fcbbed70d79102ccf972ed700de31e8605446f9a9dd67e5927150ebca06e3588ad0b9229aba7d7763e30f1722a09e0c3e3948da61b5c9229b964384adfe058d5f000ff053f2e41fe24dffe8519c7dae3a7833a1c37b6569941a21d2ad7c9ac0ee7ff8daa57666fcb4f90b22cee4381e73343479f07a86483ad10742cab242a5e631ca7a1cb5de67fdb210a96981f0bc7d5926fe69d38a9ce3ccec2e0bc395b292934a14afafc60c868d68343bffebf26942aa4c103a6ac1e95e324d7d56316bb5b37aaaf3350630620d0c5b315d7cf71e588e92f5c33b8e0edfd7735e9217fa6712c24c48bff7def528188c48727ccad88cc96a4c21019731210f4caf067025fac87fee88fc1cd835c562098892969ba0f6d4569c25ee7fa025daa8bbe3955b3ec4c462acdab3360da6d25c38623265621e6ee5d0643ce4bbc8396c4c4d662fcf5e4957f5fdf5b9bfb9b9f66ca70e9584c6a295b7245cdc0538cc77060fa6eea703b50d31d8d62eef35e0271db58f8fca609d3ee111e853ea7cd30bc491667e1a3aac9daec1fff58d7136424048431913f77c091c2a5aaead7c6ddb2c7071ba4f7b1d444144b0a5ab662ffbee05cd58a554a333679328ccbf2d82dd08b5c8c67853848bcf22af9491d5e76a9dca5171959631a7bf039eb068b0e631bfa48812483b507c89a6d18c5c1e2a7d471b304eb6211d4fefcf1113785d026c043c0140ffae2390bd0db948bae2e6cb55cc7cfe50bda42c561f7cc8afe42e1498e0f7b5ebb070f152541cd54e58a188a52d1661e0cb7703796a11aac3da901fc4e4e91573649073fdfae784d4e86cb82ab7ffc3b6fccbc2d8f3a668265d1b68d4dbbf7974b8e617d101a5a8fc50d28c1918723013e250c64b04c63d0d30c62c3f58e039df0c36340d8a2e2a83a9edf38cf617a346fb86ee22819d7f2cc58812361ac62de4b0ae8ff0d196cb52fb6d2271f703c49d37c01addc60c67506ab4d994531a73b64eb7d97a885851e7cc97b5b24ac748d7e0e5916303f5e9e6af40090b4a742450c3dfdb639a4a96b107a2d90a1251115d03e5b84e6ba64f36c7103b5e5419fc683780bf8c86bc62a84c088b231a925fa83e44913b176c48fab9ea11541900bdc4411024021f58cf3194897abd7f3399323daa1400115402bd7af4a7b5ea32c6452ddb2dbf6e58113a103ca7b086c66c4ab44bb9f5f34ca2514b8bceb806e7bd60b1acbefaef6399a76087404e49d3d734d00be26c34daf4271403acdc9e47a3cdbad3960e1aad59599e5630814fec0528117882e07d2191c29ec418fb0cc218fab77dc042b2d4973d8edb5181edc440d9d695d20f09f8624284143a6f508b1ab7cdf81c5179b3f5f0c6b11d3497da2ec82de466968f31aa70f9b18955a88ea5845f79f707a99e37b7af10cf2d1d572fd76b1e28f6406cb07a68ce1d6e581fd6be0374942db52f1f09883b1e67a851b8218f09f4723ead86e2ead3c582ba6da9624888bc6b0a33e29937bae79d862c7f5949b9d86410e55089aa959cc9410c7fe2493d5d4a30fd74acb4e5398d64597d1466f55e05a7c100c78d9fb1b66ecf0add74061fc34e3f0d7638fd9a3862957bf8202c4bf4a8b8dfe22ead3f72013eac1ac090a25af6531dfe353b59d075f34f636660bfe89900b375bcc3e77171e50030b0f95a327c3c30877ee5bc1e9197a6f5ff7a1df31b7b9e418ef2eeefac2669b972dad42346f28c6ee8782e9ca7ecba59240a693fa84f9fa6d5419a2920e2b38365784e1fd87635a473b3dbf482b9d46c11afae18ed5f6cf9647d93bffd5a8c4e1339d56c6b9e45702a10b6ff33813934eae61c611e80ee25469215d38de0b57300c652a0f48ef398cd17bf5b364ea4680a9c5d75fde350e4ad0164f286e5dee5160e8b5ffe5e62046e2a2d77f8a32b020c8497efd7e8e52687ef2bc1a91ca83674403127e2fa4a4fda5e0089bea039cb66cbcb9b8f5bdda9d7ebd7cebe9d2278449f9295350df1bc469012fbaf835f61cf82aabcd30969e819f3792d16c1cae4406d81eb09488adc248255dae99323d1a5a125e923e2fce528d530d3a81bff5ade5d9e5368f3ec238d25d398db0c3fc85cb7850d0cee72bd92df1190e53a210e45392243518383f18e5dac094b4697c57f0d7b57490a250f6e3fa4556630e754147beacc218dd8e79245d8e468599dac56640853fb3dada058a9c882b86b29a67f8b15bc2587da55a9db65c4c6d9acd7a6e13fd8c4b84153d86079bbe1e465628e43d923e39a279e1a8acefb7e74160e479ae37b3b2b9edb4dc96b5ab7bd12b0fd90aaf6ddde4ed4a24cfb941012718f545beb9f0e6879e0e6c438a72e71abd1b5011635d1d6ad3c473412f249bb99637647a7690652ca81bde3c6b2f43f085407c201ea4c824eb2f987edaee6f19a907e43c2a229d7c1a4ac16593af0bf8f6a88eedb040ea709ff6ff1ce04c94efb82962fbddecd6ebb28a8fa0bb77c17d814f5854d0356a027e515e498c6c72cdba286521b421ada7a123f572fe33d94ddd5570873d4b8a1b5fc411aa5ae02598a6c303ad7999ac1dbe6d149875ab9da4ab2ceac590979c0ca95c8448834f675c9495499a849080f289337e1847b20c14012e9ac760ceac1b916fee7321faabc428f90bc28a79dfd87dc78796572281e99e21c5bddbb06c1010a70eef210d3b64b5cc0131cb406894cedde6cd5b3a7f0b8dfb5b443db20e4252731eede5afaada36e7a997612f6b6bca32399d557782e967983f56c7345e959b83dc4ee7234a94ddf8928cfc3d38a2fa77c74fe483fc607dc5324a2e27952d6576f9e59502821610fd9ad82a77e973dd1395286ab0c93d62b7d88a132e71dd2c8e5aea873d8dbf7aa3fa95e2c02bc8b4892309775ae3e59137e8f48b5deb7dfbcd58b35319ec231d25137f0971824b58fcb2e04997a4e55178c6df1e77bb04d646e39e8c1d84ca7ce213d03b871763a57a1a6b0a905e7a43a13383b84ec84627d520db7806d113d38b6923f7f960385ffd579ab4b029ea2d34487a18f134f9c86d426d33fa9f610a3a906b01076898cbe42060573ccb453537d3fa0f69b8a8cd153704f603fb0f83e37621f7dbabbd2c55a6976889d5da14231382261aead90615c5a6dc1d65779a12a7e7e48246ae4482b4d840c3feb2b53964f73b493b4634537f51ab1fa2c3989690c553bb069bb6e9ede0fc5bffa38ab3450dffc47a52db6362aaf9e3a2544f9e54604e0fb02a3438d652ccc0177b2b2bc146609c598dc8aab77af74297c4245302c0698ec2d5d96ea5f62fab9b62792a97e1597c0814d198e60d907b37408d17b47b05af141bd35bcaa501323f4f3feffcd95d53af9f3e7eb3c7a7ab0cd1c6f2583991fc6f734fcada1345e9ec82d5f92abb1f7c8aa4dba73311f5f264ee83da0c511f5fa0d9bb8acccaecbc0693df66adfcd511ac968af70c7be2dc6d4f67a37c18a65dec3949cd1f34dc7e17401596f47ad2ef5981ae836676d8213024f1752929865de1d75181c683f8039d0c5186adbb27996befa69d5e2cd83f336a907ba7b4b27ab9960b906f111ba728352a046965e7a2f497abedbd13611f379148ead68c308994770dcbc4b5c1f08c3277ed2c9c40737fdb0f31c3db6dfe292a7b2126bb9877aedbd226873190c5b5e4f49e1363ac00b75b1761a8f423f1c192098ba60e51a070c18722943ea402ad5783dc61128bb27ce4e782dd2e446a7264f74f1e257884afbaf11ea709a226bdc9445ae393d1560543f5f1b5729238af717b99ba5d0357d46621f682e7793c985b09b37f68b59781beb6c1c382f54b1382671055bb401b84cfa2f8e16c37db320a072a20a23ab6163823f26835250103a438a9d5b55100fadfbd7000ed778cc68ba859bc1b49f1905d50eda5e77cf69d2c05f6726d5ba796716be0a8558c1f57343cf337aa04edabe53ba8fb9e77653fc2b8f54c750be5e720c2453566ff1267a5452be54f46a3b5c21ab7a91e3020da66de2d0207bd4608ef539ce16cbcf3e2caba4dd70f07eadb4eb25ecd061d13023ee2f946825ba42dc4480ec378114bc4bf1a174b0d0b9d5730f0d0fa8176bf95d900592febc9652296015865a360d501ca59c8252b8a07e2a11178ac5dcbf0b68c0fc8db79c0b0f3a948fc9f2b2a91609e53cf692aa7733f3a262ad8619630b65f5990830e46e48485b3a3b773288c889d32e268a2c09fde9d1317b9441fdf602550442a4d95b0fba5f6a6fd80492e43f41ff0556930410aa7c370305264dd93f06f18bd2157c00e78ba9091640bfd0401a4ea0aaf58e07c469c3033480f97644c9893d4850dbf4c053d1a4f62691610705437095574f5c2963ce1c906abe8d4060f0defa63f5f8d993a3bb861f52b4c7bca9fec6901dd74951a647af7599a9d2c2414bbeaaf992822252d3b553b9bee172915616a0f732f8931b8ead995af2cebfcd19fec39d49fb103bb23ab29fa3550822b05921c40c3c5120a13bd27f9254b7a8b70944a782daed1652d397468ec79ebe5cf3d4bb1a620868e2012b7c8fb99c23c7f7ede5c9b892016771c3637f09c6b41f9536541de18ef3437cc62cc0512124f1e36edaa81edb4aa3d1691c26189ffd4c46ecacc177155fbcf8ec09e130d556fb6b7fc56d3587876350cd260a043504cde15811b7a19881a7c36e42c2d63139d209e474166a0dea6f9392f66194b82d005dc8eabee2dfa66b5a075c1d1d1f6ee088c60ca315c0cd9d78bb738c0b599937232e223049663ee49fa4a27d0e56f1de6c70c2d56c542170a75f78d2d90bf8f666e2e4da6a91cd1e64a7c7a2080471dde283814062b5b2a0c7eeb23c056880326261a5ac5a7261cab958a17dc2c93ea8b590f9fc8c2af1f39dc227caf9cc2b7ee15ff31ce12544b8ef7297e9553f43a777c3b1536cb952f8a4e2e1898e556069b24d0b0bc6dd33415b86cb0055b9489df0fdf3d1004bc6a46bb6280bfb457e8c4f85200836a31d487c6c72c8b499daa317fa33d27db412286ded27c0a9e77624dbeda652d8182a1cd16c48d4d34ab6fc84da48d28d25832542e467d2035cb9122fab883d5c001cb2aededa68ccbfac4d1fac324186858cca829b9ea455658bc44b894881996420d3182ff20b48c2bb34337bd595dfe3416dbe3ce902d84f442c75c2bf9f8ee861aa0857d2f39993afeac4c1ddced5405ac1a55344aa62f916766b7051662c0058639418418ec20b49d54acc939d4d5b1d86f75d97643f600ea5af76f9779c8707869b054e3b0efc998c2dbd5c010a518c41ed202ac30a53c910f6351e22562258b0364f86106fea999f62aa785ba963922a3169a8c83b7b5103ac5e77e0f3fcfde97eadb63e7679847b0b611df1bff1b6654f9e9f3e8b371337c042a36f13a66dfbc894ea6286c6e152bb8c8bb0afb9df06ad4b61c17e5179230faba4cb4531c520566df2ec4f719d870591cf8a2f8ab64e986274da16810b2660cbabd34aa6c3aedac52a7e78ee407c6554cdfe3c3c68d6173b2b71f5414ffcbde1c1f3e758cd126ce2bbd7d1930b67654701da1adab2f5b39403ae6e4662a070e63441ad8f9f0c7bf96ac8815b301d01ca4e9382a04cecd7c189228c20046e2c066ef32f5ed011aa1101e4b9a8b2c436237c35c2357b580dd44a8a05406d54faf55293bcde71da900c92f863edd773c3b36004d260ebaa75e5328602fc99f788a04a47a5333891ce3973ea5810cab58a048cea88dd950f867e0c1c4d2ea37226913c91beb81690ab6df848d7d4d99f3aac2cc169cd8fa8b628a3f9e0bf009b3b3c5c1e40bfd734a5d643e56cd94f38cf189411c531ccb87b6b272515833708a6efec0dfce01fafd13e4e001696ed6b73d685c48ba33278b0c2d809e5ad562764dc9d17ff63945e435fbe1047699a209561450f8ad47bb43f0d24a4366bb0d72139c31baf801c6f0d3226efb5328d83cd82cb61991ee45a07c75e9d30397c9215750f66bb2f4ffd9a7da36d025f5ba422aa2f2ebf46d5f44eb8ac3a21aa6f7e974a5ced4fe01b00adbd6439c12c8a12d25aa974c6cadff1bec4ac2545375bfdf266e2c9958ca2cf3f90ed96164b60af463e8bac9c7a5e496d6a2f660f029c143f7ac16a0c37d073bfc316dae652e480c952080a8fd7e979fd68fc48fbfcf9076fe90b61efa4c1bc364dbd755d35916e8405ad03b7a551643b818e7991e412e9226b26560eefaa230245f77ac08d46b0054317bba7b594e9a65c3ac1808a49f11d0a1e8804d6f50ad67693c3b04e88a0b07c1eb9f24429b6c545aea59bed0c9aa6ab3b5c384de9a6278a8b3db06f96b6b40de3361d58a31bea6a0ce8ad1c8ca335dcd259112587a61a21703f58c29eeb0a12d8d16a2857349b9f0d4ff36095a8e8b81a73036c780664a3f2db482361e843094bf7b0c9dab050a75e70d9c0f7698104532d08e0262deef52f68943c2191d3644dd5abc97cd0acb87cc0145224a92cd7dcab543d4a4dd481438c0705466e436c713321c6d323440e6042decf7eb940f5fe211856c061f48ad9a6cb62d9eef0751b16b46f32caaaa91f321b0077485bb85836890cd0cf938cf0a7b87d81da0623383fee70a8921745a3852ce1d74d008874d86ad226858743e9035fd0818287cacfcc172cc47082cb2e2178436b0dd3819fd697c6805309a7b833e40ee991898688f8c161b8ac6e6507368b0a2c0e928614059467aab5bf75a1421bfcb8ee2ff60e8f0a81bedc72515368667e8178f1249e7a7e4be61277fa10b4afaa95232bb7f6a8e05485c4394e2ca7097e877eccef58fe6b50c6f074e5a7eadfed400ef669daab70974970e24f570f6d5389b3bcef0aa45253e37c0e69abbd8ba5755b503568af16ff96c862a2b9936c56366c98310ed94fe00fc688d4d3a0f4a855a25ff5edb191be2f87f9c217d866bba328db0bc84ceb01026217075a8e2d86b07980dd6e0e87013beba59469b7dc51c628d93da33d0c81e920b19507bd288fd095f9c3b92006888ef5f594778137f683c56e70cb88502575029f810a29fca825193b304c929698f48210cb5ec867a2e79022b37a15d319521aae0ed75bec4bc60c222f44d39f9fdddd4b86f20b60bda350165a8d967af0bdd144cf15d88207bf05b51571d574629b179e10a22bb36f28a449df51ebe3a8eac6b3d542073843b21cb5eceece8964b37b21b2cc34783b969fdcaf9558f02ebf6f37715ef3293bb9833b37864774f61c43100f10355dd4a120908a76ea2633ccff0cefadba50cecb7bd9818a50cae19f4b9db8674e61e1bfa14d6bdf34921b8466a4f92643f48ff123f343eb891722d48db704e55af697599de4ba70d307bdc6ba6417af36345f07b9f62dd637313980ec6e99f26adff942439bc95cfc944f22b9260cab6e2c5706a1ab51b1178a1b0471d61b748cdddb45e78b986fa75d9d52c4fefc1a3c4a7490e907e578dd1d4fee1bb8cea2de19839ae591171fa9d8202ba7d4cdc43ac18c8509a9ad6807338114824821e950c4b4413070b017b30123381d3fe05085a001b91b2b925ef761f8db941b1123a4d64edd83a499692832f83426c350c944522c29e1ffe7d94f8f83cfc556f9fc600a1bc12cb3e353b98e4be4ea6addac6d9b6824c2d354dec7a4104571d6ee12ee07e31cdfea4ba23611ba4c426583c7f0eeecdff60db746668d0940a19e6d1a21a0a1820452f9ec4af613cf3ced1c13f07aa5feb6d1139a9ec8438a3c22d5730f2e36f92fe86da8261f9ac8858111b41da078372ebc5ec532bfae4fa619a481009361a78ae1d5f0da4022604467f10540d366f14cbe93f7614831904a4fa646eb2be24682b5e0f2d42d97170fa9e90cd28ba4a58db8a0333c92c9075433362f3c75a19f56c75842bf0bd2d2033d73eeb210969555457b9a82380f0844e98b732282fc2b60f80d5745b363b197cff062494f3416d0dab73f1b8c7fe39386b56f899f65b07a6b74d4c43cc648d6cec99befe7124fb6ed214af17a47a9c6baa76f00f9c4db014399084e0623243de3d78b1934251a85ac054aba6abcc5ace28210f34acfd6181719664d52db25d35cfd80aaf41cbbdaa1c3ef7fcc6d9806538c6e5b6d342ea3ec6f812a41f76dc4d794059fc7cd7b69a423d7d500b2a67df2ae0c4ce0d55461b9324c188ce1bf75031c145b4993a810193319006d2049abafc436cc0fd17aa3ba84d1c21cb34382fe7c64f2b930cf05018bbaa480c6f64de51b21bca948a18181bb3e347c9c74ab4c5c360097a28652a3ee68d316919bad80a337dbe727d11090bfcb42e3d86858c33a13eabdc54b572537537987a357f77bca234b3b9b661739c0830dab0e14293f7432ff1410935484251f0e88cf50e5d97938839e6411f6a3b26be6b146ca750bce4509486f062f87cc0173610147498c05588381bd60f5c459d8e1448b55f4f12524dffc9950b07d0ad8a2fdb3c4779f8dc0dab9881434f870a4c59c18406011720c86cd609e0068d1f235c744783bbb5058c56a051851d1ed25da9686ec72464cb3235225a38dd65294956a9b4d20f1e137a5e9890e671cf46c15e971924b0a7724179647003c602fe81fe02c4116dff0d35637f75112fbb650e5321a36390353e3874480f4331a467b59b433801ce55250e84e0e1776b22a361e8b9873fb3345f491e2ee40cc1741ad9877140fb1a1701036ffc8c523e6a52848b7fd1846378941cad15121d11221ba792275c978c73e0f4dce7f52aaadbf772252b8fe2481191ea253443f2daa7d064f6f3bbb9eab24901c6ae6b6f5c390b8aa29c6b55182025f756d712d9257bb8424467f523732b8bca5fdf418a9afbcb1cd19936f243a69b661c40224f4e2ec017b1b2bfcc6c40f1aa37d657f5f6f6aea824cec50c449faf6788d1ddedca05d7469f756665e68d59b45b78f88a97d966d45a835e6c120692f893ef65f3bd3d16f705c095ea17dbd62941df80f1200c5c81aaf903993d1ffa7453c7db15d5315d960e2cf77156102c2f756f2fc75594c7ca40306dd357fa24c867a7c1134c081e9cac01d399869cbffc7e98d8a1cf9743c2ab637e258d56fd7fd4d999e23523d0f262b245dbc467d6a77bdf474ae00463a1f6d6f807b1fe77f9cb22d8705e14e7bbee482807c22a87ace930646d5efe402e80c97ffcbec8babbd945370b4aa7d2f4dd3bcb2b2d441439566cebfb215407a0d504ae60a6b0c0f5f0ae3accfece0a601f0de218bf2c32e0f15a51aba8c5224c3db054dcb064399ba7e6035126f12822f5cd3e2241309dd889bd112c7f66d151ac31ee00b472b176eba7c085af2b0e13e87c9f7be7ed78f29d1f1250121ead4db14f6dc25db0f713afe92ad1a46ae3e9170c2d6d0d142b70183497820d54f444d7be62a4e46be58a69cc4c81830016923550917a89ac9dfae14c65a73bff87f77feb9dea7c0de7a6ce8485a51fbc14229fc90450e85b8cea8a76ddd743a8d8bd0e04064ba051f7632c3ceac0fae7477e8b225af95789e3900290a449fa5c33217070c834fcc6ea4bc9a17e5cc5bdb6aade164b0085fb724fffb904a83d31fbb9a61ea3aabebeb756fdbcfc29d489af8b08abf1047171c0ddf516ad50ca39d506f4968835c25bb0276236359fba7bc0b5c3835fe3451a4a132c47ab9c164daad0cd87bfd67a3947ac62e6b1b690e3d3f94ead9d1a18f8bf6cc3045109d392cbc9aaa85fc20408cc05c545cb35a3482758a8809b3dec90b6df9d50eef6bc7f2a6ab7b9dd4ec4019ca16e20909d3a6f03052f6921e928dd558b0ae5d506c15cd64b63c9114571bdc92e66b6ecfdc726857a0e851f01b0942425a9474944a6c2433110b017cb26fe375bdb981b4a9b2ce3d3a47177e6822bfeadbbb48aa17b9d6cf5349b111eba4cea852b98f70a98b419b15d93973cb4fdd1914f1f983e1ad8e6178aa716c7bdbd6cd90bc49cac8bc156f970cc23c9fdac24dca268a0414c5d914e2adb07c8d40ff84b4d9b0f6b25ed25afe93b222542a775a555620ec0dfdc2d5f5061b6bfae1f135211d481956875a24baefc9edc76187df987b0811690b8e5216c9589136ff9e7f912d3a8a67aca7916de32e59fcfb3966a68f031fd76dc7b689de0c1af968e096a66a31f869fb5f77d6e0b90097bb3c52120097185b358b98e847662cf0c8dd7b76b3dcd6489679cf92806eb30f6e98d8b5c31c9d38cab18bb72b7b18c7f4b342dbe1a24d980750b840b7936bf2270c9dfef74ba3cfc6012b024ce97154dcf884b3eb14685c48776ec8ddb1d2ec5c5b3f963d350b68cf628c0518b24d6e547c72af483ea67909f4873ca8f61a5cfe79b3f0db67030c97410f4257a38297b40f3be1c307d3376d18a4784bf29dabb4f8922f34da7921bbf5c1c17a9b86ac2c18819627dfeb9aa69799eaedcde2fb637fd345c21a9f94f3c12c1e6ec49408fd8f2071ce6654b979ff51d82f448ee09e1d2e75e4448fced4465d7b2ec0583dffffcb7575c6b67e402770833761fcca7b29320a66da4141092ae0c83ac614b4b1c0cc7e3102469990639252fc3ccc7d9621a288060df29f9565fe6c129821c20a1ed8f978d86e4897ea7dd91702be8e1edbc9c045c168376e4e1f8e12444d1d8da04cbaaac62cf4fa47aebaf8b458824f2214a9603f784672e26e54a04f67266edb694ea92971f9c95d42f8be9fa225f7260af09218da7861483a0d37f5fe84ba067897d8d4bdaefd4ea94dd8d0719f630e79b943eb6ab0fa7cf27d3b9f84998f199f2ab64c6cf740927d9fbfc1ffd7e7fe2d7adfb932511bf502011e262b2656ad0cad10aa9fb2b9881d16131e4c1131d8801e6a2471b3ffe1c3a964f78bc0fffb9939ff4af953045e0f70d3026af6dd31dfd89f8acb896c1bd429095d332018d7468125f0936c704199b96e07105e538ce387387728ef220701adbbca5dfabefea562e669cbf0b56c6f92f1148965507fdc4efdfd6b025a06f2b42d5ba37f02941eb00dcfc24c3952e5baa1b830f4d4c8a4531e1698b6748bb03b6739c4e81d7a9d2531da091788699ce464012bce46283e08af1d2b9db5dc16be935ee1d6b458bc0fab2fbad8525ef32066851004045df539a36c88ae1fad19fa76978795e99cb59d13c7de61bfd3c579022b7a93791bd080686b97ec6413e6a5f0a9161518042db99de928da33127874e0cd14c5b07fd0feaa1452ffdefa28a952951cafbec0904977426559f41bd760d8221833de9883da89544a9286342641797ab8efdd0eacbc03a46e7032fdca095eff2539334d11d68a2c8296d563aa5d444b5a38d248f70f3e10e8bd8ebc84b7698ac86315dda401bcd9201f92bf4894171ff3dac8c2272584f2db59bda2620730075e1f2f8a9369a1d483e9ed76e392cec79bf640822aa3b8ea76102e63acd62c76568804f7437ad5305657d3c851879f17d3e39e66eab67614341a7e599c4fdd21c7c258af2dbdb8f0fbd131aab907355486e51e9a3b280387941d2de7352a11822b12fdad6527e656b0544c822f0dd0f08022f9480b550376e5eb0fd71591c9e124d9cd421d62d480bd11f78b0d761e0db1b9014bccef86610639cff0788cc2bf929b7ad8be86926cff5e981d7f0cb08a1394af0f22769a7ae773af03463a26b24fc7afaa8e6fb8f333298320c04fefbc5f24e5b586c54415527dd974c70342386dfca0380c491250ba0afdb9a99b80cab01fb3d6bc3116668713d2a61f63c6dab08f9618e550900919e2edc3a8d120f5751ecfed496f6367e2734292f14fabd166127b495b1b5ab29f591844cc361050aa73ff1b9437f55c227a657e9e9c6b83baa08116ce56bd75816a99b1d2c037cb989f7824d131811ffcb30b2b2ad07a6f68a5b05e80165d63c258972635ae717667819af5d2806af05af042b1c05fdc36d7de7692c0e7451d949623782a3d843607d15ae0fc74722a6ab02c5f137136f394160fde355440fd2ad3ccb782822e6d7993b944957923828961a8dc1d2cceff3c9706034c3ee665c3b77a52714d1b02fac3c798d70fe272517a6ad83854f9b1cd2efe9a474e3d894e805e847bdeed0a8fcc0f4307e6b5384b8b5c091971525e46849d2256d8d55f2e223877915d490927df960133e00cf13f11eca6a6844a65fb17a60735f37d530045c8567e1afa67c78dafaaa73d26d66b5f90dfbe206eb0ac3199fecef3fbc3a001cc6367afa341c0f3c6ca33998a8b9bac721214a07cc870bdc0dd64ba5edeaa4e73319ee176867d6828c6433d8332824b307a10e741c97028bfa86b7b4a905bf08d56b3fe8b1ade6524dfdf8a1e912e0b57841a37067d5c3f3c573f62ecf7f86cf0c9d2122518e87e7f627e5ab5acb257e63176e99b5e0c6ddef07d9d2476969a019dd8ba94b424acebae47a651765a00263429d2793c15456449cb7bc2390b6d9b7cd47f4958f320cf4260e7ab21975518a2a653834eb94325518dc2a8e171d45ba79154f3407b946e90674f732fe78e6444611d6705d8d115e2f875497904444ad5492b23080b79c4a6b7ae2fb225445bc3ebb288cb024dc3a855d4afeed1225d470e9ce87aca9e2dd46126f015ee967015ad335947b4e6f3f0617672ac8ed115e2892871e9b6cf2ff3dba82254224894b53e689070535812e859fa6169381c8dc88817e2a7d929015902a41032ff24fca3c65fb7f04d2ac8a2de836c23c85433e33fe8701daf4e236ddb279135a2e9b3a1e5933b8113772d73d2645535dcc777bdba0d2e51b6b9bfa9d57f8ed28accae1bb916ce0d61ee93d93e5722542bd93e30603a082e1d47b3f8da0b2c77d5e8b6248fa5eb1f995368166f722a7ecb9f6b853f095f2bd8ffc739010ba3e267f496ab97e91cacc37fcdc330f6df2da33cac35ba2b371929c2af782d3176b6cf48d0551ff8c14c0c0e9b9ae6a5f4d413f44e37310ee6c9ad5d68cd8f3ad9f6ec9e2eafd0a2637aaee63dca43eba64e378da5d60a2bba388477699e0bdb3cde5d748417c8723c423ea72212336c9456c5020e79e50d799ac6bbde38d80c35f6718b1a1f77ed849ecd44f9d80cdf9b7c463be9161c4ed4c965a708d75a0ae32afdfe66bf262cd12e6ff8e8626c68588227a4225b571975af022911f9dcf5bfae1f9138e488897a797941c557df3e9bbaff1efb51f6cce99a879d8c3628d036cb7910fcd65fd5da790b32f6785ca1af5688e22956d2b3fb8f4a012132e74855a5743b038000f827ba42285264f2b1a25487253f05a260e93e459975b49999e15bac1335614edcca0845fa8c5f2fd7b5c6ecbc70036df49fdf89b30cb21f08a3d36355f00741c4c00cf640b254eefda6265942f3821b84fe6820f74ee8e8f7a2d6c44f4f50bb39199c5e6d6914653f42362ca02776450357e0faf217d40942965f27970185d7c1de6849facd983f42d9e47b371d82c4d66aeca9acde6552a5442aff66a981dfec0f04678e55e05a545f10db2836c1d92a0e33c1e3630be3dae9cd8eef2adf8570bf4487cb48f4b4090541a51dfa497894529d1617b45b716f1ba629c0ce06b812cdd66cdceefb112bf8e36999b1d853a7c13aa29b6077ae7339207df5ae11e87e5edd4028d9d8111174da66f1d466175dca97e8925da0f4dc00d825cd4c89f613d5310ac597994ac7e0d090da82b55439eba2762d1d4f5c646d1c75662b03feed9b1c33a055f05394cde6027d22f96960bc2aad13fd1832dbb79ece357d56999d70308987baa3070af7314a5409e34bcac72563993c9392eb7d71b77208bc5aa38d6999e9e310776ba5779a8fa7219bc9f54d51d84e73f2efe762e545f22815793f737d2aac7f88edf135c1f56eecba7274dd744d564ff0d362ca2c7aafdb5a85469bc6d8991c1f2cf55857353947c08070a0d686fcb5fceec3cb52acd5b1311f464415907d614930be13a36b05eaf34109a9d5ff2f64bafa1c11658353b17516ec857226200eae56b1bee173ba4d4370d30b45e593222c18f60ca3d873f78e67ba4669dfedb5f8959dae67625e8aacb3322ae6f87c69a435a15c09ae50ea1aa6ea35d7c1cb6940ccead7ae4d5981c88cf37d0ce533480d65852cfadbe89d81838b6122147b8ae518709b1fd6d31ecff9f63303ae45f6477179d156ac71292b4cc197b231c39ed76e206f2fbbcc332a472ac41ff2c7f06a601f310ac81714cd9826a25b500bd321de96d61f7ca9f438b37817a666f15092b74317a8b13008cfaceea2138643fb59d7594a884167a1d624a28a839d2db725fb4f043874619005f4489a90beb80c20ca96b6ba2833bf226c08850b632ba1b3e5032a3df6077fcddec31cf8d7029532ac405a7a52f4b687d6e7f347ca46eeaea78f2dc22a388758ea0c8aa557841479c72ff6d528bd1c17116301d991776fddc62d5e0232b29ca1184d3e6a864b933be4a858aac068eeef563518f537c20ae7594f2c5327517052dafc1928799a894c69bde9785f1ac32d9ef21192994ca6633749304b9c38a1500918f508a641cf741f3f84d254f9bcb9f3fd0a65a0a02844aa8dc31eea4b8f9427c9593b7ab4b74935998b7d4c51af559d7f44832671b89afdaff1120dc4dd687c31015b98579e5f0822258c83ac70c902be33557362e1d3a488b36b187cf665606e983cb2bce9329a41954db0fae2dae9fdac8ce74d56b45f80e7064e1fb919f1004700a119d4d85fdc6899096b6b5ef8a7c41f3ecfa915f4d982d34e73371c4e25dafbf5f775541fbca41949c0a42a852d7ad837aefebfee0402c5b7069f4db6d3d38f8b3471b95cbd0599aee4d2ddea87bce1c378c6447257cbacc8d2226bac6f9d6e40b0eb2334f586b758ada77771658b93108f0d59dc1121efaa43d5f7ef56ccc018eac20a94c5221a50ff0f976254ecb3e4ce29f8b50c973691319411b4bcea09eca6b9986fbf980c7565c06145a5349d3c9bb64604885f3377bae6bf200df76829107b93f5ee2800da9e24e835ae9ba3ffc5813606ff4368cc28e34d0e541c1e9532546ed2f816ae61c647ad5d20d3ebc86b76bafb3b6074c442f96d68fbf92d1ecdededd6fd43156cca00adf2ce3f0189098a563ab9d3b49005158559287daa0204db2ec07ed6975b6940431bb68ec8bf417462d33607e94b0eae283f6865ab2abd6d912577c3803bbde0110641a1438a371ec02a9798101558a13b3ea6e5df3f36950c70622e63915ab97605535defe22006ebf9b2576bf54802785a53bf7de063c40d3315ae9d97e01b4fe5fe2e22056a13fb7ad77b2f9cb5956495ad4594ecf7eed745f5d9adab2fd9aa6d31d378a9fee6f9adb1d1e96e343d312fd4eb02f0d34a86853f2f6ad636b2476aaad74f03ddbb81213cdc8e590b065a5c489a528ee871dd4706fcdc706860747587d3eecc3b16aa4c1817ae64d5a8278ad0a1107e29c5b4ff7bdbdc475b865496bf191500f783f14c906ea86fc4510566f669c9c2bbfbe12dac629b8d3b9a8a295e76a9c7285516d5433c618afee692001535cfea6020b7554ebbc663356daf51608a60828fab746565aba4eac607ab9414e414c46a31b779a71272003cd2b810f98bca9687d7995edfede3647602d21e14170dede9dd94364c37068f6715ba69f4cd731442d3e3cf97f29c4e8ef4642ecb81b4f1f4c235d1fcf45e405c3e85dfdc4b5f0c65149bb94362c50cdf6807064cbb5f6e038bf68424aaf183c0063167457bc1642801b2260a4700a2d1a5ef3fd6d22bd875b0abdfcc22887897170f3adc6c07f1a6a1c0c8017625bfb1e5551a44f370b37f070807ef8a7dabf90d38fdd23a2ca2d0975e8c1119309be24e4b03ce4aa21947ca8a399a8fb9b8ca28d1d48b80c9d9f5da798117a52f7541518ab64aeeb022b8b1d64a3467343e23175292ed0aa26b6deedd11bc3778d1f2d709bce6b8b1a03c9257d6b582e538e3330cc9d778d5a01a00a0200f7827df3c9925307eda7eca2dda36a9f23b1e1f9c098b15b4c77c297b63908213365d573d9455e00aa1ed0f26b3a247a28165ec085b9d0af6eb8473c90855f0bd665c6cd58e57fcafc54467d50a57ce5d43e22b5cc0530a4de1d9d3fda18f7fef6721315d66bc4b6917b18e8d94ec7f601b9e4cf9d2680d03add843ab8a6625b4c38ed343019039bb768712413181bd96739e400e44f4793d224453a60240c6866d1511c45be3289e69c4f761a65c0da665fb60b821d8e0aab4bf8fac40862b62a6558eac4c354ab8ca35d49bf6287004d32406e617ef6d826962d273205857a6d0bd3ad563906af02c65cff5a81a821a1b18b75cef49ea0cb79797cc5eb83486de04ab707669614ee754fde655c683662ce503457c1f95c0cbbfcd4bf3802713e544bc153716c2e3e264c5102760eb5d65161a57b95198d809cf2215de31f5f2677fe24b152ea6570f1ba18ce1e4923f11a0db69f8d10131393db446bd17c2b54f59bf502458000f673a17b21bc0219d5c485224e4defd4c060873ee93f9edd6d1d95540156563bc5fe810057e59c9a5a2449f7a89da8062bc9ac440c54ca920c31e8b4a2fd79dedb54b18f3878abf1dad3c98f82719d507e55f86c5aa07de0708e0e4b2c8b12c9a8314f4107111357e9fba4d4b0524010219ca72942a87270e52140483cb9325d3ff63075e0df82a8e3856ad068c3f29bb550fb77169f9c34c0bcac5da7404a26a35830908cc214d0323738381df6048b1bcebdb7088975c29a249c9b805520b260516ce1e13ea3f35e9b5a633724b39b56fd4bdc41fbc03a2a6a67a5a6aa531e23f2cf47a7f7f2317645edfb5ec53c4038fc6587b6f0a3e4df2626ddad2edcfec2c24c9d4c6710887c7088f519f483ac96f88a769732c33c5cfe8eafaee7709ef9836612fe9611e11224c6147bce0524b2b6b58b579858be6102b44cac78970460b62b01249a892711e43d77d78dec3a4340b54aebe8012532f6485fe4d2c8660b681a6ac9d0e9c5fc76e77a1934e8e59904fa50f7377bc42ae1c62cdd8f52aec20da671330e014397fab32ead7fedc4690ab9f5409b3b8bfbcc0e8496d34dd0f32d31de42de3e0c52f299da08ebc3209538e3ce7df76712a5dd1d983d693b3a0c34658c5f90892229db00d00fe393bc18e892431a3c93aaa16cad12981ed13b82f27907c91b99690060085b424cc36ce36dc4743e994c0ad09058c80bd657b9904a3f0d2296ab82d04a8a5cf325dd6160ee12792a042c3d00eb4f5b962b85dd3f8674c0abacaf144fb2c5f2e488305e4fb0eafe5776348df46b191cb4d264976993ff64a2b393d276927a29b39bde06e7cc7af48c63a1e7949b8d133cdad21a99090ea9f19502abcc298f0db3a234b6b3132cd88e4f9647d7d5c414072a44bd47ccf0fc7857961c282edcc5ee3c0ed809a90663f4b92ccd98a833297b854aeecc1ee3e359b3f7e51db1cb1137810866aec3efb3941c5ddc8b25446a5027b890a7aa4482be7701fc73f207c51c28a1c029ae4ee076d5c7c028cdc80bd5debb9d51a6458669dedf8eb286b317a3525d8687196736f9be425eb14693bee8346834378171703a706be00623f4794f4505c8da13f461e53c5771f6ee64132b030ac94b82060c7a73f3a7f05f147a6e5eb741ac2856f397446143f34bce568ee3807979c7a431d2146ed9ecba8ebe9b79cbb7877c609922e58718b341815ca3ca8cf301fdf1eec035eb90914c7c9e6c8c13644b06e953ea2251dc83af1f4ec4493e5c0168c7c925b07f3541fbd61e972733083605fefa238936baf389f367bf738c7db6074f24bb876875e64b880921c7f38bf442298c0835c6e5697825449dfdc4dcfd6a3b191253be94673293294884e73b9063561e2cce836792ef4086e6e051879242ed0e8618c27986c7efc70ed6e160443d2a57937f6bbda389681b069283937b5134fa7b2f6b3086f5295315d68e36e1a50dd0ceb75c850af4b8b34303983d01e1625177982929066751d885594f2d5c9e68c7666c510fe2a110c6ce593f28bbd1cf87be963f1315515072a0520f07dbfb729f3acb3c5bf85b26d8087cd37ba41a9902e49b52e958d5940e5f0c7dc1072b5cf148480aa382a5334fad4c3c2b0e06a7f84d13e0f0838517cdf6f9eda6c45874d927be3917299535dcdd353edd6555f4889ddae2903eb5f966a83be502a08c4b97200b29304f7e5f98d1717a09115a510f3472c11e391f13dd9fecfff3960a36af06d43d92c8c1629a4a34b2a9e0983a7c870bad0f343d3c8f4d14f42407ebbc4408dd2900e8dd64a0a2e62d5e524cb6a59cc1858e478e35a77544eb4bfa7b279c3c6ecfc8a67574a0ceeed91a26a6174871ff0855bcdd852c073e6e181993c88b0658b53793564007eeceb2d4d4d87c10af5421edecf67d936ea51233a83377813e3b6ed759616fd4cc24a2dd1e80036b43e4c9146676c3b495220af731238be2304258bdba69d477b484f959ecf3ce19eaa4e666842d748a9960bf9067b7b28a1b224d63b9129c85e7b41aa3613a2c49dfd46ee911ea285b2fee2b1b59df7879c9e644757074ac70f3eb2533247726b64fe2be0018f8fd9d04d4bfe52bda8f109ccd743516f016b0046f72e22fb6a0a55cc4c45b724c888fe934aa55b014d9e10e44213daf6cb9c468e12cfd376ea6f8e2044280701cc1a0d672baabcc1bd33340dcf6de0c064fdffc79e690abb9b1c2b35ef922754ab3b5b3c9f9bbbcf4c4578feb8777e3dd45d939e1af0ab7c30357102210dcb1cf22b5b3a73aa709c5592b2e55869c249e93633c0ca77975db08f922c7160296065b1e82663610fa232bd46cfae113f5ebe1255be27252a803dcef97cf980ef8e748d282d2d5c294f0e6dfb4b2821afdeeedc403609a6d58c8193cdcd51a62f942d8127df2611ff571e22a658c7048efe95a3fe7ecf819a0c44b3626302f4b37cc0ff2580f701252097376c9b6c05edd734d3a180eab52cd57138cae8946deda5e990d07e093d20b788e091d73ed82e63ae7bdb6c1196f91e65fe854a94ac3f3d6d469107b06454c8cbfdcc72f0280786fecd56f11aabfb6c4989d0a64587b2fc745ad826129ee26cb34c19d98b70e73cd66b73d7a9ccbd1fc9ca298b16eb2be03a8b8a1f888980f4d230a6cad55d6710ca66333ffc17985a81831f040144e5d6849ccc361116022ae420814eca80332679f28db33431d9ae332c832fa2efe837a846dde14d9f91b62dc031572aec2a44979a66374dc63348567bafb3db8bc1604cda7b1bb6ba347a7a997c18780941142fdf5a6f6822bfe5b2be355ce4ce06f4b81e548eff62eb3ed2a8655e4cf342f03de6b91fa2300edd83279ffcb3b14a8f9273e84ba89f72533177e49f24344343e5eedc54d8f558249aa734826a3f68aeb3c8a5bb8dab5c4a9f5ee6f5f659861d34b01fee995de529e1d88406e7646b6d889bd53ebf1919c0dedbb839b82ca168aae6fd7bede8038062f9f984fc0161820560e2a8bdcc7f48a324c705d03116cbb3270d33bae334071f84ce2f22b7f77c86c4c96e2f27902086c94e725da9b23cfbb8eeb7b03e1f97b6265b8cd332b5e5f1f964d5e792f4119a286f1cd99ca0b29ce02c5e5fa416d303ea93424795546841755a6caabedadad258d779026afebc24ded5369072ee0236033773a1ebea5503010175df3eabf191462b225f3a69080ef1f09ea510e62b8d14f1e788b2b2f81893733c1c2dc81c332b924c1d96e6699b2966f60f57c1851b91bee733d07eab0c63d83b8f4c1cd4307945acae30ba1b29f32cde4ae7f07063bcb7de507592181fddc3bf7bb4f2c3690359f7bd6e8f2a7efdefa89340b9191e61f0336087f82cccfb3e3e4af2771e1e431bb1049e2f2274765232061a318ff397f6c3e2d5b50f5aa54ae4fab76db00a2eda060ec9dc4f145ad54bd766c18c11e364e26dd8cfbe77e22e4f492c67a43ecad660688455eb0c28c8a56d5db3ea3e8213a965bfd7fcbbc7af607fd0215e30c8d2e7ecf9ec521a1ca7443613a774c50cc8d4d09c77c72abba3f2484298f12def67a23b594cc40b56980b21262ead6d094bbd5a32d2e7d122024d0903e69a46b17b89f3be307911e1ec986150a4876e604c6ff2a51beceaa139c21e69dbea5c19e80958e9ef54fad51f48ce14cff5e76f5e5b1ee273333977bbad69f90fc63d5e79c402b2e3b96541a96a0f5e8a7da1d422974b5177e8f938c9996e102eae22400b5e91ab7e601badf0eed777cd8e7f882522f3a316a275777c745423b14d95d96d9eb6c6dcf6e2e8fd4aa1b5a15d7464b6c4a22362db9785e4d6df178babaee2d2933e260026579c5121180d4833914e63c8a5afda09dc7dec0a3709db90c798fd0052741ada7b416de8b152251a9fc8b6a4b620f54f0164f10cedb0d39a19dc108425faa16ed9b78918fcf061183bd0f73686258b923ab668de263ad88f574076d6f14153c1bee307a08ffd3d4331bd8e07980a9512c95889f1ba57e42490cf6eee321e6a94410b9d84d79dd79bdca0eeaa1ddbfefeb1097dfe5c75cc55618d6e6a02e0e5eb06ba652c0471e34b59a7d637518bdf539a968c1c4dc8a21629c2ca491440153384d530fc8c1c569f3663c7a1b67d647823b98a452c104652ab0a15f97ab8bc7eb69ac1","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

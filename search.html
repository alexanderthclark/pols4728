<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"887e87886dd757e0902b5b924aa016df90ddc3e1c3ccda88677c5a7c70c77eb4c15e26f7fdfb07f95159ed8835986fd84caab5ed528463944f77bb9aea347785b9b3f588d4cc010abcb4a569205857cbdbd86b97bd470fcab1f566e6cb4965435ba0a4080ac739577001815899d569fbca402eb7c63fde017838ba13ae09ef0b09815c9f11803f34370b9d8d2bc3f7cf14dd18730775b9c116081f0203d9a9f0d5e9936aa178d0707941de0e3206a481f2ca3932d665b330b2210d4fa030f5657bb9a6c6414bb7d94cf18ccbecba9170d76f76d8bfbdc4e4cc703c625c29f7664d78cdc168301167da2b122365bf0dfbffdb0259750ef3742aa4fc83760131010ff91a60cfb0a258027e8955abe30c80808ff4216e4b5fd04536b294d4cc17aa896e440febaf446f414c97d05d8bf0b94b1ae5f4c152b5b8bef8d6be844ed43685ac3f0fcb7b61bc8dcb118d1934df381110c16c44f08a863d210686e095b259e6a437a2eb1577662464843fd02051cf01c0133785d9f03f413e12db12fb1180d291594f1724bc959b88d093151d15dab7f519e137ce274870bc0c3e4ce496485c581e3f23bf1a66802fc7a9a5d80a0314f48e895c688b8a597b7959336a4d309851a669209b5ed9dff9745f244cd3ce564768d389be7bb985ecf0590518e769934cf09adc5ab2628b7598c905eac476a15140668cf5d3d56a6ff1abaac55058cecbbf73ae4712009a32a4cf449df9bf58cc4a4c6a4b09eda27bb31e737758bfcf198ef183294f0e041bababcf0ed38574742fe709235294d8d2cbd6da23deaeab87305d142fea4e90dd262be117ea58683db724cd6763e54adb85793b891fea5a67ce6917f81f7480d9243b41c01bad13eaaf35ce2c04def75a70192cab959575f03e10449844aac75887352776ebd8fb649491b1c615c1ada7e9d7732d78bf6b9604ee27e3192956d5a01170cb8545237a8753bfe07b65ec3bd1dc23e110d744414c437f7dbdedcb7108b07cc9b6803a079ae7e6cc811f1a3dc851d9fb4063ba9673978dcf8a831d7baaf2debbeeee1488581437324a86ed5b7668fced18ecc18659d7dbf7ccdc1305b8dd1a3bc0cdc241ac5a381ca93c64a04360a3a19af7d1b2979b0340964b0f831a078f7a803df4991d8b37e9ce5a3d0165d06a5fb9081dcb43e77241a60d78af7ed4dae480872cf0148d9a7b9eddee5d327d0021e0a7c0466d9cd37549ffd53a3223e452014862c10b4232a58ab8552e900016e977b5f9da4f06873503c4439c7cfa2b2f3ffb8c5c1c05451241311774d6720ba61c818ec59f5058cdbc62323d2501f8bd6be72b158e1ad648bcf22e7f0e27fd659dd0ffe164430293e416befc3e991266473e84f883e4b0d66f6087c5cce72e0ae7d6073f33952a934ad53a93a838e3ccfdf1c765d0d1ddc698f1652da854027e3b129201bc1c9b4dd1bb67917421dc29c115c49fd273d380a20a9947a6b7b6148b836c194443a78f1cea688c325ccff58463446a761b5336a018e6df1fcd0a216cdd3670a4fdffd2362a4c28d282a6658018efe420a9efd2811765b6d536cb466d89b676d339d389a70533cde0e2788f2af906f5c5e904579bf08ab92ab85ce474d51a190c60b3fafd2868615031cfc82bcffa601c1cfd63bc32f8d89447fa2661d06456b188156a86277d9c223bacb654d89d7108094a300e3bb9e91a3169e6ae3e917efd2614348094dd6b221ca5c57e2dbe3aeb6517daa002afdc19f4a32c383d1692537109f9237a5362e7507bf96480f939e4e12d7b5133a1d4ef383066476d3dd6653c7d2e66ccd1adfbfc5043c21676f942ed17236bca2cd5730e095a195cf4586554122a8935a58859605b7295ee148c65d333a6261ef2dde8da0428f2cefa6b9ec87e411d88e1749e70b18e1f1df84c437366eea355503232ee591e2e4b8c8b4352917f6b1945dc5b5cfbfec4c394480479957511fb6e805a3278929d17bcf1cc2d4605330b3717f346ed4ee2bf77da03a9f14fb9d724fe8819a706acc0acf7e27e0b25c5231525a0b79869b83ecfa7cb529fd78d230c5ff93e9a4d4924f342f46ab892cd339653eedf9b36d3afecd06cda606c0241d77d0984321161001e31332d1d9f2849c947b8dabff70d928588754c6d39257b829f3f71239040ea792fc361663a63de04af3d1b46bfe923c6b14659ef429ad0ffa2f80169b54d9cffd0f3d7bea89faa0aa3e8be2252a9b04a3d8429cea2fc03438efceb20cfc7e2a4c0e331ccdb10158cbfe031a6b5ac7d4eea87b6ff43529b99a91550b51f3cbdb678c010358660b557c192f095904fc3c4668f7521abe5ec20fb1d7cdedf912149b371c202b4c03882e6892c0851edd0fe14394f4cf12308fc89b899ea10492a749a90099cc59912d486e22e38ca41c7ff7dd17cff239e7ed374232aed4b221626a56928c1b19e544ec8465d8657deb8782608dc167e7f44af2d0eec9a1d13ce7a84fd0a06db147e8f459166a3f9818318280326be1357fd39018247f5bb655fa0ace337dc0b4487ef49527af999d46dbf5d5b90d370a316d018e0206c33578545a59e1b913e9bdab22ff5bc98496c3bc148af34afe7854399f1f153b801066b03601cef904a78c73de4b2cb3ec867628b67036acd755cb0422c825defb70bb5fb2f8dd3b697ceecb6048f54c08c8af26e2e26e20f008b4b4bd75f3ac49945ceb09b2d19d8210c51e34bd40bcdf23b6a9b7111e6e531a5549db41c22547dfa190519bea2cc50a80cb78d4a00d7acc30a4c8b3aa6be4612709d8b79422b01d9210b6b3edb65cf386d09ae48b2c99af881b304f0440ae1a6c886b3a1ee97fc38f8343e96809f3fe5caf8b5f46b8411a4f136e2e111eb2d8619df93bbb33b49166a1897a0a57febea8b88ba47a15cdb999b5a2b0bcd89531ac171a5145ded6a40b16e520e97aa169d6f0e4ed2b7e8f6d9f7f0c81093d59440dfa6c1ad6adc9027e51c25395ef46cd43f6714623c8256a5041f759362911e59cb4d6dfc2b8b3d2c83518e96a1907ec2ea2abb80361419c7e543c883db81a4a95391bc8721bd79efcfeb31b1762edb67f093b7d1d084d217317a5752c2c0b40092558a8561bfee0a49bbca19f885d8645407039acf173a9fdb80199f13ed51c670424eab1ddbc38a670de6b255688dba93e4cb2a416706ce5f489558b4491d19614f736131bf5ece6f3ca4192103f8f0e651925847b0c71b4f5038fc8c7f113e8ed8316d37f9106263e594084796f129ec8418037fdef394e2292472aa65c36c3d55e2849d72c2f27a8a2a88a438f8a6077ddfc985c5abccf9ffc428e909776f0d6eb0efab2f99b83032e2bc1ddaa27fba98e9c72eb2c5993c1a76a1ab97bfb2691e5753c0f6acaeb5f8e6a4ba94170e587300abea52366f0ee076ef2c0fd2ac36ddb127c27efb6da38478fdbb5cecc3fc3aa2213f08ea78da5f7ff4bff73f025edf8850ddd27208289695dacf2c10a2b7a64809097cf20e47efcb80f91dff47a523c6a7c497619bdca123d650d9ae5d017c6de44793295058594ed19f0fabe7fc08eceeba386d24d3b276522322a54d0ee0d2565f660168ff0aa16bf9a5091412cbc32f2625995a3e229adf673f3341119a64eac410a00bf0759fd99a6ea52b649ecef653665e23b7082ccd29893bc0b264a079c9d741a4402c62a308ef9c8f1a0b5020fbfd0d8ff49c620e021aca3350b6f0bf7b652763c2ac566bcf3d85210b4a344b11937df8b92b429d0d870169a6de15989fdd1a5c536cabc2d029e17c6618de1965fdf882f766eea09999dcec6aa83506b0291cc25caa284f83dcabac93b801cff0bab72f82c1715cf3147a72a938e15973d3a7716e413c3284347317c7c252621e679444b39388fc5a37988fe592d82246bbb46cebc85d6d2a9a2e63c13297b140cb912291dfd392e97520227c2dce00d76d70e9aa0dfced2be63d40a88f421c698847b26f54d506f8cf995e7d48a79f65dd87da7424c7c21215cf39b9ef6dba7fe49200c9983e645419d354549901b7a15b63f6286ff9a7de4c3f8d915069af99f133cbc134d782fce17abbe4def623d2386a2120dff84520343495b765a81e50b85d7a0086aaea57560714b59c3aa1466d5161e08dca43079ad26d50c8f88811279afc85b021bdffaf9cbaecdee546bb3002f55ba7cc704f2d2dffb42ee69562a0c2b875efc078302ebebb62f6ef2726bb0026ba8e503e28d3deb2afbe0f9939cec9a620e91ce7f847da1591cba1a12d2d0170b99191f0d114a45220734fe85783483c6db5c911c31be805bc3816fc9b9de2c3e5a37d45a2d6e1de97cbf1e23b5a095c5e07e10cec30502f5d195befb337c7e409c87aa119144becfc157756377e14e9827c364c142df64c5629524f038c663773e732c41d40e6fc1f2149a955c7ff63f9e8b221c9fc83a494efbf2296257261111a4ef28dff91d8d864c696e903f139d34fd44df4d46c80f73a341da7d4b22c2f009ce8b8e37c5ad55f4f39cea3e26a9130bb77086028e5b3a2fc5693f1de49159c26c1018c571db7185afc4b52a2aa8e5b0ddb0ae206166cbc30263cb5715f8f151ea76990297aebe510a807eab474dbf6d82820383f63a0dbdbf4d44ffc106d393fedc9cbaef0cd6d0cd39481d1638a63f564d4ab4a6b4e016a172a1062ce54f047a39ac1297ecfe987f116e1105139e4508924d151cd0a74437f5a3edbab034a861d4116a3c6474073ed2a6db3894928bbde614b98c881f82098a27567093597f1fdc78e457bb31d8c9b682d3b903c18182e78ac46d9ed92ced2d1a6b654801e2e854e199b8a6898e8eb6aebd9ca4ec1500824b1f1a57b9d03a5a449743048041d8dd22950868374046b52d827577e14583b0055097f33795c34f8e545b2c22bbb25f1522f976426ac322d535726df47b1b40fef29fabdf37dcaae176e4f77feaca60e93753b4ca6c66f51fea5d246527ad4c1d52eff30da54343b85614c9830ef6eb80f4b0d567a8772796ad684be8d7ad27570feaa832c226dcef00ed134e0f61894623a6b7abcf3e076f3bdefaed6cb621583f95654a66a97566d178b8897211f686be686afe6559b68fc47e82d666d7f3abad3a8a72992f169f149ea0d493174a56d0667366a9469a1e3f47459bd74d382bf3b3aa170623225c79c0c1ca63db5d966f6245c205640902dd79cf3a23a2f750e022def400fb7573102967c5e7582a5a12b8795c3adecb7ee05ba5a2978dcce4e5df94d2fcea665d13762ea9bf737814006057cf3c7dd12b1eee0f5a1bde6d094c9b4a2cd275d0f873bf028f0550ea7ba1444b37b84ffea4362a2dcb3a9426eea38e12099fa100cd33d4a65561750abafb3588b8709059b11465e978dff1624164bed24d607c925e9874089059d73e208720ce1e7e077819e8850363a601038269ddfb8fb5de42574d9594264649e915482b5abc79d78209a23873514df87f9644431eaa45368a41ea990d212a8aa30c05b5de499c1471b1218e973ac19a41e9f9406a450f25d0394599d44ab23e189d983d7f4d028ca22c83796a61aa89ac9fae476a744bf0e86e5836f42e8391a8b5a07dcdd4e0b97bb3f45f4f78a88059e77e75c5c4d4768cfd56fe674885486403a5a527e960ba46a93a44602dcf2c8d6444db3a22fe2e71698ff0b6ff6b76eeedcf42e03067723863d8efbb1a087f21dc0d07d16af393da29c40df6e9f18c7233a2bcf566eb80e4ce09bd4f84c2778a8e9594a0c58b15bfb1105ac413f90fbb040bb1c3fe19a343184f17419b5bd465aea1dd1eb11a848eeee928f591bc32815326a5bec1d004c717e0895e041226770e4db31e222cd4264d07b92e5113da498d6bb560679b30c980f8f38a0b1872f761860f3e7689359815ffa9348a8c078d0771fe9736c74e183b39fb74917af2dee93644f4651e336d3a46cb40e742ac086cd1ea08f68b1551e1edc78f28d399139857c0ad7a59d6f7b903b312784bcd2f9770ecc81565c4f08684421b6d85f036612e0b950f7cf407b2613fc07b19d2fe2316a0ae7269f161fa4f288d16ca4543c5e3f8e842ea8bfa55bdc98a4d662c6b52ea3172e0815dab15cfc3fa35cc072035fe830da16b4d0910886d59fcf1ef731adb8c1a3b39e4892369540f6f11d51a68652772c7c235d3c10f5635a1c4f469fc90040823c747795a47e4767b1ab8c7fd47a47dda9ec2316a88772766f0cfca61416b8778f225d69105279a911571bd5b93495c1b6c01f0db92f46230b63bd83d450b0abdb2047d8419bf6f2a9350539d518d12f081a0a79a46bad1efab55244baeadc48cff5cca478744dab32088f4fb60dbe2ab6c5e0b1231239f2c479fe1b656d794a0d9aac8801c0725dea065e468ceae7d91090740a44cbde8b8afc5797bc1a3283c986aece97a0c19e260d16fd4e14527853174a1a5b87978a6a698b22681cc6a7ba12f045a338ff28c5f21a4008e4b03d4e071ad67647776d00126bbc4b857381d0ead6003c613ea536f6f246749cbce919d27c225f50022a8d23680b6a5551c326f67978ab7a561468efd61969af8b77bccb97ddf5f4a74a84f78d58458bea41832274d0120327b0253ef1f47fc2b75bcc9171a3fd65b72567c4b9f9921ed9c4556d098735ab064d0191decdf72e35c493907c7398a5bccd17ee80ddee7e2847cd872f84a73276c7afc0abe4ec8c24aa1a348cbbeead78949760e23884d0fb195d90e2aeee89ecfc0f1454a10b1600b3bc19f0a42d9ee8c9f611139fd139fd0846bbbc50ab795b0a9e3bc445ee6813334f0642a8aa08ce6c974addbea991bf04ff030bd3290ed4c309102aaadb331beb9dc622095ba5b5f0730569c62c8f7cec96eef60a14d637482b7bae26fa48c3fb8a7e1305f063fbc0acbbd20d424e2580ac579af6829cb80f3492234ee854d895483f7636d41640c3806d769e892c518bfa022ff1ce3b2b13cb86ea65ac299ee641bd1de2376479c4cbb92641e97681b82857268b2562a6218c361d425f19b96799782d902ff12df346f06759c2580b14afc454d27edcdde06e00fd9acf292c2da660e792db4052c4e00450e451e5abf8491c8ca5ecf54315b71841a83e19648daf112829a6a050ac4b56130ab73e654a7493ab6ce504ebe88dfc6a2b89bf80fa5388d58cde845ec16558c8e44feb4c4edcb9fd6f6a11142cc12588e80170670eb2845cb10aa9879f8c961d1ed96271be6f0acbd788f9057ff27e66dfc39fdc11b96a938c7bc4b117ae00a19370f032408a9bd1dbe79a8b5a241734d730e402c85622c219919394abb12766759f78825fc058d177ce6e92b211a084364a232625fef1971e2672a372e1fdddbf56e45075aab333b8516a8bdb9a77a0cf7d28e0a6d7a14669fc6684d9de2329c550f39431fa616407c8e77aa02660b0552ce0fc9e3fc03e0878fafe40f097d84808e30205afaeaaf466207ef36a14c4683bc9037dd46a95dd9c234c077397e21ac34e8a91fd32f614761b8fbc2f10b80bce06ebb66f1d9ad90575c4b81500f2cf4377cbd673f40f90167b4a2fe5f60dbd4bdf429d99ba6bdbc8caf9bbdd5c3366ebdf563c952b8d6de738bc64e023fe4e674d1fa8ee6245002a50c07cfbc4fc4f0df9a7a5ad43889ce069447c8a56b77fb779b11c82e96471deb038e4eeba2bec6a36f20cbb1acbccca72ce15b903b7291eefdb40aef53d2219b7b5b8b63ba77128f896893da0d7f2cd3e734b7c64ee8ca755c10dd524bfeb1ba74d3f2f8b46e55c21231e2f1963b709cab24dbcd4697d6ee0b1521b4b0e3dae2aed5d7752317e4f9adb0a6a24cf95798a086fd5bd70cb52f891bf54a5ed3b8adf103f42ad31f847fee948ebde931702d17e71e1278a5f2e482af0f9dbeeaa6558806072cf0f8630692604176ae91e0f506528d2878f23cf73b87d2358b6e3f9cfc914ad6853c11dea04a7fae32c31cd6257bd7a0ff60a203296cc01e02ca028ee8d2f3c0ae7b34c2b97d239aa87e9cab1bcc78f8d94a9d2b6eb983ae7a827f794c421048884a679eae50f6081127ab23a3461b3307bcc9be0e9c11abd408e93f4d74e17314ae6168f06d010dd4b9055e0548a8820642ef365bb0b0cc33fa77141282f0982491e49a66c24c494d77e1512506d70d478cd2dc6cb3ac631ba6f73476a23f5c7949cad1d51f9a362aa0571a3c5745a95709bd432b6621f83313501003a6307b4d50155857edc3dde3745194135963cc3f834d39d9230e2b527597aaec4b6d6d2c5890c4144f921f4908a40effb24d1252d3f4384ad43ef5044c8566fc8e0efa090d13fcdf963a8940cc3b5d548b8e540c090c9ab246507b1a97271f3fbd24e03f73ae94026f65eea6fa4cef4d1bddafd5a7db07d0e8dbd781b2ad47850d6fd4c38eab5b6f81c9e2372ae413ac5393b3909ec090c07b8408ea976658ced1afac12e1c77b38806183b434745ba9c79b91085edf306a5880aa854617cb0ade76e870934cb9866f7f63ef9ece2872dc12741198c19a08bac0029cbddb0599b7574608253db56c83142c6760a0986a5f792946d8c2f36ef1296fd6b2e907547235aebf0ffe57c1a09785f2a24c3124ea0c63bf61398ba1b03d88b3d6215fc8fa7873c796e3f25c3d474384a5ffbd4781288e6dc3e776f6af71c605a4ee029e0ce067c3081afbc9f5baa5c9f32f8ae471eaf7657af64110fd6ee4fe2bd8bd3b9085007c38634daa9f75e07232f2ac9e30ac50c9487f6c06e52e8b90a16afe3015512ec3316c0a86d35c00df22e7dfc5d35fbce5ec88836f3205a98642b8d86a2bea0f0305526af142a9b3f9bba2772e64801a05c72ee964ed12e900036851f2372ca2715ccf29a25753833067ee7d98c32df51adf28f6445b1c84c96b35916a87e5069811afc0c54aab7ea86864944fc6e2726ac3506d164082cd7e796b6a49f5db2df4b33e3185f5f824c39b95ae1d2c9a703fadea5d3b94e196392b9d7e6e29cc4ba4a499563df7e279562c3a646bf8226634447bf7221d5873aaa1f1b0db11d52032c40097d5e8ff424d99c5d6fbebb6d558a6211272614ce8ea8559955f158b276e2028d501f8d41ab7031637f25a40528e96e6711d4de8a3b7b372005be2fcfec4ce20d34aab382fbcb199b52279809fcb6c6dd6533d18ec831ad6098c2815cecd0fe5ffe8a55c7f2bfeb8e5ac21f1d55955bb0503d5d90d7b928e4ee909182c6b8447acbd72bdb30c23d9ae84ae80af0883417ce70f3cd3945733addfe7e61217517ded57c63fe445a6249bb4af3998cebb830a55f544f69f2fcdd40488035cc44d74b14165aa1084c6c75540bf4dd248c1ef719c8c9f0cf10d52fa4f6d06f81e0257fb32978f35704146b5f0ff94960a9c22be9e627666d1caed3b3853a8ccf666ce9bf507f09910cef48c06c982917a273cf5839b6163f627458549c6634c81e18b5b3bf7ebbb688ac585844a7f85076cf799afc6b26c2902d4d4e9efd39b824a7b3af0b3b285b697641b2b1fa065020780ad1b71055a439bcf576ea45bb15668f3f900dcb005790ce9f07f729f53f285173709b3a6c07feb2eb2d0f2bbb48a74f5c2f5e75490e1363c188f7f7ea1a0b88050a2d673834a0e3286382a711234dd98e61da32010bd0a7845457b99a2f20f96573779c9edd414f83da107b320df114c9cd1d17359a925d9b9de1da43a8b90fc8bf47d3fe90725eb8c487c06d1e75464b42724f1c1319f3466a0b9576d37ca7af2aef4cbfef32a9413adf94305efdfcbc2862e044d8b8f4d6005f3819559211b57bb313cf7ad00fc5d55af9bd2d191fc9008d396999c790e8fe1b41519189b4fe0e724d2006bae48ced698586628fea64933c9425413d6e759a65ffc7e1936b1cf63a6a95c77dbe09b36d887698020df466c3f2c1244e5a9ebb552d43c28de61603bcbcb6369890777c735d1da2b6a763e877f292eb18857a16f06d89abef43a1cd61c3005a8aa3b63c4f540bd8fe0511ca6783fc7210dadde229a08ddb5253ca947426c99cd92bf6a78cb1017e2ac18031a89571c0ded445f3c632c5e1935050d1c4217aa42bd36284675b83a385944c9ccb615775f16cae2125c9fb1a01d509ce15bf033b7b726e472d21fa91b003bf19fec56305cba96a3806d4cee9f0534600da6458fda8e22a0286ecb4a10cea112431ae13e4bfc6e8d289edfbb803f7106a139acf6b7d25a6152e1a5e2281ce7486cda23f072151c0f791640e2c0f846267bb4fb55e85cd988f2d1dfdbd88ebcae9c3a2aee2743af1e6e4cc5dba911f22c835e987c346f62f4174982c8b43c95684d14dc305ca23c28d98e317c0e83ba060b13a09e5bac4aed0b03dbca484407eda8b5ded4f0d4505a117ebfc907e83a0908b9dc3a9296804f1df1d51144c0b8ba2f1209b833a48390116c8c25f79355c16fb5a1338e186f28c7dc3442249661966c80a9b23d69fa0d7b3b3a00aef2fbd2b0e3aea5fb7ce7b7a2a835e955552a4f2b939fcd69db3f843959dd23f6a4d9e6bf9e5848585ba2df9c56b5351f810df81d79a13418007a3c601c98ae1cc0ae8e7879fd3bc3cf2b894fee6070057df2283d736550795cd101cd60ba6cdfcd8f29ac1f3671a23f9c622cc6c9f6fc5f7273698901affa14db21b67c479961ad0d91d4ad01bbb549d624a3986e35d8ac4af762552aa36640dc21f1bed7c68272820e8ed0ea010038ccd88cbb3e0efd7d82dbd326003fd52bb108ba2c60b4831ce5ca898589d635e3c8b00eb643fbfeb3409a14034a52d17da7ddf6164ea90789a98db693f69f5f5cc94c448dc9979fbd7554cb206718ebb0924361053f7fe8d54b2337ac5df8860f40f2fabab49a53e01de147777cff30431d7ea9254d2879371b4802bf5c0fb8d29c74f396ce2a4133f7cbca3f5e3f41ffabb56f109707789390112d0079997ea84546a70adeb976c8f0bf1b82bc9759a34598149311c91c772d37c565df9ea9a898ebee5a44d394028d1625ef20cb30d78bd00374cf6c1df6627125e5326d26b5f8c8388e8c5258fa22ddaeba55ada327c97959123e608af01f9555ebf8a555c258ec38d22a1b1388d0d4147cfe1685366ad6df69b2b11ba25cb7262971e5be300301f5a8b1d28ece99ed0f4008e1752febc6c828264dbf362068627f2de20fff367d0d4181c970a069bd7926e3a69e51f2cba0358c0a96009c96c090ad17573ae113d1f639ed7bbedb1c8e246ee5b0c05df59c4ad6d051440e8ce3db47b15cb1de48df6d2e52a4de0da951acca3bbceec307e476d1bfbd9a08f1275c4b161158337d08eec99e90e9d337c3daed6e4e76d056ad11acca398a07d3de4d849e41143ca28b7e126b6c0438c4523445adc85483695d80716a3bcbab98fa36f8bf33d3ef8917dde27e429317ad95c4e8e4e0e2de2cd2accaee4fa75f43f1e2e68ee55c7579c8e91e7ab5c079306947948847c068d83f4c161e026c6fcac0c041d444110aa7da04492e7bd1fb5b19bd916d2e78a077bd86956f5a8fac1ee835ea8d9365dc9de2b7639f0ecedf559cc7213f57f86e4d7eb90a01716b4e8f4ea84e7d079bc9462a428b32787b4a16fa099e178eb4d636c5cfe5c6f8a4ad805b87f4ab4559db8a096072aeed34707195f085f989ac43cb69c64fc27408ba783de283e4d7ce374ff238e053075cc74f59feaca66fb1c1f8f49e41ecd879cef0ad996d4793e2d919338c760a98a883165f99d7a66a9991921fa584cb24507631675bb8f3e3675db3140c5df1cec7aeb5b68ed22ac85ccc9a1d7d577cc2da6958ffddd6294666a069ccf9d9cb3a5a289a0a14f6774c8180874cae74dc28c0174ffd074c99ef80763aad49375c27d217c3a604c0ccc5e2b6857aba7e76ff1b4acc9e638dc2215bae06f6e643e8f19bb0fbbc8ed0a7fedf06b9989e17228103aa873889a3593c1252d9b3f180eede0335faca1ae651d19a338c9e234d6fc8133063ee5f120cb66b3dc6336b90a5561d67a35b70bf2937933383064eeab25aaed417bd5859ed811d776f1247b09caaccb8f3a1c505422d9ea47968d0511c5b49c8646041c7aa94d899346e67d4ad741c3b94a33760aa3b6ff04e977db90231ceab873b2f77c557d219b4e70b26694ae10c456daaf06a3466eeff4c301e952ca63e8cb3b272ddb31a845f857452d574690f9399b8bb48d71cd3fb039475c37f03271b2bc6b1938a2de7f94b646c6c6c4be36277bce1b5b2055208809e22df9ea22e00a8d786dc18ba499ca5977699f3de9ad16d39cc7f847a148104cdab375f2cde96b8cd9df153bd8de450878c1fe7fd37f55f048fc1612cc0e7b270306ae171706c0b40443a9e2a69978b5aa6dbfded12a15882bb50d97980f68352c516f2dde9227c28272534bd34c40b5e3df8379d2178f13c991bde8a5bc3123087879ab837649d363db7d481b928fad5708e05f31faf660719baacf53d2b686b1c176ff1170b663f8e83e326aade58702d178634bd66b2874984dad6629c6c2b0f858b504dea0644fd7e8e31c07faca896b36335e283e29bfd7c49ddcc3d38bdfd551448f318c82643821986df556e493a420f1b0c12978f8eccd77b78c99884f28a9e54e982456039708589c6428a153351a9ff766838d5c85ba2375175f8184fdc25b1b76b78b57c15ad9622b9ba17abf4c3a2e8a5b69e41365654f28b1b773ce1fdd15dcf36c010fa4068f1555db8243e6dcdc720fd60452ee3c67a327006326de379d934e768318e4ef28d6b33f1a44f6e505a6c6a7a0cd13f68d486ff8238d4a43d420d774438eac40f67198c4b4655e2b282e8f2d3924c6938de0c15286c117fd576b91263d615a19199ecaa3e33de4616d710527e4b0620bdc145130fec208c686f175e2210cbd5665eb3b75730141be488160c26ae16aad618980feaa6c7e4e67c2600d36683f23baefca87d131e3b7d3074127e78be381a3456f86ef6b2b451208060336aeddc7706883db1c790ebde43e82d1eb2e98be9847906b9b68eb3dd2b7c6f9371f94825d819a4f292378a495b22af1e2e5696e967ec58f1931b77fbe5443f90f13505557f1963ce6aa9d4e29eb9a43b6281015e748f46508c2e5bf2b0f85a149c84fdceffe505f6006ba7eea6ca819ad6fe748fed14363366529520b926379201f9a72734873f1bc2fe2fa404e7005d67931ceac1a93f92dc8134b20792d4831479f2361d64db00a5b0b60e57ed92f73d7cc3f60b534d94aa47769f4d39408dacc7493401f0db1e28feae64791f8e880d8afd5ca0510414d3ceebe4becba65e1de5cbe588f17bee389e7617d24ae470e0640816b91b4590c5c52d32ff6ace00e82d8f1ebddc0a840932c3e413116bf89a008c7869199edd3e38c6c9e11d3677f2a72b668db591d22b62ce81e8c82e3958a1c479abd1d5ae8d925c8af97f583b2f8c601ec80ab6335bf503f5146f362265e7ddb0e5479420fd04dde06bb3d8849bb82d953b842d3a43e9d9d5edff05b42bbea30b04d35a7f10b0238044a733c75e2282e82d1bad84a5281f0ed5544bf2166ecab3db29bf73bc7184f3cc802899f2fae1018c23f747213158e632997d76d444721e655df87349d8161c181a4f7f5ce5e4fab5b82b8a6760247b3bcf97b38a970cbda8e08c680f2fe60caeb9ab0199b438194f3f366da1771f91980bcb5e0a1f271d01c0b93cb4ef3736a3b12ffa8776872cf485df68f8ad6eaffd7e838b58c8935d41f386aacc74c8acba1019de6d05a3253acecef53572a7d09ced48a0b05d7d69a6c6c3a7b4838aa3306ae15098e2b9368f493a75802655ba99f0992c0d73328ad56458c482a620bbf2d76928aa148221019e5ccec692f64adafb9d1d60753cdade21f19e0f397e17efa4d78d9f1f0d8ae47b0568cf927449117d674c3d6941701b92f21aaa0c922f02d43ebc2e1e976689958fe175569004d1a526b38efa1dead7754821d36bfc40253c08107ae6d2b4a6aa4b5baa78b43ea4425ab0cf8c4b8c79ff8c3c855ea946dc7c489987e5ca186ae57ae0ae23e2af99c8beca81ee7e432bbb3cd95a91d9cf6137fb7bdf801277525c7715887d45d2356228951b781ebe9c341a03a063e7f1da9c123a580be8a8604be11bf73e4ed08d68106472722df6697306e89786870ad27fe4c74d0f1582c54d85a33ae778ba53b51d2d6d209e0a7979a774df496d4fe79c31b0e00146cc2e5df229102fd8176638a5f36c969b9d0f5e9fb21c2e83d9cc78e9c9a5ef5bc678c8be60ee787e0ac3dcafbb5b0b40b5ea69c2fac10e8348b7b168010d6beace99e930989c662ff8a5fa37ed58f22699f24d5cde48f42adc78b63f53ed227c76c70c11880573f960d917d2c0431930193a659f71471193e40bbf259315c22dd203b9363c6b986bdc7bb55e84c13e581e2b400fb5553fbd6d82573b30c2e89d72b72fd7ff28ca19ea45dcf1cc94fb60b80363d381dbf35cb2b61beb8eef14ab9695b1cc35e57e6d356da71323a2f436545eaea2c24a94974f22ef5f86e2bc8f9b405cff9dcc1eef67a3f883c702cd63e9d3106969d0bda3ec139e2426bc770387910b4d1ea40f9e7051cdaa9ff833d9d7de84a0dac074d12eb9ea9457f52e15c3cfdb82e4aabc31401c6e6551d955e692170eccc8df41b79896973ec77705fc0bdcde319bccb24625e84fdd1082800c0b53ca62d74b9f10c32655d7f66f49033965c82220bcfdcbb3c0cf488cc099f08b518d0b926a966d549fb7094a818e0f57441192fd03ac5cfe3c524d73aa14b838902e7364c93ca1b55d2664557e31983b3d25f8ae77432004760bfa3b4175917a4ad052b99e3682038cba443640c648df096bb058a1017e145457f25ee4d267c8181b8b98eb1aa56dea000ac6bd30c5d384186de6e5db19838677b1775e8b59199e2b24700f12b5d62b48dfa4c05665e4e16f78b0d027c2015b7b34a3a68e7e2f08efc2ae9bac09fc3933046a689f14fd938a2e5c19910e1e1043c17dcc654377c30e5efb441baa48e11f6d20669b7e60e703f54a9de1d3942417cb792c12df43e364d9b5bfb25791d59db5cd9f2f3f267137f5ecca0980312df227313b51a25655defac04e9cea7700601b04b55e583abf0239941ce681a904f4d6855baee2602b1f02c4c936d51b3bfe197b463c70b21e7dad297f778bfc8d030120efbe17ac461525160b8b8c33e40c577953de60db0b402d960de71f29c0bc45bf74af4e23aebfd07d03f8676d67a12ffbdb027a6723b282eacec6c6b8871acb42dd9fbe7490dc9a31317b0f04a2fe9d5962430cfc6404ec1276e2256f983b8db0789bbc3ae39699abe086aa29096afdd6a68ae465dc24d057cdcc1ab5aae7cca18004fe2962ad9073f847c28a2daf472e7153c78e627c29045f2efa72f34d5eb83d070639ed44127469831a2a2145732b989133f817cd3269a2136232d7fd20a2faca80fc5c0f0c3af0377d1d11f866d1d3f8d963fa1aa7bf4537379f0aa149c57cfee54792720f1836e9729faecded1ba57204831efb76957f24c41053fa02c26bfa42790e57d7ecc43a74b010b6cfab76b025dd5942c1d4f954c5d6ab0c777e044efc9ecc945a72180d83261cff719c184815ad79638a83c400e709ef70cdd716723cdca9a3bd3003629d6c0ba8f62ecb5988be6201670c8b4d86a63e13684b750258399793d394ac5eb3efc48bf7a36c3141f9b1ad99af8e4f230f7b89d30baf745e7b55d96f21d54a2e220aa625ec4695dbb18cdb50c70b63fa6abd43808440def952f541ec1d923999bd2b11d42f61a8a5a0f12b0e7ec51857750dc15d4869008f5eede4acdf4822e6cc60e2dec3f4ef57f4aee875088563ba404fe9a681a3b1e2fd2a239d10d3c27ad1acdcfacfee53ce0d3d882ee0c14fd1a8ad2f375bcdf96e7db7155fd45b5d7f0820b5e431c98e72d7bee78329f912352bd81f5c27f5abcc4589acac2b5e1e4dac0f156b90964afbc1a7932af7fa01e9f0831d1eda0ff91eb261885e7831bea4bd80e7ed950d2a7e888a67288739a211c4d6876978b2e18f082c733ac99cf76c9138db8fe9de07d7b44311965889ff59151e748ae0bcaa032139cb7214b9e40f849a9737fbb1cd774dfadc257cc6ae42cb018080b30eca9bba4a9339d96d251f87bf46ad0b51feeae19c5e85701a833370f73c3e595aa50b41ebcd5d8699054b5741ef0dff4d25f819c95bc5747cc2b76c1f4d7f2482cfb498d00e75fdf1f0489040196998d195f7e684a41598c6f3aa83e68cee1b7d6dcb16d9513296dc643b3093027eb4fbd2948faec3bf08fe0363e9246706860d0fa6bc5f31edc3ebb5311fbb3b00870b59ae015e6ec3e90cbaeb7bf2fbb275b4f8c3af12ae72e6b42e8d4962516c5fdd39f5cc197631e8e0c2deb708c204537d15c877a6baf70f64ea675682cafb50757ba584c166b214c488162aba3b8d3af8abbfded1aebf19ed8b91f2ae6dcf43819e1e763afe8a05a7d08ee6e49ccefd43512f3f06972091a6e3cca78500da6f201eac18e519c6da28983135f9e1287f311af390de2694b92358282db28234349f20be8ca31484046e86f9dacf6c4409ef8fb4d8a2ab0ee4c90aaf18f4281910ae24fdc679035b6b29093c8f6d6aee3fdffb065fcec4afb800249beb911c121d58881a7f282dbed45e27bb3fbfc7e86fc659c3517a325220562450a50412bc0288ef59d5afdc3ce2a0567da766b391c20612cf8c7cf31c8e60f42eb63e7db3ef3b196a2dd5148ae5ec56f314b19e9d567ae3f25e26e46e990682a4bff740f7f1442035bf24ab96ad3d501fcef429684bda6bde3611a6f8b711ebfacf3de609a2873a7e04dc7dbb54a080e374e86ea13ce249afa7f7fb6b59916e8431c457641ebee9e5a255d148def0e66fa284427e230f569a0520dbefa98ef60d25a1c2be57538b7d27466905d41a3363da8d1a58cb306cbe123b2263d8c6643da1709672d9b7fc93e65825f54b2bbde53ff86abd638c29b3133fc151bc9ba7b81bbb83da2def552d07683e72b778a6fb3719b26323c1e184cbaa639296f69e17ca9f4a994f478c476df677b1e9173fe7ec8e24429df10efe99c6c17fdcfb29abeda76eafa0fdcc54b9685f7a08a4b3383ff8033ac077b8e4e1f5d3b6b1b89b979d4aea5355213fec6fe6af1a4054479a0e5c1fc7470efd9eccd7ade8554729ac1cee0ce25f7041a9db81bf565579b97a3d1b3ed4d966a7e5ed9de2d326fc2fd7d38a41b4a7e1fd12674f823ac989d7fcd6bae4db252b54384b308f0d7160abc9ae40f0c9fdc2c13ab7cb57a6a750dc76e4db22b7f79e4634c95dfc23e233de275ba85c00490c278fcd8bf675a95b452e208162695fc1e3f40385b202156f2a8f127cd76d33948fcdfd766bb0470153dc5defdc545bbb52ab981b592608c45514eb8088b52c19d497f66ab40d9a159a0a15ed894e7c1a708042161fed856573b400dfd7ba0d0591b4c438834d57cd015a5cfe404997301262f1dc3a21658b40a0a2caa6b3f4abcb3899f2f99ee3557625e05e2f0b4d2610ca599188155a8d2c4563ca711821ba88eb6144981e788bbb36d5f68981d260da7c4e4868cc0f823cf1205daaf2956594011eb7b10812d024b021f20ee09bf78f2ea286fdf769156b87afff4896d161a60d3206cf7e34a2bb04a498e747c5674918cbfd88370330d3df6422af2448ec27fe690f5d91bac1b9de5a15bb926c91303d2614f86ac42739c06ca8124f7c07ac088f831984ba412abdc08cf8a66247ea6f60a2be94def55063bf1c4e77549e6ff12e140931b88d6bcdf7ecb6e9d9d0632b0f01d1f785832ca01ff4d82f1bd8c7909837a209fe7a26b6c7e44f11e281ff0e971bd25c6356a2e50a21d942b8e395ee48c1ea724b81d5479beb0c5bc780716a2e53bccf0df7c860eb372eef93df33efe5efded510f38866ba5cfeaa2bd95a89913b15ee36b5d81eb9603b9b2806194ceea60983e32edd824d55383d9d92631158ee81442385f1cbe9c3f9395639a28fde810c7fed3635afa4e46f2f272833206fb493ae95bd8826e61c1bb7577f377b3544509a0e21a13b4beb2e84f862521e620ea5cc952b0cb76e9834ea706950162d13b11d44e5b099d5b28c5e20a615d45a845268a1efc14584e34c01f7fba1a5772aee7754c7adbf80d2a1ab9838d72e6cc61f97e903794863ea93c8aa9ec6d1a35550ce2bf88f64474818011188ace677e80cac1fd1514ea580a754a4e81c68ff4ef8671aadcf733ed74abf501d8e7a919b5c329b7ee0d7380b9d239c0d866cc3db446a583cf80da9a7922e5f753c872e0871d3ec7c72fe6393f23ba0aa2c1cb2b7976dbc1a518c9c806a17bb31b5b7e927db744583cad49e7e07c1129de048e5d0b9531152b3b1b83b52bedc1998be44b8a3d8f07d33d98b0d0ea3348e2e34f4793b1fb5f0130eb4d36cc4c18660b61b0447316f60af415ee45a69e4f7dda7f8f145c69115eccb5c23d590daa36ee6565a0eaae4c3e0c95024cd91a6662cf90c2aac3f3864366e88e481cf765f5085c9de38b859536ca898873e317fd7bb5a0c167ce78122478ffaa86f2595d621d9ad1c840c5b0bfc6927f2580760e506fd6eb8848a74fa58aec558f5d4971dda22b0a7d8304896de7e1adf7dff5b9d2e8776bf24f1917fe7f91ff871e183aa18b9a8525389af6455ba97a0d4fa8ad0e8a488bd98bfa3fda545db763578d295591d0ff9299c208d9825980fecb96690e1b063585405e94cfa07c04dc15dc31b99839cd106ce7ad67215df7c825ec5f6f0da6aed3f905e2c4d98bd1168da49b9d1cbdca7c325bb92c6b4ffded88d8eb1d6a1da8ed6acc4a5ac4eb87bae66d9e61cf04ee788f473f6e1e5c2dc5fddb84c2b197885018639cb16f835c39fb734c43c1621ee194612bd9aa67d681beac8def0d505b6355ad681a0b1f09b80a25febef5e4e96eefaf460ebc83d68167ac5f7a88e1cd71a4d45284440e703338f0c7cc860fca76417486ffe2a23fdd52672c8f22c4f631159e2fe9ef86c2a642e70617cc9f18f4cbe2ceb46689601b54d4bebba34e63224b629b3ce1e6e7e3b883a16129333a8a47189a25f06135bf4217f71cb542d1572286efffc8e65752b70f1c89f8dd671062455c25fd278148e207e64118f141d341dab4716efd5d02b6904f2045969ae8d6ede67ecad33073dc95fb62a9ca65628f8d41c428d44dec836c8281112d9d04a9c895eabfeb2f4b820bf20d14c552bd21f80f9d92bd5478975c5e7aa2f79e83020ee1e234b4d0f5b5a31a215ac793f6e5b761b1e085c708544b7e7c7833e89a178792dcf9ee2eb2d86755dc538a6fc79764a289966f748dc9b39185db8321164b325525d43205870e5c77b216ce44e46acca41bbbe02ff5e2294511eb9c1bf3bf9fcccd70a34a7b3bc6818425d2a5f7559051e0460e6b761cfd373e751e7793e8236321f72a1963cac7630e0d68671ba05e4dbaa96ceca22274581f7b6d72b4bbba826ba5268e48d86d04e44c804cd765803e67f0a9ec924d65f2997a6116815bcba317b2c698b3124eda699f8f78a04a23786a714a27ce76d2d7ab654ed3ff4fbfcfd0200f5c9ec567603de36d097e06a2b6a5f529c80b1b01c7bb200899d99352d49eaade24c4139781909a9d329d3bbec137877e0da6ab7af19a934f28272ddb0b5c94eef95fbb4992476f2e967160c06fa5de8e2942a75aa2e6baa96e220b8f80757c9a42c772a940c6f5c525b66b196c490a5e29109e01c34900d447c948d82e3d5869d6ce5836d06530646e144e138ddd2683924342f4e8b685779578abf265d773ba532e5d0c0e1827287a9a7e61fcafcdd31df36f630e0eeaf8179f4081763a6f4a2be23736d06077ebbd3c66cd3d1f15d397643b4ec2e70ec0834a2572c4889bf001a1296bdd60e8ed790a4579f1f083602159015501c20321cf2acb75525423b30a50ae8fd173cc30845571dd8cfcfa33e1be8f7294cbb677abc905b691e06c4b5f3246b41f504a09d909fba40a6f7e058af44819c6f6b31ae981a7e90cecda91976f98fabfba85bcaf2d69b23d65fb6b6107c10e26992202483b0b155c047d659662528fc48450c13008bc9e252e99a945a16a2730a2649b3b5b954d23c6c1943fabe89656d8354bc4f5a53864432f173afc3488e7da30fe1961a337fd9c10dfab2796b002c4bd2a61917fb3037cb92ce9681e0f311af6852d03d70e09024e049d99a69f5897e2978ecc1569814e8395e1bd062ce9b99d593921e5b21db6aa011a3d4b03f295003dab86039670512c15481acdeb1536176f5bbc82e13fad432ad667ac1e53a3315ac8171aaec350f82e7599087b7952ab5aa30f88b7b43d531731a589b85416c697029ff0f97c20099024d386006444b76a8d31803428471a6c788b86d647c6c7136a4204fbc411156a9cc73ed9bbc39c195165af114775bdb8db8d3e535aa1780b0ee84bbf5fc16d090b0d1a168f5f8c230e0eb04c331a63c0c6d694f3de5f9c37d4c3e67509b0781b96f17d5407f96283d1a1f499befc502cd822f958708910b02b44d062fe1f9038f5e9530b93d259ea6bd756386a7dc77292d6397343121557f6d7145eefffb6684bd5d6738782f46acff939847d1196b150f6ab6de63bc0ffb2ddd665a183fa623f57110c3e26769ee62f2bc35af712fa260abdd1c7d506a34923c07d5a351f3863b9349ca0ce7c9a3f5c0fab19ec7a9649b4b55d1e139a8246a8c8b4df","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"09b4b540f4a77cb9a02dfa732bd89a14ea75709ccd3920df0e58713ce2f0f781059219f3cfe3045985f212598ed7b0bffd38e57a2bc4ed7bc790b519ef033ab01031712cfe33652d6bf08e19ac405891a5678e3641c078aadf25cb3f58e993d77f576a2c34bb2444b7f234f5b0206fe008894c6c6ac9a4305a6f7c3c69f143ecd06035c1249270b182a4ce0e0de19acd732bd8c27016477168f25b26d7b0647ec538123a47737ce2d5605d1999cc39644ff2c4e15ef0d7a7ce49183d5f265844fc6f4483001904218a110a0e3bbf06fc9a99a35e3ec7b621e6c08d1f387673083ce656630fdd52605cc10bb869ced0becc0ea9e95085822b5e9c3a0dcb37a79ba991385a96060ac8c12731f4e372110b2e40c46c41ce7e87153135c108a2b5e3159ee9b5214d26d76c653bc244368645453a4119cbc6af4fdddd89b285af6abae6be12dfff37c7fe1336c221b33a28cab9b2896d94c43e0e48929ab18882f90d16d99e4fd2abd51a65dbc707e441f508c79794f2719d2259d68fb3d63f2e5d304e6fdecf74a186a4023c32bf7f3994380e71833ccc505cbe3e975cb4144755a61d7fa9aa726a8b787be2c430115e42a7e3cfb9fbdb52168e4fb9baffdd07c94168ca00ec6d357a528a1eb268464d7affbb79409e71feb12dd574633fd128d1f8ad0f354967c3d7f38631aa6d8e32e0a153f5b2d4a977786990391018cbbfc2c2a9de295052895d82bd849e78069646be0b5ee5a9cbc30db11cf7ddd9d562c5cff3d14c0f7e97c8d98caec64784d6b7f1286fcb076a0e67ae19852ff8853b7dd01ebdd0a81454eccd7e3ee2e7b1476239b995bb834d8c94f7ad2d9e886399697115c180212972f5952905f957ea1a6bcc69cd65e6f9cb878caf2a9501e274022ebe9540c6b8ed765b7050bc52d2010abdd251b9af54eaa435c5ab0852a4f5d39030778ea98b39d5dac148910f20dc34e1753a2fb6e36bb3083b45850bf38eca5c3af93e15b4e7fbfc8f346aaf6dae9ab0d095beffa76b4b1b775f4936d38e7fae3f185384111a32c4f056aec2a6e4270e6fc874b6eacdc9d7052fc54a2758ea368e8077ff178b67dd240b73320163902dd7699faecbdac32ee1ab274f314a0f4d361dc1080b819cb1499e6719e569b990d9c0c5a35b4b7e21484117a7617209f1d3ea7fda550287fd9ee60bd4b6bd52f963edeba0141019daf34d2c8b006932cd54c9d5ac45ce76ec7bd3a4c407c3d801290198fd5fba8136a6b4c4c12762e826b609310831d02e309462e4e88551aea4d467b31f623c5e70a74e341cbed17cd08156c9aeb05fa4e57323d9e264311ebf84bc0c79808a2092a1fdfa9213dbb8fedf9220700a68e363287b334bbfeca1a47ce0ea51fb770fd1db62f9021aaa7dd9e452daac2695daf88d24f852e0d5cfcb5cb1d40af3930fb7729e6bf87cdf69ce93ce72bb3d8266aac61a159e7704171163338983db2aaad11743f55af954a23f8fc2c02067ba0613b333522fcb0f12307748532d2b905e78efc9745ebccaa48a3b5910728b504352e933cc71e6720c40aa65c787463b9f84110d5fdc8fdada0945814e7194cd14717ea6676d01b113120c30890dcb4806c0d493c5c6d2ca4ea6a4ace9e72987d4784cf3990a91c907e32d654123be1a0627e05ad0e1cc3e3406b3fb16a02fc33f2be33c7dad71446750b278058656c0892092c1f78cb78c3e12313d845a737086175c7b0f458bbb540882576aa039cc1c50922dcf99b361effe07251fb9776a5896a7f466607d47def9cf988a5bff4b9c4dafd38b84812ac2f157b1fcbe2f1e82faa676d30ab65dad0f07de54e6cfc17d209efc218261b053d77051f5de624e7351fae44e2cc3187e2f4df80a65538b6d3cf614f697dcd01001b0a054dc60ffc3fff06e09a43153e91e6ff05c375340bf73006ff223840f5f4a4b18751c252961d7871b36e662f357aeb19fdc46f9d7be2914ccfda88f5ac64b75290179139cf514dba7d96caeb3e08ec2d702a42b40793dfe308dc2a9907e6635f9d976d908c6a418c2e3512ccfba962f5767b9a66e6d1414055542526988b37ccf31d0b1bb3c6927fb17603b3b20db0163198e06d5b7d0a54e7265fad06980dba9b120166820d778301e3d21204e52fdd346966c69971b30d111a2f811271c05eecc551cb3eb22e4ea2dbe17861fb2c0dc4ce6e371f9a401bebe1461d9beeff0691d2be528b5b239edd742a4b97b67bed3a6649e811f6dc85da123ab177aa668a83d679f860dfe99769800f6c2b7bd9e26419e978c427bb5c312f657823dab661d1ffae2e8c224420fe3f5e249d611ed91799e87e301dbf2736ae505494f0f505ea3530a920954486f5eda858275b54ad2469ffecac009e6223f6556ed7b05fa88a19674993a3f18e5c2ac6fdb92a5534440f0c8c1f3accc63f3ebb28a71a52d731ab3262fc0acd2427248d47f700b0d61c723448eac244966ff3e8512738b7f5f4fcb856f71ea1856e208427298f900b51eaeb8dde8ceac560604621f7fc1f71048ebb5104cde6e3a1369ca3e107d7d60ff9908f15561a439617da8757e8b06c1519401857f8d5352ace84d469babdd123840301e021ef44bf192ad0a8e7eda9519f58bea14e26a43900dac6a1ac9b01f30e336416ec96fdbf61cb49ac212a70e270811db7146cbd796d0ab57e6cb82867c8d81f873dc59c3a428da92458b79a806f618e5d611eb44a0f20a0897662e3438268e245829d875dc48805c54b3d4b000b22c1337e2403639e4be58d2cea8220d7f57882fd1874c297c87f26dab8670deb8139e7f2e7acb542820e033f9b917b59b2c4ef056d27a142d52a7e79bcbfc096d5e216c2570a46797939c17b9f9ce74d892d1580bbd7fac0ba9b9c779c1ffa7df741684c3e8b654d87914e7fb1c6b51995a9a4784b33509c5d0cf9092f34785294ba9f297737b9dc52e43ad8e42854abbb6f9f41c09a2a9a9155af8667141875a29fbaf765e8a687e7dce1b0b9c2e7d56ebf36d44c1f2cb15ffa1f1555d2352bbfee2aa78cb6bc3ef36f4a210a08fd3110d0be8bee166bb02933c8be5c2e97ca372f91c128538241874420511a23b8ce1748064db702e4a0767809a46e12302672c2db3a52fee933da792576e538ee01f48e9298b548b4181ad64eeb7b39de23dbb912f98e6b960a099dea5a837a7d6d4899f3408260c0e30eb76310aaa88ed873e0464ce17ac0882096a811898ef2a26b9d783928c0704893bacd733a2bf90a8f74737dbc187cf525c395bc4c3d39216f5a33a10d2dcb57d7cc3dc383b8905ffa25d47d697e62f2844c571b516f12e94e1ecad8ffe4b71c9df4e4eef5c6bdd3df69c4d79c6d824d58598f6e2cd2f9d0f2f0b703df06d1c4223561be4191fcd3cefde82d45ea04cf5f215ef0770d20449fe0e1e230071213a8222cc50dcdcb87fbcc742795ff089b79b6db55559282d89e5a30ecce63f6327b0b484fc8d41b94da6db596559c7e03ee4c19fbda8551e4cd4548335fe2aa62596fbbc5b570b0d1ac508e6b147beed34e17cf91748bc608927fcbce0de7668132fd6773f555071110d514ff068c343039aa5d5387a82e40aa720de869dd32b85d0d4ae52a61ff999a96b30334f12984a21633b1d42fc4636b49db95b1e4dc071752783ea3b8c6768cc040b5659bbc0334d7efcf52cc57694f40070a4ab0dedee5a5e7612fe6631aac2fd6a773740f9c01c66eb8883fa225b0c24309062541c71e26fbf5e3b2ebfaa38a96be9027f981a24e031e1f6edfe9a84902d6a766692436e56725d4d39e5000e52002e779604e4230008fd2c3a58514393fa8a2aa04206708e9c41dc262eb722c12df1ae84a54664025444c43ac54a0774ae67fed8f712fd03c97cac850e4b8384fcb3dac31fe06e92820ec5855d8e7cf3523994dc6af9ee376027f86ac28aafa282ecbc2e90519e594e32b83a6e644917a7dcfb6dbc9e93de7e33a8d14ad0f22019c32b63fc088fa115587c0f2d3b0ec582b8381c9ab32bc326cf8849f9d30294baec08e83a3ea797bd8a1f6f6c3c62ef48a596c5fe98c13b8abc39c0cd61a3a7149a5cf3337cac1c39926b434d66aa20fe66ca0942d94ba576709d60cd61c5e74be852a0bba4c24c8210769df0fbd60ea864608b732286b90dd3ade335de4b45c66d8fd55e2460c40739c7bffa1419c52388b3f1a4e6ce8f5a57fb27c1f37b866ff24a8dbe96179ebf3349c0d39ef3ce6ede72c13d5308e348580db6605131c9d7fa09543857ecce840dda66d5f881f5de9df2c1b0f9de2d995d11095fdcf3d5c8925585e9ebda5ad8a7b94825abdd9fc328d9b969bcb3ed6115bc258ea22aa1b7f373a355ee1979b8029774fb39a1504a5d0a5bb56270a1ed641f6083b6e052fa5ae30a322027c4948f6177cbc02d9a1ab32c74fcbef38f5b6291ec25b1a1ff5b4876e1124a43abf102186882bbb77040d9adfdcad7fee84609f4087054b76e5fa7fed49490af14e48ca644b47833c2a7b22e06aa718b0c7709c77254e9fd881b63e42e2efebb17835994f17a4cc7210df499a90fe9ca702b6681d5f0df6dc3cf6eba27ad71543ef8550f294e856e1c1d5c4f1d1fc387438f56094dabc6564932b67ac2c2cd7f8e3b29e293c89583bf5a0573e6f14629675d82086e2849acfa9b74f291f6a8b902f16c12b0a10e549814cb08fae00f24fb4f1ec1495ae5a1d332c2d0508840d112026b429f5bdc718b1f61372389a9efacd56b752189d9bd95d11228b451ea6b66d796baefd9adf20accda7ce8aabc3efafad7414f1807de3ae0b69952d2b6109ada515b87493dc7e38ced3c4348d7f57d87c40b85318f863f47423e1c2468f12c44e08c0ff56b5ff65841d7195aaf1cccf189efb045ea2125ff070d477afb531d488ba88e04286e9df9f082631e92762cd3a1d7b95fd659ee55229adde9d1c77f6418eebf2241e3825a320feeb9edd83c5297bcacf26af544787c62ee13ad320830ab88b14c6fef4c85fbbc5c1a8d530486bbf6ff4e8e8e0d39dba3115812a1390e6379ceab1e5600b417d4044efe67bc2e02a0396b381be640a4e8708b517ef42a32e0139ad0b53e63fd7a19082a72851e845ba0e2d5b03da6bb3ea46fc495aeae14a58bb5dcd22c994a0efc4f409abde2f3de5957095237f06e7acc93394df003e952a1fbdd85894685bcfbc5a7ea2900708e6da840ea9ef96b14ef7c5caaf78f684b4e07a2a7b6065fbfa18f84dad12abf8dc70fb0451648028640289c8d311ec4ad48861cfe691649ab8dbaf082c17ca3474e2629364ff7c1263824fbfb0ecd0ede3a5a38a5b9e143dbd216b7d13b39db2b4199b4d44c1a6b1a32177a52d45b379e89cf2387b4136ee09950ba03e6d26b90b290c71193c34494894bdd3a1e007b2d20be6965609d573687bdb0bfabc73740683321f8cee72fda0c4f3621656116c932dc6d6520b2907d7ed34b8d08345dceff04cc4081e48026c9c4e2e0339f1be47252c4f81f31bad288b1e3fdb4da516856ca10450d268a12707facc23ade96541214d73451cb1c1800f83e3f7094b343423fc905867fea429af5f74fcb9623f71bbefa3a9c1459336a684b45eee1208b3e24a789b610e8160180df68b287041d622576889d56412fbf075724b619feec462edda77eb58b4b0c41d525944e55327bc2b42a7ba91f4bf5be35399d7b957b095418bdd42823dc9a5cef6b46ec4e4d16945ac062a73fcd25a313daf3db30309c67bb3a440efe03d677ccbebab7c88eaa8ae55da38ccc2baefd9a49d0fe2e7fe5a7ebf951095e60425155a52bf432d627e4f937010a29e6e99cb1a76cfedac6c423562fcf3e96c5abf6435666ddea20c7bf8e08a38240161bdc89fbc0c7254d9a3fc75aa01443b8ee787405bd2bdea40655e749a7e253e2332fa8909ed33aaa092654798e5f1e7b7b1c2fd06c562ffbab255f9af9bafbf47021b303f52fb320116a2c50865c47f1a62a04ff0469300d3f77117c0c401a931a05db77c88430873e55cf79cd2627ee8f7d643d0072150c41448d9abc2c2636786969707114a56292bc1a508261926f3cd85c0b211d054db3fbdfd60d374de93a5411947f7a4fe196937d426692ef7c31705131e930f1a7e6269d8fd22283fc84918422ebefb95713bcda7a80c1fcaa858f61a17752d84ad28eb94a5bd8f4e4a917dce6122285ddad1cbfcc193ce5a2ff1600e494cb8282c3af062b019672a040567a86599f8cbd10310e7ffc420ec53dcdaebe5cd9b56e38fae6c58f965edd084c76135fc878b62b40975294a9cfbd911b633cfb7beea1c72c493d98b2955b3ffd4ae18c53d10fa10dcf2279a674117c0eaefb65651133af0288374619a81b0a0099c8a5855570753373b14631dbd1ac96a8a561b548d24e9387145aa2c9aa62c629000161af0e1562d4db8557cb455e64c41f2359bdbebd2c04101806cb3e871d072ac2519707f7baf35630c06ba1a694be173225704ff6bd8258ec801520b91bd61c23b29e26de15ee1fcd25e7b91cad2da026f680744c3e79bab52f58443bdd07ceb275e0a64b07e027117b1ed02b4cd3f4d11c0f79ce361c753391807bf1eb0f7f2af2abe60f5852d07251b634105a66a5f667e44628ff993f331ba7685bc1d222a2a848cbd0af0b79e50bc256d4f749d56ed83643bcf2eb51fd9c06d5ce4f811c0e454dafb662f41839594433e0f31185f31f1ae5d0b277c3955f59f970de9369081a8ab0c70acf5660bc991cd31e21447ddd5f57ab4fca74eb98de83e98d97699a73c7e022a26b2cae863b3a48b94ed00cc994a1bbe97a1d170a9b5cdc7ac68447e09f1a0364c746c70443bb3d3aa5c427e223fb7c501805f1213f266894f1de29f498ced0dfa23eb39816fa5dbe757293908a46185ffc2db9395a01686ec0befae6c4bda75411a9e67e92df4ee1873a8878bf15ff913e87565eceb10cb666e8c6c7df1bab7acdda892729bf0826b4f5d1d510c0695c94121eecaf42d6c2200cdf86c0d66a6bdfa15cfd64358b1e93b306b4a74fa26c3c1abdd422e8846ad0ea0e84833df900e70b7cb911d376a42ada9e91c617ab53b8cf92fb89365e855d4eae59ed0bfce9d5ea093ec357949ee9a6b77035e7c871d689830569af1e19107a9303c5150c73a7956f19c9806c0288534f0ebe9b1d2cab5a46e655ab8e7aac5a11fd076d217ab47a3078c2e5746e1ba8559f44caec24921fbf7ce09efbfba0c02e9d56d20e655951e9698389d3f081ad2be3f184521297fd8c08b663afc25deba7c76d1577a6c65bb33ccccb8b98b07ddf171fd806355dd5a12252abf7d1bb266f9f40ffa44cb98de4e016639c7a5e20191be8349caaeffe1da37092a6a2131d2778de5ec08b74ec27f6eaa35f89314226337043aa2fa19e8b07143638a90f5ac6afe97733c21c325933375845cafc59ee750448aeefe44bdae93435bcb64652c340d638476ca151e04b09d0b14bf896a432412c7221f8693ca7bf469d32e1aa701ce1eef252abeb78917a7737d66af65deddbdf939bb109ca36c81c253dd0df82b1c8157d1855968f264de9c3b25b14ba57ffd06a9617144f24a107ffa0dae9068a9c55fd386558210218dea178c1016dd41c599b1ed52c657fef239c6817a7e4987381fbaac134bcb2d24057e35fdcd1bce7fe56e640d210a347bc85ae520052bf2267430904f27d2a9e5afe262acce4548d81a7c57e04b949c7c1be5833d1c6fee909290a9e5922c29125434179797846c3808b2be24ea44529555eac28cc9be5c8ac786f228aaf61488d153710d7c5661dcdce4004edb867bd4dd9f857bba3584b282da6cd800724687046d18b8abaf953169a1d22890935e5cbc4813367b602357ba7945f5a2688a20473cc0dc957d2382b5ccab983f107a316a78479d0d6c8d20a5d086188251e646b58be6fa02d2bdfc9734a50938825e24a474c639d7af3f98cc4521f8dbc39bc7146ae44014c14463665f59735281da808d0971356f3ca93c07a59916f95bcb5b6cdd9ff6fcbe956820f88aa16e57fbdb8f1c59c5f8a58182918b41c0844ce4b56c65ddb58ab816f5e5d476a218178fab22daf53a8f26607eb001def4107dc8297fd858775f97bc884c8848c19cc3938f8bb2af3132279178f98bdf04085849d4748e9dd58ac7fc7e6d2747f9216a800628a2997b111610f675be1673eb4df88d4f2716123d3103a3652666e43404c26ea5fdc0bc9e444c9b919dcea14256dd5a466a3968f95a51c42eec5886e022061e8d3a6f6c372148db9b1ad471cf391de9c91e6d92c3e4882dfe69e8b75b76c68b0de5f47de37493326e3be01dd8f22d4b6752df34560f3cc3470251e98f6655893a10a2532e3ac750826a59d317f7e42ac1043fa5b3850bd899b94369a9a4a1976ce767948963e347671ef11babb14a5b85534465bbeca15f9841b31262bc451d4c7fc6b4732a2ce9674c52367941fe5559d3dc1f5cb3278fbc2520b586a3d277dd9172ef3604e544d08a7a2802ba30d8b218f0838f14157e51e1f14224a6f1d15381ca03db4322a34afc9087e7d86e9dbe921a71527f00c3c6816c131420a60909fbe1d26520e434979a9e70e4a897bcee1392e1f6d60ed2b21a1d5e9b0c9ee10c58c8fdb3017bc405a4160befbf3aa1a2c2da6fd8d1128aab9f4102bda94e9b395b5888c14021e5d249589293a3363399978f76a3490e74eaf8767e4ab98de5846ebee9ef863ced0545c78241cfb89bb9befbb21ac6f87a509a688db08a899112221add24867e1d1ed02a6c2a15cacd30489ef67e8b2e034860532817721c0c8fded96b276111f93a32802614ac8e04e4a95ceb6ae6c514869cb0affbcd631033355ab77b877d649c234890fae933c6aa290ca67ba06b18eee580485af272036946ce2fe46cefe86f0e3588b74bc778ca432d3dba07bcef81349ce5911dd1274a217e64a53fd081b320fad9fdbdd8799e80bf6189a9c18c09d9bd9bebd0c0a387a860e8f5d654f111d647f183658c5c89398aeaeae14cb21300073513e8068cf06fe6726e0ff20a5812f8cff42bf4303a43928cd8331d1f5f1cb974eac66121a419b6d6669e7a9aefb21b05695b0d61f7eaf30a0037034d3bec74e23c7242e6aa05cdf2b179b377d1f9d32db25764bcb7c29a0cce4cfce20298ae32244a2813fb4bb55e0a4977b035bcce1d7e0b1f30f06a5c7594fda5f0382b31a2381759f42e2f8f9c45a2b90c851d56fa7cfc644da9503019598ec7800b2907d25f32daef47c4e9634d08b9c08ce1835423ec5c454f68d98a602cf8c19b8fecaa72422d195f57205fc8b995dd3bdedf25e7a63b571c505ce7aa604d9b96a7630f9185ecb6562b33e206006488b9e21c814588aa31564b4811259636fd2c6683d158b215ab3bce5c721bad76ae4e0fab94b79c2c59fa2280e24c84642406407efe521c1075007e8dbfd9fe94549b568c935be5b3bb956e63fca0ad3b0272a44f18d76968ec6103f57b3463815d3436b024d61292cf50878f02db747dfdeece283616fe0904b5b576d66c40b78a2a95d80665acdba4187f4346dae636e8a023e25c1efe8d92b5bbb1d5fd8051d0dd397a71d284ee868ce284eadd375419388480cf60dc51afb96bfbabc8d3d8aa69606527eb40c0ff06a872e54c3abd50e6c0022d7393525ddea8b8a739765848f12509fa1675375404708bda1a69edb2bf7e3326ac37b3ad4602f2e8b786a068a9ea3553575683329ae323cb5a54eedfe003d019b21a77db4f4dfa98a73b38427e47d038cefdb8f630b10f0be93fa9b08e7b3568875622085c4955ff2078f4767856927064f14530f29d4e5c8df6f8a0423de4b36412f742f892a7746d465c5a44a783a0e741ba349e7b237932aabf8d7ea9b14b56b1d9a70f8742994189cc152ffcd6dafdaaad7f6786356481cae5a6bd3a2270fa74a6e682f9195ea736b5393f2f6c015467dd9d234fcf77a6be0cfd30a431c5745ff38b72356df84cd6655d0be0529623fc6755f53736df3a83ab7dbdc5869924ce4f496b4936e7b392cd2cfcb8e1c7f614b26a35d488972163d67aaea35c99bb5fb1df2a7dac97619d6920673f07b9a2454d293d9107932aaad4c85c3533f0c202dc1c4cdd3001678e6c0d5cd5b35e9f868304cc481613a3de4c176161e0743670fe7cd9432f6dc94e09b23b970980e70c2b39b6ab9b205a2ea3c3d34e47bb09e274fe4248d4dd1b9b5b589076859e19203e30dac66b50d6161f572616a91c81bd696a7c977fc86b445a75a23ea26dd69edf7a351cbbadf7aeade93ffe9350e5fc48c922f38fba6dcc28f191c3d15bb73253beb9dea89d4d4ee6beeb016d459525c6916a4fb162c07e792c5f94f0935553cd7593f743bab27a3a80a33dfe83a9aa405b259f823fb83d4b1dfea6f084a650846607c637ac9a22c1092ded35da6eb2dcf4778d9723bdf8dfe03e32e509c55bddcaa9abda5e751e0044d571a6110f7895cfb3f9c703676588aa579f8f4af5d2497e3c15888b941f9a882b22184e44cd12fc6de48461922573e2816c9e089432e90401e0b951f868f2e8232269f9dedcbb7f66fa0551c46c5c2a501f47f1a6d8fac522470e01cd07566d1a68a127cad4620e0517e0b3f507b0a35221cf72156ed5fe4da99b85d3dd7140516e9aa23e32b713b843e606929be4c86a9c2105074f15c50bf2577263c04ef7638b0aeb8276bd5932ac66c8a7b95fabde5536be3d771e7249caf1bf28208cf830f839a1d60e1689da401444f088ec6a44205ff2a227fa188c2d9771a8b69e8f41bbf4fa4b6bef2e9897fd10aa2000adb57cd6579dd97ab3a8da9be39806a5a8d368329b6d4095f43a41da3ea32cc098fc1787e01e479c6750e34a19a1fe9f51326541e3bb3c18cba94a5b53d78376475c8dd27d5afee88d386fa3ff0050868c737bfcc66c421eaf6114d83d4b7b69377a214960c6dc6c93e094723517d2baaea0a56ded12b72f260a2dc311c8d9a1dfaf90723ce72636ad2f08734a9ca936fd14500b8277c4ba3433f8a9db674be3e37805f1589d713947998758709168f8e523ecaf46a3b2985991d3ed6218e5fd83b1d782b699659d977c53958f1387bb3b598aab7ad053aef5fd2ca400e55bda25cee55d57b9e15124553e6d481ce82f52aa4b0357edbe80466ccbd88931e16b92c80fda0815fdbeaceeb9c7b1cdbc5842db874fae5e627de56fdc676732d5d666b7d5c05eba90e52a6747f1c6cdc196b3b8f07c950eed20d708bb2583d15e9a825df579c5be1a07742134c547c6d2eb5664f3a6fa593fca1aad900fa3f2afecebecf16e83b04bab49a06b24d0b6a0175d9ceb493ce84368c5959ca1a0ecad014b8ce4916623874748b71fcb878df64e37d6b4deb72303e6babfbc8b5e5b6ff088620d078e243efba78ec7d6161752f5c9727f92491adb4d333d4b128b2d678ea14d1248816af0e8f4bb768c744b93d3249822edf77aeb2a4797baceb7b8931f24d6340e04dd06b6b825e1fc1133c13045a35faf31d47770496a4064ae3c8c4d5c2eb2936fcf1b08c37e61fd4f3c842d7344eca4ee8b80c01b6e96693ffa03c147a526a35791bb46e62be49030188f31aed8c32d40a64a30ab47b3d66c91ab4c99ed03b5e5e2370b8f31862ceaf77fe6cf676e721648ceeca399b43164f819b1610e095ed3453bacc8fa471e94311fcdbfd74c233c8055ad9e90fc04136125dd057384a37ec6f48b7bae737125901cd59a533d17dd2836ce1d2285267fd9b913a0d71add813dd8388b80a16ef69971eade1884b469188148e0a115046ad6af78eb6a903bc559592ebd73b6ed3e1c5847029904923d7a30cdc47899cd45a68295b02fc9461b00c4bd5032b1fbc0d064f8dcdd25b1c4377e6971a8eb0055c42e80e4eea7f8131a30398a00c4386b8f71ed6d91d14841df4775f8daaca7d039a88f209c0eca199c4c2f089a600dc6a5b0e25f8087157bd1db526ccbd9f3955ff774c3c9068d7fd6fffcf4cba8a67e0637f3dfc4a79f5ed97913c25fb99fa4f4fb4244d91c2943d3e68495f65f4baab9c5698ed54b0d673db183a9ddbde2689a2d92643a673337443d690a6e55e0f87b34a955e08953d6810d41579b882817111133dc98b3241ec935c118fb315b7c806a1ffdceaa074f371820e53ff16b05080749a32bf2ff6b9fe3c9c11a95b991eab82ff22e5ea4fea7c5e5dceb079777f7c20fdf8280b58a5b61fd04e3b46db845a9440a2aebf07fe10dbf12bc8fd5709d6f2bfe3f8d626e86b89bdbc3edab14a79ecd5a663b668b037c5fcf778ad1a893f65586fff6b288acb4c28748028181977b13c6c44e19c3ce6a66446829d3daf9767df03d0e7878d68fec04f7f99e9b99fa5ea634eed75a2e3d3d929fbded5dc72789ac857caafe4f47f437b74f8f4d35be9730fc3bcb929164cbc5eaffbb62c05bc3f562475bcd1fcd6fb4f4954e7ce677c8909f30da96619075db493f1adcb4a9ee6d13cf9917e390729b5ec1886f0ddf1035c4594bdd7406cbbf1bd5eb8daf37e4f55aa29cd3573bc8b636f19102fc6de944faf0ef747fdcbdffe9faf5979d9cebe765dc478a361be44d3b098ed4f8a093d3e89db3866b72632997d8b27101957a328ea63f9040f416d213fc7df986612cc6f6543f642452f6d8234d982413a481c7e18f0ad9776e05999738f5bca54c43bb9b9105fe16c06bdaf6c348c7f45e7d448a882588e1224d045edc67b3ce5e9f8aafb86b52c6dae47d89d53f6d71102af9d552ec4e2fcb866aca6753b77ef7c22f936e1d22c6866a1ef009ac3f7a418b23343bc1e1656603d937e7b8124ff6aa1ab24f19567cb61d690f97bd0b4a601462e13b189f6e7189a73881457cdd8fa4b3fd148992dfc95bdcf2c8ed7883807cd82db8c848cad93a3affe19939f5959dba93427283f06aa14cabb2461e871b4a80bcd15d8111d0d4a7193b80afd5d2ad0f3dd97874905298356f4ec2c0e20bc42812f48436d01f824da01e89d0f94ca6dbeb0e410d82570ec1c4e68dabd5ab095e1dcf5ba973df17d48e4b6b8cac3cebe5cefa244758af1688eb9d895b98d5e33d9239157a8352a6d42cf5649c4210654b65f071fa78003b1e8de7ed57d70dedb812f003a493f71c7130f50598cfcbb1d4fd604c8d3d5fd5e81a5e063b43241064aabc2a305f9e2d237a7517a8074b4325dddd66a9505b563d52e04454976d8f35ad7ca18ff6779f4e9ecd7a81300087e90dd00235748c6c8d04823e34165873c6d92e576afce3f1796d3ad566e8ad1013aebbd67707bf54ec71e73976215a5a4ba0155a6f9589c3116f25202d0136bfdd748ece7eff6231eca15b60d0684d22ffd26c86c2cbc8a354918383b9ec0bb6c5e24f2a10bb46bfceff2c0194912e6fc8dc1fd822ad02e33bfd65ac970318005b33d9ce9dba360187961aeba113d1214c8ec5fcb67a407720f515cf17f0124307647d6adbe722782e67f6a3df5ae4b3384cb3371e435783fec5ca43cc550a5ff44415682412e7a01809614a804fec2128ec476ff6613985d2200a09798411f04cc91cac394e4efdb1c95d3bb2c4e3c36a5d39d6f320c45bae89a80628fd38ebae698c3e972de01ca0694cdcf88eea741880db4dc0506a15bca76ae938563f50019986c39e4385f903be3325fa922a0da6e431c4994e62e467a5bf473bebf38749b16a9c12ee0b2d731f635c8b1bf94d3a6003d88f5e23801a3cc58038c31121a80f79a683c14e2af294a5c0cf7d85fec4abbdf06269db9750959716c37b59ef851190689953b4dab134a26bcf3688a83ff645d519c99f83d513a3841ddda4a1763cad2dd1f0bf2d71b5f46ed3ab896f4e1c0dca3ced7d72d19e9c5a7453442022a4c88b2cf3ad9dd13d6040932a011b216af9a3f9ca09e627cb8dd262cff8b32e9d29cb96621d8e0b29b04bc62d3daecaa2a84dd9188e541d4f9b6e1a80fd8758321a5a0afa5bcd45307d251d5f3c063c72e03a3b26f80eb574b9474450926d0280410836e64569e1c672b3b0b8b6ea93c810f8aaf06eaba47f3a3dea094244111fac4fb06716780eafd5826a23fc7ea07897d12c981e36b27b9a9f19365bb0e29d17242d93da69d8c8081a8afec33e5ee3c1479d62b08a3e865b723be7cb2fd709ef3fee57e4efd5e3db4feb777a81c0048b1939612a5baa68a072685b0f6c37cf88a8188b78d00c199d491f9be785c7523abd8b7d1954085002e57103be251bfe3ba9f317b14493b10dfb5287198b9f29c58f7ea420335307d900f35d31e531123bfc9fd2df51e27951f84ae17e6378d647ed641b39f8826e15a128a41ea7a584ec86ce95645ffefd9d3429eee5bd56f28a249a9f34887e31d17917a2d75d531c1fa1204f9fe9e038c678d51c2a483ad38095a1131448c3fb041498ef7b00dc0a2b6650784298fc09e80c3e939da33efdb6a9105a8e937517f2e78daf435a369a99d045026513b6e1ed3a331884b405b603ca4a9f3fc7e737bbf143516416c1a815e31d2195ce1f60e50fbd3ea6044107f63647342af5226b1b0e2606a5d3c8008e915d810f56171aa1f8e9c4bac8c34886aae61920a0fbf3f5a998874892ff0ecac21bda6fb3e3020cd39f73bd8b096742c03c2a12f49661450c96612b7ed0a78001f715832ea223908a22ba8cf524c9274aad779efbef6c5c75122ede676c662195c006c662748837cfeaa84ed4080887f2c2bec55107f84dd0ba439edb747c96e2bf82b4e28012c641dd70413fd5e3cf5f1015425c1de926583cc4010060036c383491b94e99483141f4a595ad9b2d6f038af5f130db1dfea58e538cb140e936077c0f374963e5c5e07aee77d0a879879f9bd43784ac36faa0aea2bb437a633b0022bd7bb05c8b2ef88fe7cf334d1468201561ff78175f13e2299dfbd9605e03bbfe633b39f4a8fcd8412e45c7f62b8723bf2af89442a3aebf62bcf72d310a3c6bfb0de5be672d22075458f44c475c0a38aa676ec83e89429132ef4b4f259403e9a735d8db1041cd92095952e7c63e36b6efce9c0a57b761261a7eb1f0e54f2d5c016ee59924b9840b5d465bf27e109a42123cdf1f54387f97a1d6d3db8fa00037f1101c41f3742f7382c85dbf6ca67de21280e4fb9aa88f246edde77533caf0abda9e6abd2e614d1d48da64b03c3939c2a197de525fc272cc9e7fcd8176597c44640888fe079327b4395af06edbce61643e09eae5ac7131512bb3b4300199b304c6b2183706734d4d41c55fa956fcef46d1a3365d5ecb1c7b5bb86a2312cde788d13d69e40bf30f114771517bf611706c8119a95be9e693e42095aa74ec189a7ae623d635236cf6a758eb8dfbb0927d5618f2f711fd371d4e75a7aa37e8cf2d23dab093ad3eaf0ff61b6e7184f5a7a6e212879b66ae3cffe23c10bd0b08235aed6af3a7d93aa93fd68ad2010c619643aba51a2138e0675f8a79dc843372988085c27b402eb9d611ab827467b2e7a808a8a896e9c052e490a6fc232e9a4e0ea8e8908e520d682317f273f9437792a4936c15f90d0bfbcbd8515a26b11cd3f47e2776272a43ca2c39db172f9b7755fe9172e5ca21525e71ceea87de02662585cf362fcf00d6d273416d9606e0b72e9f3d7a7f5db9a4a540a84e0d5727dafb53c966b28c9247b65772577a14b1661034c0b2468aabd3b7490c29f2b9e53143a6dc24e6c4faa52bb340d07789e145469f7c7c8cee21186963eea93a263f9f9e440bbf9cb7c7b4d6654df486d695ac2c2454b6a3a2b35bc7f52f1e1df88e1f1e8d64b9810b3e85c12d70b2c87c879cde64065ccef7c0ece83548dc0df764131afe6c5dc3cbd01f69d875903d27d02d903acbe3c291a36574808931b9d554dd711ad2a04bc0fb80d5f4270df173aa2e985e67a541bab2c8367a067bb6e2fbaf47c70705a496cc11b825943141ddc6140c53e5d4763055e4821b3c42c0a2436b35e6e8fd6ba3339f8e64c0a844efcf0032edf9ec65a2313a0832d36efec95a9d9e3032c8d2e6e30ababaaa884cb4c88c4f280efa73d8ba8cd10e5f5d594a1cf5e9da79fef61cf028017be32e41159e0d9c259649cc4ffbfd1926881c5f29a2f920777b03b83d1bc6468ceebec0fe5b77659a806eb13332fb42de43775e7caf050912cf21787b989e90e17b657ddef25ca14cea089f098cf63d46cc6e6625cd930717d61da7ba6985c0a0b2b43c47fa2f5ad60b3bb41301bd4235c728b83474675f282a0c464eb9ffe0b56d8e4ca605dd2ed79e9ef853fd3b01db389bb33e1b4ee98e59017a478fd8813c3e3f21dc5ce7be9b08f8d902b50eb374f336fc894e2defc7de427bf1bf0736124b0e36807dcac49c615d508fe72a75497cf2d08aa6dce581b2a18093b00eff7cfe38a4535fe9c22a7bbf3807ef2a954eeb8e95eaa05d27ff6c4bda3c8bf10a5ebd63bf33e0235a0fd446cdd570f4927632bb024a6f15260afe0ff73cd4ee4a1ae67102f923303b2e786bc19903b9f8d37030674427978295b328e3cc409740dd3af979914cd25c1b6881240e86ad186d9bcd4f79470728d370a578c1242163d3203ec49545a7414555c4c7aa154a6a0eabb39603a397947dc6eaa9b520e2fb8153d18a307591c7053c5c370b4b1e144c05f4bff6c725ee88efe800c34b096aee4b71efff5ffb7f6dd3b42a84e55cda34c2d9b84acfd67546555b936e35310d21e11b4dda1bc903dcac78aaa2462ba555b764da86908216a71ddcd1963bd993457fc0c7c5c06136144b91de8d2528fa64258dced1b33b7c96b116f877cfcd8e9ec5926453cd190ac25a836ff539a3e5ed3344c5e1b4c3238017e7af4fee9b37450599c0673f298529d93d61c2a84eaa12edd654b76e6ceb2f2f84c748e5840f33c095753d67014ee8405e93ce3ed2cb518d68d50dada957f4d1067123a03813b8eba9985bcc1fd3f17a4a7349b67b4cbb16534539df043a1a4850a5be66a9392f79764eb3246cf62fe4cadb4f39eb94eb6a0a41e95f628789dbcb023758b7761c4b8e39fe637318e5501688385ecd2c9ac37345e433ddd5bb700e7e78de755b0de9c3f041eaad0190af6b4203c3bfad5233c21a88b21d76b98310431fb3a53b1e0b1d4a6e17a3b4420cf27d7deeaedcbd37053eb7c69ad586494b3bc9a55d4003a47cff89c89ef6ac3e66195e993ed95536555651b2bce6015c920c5222fd4906160b263f7dfc8b0c3dca6cc8ab478cd8be9154f8ed5d99369b3aef9759031a670219ba746ac6158f39779b70a0d6c3af240b80266c82061cca3c740f2cefcf8185f2ea64d42c6754e5add9f4cc870802fadb7c875be83c4b21344ae91c6330d075a4c6d10c763d8f8c12cf756ba7b05c7c4901641cdf8dcae26c2b2e01c143fcfa8e65a9839a8afd94ba3f6b89031a5aed98895832aeefbd47d63fee67d905d0598f3f5763caeb6db478b6f2ee648bc0e27b410d8c90458b1e66c52f2f77625ac7b0c823c8b739bad5077c41cd0b9f2848cd496859811b1ec5026e26d0c6538720f014938fc36714101aee3d809a451d76806335039a6dd129935ae5c1042e907d6e1c7b6f3c93b74e0f4e0a292673e178ec71fe387cd4d48f001d706123473da1d282fa766c13b9dc5bbad3b60e905142461af34e1ac904c76809be306aef1b7bff38c5c4b19350a5251fff6cece8bb46455aaa0ce9cda67df7b814bb30ac01a06006cdfa08cb3313a47350c8ada293d0619394d7eeb35435741bad5ea617ffce881096bc6fd6a2a65152d797337ab72837be162ab598b9cb65ed69e52404f211dacc406d0efd7b8e80f805f1069c4d2f2d0cd3df1c9cfeffa76bbc34f9b4e08f8782b31bda81880e10a0ba52fcb66d708a027608963b6c880e2491c71f9fc0822b8df492a5414ce6467c40ee4c76d28eabbfbb15743ac428a7d1ed699b37446e318145227aa718a421550036e22827300cd7e3a6de7550c3c67b461cb2774b9d2bde4a6c786449388198f9d5cc9a6864732c8b169fa3abc1ba77da24fc5c7bb2e9a23d129cba5a85bafc08bb4a4817f5f0666759ed33105dcf4417c0763431d04735a7cdca2c8013ad853dd8a07414d3020fccb05ff00a8e80b697e72196b321359c18ce440ed23de7d81e5c1d27865869e663520d1a11a3b0d85e60793145287681a9b52975c7cf91b98a766286091fab2a01e9d91bb7075cdea5c30f4cd9eb1f1e94915dab2921fd391abe6e2ea112dd588bee2a87b337135fffab9acc5891513b5ae8e9a83689a564b039f546f583f1d934611aaa4c6164bc1c8a29a8f2e9647741a48785dcc1a7c5d42a07fce9482dd17d7523a6049cadcfca301c240569a63c6bbd2f41187b939a9982d73d021737205d2240759e5bbf2862b436be5e3a7c03f569fedd62bf9c4017ab8025d32e1dbc92255fc034722ea0f9abb23ff7f5adc9752c1a2f358923d5b8144e7a853794d726e04a51e19a37a261b70a339cae1471171a2bdef01463fe2f40ee0e15fa1753054b5ef295247ce8a9d98e61a7b06515d6d8b30c0ce36354e6817e6f659e0a03b61831d014457550acc46be688a66ec24251e70b57d6471e0f0261a7f322ca1be3ae1352344f9d5cc2fe128c264d217110c526aaa67251481504dd1a0c1fa1e5770cf2373537c7f2fa6a7a0d7e9bd50c2f4ec7c2628d91639a10f50020d1d473dc901c51cca9fd30d3566dd19d7a9843f3c4d0532dfa606571af3804328abe68ecbf15940b818ed1ed1fd9848e0654e78c3abb6fc5dbabe2d0746f125bb656eb2653cb5893a1bfffa74692c79c38a73388e260002e6e03807e4ba5aefa6dfb35c552f5d3fffbc3b96ea26040873d035539cab7c19805dfad1968c562df1e4f6defd6cf7e1bc61dfa8cfb6a2ba8e865dc7b9a7ff256ae12b3bc27c4540804122332e71aecdc511b5ac1091621be524320c9512250ed58cae66c1a66c98a63f05327cc3fbba4868ef08acf2ed9fa72d8fa604d7b631d29b4bb000f7f83d2c8e11dcb72f102980fcfe9138e6b15438517334b57ff4e6f62e43e7bfe3ac43c8b2020bbe69e695db064785ae28a25db393c34a49229cfafcef13024e96fc8a5bfe3e43272239dc849fc3ef4913532321f2d47db2ceb3ebe3890332a9feecefd2ccf2707d359239ab7b253360391daa76b20c737745eb0fc92fcc07cc630e4b8932de03ca71dc1c88b5b3616c83fe4342d81f2e77be4df02d3b1e851123938986ec3d65ca4234354c4330bca7c5259167786ab26f6112f3fb6fabbbef80305418f66ed0b99caa922a1076c109fcab7f7b1d9c0e599e1d1d5787e416a4ffbe284dcae1996d06ac9c3a6191887120235f9698bdaa88c910b75d1421d23e11a93d5d90a065fe02b24fb0fe0bac02c547c4aa943f31800e3a290b35be7a0553050341d84dfd82b941052d5bb9f067a46f858c45a8f90119540b4b55f7b80a16d80205d5b312da49402b89e85930f17659108cee320e02e34d230ffebe86e51a023ee71fc971b364814839bdd55090c40c9101161d1b4d12da438b11256d4f05bb669bef888f97bf6521e58256c6c5851867e4cbe05a5dd6dc562abdde6be363f91d07ce4e675efb6e06e8fe79abcb136957e9f0dc895c25d0934d8b6ddeb02b91a9413b4b6c9b676dac44298c940404e428fc62ffc5c2a0b1e5ccaebb519f2dc9c2a5298ed478c59fb0170c0aea87bc986176ab91d96521a376f515de38246a9588fbebde65dd35487d339f97d791acaca00d1b9f279a77484501a2b3f7f0f0d8474983533b55b5464f76eba4101077362a1621df980fe3013e011b4296b3e2fb46c617f27755051612d84c8c2e837535735a94d7bfcbd41c86d0cf81ef108509d47ba480af4700bb26a9f64afb285352731f63a16eacc355f70c680ed9a06927b106412d319115b10b9384d3f0e07a995d1245507f8cdbfe75c6299168c0f35405cbea48df7f2e1c7fcef142e9c8fa043cf0f8aa6b7d240910cffbd3bded2b81cbd9fb43c2adb0ec98e2c0c2439830fd15f8bcc4146de75734d4d688b460037071cdcceeacd3977f1a7ba068628d9f68b4b7244fba8d43c23084963d75f624268796f9c90831670b29a140de22e277056e83968adb03a5b90f73aa1fe3fb92f46bc4f44e9c63c2425ef108b4680fcc60c73ea0653e9be9b275cd9aace6abd5dabdcb9f93de395df313f6c1d0466ab468a93f163b3b77a769e837a0b54f85fc7747608b963d38afa780d21b1c66a9e44ed763f71ac434e39790d2868844ab44a078c87b8af9831d6c0aea78da502fe08a6848611286d5dc1f13627fbb3814dbed1775666133022835389b6eea4abc81e1c8333eff2f26ac3c766905a776e9acb6b41cf1f1a1518cee6b3f2e8b377dc62b262b58ed48e0dfa41850061999597f20a2d5faf3bd75fd1c57fc4f9334777fb54f2c2ca1465f6e2eb42c6957f952494ba0bfdab6cb6deeaa7b55912d80694bd6bda257d1978666969fb8f65c5e415424e1393355ace23a45dbc512caaad024da1142159373fa40a2d4b2a60aebfdd9187ad40fbb985a6c1adc47979128a296f84e643ed84ee3b4ea7f815fa18b8f839f93a2e218397fd1cfa64c806282a3483c98cd4375453f435fd88e3a387d35d83c7db25fce22bfba1bb6b092d377511b26f7386f638f8b3df46b27c6a0bac521bdb3df4d75c17b99cb3ae8e4554563fddee61279ca315fc48a32f46fce92eb26855c721e0cb84043f4","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

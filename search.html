<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"547d8761aefa70fcdc8e3dea537e98bad0fc6c9f500e753dbe4b33088ceead774d2d67bc698f5dd3abaea55c2eefab4eda8f34a71ffce953928a58dd07dfca19c6be629df174dfa805d776be40769f75f6cd97070b0bffa65595f3dba3fd02d848c56a558f0ae6cb21aa3b34c8c1f8e7b79cf466aaa05607bdd9834f0f58d9543534ca2ebe1db14eabb0c888d76464e4354db1feeaa18cf7adf8889b74ec5a33cff28b45b99361681f79b36d3ded6c5de128f65f7687503e018b9bc5a55045178c734f525e89fb693c6e27d38119a9417c8ad568d253c685861f7976816cba12e4f1272508382a0e7e53005d4b67ad2a46dac7115b9c6e15fca15d2de7088281fcdf40a1ea682d01976892b7534e9e47765ba0ef87616028228575bf8395da184b89ef0f6938a2427cc2bf7edaaf31ab0e58372148b4d73b649d1e4d4320c778121ba0f9ba942297c5a809ecd7803506eb1fdd3d4fb680309b52988a62900998fdfa1bdce86d154391b776ddbf52772a3f6f8d0d6834f45e53ae5757c779ac6f6e86c0b17366df50ed27d305062a963052834aeae777dc50717679d960a7f72d94ae3c0012fa6c1a466210fa211d5958f9b234dae5aa9f60132f6965e873397f0facdbb78513ad3f3624d8b94c1837611609095d66daa17041a83de89c6dce40316e10afc64dcc3c88318408f60f314e560fb5afc723a2087b2d00285f48f63a627d4513ae732facdfdc43696f7862ad0826c83d6d68f1dc743d1129a5c0e199231a06f34825dc02a700544a4b7847af47b080f4c0b0be2a1bbd85523bb0bba9ab6b2e9f760b94d5db10ccaf955136504ef8e7c78d5a316e13c0fd890dd4697ebad2126ccc3895a2a95b050bb8f649a6a2604b29f18cd17a3c17be09cbcc9cae993232602a50d25fce2fe5b5ef375bbd73218678737d35250c80a34057a880fd7ad2d955f03d48610ee7ac7f8059726d864e81e4f4dbb6b9e073bce6b7d0b3b9eb00ecef73a86d8cff79ff6a7ee4659b1ce7e262590f11f0de78750f339371b6d20e2dfa0cd4fa5dd43a58c70e1ec837de6891194f07b24f4f86cb0e80690167c119c30ee24ab5beafd130c620a2ab6c1e4462941ab243bffd916ed0956578071c5092541694afde8bbf1133b8e2580a85630fd3467e225e7bb1ec8e9c0a2fd3f0ddf3ded5e867fbe10a18972ceae4e002f828f5c06a3f9a57e0fe4545f2819830880aedf9f98c218be3237df8148404437d01c006ea6f3bb68b741d563371c4f969a1075dddebea01eae2ab5add4e3157211cd73413be3b9dd8748aedbdca32852077fa9eea8c4d731aa9433a797f2ec236947434ebe8942fbbe8e58488d92449b597396c7383aa1bcf9d457293d29f76ddd1d799f73856ca790bc7e6511b027dc95e413896d413a2f54667a183f6bf489bcb5ba15b1e994c549b292df51e7220f2260fd7ddbd4113f7a023c07eea170376d769cdf7fb0c344458033345b94702a075285f16d01a11b04891e0ca45577d87affa8a501524c68f34da6362e22240345652b6d7ec2ee50845c62f490bd6bd9ecd264e8f322c7caea73d4142ce696179b794572e866a90e709d08da599f7c1c51a520d7d6b07cdf3c995be188100d44207116af234ca5fa3c6715ed1874ea0855a9c54fa47d0b633ad9f44985c018511a062d410712e3d47c897c9ef0bfae5d954311580bd72c140a4004eb423037f140f64a7b2f39dcabab466f7b89b51b95a95d9430f2fd0adc7607a392119c82b8663928f6d5d0a7b458bc7dfadcb22c58237f6663a92e7125920052ed4380e90f7afb08f694987cf79ec3a0eb9e6ed6133455e27e6e0174feae634d3963e2695cf43894399433cb3067514fbdf8b5f4ee9b2fd0328c3bbe303dbb2b4863f980923f8ef7215dc7f5f6941108e6619f65909011a0ee8f81cc4ec358bcaf7b1e69283b84b44ab936397a03a274c61ca1f596b43bec5863b72bb2d233700b318601c6238d8286e5dfc33d5cd454a7abb2397c145d8c0b12fc35ef4c4a412f7960bdd7ce8bc4dae95e799a81a08fad1dad3c45e1f0dfc9530dd9ae4497a588999f7a7b751290f5680344eb14f6273cc9738b5a569b5ef2e7322872939c4c6565476616a0f4eea8cb6309d5a9889b1f7287a2c842efba4d620d7ffd7dd2aa9939a10ec7f32b99c74c7c497c0c42d20dc593643296dcd308a2e8b4b01d373a9d91481b3f527bc17fcc533d0a7b1bdd16a277c9c33cf37cfcd9879f571bf567fc97f477f123e71f4fc25b7ac16c89b0e788d455d3e75f72b48d8e493b867891aa8889ba315803007ae8a527fd19713605337c7d02351b8af34774b4b57fef45524010a468fa3bf5ea240b8ceaa1f5f3f3e513a9ae16442128f128483ef900c1904ffc42f97d287a3aba05c34fa473e0a06760ce927722aa4b67211eee4e2a529981bb826ff960c1a0627c9231381d67f2e5c81f59a82e894071cdac63944fbe2b5a419268c9870104f5f0b7a6eace20330bc149cc404feded48a58908faf85beff33e507b7f7b916846f865409f00bfa0336156ef4f85b284139e87f76152403032ab3c72b55baf92df97a9a780a35dcb27a961dd16260d8aa3dbff02236ea412e67533c4943fe78de1d4ca63c79307284f41d5f14f33e56c5e4a3940c63dcd04544b16a6506914cb0c823b8aeaeb182bc084afb56b64e94e8d4c4491522aa14a9c72fb7649245430fbd22c6906b852d0f2239ace8f1e601e30b685561ea9d2766fd44d4c113fdd2f023d3cf65f3be5bce83109fcbf176bf10def828611a1b8b2ee248cba50dc51d57eedc1cc7f421f7921731f36cee1ba80b78db942c36d8fd0a3a5730d78e4a8312316a2a732af596a47e695bf0022716a95645f45bd78f95e378cb310f6aa753fa66780e098aab9c4755bb35dc271f9fcb3a14c41fb6950e50fe6f35498726447b0ecbf805e6fea6df95a6d699a4824b3b4f074ecfed6b0a1de2a98a7ffd3f6a0a4009be89b846bbd94d8c7353122f414f354c819372fbfaee7a84dc94ff5b6f908724a9b14701e9c177252ff4046805f3ac97db0136961f7a1547b2472a02aa98f97e111c603121750ddc414acbb172f95353be7968a5add01030903049183717b79b9470f1070644290d4a246eba07a97a80afc1eb40552fa02598813b8c0de3705cf71f659f23fe2d44aa8811edde88242f7ea9bd49837e2bc17d134bb63390e8b35a8ceb741bc02d686fe4d3e1161e566b54d3672dfc4e78a1756d9c7f0b5de8cc50ec76c60ac1c7223a6d6e1695036663ab1ecdda3835a552360954548b882d9e77aa36897abcf54f749e1b2532d44ce3b622bf55c102336b488da3a251ab857af7b74fda136d5beb4a0f1a6fccbc44ba456b332239bdb586ae74812c402c979798dadb6678b9b6d43cf82e126e9e5550b10f2200ec4d6bd80f4fb3c608800e447b30f90e1f912db29033db0e98827cfccdc9782e4beb6ea2ca87fd8e6a20634157934c4350cf9c3387e3ca3d9f222583efea70026a868caa3c3d88a35051200d8e2a0b1ff1f903e2ffc03c72b551a524021822735e6e1b3ff71605046c68e199e27cbc806bd766024de2392fa5231d955e28b0dfde46e83cb5c51a4f1049d65c3fbe50eeffd6c11a4a2c8f49956dadf93932f1aa06b5e667d3f841436ae7d5ea8231e265170c178db6437c48895f8a43a2e3b322e4444f5bbd855584fd0ccd0dfaa83036946f7f94325c8979d9976a15004db724e571b80597c43517dba952769e0a352401794dcf127337019396b6d97781e7cec66c1b0400c3ca04229a68f49a6c77d57b699d7c2b89aed34262d18b1b1f4e316c7616fc573a7db59e8d9b4e5e926745dd96fc8d198368a5574e7ba0ee8faa2a25ca743078dec1e792517fae743c35bf628bb3df3fc1532270bdd91c38cf0a665b607c24a456a7863379a349db078c33b1182270e73630f5bc9dcb2bafaad2ea991a9323d19528b3d5f66e43da88ae0f716ed3ba78f4ccfd421210a5b76e6cfe83fd47b6263ec42405b97f2f3d1ce76c0dbb0c8fb2374bdc95ffec93656994b0bd0081e7aebd50f10d45ea65fbe47ac6d8e70a6f32b4023c8144e1fd9250124a687d697265265406e36889b0b3380ddad03edd0ac321a83965f221207a63f004779b0eb5a6e6968976b015741dedfbfc434cf5e46982ed9e4a0b4e65e0f2338e34cbd90dfcf3fbcf36d917a7a085bb5c555deedfbac88a9e4b3e60ecdb159cfbd683cf87bb31c56557bb8d0eabd61b23523cd5f62a016fb0327dacdbc40b6b0c3988970683a9096778feb5f479d171d2334152802b7dac933d13cc5f08284418776200bcd5fb1a7fc984d6c46f066f69b7f69598aec95742f2f3b786c4ec199622601ab38462ef2103b1298aff58e01d630fa11afc107642f5352ade66b9aed87d1cca5c042652f1a623acca2f9a99f07188b482ab941b8fb0c402b788566c48c6e0ce7d42f0224f43147167456208aaff098800dba396f3b10f2ffb2a0753302ab435f51795fd71277bb84accfd1d60b17346e43f5c983f22ac761c72e8b35cc53479e3bc6eb3faba2e14674ee59f0a9f56220ecb4b9ac858db378f247a3e082496428f777de27e73748cf58f18b89734cec320f485bd1497025063cccd9f7c17ddd1ec3337968b30f5c9adf73b0f5b6571be4725cbddd421b4dfe4aff9fe077d15d85cde5e9c87d2cd947e68a301ac62f66eacb1c291201804d7317946f3bf9838d9cda6658f3f44ce7d54e0604476255574d81a81059531831aecc0ce8d79b205aa9e3eae13efbf87c215e3d48488e5bdb2b44c6fd1c0a31731c289898ced0e8cc5ee038dd104c57c4e94d8a160917e27c25e6edb7636279982dcef719355704f5be845e2e2f3b316d516e5b365a49f11763a28c24991e70dbd8b5c2a74fd6a3bdefb5e933f1f20f9b3942deef8331802f0cba3ee146b5d8e2728a89413bc1737593284fab97f2978dcba67ff1f42aa055cfaca7383aeb0bb094fa4462cf34cbbd16e960cd7b9ea5907557798c53a688ddbb13a3d10a766b199d18e2d60026366473c231cb0e66ff3eadaed9e3a848b6c0dd608b77f08dc301c6e43d48ca9c9f1212105da3d331c4998af363eb3bf5641935a335bb10c61bd5c57f47c4d1ab8181eb9034a9882043c3a20bdd63e76797c87553d1ba94fcc0e37f8cac501df4f7b339a301ffd1dee6367fa710ecf17fc472f10da63c2d6a39a102bcea4bf49d4243d179a46a5e7c7edba7784506493efff5a1e404684976bff416c62f1d77eb517a178b1e5cb45efa2face5f7e9f2d731b19b91beb5509a9fe32d0cf37015d1e125d402e504f547134707bf155ff78eb64626fbdb8fde19e0e96f48dd910ab9364d41dfcb6df63e1db33dcdbe4081653b948b9fd18a7f9dcca51f88284405ccd2abaa6e859ea367448fccf7088e458c2e85c0d2df592e2fdb372670678ce6b1d6b9af9f6e31ffdb0d6d6bb1a605c0cae14f7d1b919ac574eff9bef1d82da72128450d9c64a12e7bc1dff31bf414bf2d658eecfc0066df523c0a21f9575f4937d87af112d59966ff4dc70468486339c8cf9a48ccd25070f0de9ff563088e7ec8fc964f5e603dbcd3267a460bb311c2cbe11f4cb1b418bf87fbddca8d85279e82e26f092025a37331958339f642166acf51af1bcf3872b2a53bd7d2e2a94e265d001598dda6c9c5244ff6f88c0d5b10f2b949a4a61e7c0061f0956ce2ab816c46f091f9483d92716df1707baff1f11ee6f39def920133ce98acf91bce3aa068f4225af06b3f68fc9813829f76d75ca2832e0a01a98b77dedf55ca07bcb359d1d3a2aa9d492f7906b41d944d53cfda1e2cd4b1cd2ed251b6fc52e07cdadd7c6060d58581bec8e7d9f9891bde7311a3349b5186c26e6970cbd1444d4b808cf1dda4be94d9b8f5baeb662a7cb9a2952e5474754a0a990087a2833089e3363dd28aeb66591dfb8626f3761512053a724493f1cd76dd9ace48143aaeaa4947d145bb1ab45df66352f275a62773e81ebb6f32fbffd9c8e16a9a30c978a1cdd0e3b6f2d3d2cc2ce6f05b8e0d284dcb963720e88191749b6ff3e14096e1b81b7b470c3ef035559d69f8d425a2a322a00238d9a0e69442fc3fcb45608c169f53c995d823330fc243b7cc98aafb3f077115f1ceb5acde5cde0abbf5266370a9960068b396af1d02af3295992830bd0cd81c8eb12ed07145139ffd8f5b2b11412f8d8fbcaf0138dbe6e276a70ae9988b9e42686b30929d4d9b696d09ac95c14e5b049e8e98e8ea265a973fa95cfa880d319e6496e987af4cb8570866a61b0390418cc9866735457fa669909921d813ebdb227ef835888f4c9b441b5f6fdca1447c1bdc43368d2255a059b0e72f64d443e72870cfc5485e9de2813c114f553289cadd8b6d1c8395ce360e00446d7f99eb6e7dc363f306bdce088b8cfe18b60636796bb841ba6240f8d860761579133559f1451c13dd05babf5d1ddde31c7f82f98a15b410c8fb202cb1f55d899f6ccf6e199ea130ccaa5f6af9018e0dcffcf3996c011889a2fc7ca99e86eb706cac8e087dfb86b453019202850c82b09974467f5c9f219e9d10a71fa47b09a914550c4e870573adc61b22862ae1a68ba1bb8aa5b9aee9a3ccfcbd3020e02f2a09ab1db53164041b630379714f14aad863b6653de81f81c594f9ee7326181e62450925f3def960ff0f79b6834a78d880311c747fd460868ed63d2007c06524bca4bbd7eefa955744b452f752ef1e80e27f1dbb0511c0b36fc82f50345c6acb33045a74af976a7a103e1c3d242bb208a404536e6ed8a41e17ad1091203cdc5ae4f6380700347bca0cd656b766bd2afed2a6cf05d778869d58189131dc312fd093f3e3fbc2519380932af80b4b33bfecb1bc11480dc162e76932492c253f70c080e2761b6dd4386cbd6950ce979b57499bca69ed4c5cf363f194fa41dedd5fbd9aceadcdcd8ae0f10674e18ab6e59d716f33a854b3a9b926e2d3269c4c03b5f3d09fb68c3813ea747beb93cfb5f9572f6d871ad6bce1f38f13bf9cd39db854b362ed6396efe8bff02ad22d8a2b4cc09f1c41f84de9bc76b4dda7ff97cd708ca0ffdc091b43c5b09387c29119ddffa0783b48cf7b358e158cb9ea946a4839331f6d6b9a9b08b233ba602d2dc8c619b381bb0d026df15a187094101f809546d5e3688a785263b8f2cbef55416564ac5ba562346a40c2900b2f3638ee6fa15c788dd4d45a0c4187c4e859ca1f6a0fb07b31a91b61b2150e9b737cf5f4c2a72ca4fe9f8ad2051e74b5e51305c909a07a925dfa8709216ef43278c4d5cee1c1e076a3d83d98718c6b1703ed7bc50346f897672c2ce4fdc497b5953cf5c25a3036ce7c4947f0d7fca398cb49afadc8697451e6f58a98ce97f44417ad58c2a3503bd71b3a62c4590d949264e2eb0d3ea0d266bde35d8db6b46bccb36cd0e5d0712d4a1240e523f75b6a0eb07ba684be57bf13d83f30053bb6fbf9aa2ee98d134ed57b2f1785359a5ec7606de0a32abef4dfa17af56d9560b855b1a79a1f42f7d099ee96b17fbc4126bbeddf72d7589f65287039462d4c0418f06ca7bee7065e9a51c7b5deaee78831ea8eb158a11294a5bfd84134356ee09ab2b35c059440fc4d9fda2b4fd0700481bfc6eb02405fd0daa518b9a67c39a4c925759aaa81c4a8b56b2f957beaf761b278871800be6d97f4488eb3794544379248cacc6b81fa839492b6f338eb7e7c800aa3ffb284c1b1f627ea8a515bec5ca4899a31ecf83fdfe4a1b90fe5f84e7f52268605022579fc6fa89d4b3763c08756cdb74c70e5bb6e6c0e3ad861f1e5422ab811a8ae3ef4922db9a15f8794a7ec62e75e7c2a08530cd28ab3da18f56fd2b70c21825a36f25441fef3097ef5f5a9a45fdcd2e396e81a36a058427adca873c97aa40f4f21515e86acf02aff17058fbf354734fc063f125ef7682493051fb0eb3e7a1e2876acd215bc40142d56b66676210e977e4060a42a01bb4275ad92afdc57643a49d42e44c92bdc7d5eb5ddd04b8773e379792ba4db56937d58b38402f516e4e5a51acebd952190e21282709ff2038b74a97b3610fe89fba096b343a579089046bbb9068e2433608847c4c918cec3c9c5a63ebec681a239f3a4e2c7e6ddf5b837c85c12d751e2053203c01880a80693d4f7bcc8e8038213585ab2e3973f84d5798826707c4d53536e34c4ba41c6e82415665948d54f1b562becb77d18328f81064b6e97c8d1dfdafd08d0da31218b118707c263251eff29d2f58ef4eb3df4a50e08d645ef0fe86c3903795c1f4b50979f55464ad0fc9a46945f7263979c1c4a8337a6f3dff0b14b010160c2b07d1462120b1b46088a1ce906c19bcd6b93ef28d9993743a0ac3cacb3a82e7d1b284c5eb0c722aa1f6a8b95ddf21c021618bf4d3470c783ea2024c0bfba3b8a790c13ab8010024bffcda46839b9d018c326167c9e7ab541cfecd474f5d30411403a3b52c972a7a269ac5a6d64eacd10e218f433a578f85a98fb49c00cee1bc4191359379c9ef9c406b1b11552a67bfd176e7fdd81e1a2588252f4f61e5094254a418eed46016b4fc612c74965adf4fe524e03b1235ecbdcb29fae9db68dc88d28e52696d293686aea43f813bc344698d90394a32c13bb4520dcbc02c3d295e3c7ca7f011e88affaca1ddebdbbcb5b3b588754d38f1b1211773490dfc163e10c1288a3bbdccd1bb1bd65e9840b7d4bea3609fb1197227334006828d5e619fc0813a7dcfacdbec2b5cb8fdac3deeccb03b5ab07939588e0007b0bedb63d5168ea3019765de49a75bc156ed0ca9a836f0fe07c9daf0f72f1454dc72b70b6c25968af8227313a6f093cff463d26663a2260b011ebefc86f9ea8c7fd68610afdd03defcfa63c234088b063f7ef5a4b2383a9abb51d247e15972cfb6d22f3f1ee38034c8305b1a5bd2ef922674dbb13070b06969e05d12c448edb1622ac7cfe8743619a6da1ba17fe02ff5857595692f17246d092de139c8891ec8a96b407c5072f74955c664760aecf0134a6ca338e6f017fb86fbad01003420df247a6b2d5b2a90db91d63a864bf09ce9a6098ee0e9e1530de296f3c56ae6601fbef5ced3314fcf8dd7a855299fd357a107b7f14da184e12195f93b6f1155b731abfc8a0502df564d94e416615d77004f9c223f6461f8fc00328524929ee83d5f00cce13b40232bad2ad332c8f422690b732e62ae762bc4b8dc2d58457bb3130a4832d86d1bed366f9143d65bf8c193dacba9a61eba53bd2707970c0fa1183f28d9ac86f31858887590dfc65329f8f6f0ad53f04bfb43e38293598ef2f4b1ef86d36703ca45529b9200e36deda3ddd77c7c5e8ea6c1eff82534a0c2d35c2c06165a0170bab1cce9cd12fbc468bc85f4ef9adec1ba24b5f6fabdbf3164de5be6012decc9ff2bf235d15e490628ac60d1800fa891868382290878284ee272e2f494300e9e3a3b8cf6c3aaba158198cddac31bc7b12628f05dcd6ef7db32155e6092590da22da802dc550520c061ad7382ef34f07c44e5091b32e658bd34f70160977ef644f5dcf9ebf92503ee558ed2bff84601068a7d45a62b6606859d31b545e58b0de092757238e061bebe885187f1bd56e17fb90714f6ad7c10a83f9b5413114e1c7d7cf161b987332c59d1be889ae1337f8850b3097444c0cb9a85be1c9358b2b220e1649a8b0bc8d6733188cd74c94adb06c5edca2a0ac41c7ef32aa45905640f9c5261e6a18e524d35e83a474dc597f0e3c20534d8661d4ccc7913423409ebc0defb8c2783e78d8f521d8b156d028582c992959359d3a649c858a244796c10dd781d834c919bbd2bb270429f1ec13a1fb9bbbbade796834c4b4ae41866791ccf6b82922965362b16df39aca9aea32005ec6736b4ab190228f6a12efac19008f03ddb3d5c22484397d7d3501462042c3b5358c58321dc24add0359e717c0f35f4ff81813508d43a3bd10c8d0cb91fe3a1690f986d59497210dbbd855401fd8f8e3df2a85b843c46b1bcadc02cbf972e15082f58887149187ada5fc06daadc5ce9c77b68fac7438a525aab7915f41a629d5e26507d0a3497a7f5981a46e27732d2d98b62183f2da1d4c8239fc0b0823a1c1e5aae7b963a84848856419c0fe387cfbc08d89cc51eb32f96be3682594e90775a9a55027763cf4bcd651d249137e74bba91c4a73c85fedc76f6f423db899999b05865b2c69ae38022e304218fa9caf516c250df6ec2690cb742fa5730db6474ebcf9e657763100b1623398b476007b6982432121e18e07ec7e09891874e5c34e0a5b0fca5e8caeee6db16072b08da5fc7b0348c4a367147204b7725e256f9f7263151903e67b80f753a8c2e4c6d69a47f76e507c52fccbbad5a54893dade2aeea70c8a6442d9497f010a6c87e7a35c3aaddcd206871f1ae8daa80bf7f4e7fc5106adbb16b160d0ae1ac39babce01ae52fac44dedff21426667a03d20ef950728dfac7ee62ac5d63401dfb220d387b9bed79c4fc360fe26bec290acdc56858e6f4683de4bb1c46150d8fd051527b9e1908106cf44fcbcb698962b0501db4c31d00d56a55d5ff78344c8b1bc6fb9fbedf1ce53221c81585d4bb5fab451cd548dbc08af5a6cbeffe4c7287771a4d65825d7ef4617cfde68e8b9ff318f04cf4b981b20e9580808d3874dceddd9de70e0fd1676dba501840c142e56c6bc2fe73f90288dcc5d32837500ccb4507e001035a30b17a83efa4e139fb5b506ad13b039abc0c4f0f060f686b605d2b8b1cdfb450d0ee1ca79847fb0d0fd8795928d7c539f3873432b17c584638e67abe1c5017d263da26bcc9c40d8f90b915baeed18fbe01293e5746cef84afa426211d5bbcf617527f0e1cc3cd40600d0eabbb843fb1fb887495e65e4b60c13879cc0fae8d586e1f3af840d04f55ef2b0145c5b993ab55d8c2cf0016c00bc1663ad33d3cee0900ab2a3b2ebe296cf3da7f166501a9706fcc03f78af2785aa88f29d1450eb46082586361ae671b5f92bd5eaa547732482676d756505f7577c419e265f8d7e647e4c7dee65dccb5a36a44e29c735935f0f3505bc2a2e77783835f563d92c26064891a7fda9afdf4ec38005719e29cd0bc68d97815f7314d7e83ff38920a21e7baff6c6a07787e9c585bedeadd3e4494c1964ac1b7997a3a9b94a3322deacb523ba91c1d0621cdf7961659e1fe6bef8b9acb32ec00376e275186690df2d617417e0964d55d0a8f4258a53501831813077132cdb95004ac6a4014d9b14d162c9ea3569bf329ec8ee0f02cb379efd93b2802ccc4271d99d15a9c7e562ee046b8a3092859fed44e0570d63ba0f6bfaa8c31413b7036f0f7052d09fcc35774a2282537d1986e39768473da3b72e20e4e6018dbcca54fa154dec45d9a3cdfb16b6328de4e5ec5742ed0f03b71b70d4909fd817a3e0c62b562a997141683c4139e4523eefd90b44faf77e67bf4b90922d23273f46f53824f5c9708ff10e799040689f922ae862494d83dc231e7d5d56e9fee883d0b972fbb607793d0ef7627d460a233d9f8a662b70c20ec9047d6b3cb43589e41e44586387239853c574d4a5e24feea9df7b2bc16369646aad1f6d553311c5af8b8969e3ffb3ef9527cd7ea056d999ddb6106e1b18dc7a8a5f312562350cba7d20715c5025f82b31fbc6dec89dcfc3e858926a2caf845518a688b2871c40b64c8e6c3b98a877fcb0278313696cc7860f9252b6250b1e6d1ecd70bb7c308c48f987f46fc5a8161a3cf53e6bb5a758c0765be693adaaed24931cf24a041e429d669dcfc1a7d4c114fc1feecbd8d2fc0ec7429d018899ba8b2181f56049ab8261a5563686b0a0744351dd0c4f98313eabfeecba46671585f201a52b0c93933421dc1106f3000244225e3b769775737625caa97a5e8652d74efe3e8515252402eb67b9844b9eafdf3531c99fd2d7a5382bade8f3be1f7f8dacbfd2317dfb9d51fc5ef4fc82488f02d4b251f96bd3bfea241ff7ad9e1519d42892e7e2e6faf549b08379e86e12a8111c13563d294b3145d841f5854c6a58aa4cf53afe0debd40b107802e930f0572228b9e399b627ea1ba67c4e0b4cea3e84c8e80a75f037a03ba02b530888fd4132375ba6f18f2df4bf1cdc460a87737a7ce314229e66c89e442380fb4c41c4c5929837d575e9b3bbe03dbf0fff2bc7a5706b6e9fc256085677eb49bb9213d9ae4e548a9f4f26366704286134bbe03434fc91de075c80ece6b92ef40c2fbb649f45b1344b4254d9d29d583639a4a06949eb2bbb02dc28c6217f49bfde3021fec1e32752c081b2e4ea277f189c52eab2a29e47bd142550d7828cf16a0a36cb1c6acc0e9d2ae9948df74b241d61fc176653cec0a3e30893b2bd6ea39520e08e79076dc933bb688e40c80fb4fdca78558dcfd5cf8b708231d1e939f9fa59ca619e760c09bc9f6d30255d31e0f8748253cd1167344c87dfa31ec5f90b7a56a71ceadad786ae2741016b39173af0ff20b54d6addfdff9f47e345f351bb2f4d3305fdfefdfe94b45fb21ac0f7679b413a81a7a7c5c5390fc4dc73fc9175082e72f4a4b3907c93518c6fadcf6ca7661222dc048d4032c402e9d215ddeb0988de40bb01c2c45b887651ee0be4a7e3dc40289d3750547ed591e0bcb35cbb85c8b6f34ea96707afcbbafccc927171be18657228a4a405a3bfee19bd87c673149e156098e88b1dc72cec8f391e17c548b466cde1b61efc025eaa8b185b61162e1335cf2e6a91aa2c95711869b93d1f6e1d34439c94c33b71298aebe191c095b83cef018822c3b041402abad8ac6ea71f1617791f075ea0429afe8df649ab6ebb53d5986782ee805ead6e6627e36cdaddd82247b711568cc2492b1e84832f48980ccf2776222f52f879cc4faa7be9b7f132833fa551e1fac71ed62caadd086382ba8ce42182b9ef71187ff604bd07d3762c23bb36c87e968acb49f3ec8beee1b52313a52a706142e2afcaa126cfc7a06656cf7a7451ac72248c0289197549a4fa27b1a5877c14e4907843b46551e6ac661ff286d498173f14dbb7fc8913b38e8d33bf18096273d9c98ba14da9b9d9d232bbfd98853ab2f25d83c4904ab1efe0e1c390a69b5b895e834f632553941cfa0b289d9124ef251e8c168c0752c7bffa1b7a80cbf65126e1ec0f782aca4239a846534c78896cf1770329b7d529e74d8cca7f090fb9cf27f2b7bd8ad8e5c04a74e7d7c33a4ce4c020ec7394e52175b52da3ca79408b7f2e4c117dd43425cc73482c707b971fa1e843dfe00f7b9ea04836cb02a1a50cffc109b779e85fd36043c9773d4de1d3a1f0a123e55b1960ab2320c5b2b0e06169be856088cfa058a8e615f5ad2fcefb53646b2c6a2c429f7196648fa4095eed477fc75b9ce03d8a87625001f92cb416d38eb2875664f84d1397808d6a346596bfbc052c8ac97e48c830b4af9ab7e1322b191d4fafda828937a1a71beb007dab70e51c637917c48eabd7feaf66d87a389166f181843458459b8dc9e580db03295a2652e23334af41e100034bdc44eec13f72f15fb81fe2050a295fe07a6ef020ed54fdb208bbc4ed034a1a4dff96b687a458ebb2216d8e3907e7d233beef314aa95821715fcdd84ff06a367064dd7d218d03506470e1b456f59f07b122ed8fd5413cef9e5e2d3dcf123ccefd31f3178e180676374931943ae690548605729a910c27db84ae63dce0c5f702f7e84d3d51a9e367daafb4f35df72116a82ef2d70919b964148436024e647ff885687c6a204cf5f11f39029f218de5054341cbe866cc5a93ea01f93d3dc03b01b97134d0526778128df130e5dbc103a3ccb9041a78203681a765a565dd525ba30b30bf93af2e5bd72d4f6f12ad88ff105eedb89c768b5215c1f5a8be93686c2f2797bd1752c00df009e45cbe9003bd7a86033e1c478825a6a0e1dbd1fad8e2521c555d87c98497947585fe4dcef2633db4df183009be5e9656347738a007d07b822bbca3d149161e5a8d2005ca98a8b5e9d56aa8165c767b2da5551520d0c1629a41f67a6b58f26b5a42e493fc5a6d13bb799d5b34974be4edc3cee73171045c6480218b7c88c61cabc4ed891f0dbb5965821f092d7e3c9b2718afd55520d728768097e6be4a99f68426e53fca3ff84f94c3e2e5d4852cc2d1156e64f1c154973f693f4321a3b8958457bf761487f7a99957f0b7adbd9c47df1ef4a9d717e16f47cc1c0f383d74b4f9e22fe4b20eb32ed9811827f34037e350409fd4873c598001a97e4e37793aac93a64bcc6a4b13abb18a76af455a23913fb4c74c322d2ee5db346dec6aeab722bfa1820e8b50e2e7e0d04598e651be6fdc831964d324c1d82f0d714e947cb607f8c01c755b00ecb1206666b6b68997ebac7d426796a7217213bdcf9287c4731e2e4fb4eff6804464deaebaef5a8dbf60cc111d4767c8435c9e6e6e0b41f812a14f3bd1aee863d48bc321447d6404c8ec97b46b07e3bf01663f18a706abb83068b5988a57447b1bb907c6ae89254344b31fd21bc66cf02e6951d6e2cd52a47d800d6483bc142b7f1b8b82503dccd88e5299777f5098a9ce665077f2b8e804c7686ba68af835f585ed38c440d4a302c72c903d77b4a5b2ec5a099ce01e4e38789989ab144edcb8f26472b2834ad485d77186233380a004f85f7be77dc2e5f3ebc3160a5739fce394b7901708263391449b56b093de419616d33233b2000895a9539b8b2794fe787a4a0366ae6b82f31f9cd3b6d34c207ce03ec65fcd8eb055205dfbefa55204a4b60e68d25f9c414338b5c1c085abe1acbc7cb9b9e28381d047a6d9563154c6123400a41841e0bb81cb479f7614746f5c2a784c4f333eb41dd5518c8df5f0392e3e0f920ad0f6edb2b2ff047e657344438436861bf524aaa104addfaf38745685ea8fd50283ee11385e6bd1b73da863e2007df4c25bf6251b1fee96851a8071456aaf1fbe33ca4563943c9927481acf07afe966d79f462d4599200b154325ef25f6aa175edc2bd083cfb643f61c8259345b4bc8e78b2299d55aea2a94efdadfd4041d7ae6760ec8df305cd4a54b6b2f6f0cacc27b2d288da9a07a8e857ebbc946456843910d929eb6e102c5f2d115ae3f8bd869550588e3a9577ad94b13b5f41e35b9a7c41240d2019347dc4bc08da12bcb840f97ad55063eb6eb374c238374d004aa3d74e68142f357d0ff2e1950f1bf0341c5d65983448206f75e56050588f6c35dc375b7a770091a17300f37ae51e82848243033a2f7855dfd9f1775d57f4fa0d6beaaf23d2dbb7372c7634239f9b54198552354a839e93e1fc07828f6a5a5c3a3616be498371b7b49bd3723da9118eb9533ec3a16ea7e80e0cc5a00073ba20687c5c83a3c212a8e1bfe135e58d38343ab5fff06342e573ea4fe2ceaabf35fd49e74df42c8da0dfcf8fc0c3ebabbd2ebbf8835005ee43585695aee162bc499573ea6f77f9892c801afbb7a386dc19bfba633ab5722dc79643f7bfc01045a85130a63ce7c6419c20b6a7592f82ff7a9f10785d602448a6f8d0271b633216bced1330bf4b413e88c9c665c3ec71f250329e32d2f3f3439c95f2c2bbbb77b077a55a6638bb9faae42653c754cf61c3f3dac5f33686d68f6d62a61a5234bf50b7127ea9929dba750886e7ce9bb2f66e9a6be5c6b35d28bda5fd1609ae6cb32a85a9c56b9400bbd6eb742caf181325927fbaabc13b5b95644a4cf167b1862b026552b8a8d4840f0331d8b975ab9eeb606a516b768a1c3023125d40e6287661c65a03fb2aa08a2908add0a086fd334664f023f7cdd17850ce7c0de76f6def35f9c1b9147c888f2f3cadeee25b2e880079dad5872163d759fa5bc98b72fdbc3b51f9923d6348fdc1d51718dc5cb32b5e07df736e39971ba84ee934f9dab8f606a84a3db435e4f6e8eafd48dc28db8f5a8295877dcf0b123e8415ccae9988726430119d2e4dea7efaca4f93f5bfb31fd87431f5e33fffb94c910c07676990939dbfa34c031db80789455a066a5359d1e982b79f9f7589e0d44edb1c88203536bc75f257185bf9555ecfb9cff1dfbe350624918088fe6760a3bd4399db467dd44e9b2ba4f190b2448e9e8bd1a3a7bc9206f2f1dd03e0ccf75b217bc1a5688d373cc07da5549592de3b32bc77dfbbd9009919b2b5cb2f345b3e8aa38bebd26dd6102109f4d68a6aff31aa7a9867b3a8e2bb0edb271d279b70e637623dd7f70c879a414e622c41f528653bac1e1d2ac585219755682aa1d6cdc9bcfae242ab3d91230f3f94a87430d41e375b5b4fd53b64a3606e81313ecee36846a1a0a84ce2e435a6cb4b6acdfaada8d6782942536f6e852298f85c122483e1f61c69503a02b82ca5c055cbd9af6fa8186f67b720c324bda09b672f6da562754bc35bcad5b634c5b3c484251a9b8a23e681befd855fcaf52fb9ddc0d4485c515c33d3eaefaf7c971cc293f92e263c10df36f8fcba92d3a5aadbb5ce5214f46dfd894a5ae2e05743f431ca6903a16ea17eeae99931c0670ba60aa893f98bb023254e76d1ca38fe69b10b7861151e6e4f98971334c80632864c735e03ddf1f16322d6fe9dc10aeb23e029eab5cd360712ad60503befa227592ca1e309f884c6329c9624538ba8f31836704b7f6f78927bfaf262cf14998a2b668966e4d80b20ab786540597e6e51ce5b48a3d7e893d810d1e3c23d638f49a62cc65e830dc88f8bc8f3d671818b28b7b77f13a8bcf2541360ade313d145c63c2e8fda3aa364d554efed787bf8cf850871fdb95c36b45521ff68395b1097c28143acf0593ed1dfb22facec86484c432a16a8939fec85c0d9136ed2f743c889c9967036fdf50a9a73d34e1116890b804c033abd8ab7588a4d336ad1c4e7f2dfd96744075187d4c73585df12fec6985a414b43ffe80f722bd8f17815019ab75e0dacf9cec1a6156b1074772fbdf1bf1d2643a23b8f3f09dd2d14cd01541860278ee9cbc780a12ed8c05bef88e920e2644593df3e19faed0a9dbc7837e04effef143a5903fb2db1b811205a9e2406410835e6b0d5b76533931050553154b4ed2b170b0b85490a9de95888b70bcc155902c489d0b0331f13c5d216a17111282df165b8af474424c27f28a359aacbac15ae4f3a0b7dbef1b76e70654b084ba86fc60babbf3dafece62a34df95856df5b65e7168b32757286bf3096fc00b2b913308abc60defb27318917af4e41e39b6ab389c4c4413d64eaf59b9c0c85bc3eda1fc29e5570f2ddc27f7838d0311bef06361cce71ee6551f7be9ce869ce41e9dd2458078cbeb833190933d4c4b37b8e5a2a2540da0dbda16d9ad36e062d3c7f7eef46e21548851ff8cf8d2fb2b08a7835f265492e577eb555996cb9c6bb6218e1230757219037a19c44cfd8dfbd8a6dd53383f99469a33b46aa9118c26642a1ced4e7faa390083f00da3cd74915c3a7c9131e185a01bb9945104c1508bd4f7829c280158e733fabad3a11d6d6976cadaa4c5edaa6a77f2684838c48598008a321aada7e5061917214d431a20a55e2774abe6f15915eb9a6b836f075a74369ad945c06de686315d7c0a6404d9ba2b5bb62025396a3be7c12d24061064df10d040ce44b3a46c7cdb01f81907c93b2d4bed4bd163c80323945b0df848dcd8370330d093ab9c55e5e15b2ae4b119ed49bd83ac1389bd172abb20094ec77d6b7527f3426e6986d31f027a55f3e69ff467f6d3a77049aa14ca1242f41b1ecc6e180d5a2b52068bc094279c044e39194d3cd09beeb7b2bc5b625342ea1a60b85df7104cceb4d2afe297bc31a3db63e5b0680dc196a6a7a3555fc048a85635707b13f72acc152c3c24168947bc279385bb7aa852dbb7dd2333522832a4c09c1b90b32dd6bd22748d09518661da4c970c277a05757adef26fc359876f82a23919bdc132361b7ac1d8a9cb2cf7b87f76d47746470ffd88206b95e95972a32daa69fe9bbaca92c9a53044ca2445f730b62b8eaa3a1574400ad89cc8e2ced6e905460633c076a9efde9cebe2868474521f13f3e5026ff86722f7a34478c04647e7a32046a17e52fc663c3632499abe81ff0917c1f862834e860a606f19ad194391d0bdedcb9fc306b08a9c089c9f8f7fa746946b985ff800543656f46847e4f0e032cc3ee056b8f33336c35246fdd0a179777c1cbd7433d026bda241ef0a5ff3ed8f06d20617e0efb070c5ba0ac7ccba77d231ba4bd0da22b3d7f1621c13a6136a13c2baf8392fdadf14784b296667a01e454e707e34ede24132de07bfd1ada0e4923c311f51d2e0918461a4527103a6ef4907f633a2d89f28ee2115fcaf48149d76d99de7b2e3ec86f5f78d5339ed0982c7d647027cb40826aef254797d9a810b3bdd4b4baffcf5dc9772056ad3e3742e4f8f1392c13d28a1dee239501a633c2b066bda0829b3da1c221ecfc00f5088e0ab5b2fa7f358f10a0b29adff24bda12d2dab9371d09af7e3cd214bb74ed63771104bec771f86b4b13ebd801fe17d230940e2b3cadaa1cf54218e06233cac0e5f3e20824c36a43dbb62d5fe2df89638e9ef70bd6b008dfe091649ce7d892869dc9379a6c88affc76cd69d3940cc3e99b2ef1877c7988f82f3511a0cb9105639210aa7b9ec6ec2839583f8bdd17c47a81a5fed665f0954246bbb5994a5dfc511303e4afe3c67195afabd7ac1a0ff1882e04a2a0e87a6264d48b85f5b6c0cb82f77a6561e560d71fe7e5f339527bfb0901fb98487c6199628f5f5ffd1ccfb16b2506b34d790f2fc87da4bee45b6757d554467c90b2b5d049ba384deed91072a9d65d9b26cb1fa6283c2721acd78f299513c171c20841512d06f9a6053661c1a896cb2b6932d7741e9df9cfb9f4238232f806b859d421e6cb29eafea7dd880612e157862088d95caaf452e3066d50fa3c087415f376aa4576bb131eba4724c47573991a1e71f711af9baddca1972e6015062c2949a2c1114e063d8c919238ff0214fc6ae7a5d3d993ceba30f3d1d92b9f890842f2ddd6d5fcb265ca8ba1ecbd04a5faf4dd10760e98dad90943fb9312d1bc68c6b35c75e2b4ae9c01c343cb5924d0d62866323f5d7d1b9b9892f101ad95068048fb351ff967e8ba03663c23dcd1e3789367f5cc60a8222c468efef19593f4d47315e828a92d76d2e2fee41c7c50ad8a4d7f1041442ccc9b140c9cd61732b171151deec73408bfd468cf554d5b7a9dfe680c280f5a1b94d76bbac22185652a17107864163a63ece52ec1142643b81079dd23486738d2b6301d3a84f7e679a1b2489132b918361131021e09ea72a1a2ae4bb93fb83a32411a77934a3bb126988cb911e3310610256941dfe46c06c056a3418590d226010bfc0e1b2115bab9e7081d5a7ce75aabd8c628915a437674df914a82db85da6ef9aea145c7d48677c02b2ccf28e465124c38aa3021ee4c4a9679ebf3906001af85bbafa12f6040e6eb0c618288e35223089b6b0218b2163f4cefe83dc7b35f8ff8bb820ae756fe0b8f23fe9420960e3719667d80bac47b5d3602a4147d7f3e3c5c4b0439f07117fd61ee584d1dafa8908170be845885297ce03f64626af14bc611f793ca9490ed5ddc664066525f04e12093e3e8ccb42001a5f13b0f4f3c0448507b39c0cd1fe96518aae172fa4f640b8dbd731d79e6f23d27f0a05ae06f380e9ecd35651de375c03410b94216105b7e941256a933b07ca1deee689eb2c9cb59278fff186fd063d9f52147bdba740d06398ec0a7897e97cecc4af9ecbfdec4bd37056240c93923f91929f76dcd31b7df05ee233902f8ba2395a095c7f1d2cd16c8401b56d146bb8aad6c7ef79778cfeea7bfbffc0a274871b1d30572f279036be1d22ba2444e0f64d2c06e9a038a135c7dcdd5d0bb6e2d6a3251d430746d2c429a561b4e36dcbcfe3e6f80805ad83b4a39e21ce8168a89fe7c3c83d6d6c993a9ce2db4e246dac5b55082275545fb07611170d47cc0764debfbf7c9fe645139601ca759546dbb6d43dcdae7026c1ef2579e3dda951d3198e478ad6978c89b1706ce215089390434c9f200fddf06ae72c56e563312f0b822a459f6009efdb614bc52e53dab7b988861b8cac84f569a8095c242ae18621d613cfa7bc8d0967db79bac0e4e0b6935db299cb57b9faefa8bc3449a33f4d8d45cef6fbbfdb7882569e947c5d75730edabb9b7b7c9be335d8698d50b1995a09c0245e9322921678f55be38fe721dafad72f94d62a35cce9161092ae800562fecaddf8ea4607cfcb53aa14b2090461f8c56bbdc1003f64e3b97ee477dd0d0719eb66f65a86be3a75ebe069b31e9a5df273313e47f3ada3c43f35a3db7732345435cffc5115619c852de7853c85a9a1efbdd62106a7a711af6b7db583002dd76b02372a1db16af3977519d093d80324261f86da3b1683da773400969e5f18b7654d2b6c99596a215e47846e46c29352a3d062046906bc0349ca2a807ec5950824b9b606bcf3d572606a38f0513c1acb5eb2c9928cce39eafddb7dce48152a25020f7fa7eddb96155f7283e75cc6f85b269bb4f3839a08b3e9adb1031fb353b1f96f35ae025a471c8cfc5ff0bdc8c3619b57f90d66bf38e356f2aeb129304389b209dfd6b116d07f91eaf96fde2353fc1ec1f5f4a33738d3bf76d2b692fe690e63e6618c767c6278e5e6aa62587971959b67feaac3eb4d6314e374d1b107f0a84e03baab7bb25","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

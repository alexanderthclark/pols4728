<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"912765c16a55ba87d04eee5f22ca91386b5429e904cc099833a5e9bc8f6fe2757a34464e21d32c9712f237f2c186ee9c6efa3d6fa26107b19702d81ae6df7fe1ed184b40b0dd79d087470649b0c29bdf113cfa698027c8255728e6502edb3bb3afc528f4c371a7539b7cbf80c1eb5346beca0c6e5433adef6664d6b3e9069e9c47b128d2adcf93b6b8c1b53bf8c9683816e16d74ed44225bf57e49208a78cf2403ba7fdbb52298c8cd26da9527fb958fcac2e55b3db698c0510cd4e601df91c8c2ac1d2d288718454f5173dedf34f85f2e2c8c860e6a34791284a76cc393e6ec24d57103b1ca105518b39ec6ef9d1702fe83be0b67cd9917ce69831728fb24266b1e6970ca5b18e14486d2fc99bd9a8ed0368fa685bb71ed650d0f5899a7d98327721d271563eee467566f3b7756a1afc933122e44f9187047bbbefe7d28935d246b2b9c47532e28e413c29eaf0ccfbeb20fa6741ef560fdb247ab9b30374e1d6154703d0e5ed1ac983b1a1f781ca19df9dabda2ba196d4b027b5db56b92bcf0f9088cd5ba1043932e20b8cf9f1acedd81a2aed7b208d63a0367397429537b0d5aacae8fe576aeb2b23b147ca92ae3b6af8a07ee281e9f50683419c80dd689ca0d9b2f0feb5f3d06e8958d36855ee6a9c8672bb89571d71f714fb8c31c3995aeff0cfdb9c76418daa69019f62522637d9ecf2ca4fd5ca43fcabb52c508bef53f942c3051ebafc8b0c2eb9e1d375499d87d4625319b8d1143bf962d606134118748188b316444c4e0fb584f84067a98e7e025edc71aaa1492d97c14a859a85c17b9b7c26eb10c6a3a3245baa5b3fe37272fbe90a03fe66715abc995c382683c5047581e4ba723ff5629d316310d9331902bc4177744ab950a679c4b24b0e9c5ec6e9468b3522d14cc4210a9c16d58b7ea21f18e30968b294295262d18f47cfb4d8777bf6ca081ee70f922f87e40854b8a09f78647edd64063cecb0ff68e131ba4802bee2c255f5cd23cc40e62884a34cf25a114a06aaba8300a825c296e6756a6d8b3335bfa801921e443af7bd19a0238a3abd1a49ce84b4662436a2d249046d02fbd3c5ef86f1d7f1bc9d30aac7ce3e3c8951e2aeed1505388a8b952e2742972879c88df6332acea6a2ef15b138204f189ca865b914b9362b463526fa66d923284aef2bb6a4c531f94a7783355b0c3c04a435dd66f69b0a893c867e09de6684a5f1095959460d769d9fc6285f7d69061a150ce614bc7129a4fdd773b3b6b6881e6479b2c8e3e67c3fed760012fd54090d4f8e0a22bc83c6262b55c8499aba7095fc0501e41e25f327f8e73da47fa58d2c13ffcd84d89daaa8598831393022ec8469a796335bb50a00b23ee34548d11f22a1a323145fdabda61f63a4c7c6563fa2bc3aaae7e52ae82a2f5f65017bc4ff0093942344bf9cc12ae25f6962e1e3e23a4db1f326f2d4b216bf3d9b8f78725ef87bd736335224a959641701d5c5842967f5fcd9d063bcec816051ce0642c623347d6afde6a597b7cb463c9712d2ea1bcd9f6c295c89e90c8d1607081e6d11f10e159c3be32851a7a422a52159dc711ec5665d89be6cec34feb56e812ba627873abf43e1dd7a0e8d90ea56701334b40c2affabe01ff6fbd1d36546b49e8e999f6c309c9af610ae696e3205ca909dd8ae928fd87611362af24ebc3339e5e958e1431974d7c3c9319a6335dda52451e3e057a6d8d0517fcbf84f47b9d63eb1acafef96038be7d0ab4417fb6ee8cc0d6f77c036f8a05d34400cd60a94d7f5802c18443012fc9b9b54912f61989a2a3014ece4d6a25d8025a46d3f0be06ad8eac9c469cb78a2827b64fe384ab92212af8a4a8109357168f3e544ab2b0915e5afab601cdfc203f6be5ae29fde890b68b00a14bd9308cf5927b0f266d803909a8b05cbfc07f56a2c539b8cfec3d482598728294a1a7d2cb9b6ede8abfe84a2911a303e5183794a516be0cb1283bddfc269af799c46622ea03ea016dc8856ad15c7ad6b50f8366b06658a3fbe160259d779c42648fc8bf9c7aac48ae94dea6581a979dba39574fbb7e4fd54fa2fd9b0fa0cf43424c8761551cb606e6afcc120bdf0e818b5d3cfcf4ce64f4977a37c70542ab8928862107658112a6a4c9954da74b6b0ab4d95ebe2a358e557369a5883f88602a6da90247cc1c351fcb3eef6a457da4842d42e4207ad151137c4ea2075fe958fe53906af5afa17b7c685569fa0b42437b5f05ea146e1979a93d7f77ddc54a0e9ad704a2021f70b0e2fb6fdfa046b3a559bdc45a707a755cf0bddae3e7f2dec8d84e408619ab6348d74059d03051b9df59b4fd4e19b97b5341f3c3c67a7e3e3f528f364aed55cebd3a4045bea44ba402c7456a524deda4beea2c4d59dbf39095918c93782a07bea24668c69ea12e0169b418c24a751221babcf44ffc77f1b1ed0f0412e4aec7b4696e6c8db7f6440721f0b191f9a0e8a56ae6c9a21166c8b024dfdfb2b671b3d9effcc1b2424079d5d98498ba67d0d0a96b4aae50931b1b41bab49c0849a9ef1243a3539b43114dc7b92bea83c0a5b86991c4d3f33b38a5087528c82165f2d354eec54cf10666d4b978d96676923cfc306628a0f180b645f43cfe92ca31ce7db77a00eebe39ce90a16a2395787baf68f708ff86be4cc2df1c212631175edbb2867b9326ac2aec9c9c75111ec3cafbc7dfa808fa7a02db35465ffb0a8e665d7cec51f93e5eb567dc31226cc58ab51df48ee98401c4b5e3607d78babbcd9dc4e233326ed71f222c795d2d925f4512bc95d1a6642c91cf380c081170b737db37a052e50cac4e5df655e9b2a31bb0d09a9d16965e2f6fe38cb918892a081827bb927a0a7810e7536ea75c52d01a3a915f66579b00af21d08942ef23d058dabaeef1901199ed7665cfc70e3367579571e8251715e21c3f7fd2e831cda6247aa7e5c3926b78e6b8d4d6a6ec12a7ec7c3db7823049ca88cf2517714ef4a8c2bcd2dd42b7f5cded21933a296834d456574be2f961aa7b822d950337a78c9141188d47f757093d99038cf6b69eb1fa3b41f0d362e614db2c7f8d286cb4f61dd73f023e5538bb3aef79b680a1e1299be9b0018c2e57c27caad92c09a3db418a787fc6babf16c56c469bc00a968f88010a3dd668a5458392d4cfa0b0f2819dfcd6bc2002a4e704cbcbf6fcc14957e7a60a1128bea1d2d83173049f1a247549ea04a9086b2f5e287fb9000d4fd39d58b9dca1bcc219ec915ae0103508aaba2248f65ce1b7b16e337d56ac103ed7308679a836b821c0672489c51a49e00947cae462bdc0375648e7e46a8c56c710f16d63f94250030348924274f8a0c28573d25696ee03dd6dc7dd0255e02c8249100282024e734e6736698e88ec2d1d0be07fe8f3937fac83f625166c670941ed4c3796c6f678eb5835d546f2a4830fb6580c34466fc81ed2c730085c65004f5824cef1d83e39a66f3480c35f4bd225e944c30a31eee722e7f4f9f5f53fdb2c8fc234c880922e9a412459e62bf37a4f70fcd4c998d77abc9c823a9f787386a8507475b1b0859b202cc3569ecf05eb8f868083e5690f9702b2e9e9dd82fddf6b9e8b56b00509bed0a0dc3828324a9a4259baf6ad8eec91736fafac8d92098db7ae845c0aafa1fe0be5c8eca0c88e8c02a6fc89e291835d8ee9d83263f5f9a201b2419b8aac8b851f55bfac3765a090c39ae29f2320cb869f13a98898f1a5cde502070599917372b9ab4e8e32009b0d04770d0fb49761958bfcffbf822379f436cb28eef5a5fb026c6683dc4d1f9b865518a6cc0045695e1fcc70ffb5afdad6d0a07408c714f1bd9eb2e53d12862978adc387c3f42aea44e696d61febfee83913e2177eb4c89ad490dc09fafb36d576dbad4be2801e420ec577ddb4410e5ba06266e3a1da764c080649b5659b6cfa387fd9b226240610f92c7f3e67418e5521088c0b1c3dd50cee5eaefaeba5e9b11a5185fd42f3d154706a004ba2a235f47102dd78a632a7e6e29680c708e4f0a548dfeb9df78c4449ba8ee2e7dff488ec771327f5d54bbdbef4f9071e769c1106517dedf38ae8c46fb8f4c2d9be248620f0fcc34373b9d6a1fddd34eb8431d93f7331314c6b8a9a32a7352f3948e0b8bd1b57470af9a8914fa56ec79e3b1f5a89a66fd1363c133148ea0865033bd7064aaf9fdfdcb9cd961019ea79aba514b00d8df519e67e3bb5a50fdc4994894f6eed14950ec2b940e4dfe44b17d5274f774379d436e9be35ef49a2d1f547dab48c172af8d734e446751860483364b056410260db2512ff1e574fae6674334a27d50d0e6e612d84975db1886f2d68ace7a95102de42970337733354df5149726b734ef7a25ee064fbc571c5739478e09193767f8ab496ac153698f41942b10488ee948afa7932c3e93d33eebfdb5babc6c429952ae6e53cfb90a97fc9c024ae1f0b74c2a079e59188120df3c7d1eaef8faeb8d84fffd9bbb5233ac4a797ed91ab24ede08e9c56ba79bbe6a50002a0366d8b19333222fc5ee27281961dc92282ff5c5859dbf5e42d8d842546c4fcc35a536e3572182c9e9c43e8f80fa924d0875bb932dd2ee86aab7c9625005f22f4b541e1b482bc7ffd5f25d3b4b1c99202dfcc3e632fe090033fadbd175f7ec7e567d6d77c1586b6f387142b1d2d8bf712e89e24dd80e9a1002c4be09234f4183de8b8e46f9f46fef92a68a7927ef16a0be3b08eeb91cdfad9d0d09030b5b686b04b441d31b5e5112f516841447c49f7322cbfbfbe79e721ba68ef0de4d6ada407ba51aa8af2b40f09e46b73ce4bef70885d7f636ac81f051cddba7bc2ef93159e60164245686bb392ca5ebea07718025bf3f18f57324bcd561631edd53d97ef4f76c750dc2aa9e5c06ee5d30fb4cdba8af887b62d83a3eec377068fe18bfb94f030e5feed4db6a4727ec89b9293efcfd5accb313ceff6fbf89b4703caadf9f738e324adaa5542070e4af4667c2d14361922c1b6bea7b18205d040f7cf89a70ef35ed2e3457db21072d200229104a6115e73b81d765fd97376a264db64269271a61ac1f81231e3c99c38289ae626c3623b8c7a2550d88ed60435d5a99148c6523ef377246c8534dd215cf431ff67a7893f5d5fe5b5b7b03b50c96bc377990fa24de204fc9f3e6b959fca2e698d71fdeff23414a848db895770b7802ae9e9757ad9528f69e8815922324d2dcfea07e1a1a5b7973394e8c021219d660ed88edad7f2f0a53b36580c02f8dc2b23d8d8e45f3d9aaffdfb7a9c1006dc9211da83761bd10d8f73487073c895248233a26ac593138a240ccfedd5818fc52c7135c8d93a06d3035b5bb376ff6059d8cc58d5559943d2d5a30c1892d216239a87bfc9f3d30271a66cc67489fe1f51ea2a0e13efe095a03d27c141ad0ed3cb990c80ab0628b9bcee9e20989f44d07f24beac3303cbe42cff802e7a3112d9ecbd3032d91917fb3037545230646fffdd6845d6ad3839ac98441cfe2b084d4704b79d811d0287b316d22935f04e8e00366c0aa6bca7260289b9d0aba2bd3512af24fb0a1838ea870dddaf9574606861bb1259a4d60e9d11aa6cd7aafde6e1e54bf609d7e16864e26ce02829b10f246b060dacf63714326d3ab4fea1e99ec952522f2115127cc00f4d9fe71a423085feeb082355c1a27b0daa8efe06931945657f8269e45fb9df30ba3b4821db8ce12deb4ffab9b420a17eddcfde7f008257f029f1f29bd588bdc9cd338d812ac97b3a82a0c54f4e4e255feb8e2d700f96855a3679f399650021ffcc800ea4c9d9b4acd2f69f78b52e32e18540755abb3b2d89b5882f300d7dffb76808e63e6632f46c02f01fe7a5d17c213508c179232a7d44a3188cccb9356325bc3aec96cb3a2201cfab03132b151bc9832c3477bcdb0406622f4402cc8cfe8979e2730a5b3545450bfdb2ad4731b32e893f68e338f58fabb46acce83cb038fb0f2c4acc11319c7b1e64ad1f432e9e4a6acae802e670cd226c41024bf7fd9bf3792e583ae3943117480e228404f8f3596cbcf44c0f29611ce587ad12754f828184e8cfda85b85cde2703b1444456e4ecc443e833c8f4d49acde0b103ab5451c369aa9801bc0485c32844962c276bd3357198ef109df033e73632c90febdef500ee7e1dc40169688b8f225547ab6d51f40f8215ca7d7ee023f24ad7e4cf73c82d4588423450a579e448da4b9e126216133ec90eda5b6ec4b001f0fc8f69ed6a9ed5f69f863ca450619d32bc5310a9eb5bc4f24ff88d63601bda4cee487926a900f577dc5ab4e43802b40ff42176968f7401e0c1418603ea60018da0fd8244e21fc0c55cdfac5f992ed6534add97de4fc64428388b2fe7dd873e6a38da811a0c32a7a3eb420b677bb15be270fd2fd0f048bdbdf0e5b7bc8382460688f998317d33232ec1c99b857afc8a505f8cc97901c4eda9447893b1a9624d213484429494418570a6e30cf2c14bdc9e3ed7730b87b3af76a9a8f20b9d63bb2e75208dc23ff27ec35176d328c6a4fb11e0f0ce1be99eab8e02c3762fbf18f7bab6f9cd411f705afbc70d6a44ad987a1588a50412d1c7ab075cf2967b9b0c68b76bd747db73ae0321c9c128f765b922272abb0f071b818d82aebdde4b859260b45a9bb497646dba4b500551509ee538ba220bbdda8809f6de53a47272f3ed851cd0ecc29f156276be8eec4b22f973675e1cbd1ed2e0a26b92989481383cf2e3824d019bc851f76d697d4e41f7decc751f6946768dbd41e5526f2b9eff066ad58eafc77ba9249b8357340cf8c45c133026d61939fd431b0938227ca6e2337844436f79124c74b248ba94b7a3748d384fd2a4239ceca5ed95ac2991bdefa909695bf4546f0f4c63f9f48e915f6ea3b43059904e68c7e1f11631062019820144c1f6f329643b6a8368804f7f4f4ea9a1ea5f4e7def46dff78714e93b4cbceabe2e4b8a046e0e5ce7561ac294eccdef2185116d04376b5ec2b6dc4cd6bfe177be61eb1dbb3446c9f4cd15fc783558dedcf822933de69bea79eba49d417cf7d0e3799749fe607bb18756c441662101352f9f18e3c1953acc5486dccbc33b7b24369cf8bb082baa02bb0228e2b031a5dce1e10c82ed5bea83e70485c797a22713a6291712d145bb1db0261decddb149bb4df4a6fa8f6f20c3607fa80ed2ad1ff82b6a097c2b314e29072035bd6cc1026564b315ea08d4f5def01aee1bce90a618246dcfe3ced7f8ab6ce3b1b9555ce7208eee5dfea60e7eb55d1c8916e57e6c54894766bfe31d0a58a728c8110d8b3c55a3a0ed68466c90320c066fe1ad5dbfb1987061f90033e35ccdf6b7191147de731fd26a98a0b7e21e13f4ece3a0e4106b33f870ccfac7004baae39662a2ac99670e524c941ea99e7704a2f9d5b9dff273c10d7d97a37403493c9dc2e8adb50ea1d75826adbbd2cc7ab238170596f3cc8698b0989abac92e31b5e557e9681d7610b1c5b79551a620775c4d21dbc0fed785ae55ba6ec0478b2cf321e141ebb282d0a1f360d7cb04c6cdc86c2e6119546df52e7c137d5ff6ed09f110ae21cafeacaa5e96c2bc2667a2d8b3154f0d60a4fd3fc76b583d9228d3ba5eec55f7207a1212f7b16e3cab8ebadc848e1ec476af2f363fdb46494c381d3f6266448106658010c74e6d061c8539e434f688ffaf4f903179e8799d8e7fd4ff07c8757404a469b294c446664289f3f644a9848023bdc676e737bc2516630be1797459c7be1cc35035a4b6b5b39e5b6600508e88973b0b3713af3bc7a30131c506a9b57f6c42f7e53a51dd2648c5d2f10585f52d7553546bfb023264fd7a65a62cef0fd44bc88b8db8daa0264bcf560a8b42899a8789a22056a768ea2070f9077e5f4954e9cd076558582ef73ab457152c105623282fb825e2ca1a081066847288605c04b2f6f440108041ee52a5cea5bb49cdfcaca19c42d9e729ed7297da6c74883e219662b91d6544c9ae08989c4155d6a1cc34f94f1f773236957897c19f63d61d11dbfebe945a880f26f3409608fccddb9ddb13bbfaeb4911bdd6b847af99a968a7e67914f02eaa9f645cbde32c4e7ad7a2601ffe9db243aaf29bb37cf13f64164bf7b2bd0b803a6f6f057a8c24817686fdf6beb841631d068e28aa0fe033bb7f42e39bf64ed483b9cc9bffde83465ccdb728b2743c91ec15974fb764eec60dd373999737db89496c613f8a21ce9e12005f3b3d94c706778f2a03bb580647f2fe6125fa3141b93b5c31d81d6e22df512f76022246ccd39c7664c861aff7c7326875bae4187cab65bc6a3accf555fe9c626cec79a18985819168c24fe4a915fe28d7b41ffcd1456d03996869b0b7e76154c6502921e3da17e910c289906e28168847af0e7734a8894513638760ad21620cd9460b097b7a9a1e0e69c2430b417ed24982f8aa893bac91d6520bdda766cbd118a3992b7c682a4fba8ee0352512be327bdc47966da91ed4f1a203e22a72b1ffe41aa8dceb871914c36dd6188531cdfd9e3daf3054825add1d194e199a335fdb4a376a7f5e54dc82d19e3b496dd0e5b97402fcc80b9fa85c5d85a7b8313afe1fee4e12757b34680e5d4e8c1f8b5e6a95a6e6ca3213cd5852d3461901b1d58b4702cc620dcfb149d43558f422d84c46801e05246390b913787ccce2557150113ed470dbe29cdfca434e66e0cd5bd184177635ba2a57caf746991daea3cac7dd75f0813fa90256872854541914345cec0d168919fcb01f6b1b68495b1356330d2b20087d9f9ee2725243a217ed1c033adf3a608d1a0b0f6b4c0c2ad04aa754a3c89f90820ac41edeb8a8e9e5fee2bc06d152ec9f5d0cd65d97e3440ab9583e052009015ab02840389392881f74ca03be3121e9b540b65f140181d1301ac8c3f8acaa5e1e94f932004ccd1c24ee557c42ad9d17af181bd8cee0c1ece2b1dd5be347eb9cf6d7a6511afc167de56a74a13b390df1ef76f917ee40c6ae4ccd3d358109eab47228f8e71c85f7f67014df5f9bda6eb8a520d8f75aaa4d30fe02dff22f4b7406e64d44c00eb25e737c75b90c22e075c8da374ddd8afb3d2369107e6546c87849c8a049a50caea8451d0cb7a7cc9084adfb10625d78433ce8367f05302fbf752e58b597e33792fac26dd8acc4b23ba253c06d65103f056dbd277ef37eda5d11b352649edf1c63c252cd72a34553819a40cdf58d37976176c6200c8b5ddfc94b5e5d45db3a68325306c871d8dca6263bc128517c857e1ac94b2cbcab8b8d49452dda52d07763bc37f6d13c24f40314f365a559f19035812bcd2b04c6497dac807b256be1a9a0d49f951e1c232dd3bd0cef4eefe58bd748d816303fb47e407033b4aedbc843a49323745b2eeeece95149ddd04428d878a906eeed4622273c069c319d4053dd23eb6f752a82c75b25cb024367126d5df1e3f852440a25b31ba7e5a40494971bc416ed5398fc45169fb7efce2fe70655eea439f330f96b90d808efe18af5ba73b44e4491aa425307c99bb18534fb217c63539f9bf197b232d581bea324e58ef708eb7888f0a66171f926445de2c7dd057713a0eca36f0e19997936bafb397668effcc9672841e955117bd6dc4279fa0b1458b97b86b5aa3e0b17fa09615addc64397716048d29909425d20d3148978c3d55c03149183c466e0b194bbf8f72809b04f0e84630c751b222997b588b0c1eac36ac19e1d53419017ca21a9046968d8337b1c9df3fc6744b5730246541ad11cb7e07294f1aeb6c6f4802a049a82ad636c44fa50396e0d5e774a2ae7b119681c4d2f2f3eb2e0596eb7d11deb95206a1bd2ba9d167f391a8b40e1aa258f6fb90e8c356672fcfb4c562626fde035d6c8e743e6ae18e552015ea842ee59d7422aea3af6a9457bf8d4ca17051b5c2374250b0600ea19af58bfd8556c45d8806392af45b90e38eefe33579ab422de4d1741df121ab8d67281c233e1f9010d6182188a8a2ed1adbe4df4a997517a9557c51046fec25814e8a4877ce50c30248efa0fe326f83234cacb12cd30116bac3aa610a3a5aa4f55fd6373054f6903a476404ce07e5010cb1414673c7b117a6303157a513ebc0dc11994943659042b6da565c49562e42c994281bfe560c1544bf3c3045c594126df553d8ca6a3e6b2bb73991aba9fde9f244c98b00a7110076ff150060ee0c58c42d81dfbe96f78970924d73fbc1ffa74d36bd6eb34d1eebc47cb5a7abfabd8bb3a7e0f40ca6e9446aae3ccb590140a0d43d7b9028442e28c1e4105fcabfedcd62c5233b11d089c80770d702eedb2e4a3289aade42d3c2f7e0a2329ebcfff3b0d5ad6ebc15709963e2177a31e788c8e33010165187d4edb966b799c60f9cbbaded18d6df6ae6348c9dc933aa4c9f349e500aa2817b532c9493e61638ce1d70b513793e84dad48471b9269f13dc5533d9b4bec58049b4ee5f0028d661226e252b92a019629ece0d138a4a7296eb7b493c6bc90e0c10a3fda8f60707c29b4dc86422d7d8f3078cd17153d15d653dad1a21630b56c9840cd0afea73ddf9dace63f954d0907a133b0430f37849e5cc4f30abcae15e7d71f3bf6e4ad82b2f0efa07520fa9c08884e7d3d84fac24bc96733585b036819e27576585d975a9979cb0820f3f8e96964ac9370c735dd4c5676487da7719027e84e8a9a667b6313da89781fa4034d0ede1f5e9d5cb2e53f785c07221784ab723c039eb5435a8d29de79e6324f5574313fd269df969c605c7e740da8beddab83553e8646e38337b1ccb3af48fc649eecbfea88fcd0a9dc823eac9c2d677d1cf7c85cb6106b67e90b9829e9a9cc20f2eb3153aa12c59186b0e0cea24b76844c393c8bcd7ff5ef82d67cad4401e084154e35815f9e28fd3a42ef3cc6c22d1b08c3f111ee4b6041947396481e04a329d46ac09c1028c60bce99887e4d6a4ed432914d48d19f12cd1d5b53710a7f938dd84091c85839c5198c7fb2e26c7ae6b0c2c5b245bc9508b3e7bb377631bc5347cc576f8979a3e13639935fe69b33a8e30725cd73f2ab2f9e1e4b5990bd1a9cbb376487a6cdaf7a2e1761145da545968d5332c065ea8abaa33a38137cb11ed6f2dbcc840d54a20c56151d1f41f4719247e2de1c10dddbcb7d48d4d8b3d6bc02aff2fe8d0bd7e7f60c96da3c4ec66dc63dabf92fa05f1754cc19e32200e847069c49f97e3b54c59c8374b8cf8e40240a7de5154eb0584c694004dae904ce0dce142f8f03afcd747fa2c093e88b02b258ceb2f6541a604985a9a48bb9cb2b9fbf43951da24256e60ff803e25f4235101cbefdb680fbcdf3fcb9ef2a21392c1a69758ce09730f5814351189fb3870d0ab57952ac83c6d8fe59b71192cf1aa4e9cee56c3275b33a0738fffb0231f5a260f9c4645b11d4127072777ef69a356987e05a6e5ebbc4ecd68279fd0033282937e0820b093b071737591fcddc2ddec92238a1dacb7d1a6b7add275eaf9948b055656cfa68cd88b7fe44488a4a040c57ad7077ce2ae22ddd4ac55d55c059c8619007a3708158afae21f1c9e8101a580f6bbc1481b985af2425a8ecb69201b6c5676cb460d04d062f82663b47b0b5222784cc9bc4d2e3b0784ef76d86fe3826a4745d0b79ce92f1b5cdd368bfe4f1d596e0408bfeaacefdab99c2eff5ed76f10a7a3c4bbddcd724c780f3a58ed3c26dad8793acc4ae135d6c379f1696c85da26f0d7e36da874c8225a4f8ae5342b9aba601f80c6be4964a265eb0e32b0104153675f26b8a3b0ed47c3c1737673fb0fba6b4aa4ae8e264e1819bff4976b827ee04cb4a166dc2e85b3894b0fb82ddd8c242cdf6ef2853bb1c11da3541cc6262d6b2202e79e8def869879c5f77741672a7c0161a30b372cc35194bb879040a8a503d00ae5ad315ecf22c72562c2443f5b0069358b189e1381a2da781c79eb87845ae8a8acb90f39c716840a27856560c706ec074ad1667810cd375648e310baf228bea538c686065cb5d570de4dc33e46aa235a96f73100b03229041e5a1754d2b4b4578c0eaff1975bca4959ce6add15c13c9d80d8ae102724770089dd8a91ae3b9c00731b76153b347ead34f19807de36156893339f6be9b2b9dd13cb47fadab270225dd8beeacd122b7e76041e414826c32be3dd94ad9b4aa3743c5b9ffa352841d08de3c3d04c2a86d6990acd918756b7dee67f7a0e2b1f1b57d5031d1d816f2c6c66eecaa9ffd3504e78a4082a9be168c60c7c4af78d82c40340fd9e06418929f241c016cd046764d7dbb7f31c2cc0b2b767c74f170b31378033ec64d6fd1e5a3ef0d75ff8418920a3da0a80d65c0083a9a1847b42127b5f18596f20732b65104b94f029822ebc47fb72ef7311da278a8da5292d4bb53dd7f4f245a9e94a24fb4118535d07854fbd4442f091ba0d7c7ad4817a627bc4672db2cc78f3c85c57f41d926da3807122fdf43ed5d920044971d54c6903e95f43ad385d45ad7525c182ce1f893662d23ae8f9a993bc48394488b68c50fb653d97ca5550bf27f173bc2030b20a7e84dd0bfe4b3e8e360153e2f68876afb8a53779e212cdc050d5e4468f70bbcfef812c6e0412c6464838254088d30c8f6dabe729885b8f7015f6df802d9d25b34656c35af8ee96db1e3b8426681dc11505875c9f44903a2471b520eeb26ff4f893475147d6830ad12b7ad9e01d8281ce8654d8afebade9eb99d583d209828756ef57d33b1c32306543372ef3c014935c3012fd1c3ebcba16f4d92d49bfeec67a30cc6cc11210a4dd1d5d394edf006ddc1621c7c28304d7afac29d94b5e0b7c64826c7f8b3cf5b70a7d58973b08e1693ec335fb68784a4b42023fdaf48b57f59cc6fc140d8ce3da4e0e43021e818dbac5fe95c7cb30e3e698f118e56d1b70f5b7cea63640c4a93d2ad84a3eb09121ff71acf4162374115aba5bc8934e9c5a6751bf56461f385608fc073d97c52c2ffafc62422042654d1d06ac7faf0f538a61eb1b8f8cd1e660dfd48bf263cfdb312aa84348425f8410e850be29f5da890aa5d1b13f7c647709553fdf4f0744b675a185608312291b61c98b7cdb1164f8a134b978b920b5fd097d33369828d828b62c92da87ba5dde97e760cc051503e7834232c2cb9a51d4f30132a5bcca4f8839cf8fd1bedc6df7ed830647a622b5d0444ceca5524e0dba19e9f372462146554233eaa8af3aaf71669c240ae9225f0b29103f631b8a2a4dc3904cdf15e9a626daae87898e6a0a3da87321ab20ebffbc45cb43a4183e0476bdd8a6051987ad4b7b31221434e78e1958869ab2b7c888ad8094b8d60fe0377b6376a1c067175ef06b9f9aac3926d3409c29bc5674879be5f6109613679bddda64643a443cf5d46e7abe31b70ea94fe3d9a78d9afcb5ff3cfa34d91ca4b2f09be693517cd7cca8c2b5f035b1a25bade96f2216d6dc5a1aafe5e380315a277f8b124a630df2834f5686af27358d760ea8387eeca3250fb2288f360ef1c9747f2e7b0bb4bc52e250ec5857b0d1aabb31ed6dca78e08418c4185bf307f41b462ee8a10381f31710aa408130b0b246d58ef49397a644e3133c8da550038819be563010a98da6429ade23ed2152838d1800f3d82bdf5d52961bb6b7454d5f96cc09ac3a26bd5f11abf0fca84c1581482ab14c2a0160b6d91d243d39048a07eb0c47daf669fa8a95e80d99baffa7e76d0d1b938ffe39f985518844ca93d698accc9f5e0a2084af02efba5678c6ff2944665b0ffd3ffb9b896ff52f1195b6d075357a458214293df5da171835ad0e7bdf9aceebb74692c19ac08796b7045e4981d3ebdee723f45ae3c06512aad210eecd6d31573eb9395c2ca7b069e18b23456b0054fa6eb3e7063393fd86726dd329b19c5f87bb471e968ce8e377bad0b3122c44030f572d5a6b40b131c16c99fd61f63d05b555c997f2e91d56a3b9c49330ec2970b49ea95c8881e50b390efe9ac267af2386322359a12f7d10e1aaa2df8cf8ac4c5d5a5c261ac1ecc18848aa85b8f201b33bf02d95a6cd75f83f5e375203eb2b73de065532239bd6d64999a526b40950f6e366c0b692efe445f39ecdf76601cd3719886f178d47d20b3741aed8a7117374e33f152c69c8c8fea453ed18a7d39f847e38db1d5bfd5935600a92f3fc80e413b9522e58dfad125e89a5d2a80e4dbc10745a4ea0c9dcf331775258f7c8f3d4b8486c3797bda92bea58f29524a671a3ce88d7f6162325504a689f4f03f36669ec4441002069751a08e97137280bee56a85ad509a4357d4a3411bb8c50d823c3ed42677d94a93f8f9c70ec5ee01839ecad7a39d0c138f1bd0534d25bf0a0cca290371ad1a414249f7fc3e260a34a17fcef95d20b7d713f0dc67b686459fb21e968764ee0dd54e0433fe99aca8375de066a88bf6b5881c662a1233b050437b5347a6346be9ca5e9f5f1cbf3f57f86472db5cd4a0860483086ba85e06601b0f0f60d200a22065916d6bb2097049617db01f24ed2a5468b6e87398b75ed9180ede8826b76058465bbff638c730a251b58110df35c83c17d350488577e7b9c25ade202b8c078b56982e60a84752195b60467223108857c227b5a4896ab50db89f22961417b860feccfac90b662c89d5fa3ae90f6223737729f2df583fea6f6d89d1686144dc3ffd8051786479356bf71c2a9291a49259e7926f7f4370b4463a0b88ebe66e5be14d65ac5aeed138dd0f95cb07caeab2cfdbdab6fef21475eddf8e1bde0cf1bf7b2701b7dcd50bdd15579ec06d62eeb1c811bda249474118fa9b42c116f9970ce3f977b82fdf457c82c0c995a9526c7d22ec168db436443ac3a0ab9e2d10ef8f91943402bc8172e9cbf2a3af719d538e71e578293c2d8a92cfbcb445914b89b62e733f04fca51a581169838429b858420facba54fd78a01b41c1acdac4dc1d26489eb33f7f9334af6d875ece89cc72be4889f4eec5bfd4f61114b8ba9e95269b0972b6be5dbb7855afd8518f4e18f02820c4305e6a3e81396341d065c05a4775e56a29c40d2b0f2e53d620bc5d5990cca98811374d9846d7ba9eca3072d6f95f137e1fe6f1a26ad220778f6a52f146bad2e1f03011798eca9f9195db2b7e3eafab507acd5f00dde9276e3615af7b1379171e4a24d86a14535a3138e7ca6259cbf8c69134e7c8f119b8906da280066956dca18f1db09d7131158c1e096253034117133ac096035804723bf9b177792ce7380653bf7294f72d267b614ef4cdaae75ec9bd96f63cfb49627ef2dfd48efa00ff6d5a8e1de87dd7db12de2b75a154a2529c9c2d5b2e7ae8cb27a13371377609b40159693ce62eba0e21c083f66c6c256469970136ce776cb9f0283a9830bfdec9968e683a120cda683049313f84d443f4ecea57e3bd453266a53d5d812956e709ef116892742da66aeeca6bb88780f010f23d14d5aa6de9b4f9824dc2f6fb0d2b152502644271da6d0566c978768aab08fb430b95519f57febc3ae992dd94bd709dd2d7b911664a468229a321d3f38f2c8720a2fc485bfcc0c4b5ed2ca6b7b6264ee0d46ee1fa5ef7201007898cccc922650333d34a4e360a472d0e64a3dca8f65dbcdac052ba83952d694f7afb12f9666fcdbb88937e073394039e1edaf82435f2b0e549096d965579337b8e2d57b38f2252009ee296f77e17ac5937317f1a4e0efc68f0f1c576b4b8a58e3b7e3e5c1c33145f509a3400d2124babb70cb2b8bb6ea2b83a489e9a6d74ea830819bb77cdb0339f58b158c7327a52e58d2b1fdcca9b531e7b98d6d315e75aaf2b6446bf5b84bb31f6d999848abc42f0c52b218b1f57f88b1104dfa34ae4b41baa4631daa4678385d59011d76715107b0a12af32ba41670eb927061db51e6c6ebe61efad7f1543af388fab8a86b772e1f8f86ccd645886812d77b89bb7fc89e9b5e3b4cb2224742d5285088748582015407b497df8d039c1309a4e9f5644f3060609d14245de486220c1ff0f01b4d8cbcef7f7730563804c71e1bcefec21324afb3eebe7487f828be498f4fa779d23e413495d52c8d822098e152de806b3e2bcf67547deab30e956fcc380ba9bcdd117a37d0cde57ee0cafac08dbfa6c3553e76a9573363b723f268cfdfca8717154931c2e3a37e92d7f5211296bb325a46e4e26460b373dd79d953c0fd28f8fc0de8a86e9345e578548c1fa011c1cdbc0a1dbcf73246234f33c73f355da85d9b9860f85f2701bd102586f90851525767c24145788db8b5f928137f9f3b5ab5b330b02a67e791f62282f15c6e9f2ef3abbba8f6f3c55cfdb6ed7f4a91d669bd524e31fc4b83a5d626b244902d0a4ee1a8a3c3a40fee49fc98c7e36ae266ec9f02c7c4f2dc7046ad2fcb0011960de749c3cddd945a4cbd85c462d36c4b5ce8bd0d40d68d0a26264b1088a202c53c510fe279d58f4dc379d825b8e22efa8b897d87642a366bd59c996947d3a1f52db04e06620ea8f661b80448e5d275f0b4004c4acaac185d94e9d77121f52dd57d22942991c51656848f54289e31a7406b102385c2796c813aeeb9299a488c7b5aa5fddf8c82b733c1d6a85c631da3dfffa2dc2647217340e66ae9561b9a81592da657b794db9c85efdd9d35aab09b9b7a8e5b6b403b1f6aeddc8c78b396505e36e7085918238c8d25fe66cd201a494cb6d4ce1e16fc13d28346c50fc4ba5fe5cce5226b8430f358ec3ec61455a6d62c314bffc9668447674f45e9feaf88ea73ce89276321e528a53548299a8cc0aaafd1a2e54f1107c5f6a01d9e6b810ba66fc20a250f08f7c53ef03a72a646663ee3b9294d99475af0712358ec469d6ca8787c196e1aa68cec8868cf915ec2a2365408ef5b3eded7e12510a0e1ec0d63acd7077a37421d36df52691d32e6676544ee57405a49f40ac59a4ded9f080d39b22878d7cb7c26f0b5b52189b50b6ffa137ed5f42ff668d084955ea24cc7e5c28fadabaffb1f58afd69a002c7130ebaab84d99a9edb8879bd2b12a56db9105bac079ba8b59db3fc1e1a0eaca1a229860f1bbc31b7384f95fd74b0bd22fd69063be02a05e2643354f09d7df415d87863cab49eb9dc7398efc8a414e243919aa2b03e39e0583d282f08f879b6acc0531cf191a3ca4582e22039850087378bc4c5808e0ebce1180b7a34051eb5ec1982a4d14fd51e78a717ce7cfe8221e8f7318bb4b9f2e5c4f9ecb830106d297b1fab25b83daed45639808480050c91398642ce7b4ee963f3bfd3f5b284f10796f25e76af70b9e33a10f057af9283b1afda5fd5cb2bdf649070cbdbd03100be303f8bebfd85ed50e93f5c1503f6a796816993c87435a9d623b545a0a8ad0d689f5166258718140a090588b77f31e52659a6fc0381b4c9ba2fe67d676cbae372735150112f9ece71dfc093fb45a335b856618e05525b26d0ade2a52ef5c7dc2297aa31de3b3f64bdd395e4dfb3bc1cb12c4a4d4d09d2dd9ca5e8aa22d759fd4469ac73f6775e7c6619085a3062e22ca972194cfd41bc85a6159c0213b42321c20994d74c4c6ff4116afd236031ed48d56fa935b5937793179cfbd45880774b56a0619a259373d2e9525a9fa9009633681448f75f63c0892dd7708780fcd1f0236d156235f1e8f86bc53c46a3baec89bd5ba680cd819a5968a7c2a6975014a39f20251716f416e4871edb85bb54f5aa8fc34202c97b36b924ae2283836c132a18e75056071b85082809fc5d4f282bda815d0183e638bad9f34a0bc60bed70ade3020956fc1849e7cc86a57a94a85ef12249973e05133f0e36d429be3a647a58ed52229918203d9c1fadd1efa3fde81a5adbcd55cb53ac224f8fe88ff684ef11ea3c00c1a81f623b6dc8a6f0a1cd5a34a51fcef664374eafba0f416188420a2699af5bffff5c5cadbda6e09f7d532efaf2d73e62a8f5df0e71fdffbf3fbc8091dc0d61518d3db8571279b6cb67f5abf376a1774adbfdfafdd2feeb57f7771f762e6d12bed6a2fe8640a9d27f75d9fe332f67efc57e7a097721e3418a3ec40317b8e2c8d98b072133683a49e7b6eb4c7f8205a7b8a0f8ec70bb44daf352da84fa87cc8ae0fd586c879dffb28b92909febb48868c055ca6149a348586f0b6a3009be4755b1763a3b0e3a000e0ede7ab85aa2ffe40b736a361e8036e758faa1c3699d7cfbad2c62d2bf225f1e942b89df9aa6c6cb9f460f87e0c2e03d68c5b02618b60cdadcdc162b22e912f467193fa4ba17bcbbae6fbcbd9c59cc6b8c7f0c5a178e8dc27a1bf022c2c5a13d2fc438a1b82106a845e97d942660bd15a2c63f2bff65b5663176b953f29560546717619f7e981620cc12a157f868b7426dd1c81f0f6f9faa6c9ea8e0a6bc9f0d1e683d904534c4b95e40608a96f20e307a8e0f58dc3d4ea752322afa501f9ef891aab326eac02d7ec0bc66aafe0b83a5d8d56d101826f899290ad26c532f517fa9f93974bebd11d2db4123d539f5014220b211d90d2f5c43544c2e2088c23186b1856381d4413b90743a710ae6e5abb2a95a055a135931e1c85ad77cb7ff7b1f001dfec20449de94713d360903728802236afe91216b261fadedab62dd123ff631cfec824ba2489e08db6ad6b43f1646e5c4a09129be46f1bab9a99ce71cea3e2c53679e9aa0b843c23067f01224dd84a3ba4fbfed38b9af8e386e2661ae791870feaa4321636b5491ed257da7bb151962ed283c7e835c3168e762ff8ffac72e103fd0645043a52761bad16f6fa39931cf2d403d23ae73534e7889addebb48a751abcf078860b529851bead6024e5b5d70f2ec18813caa6a792791ba5088f8230505a04afed2af8295295ee2c8d45c704cd4996ecd892a9e0a680a69f397063fd250d38e32ed71a4bc17dca7a9a618204fb792f96d003a59e74157ee45dad0a2f7fa682762cd6f6554c20c94fc7df1f2ddfa7808fb800d632a81a05afd3d635c79e357cc3c9ca10390c9cb6b5fa58cc4332873c9657aff0f13321a977ce2fcc8dc81a402b27439f0fac536a24c4e72494293c2f978ad378e6b4176d0758714edc23e34f3431a1400c537617d8b804cc1291730bc3495424cc78d8ed1f64f2b4546793288b90761ef8f775fc8311b65fb31104b038123704e492378603b5d1f32927ea23696f0695b36168fe3e5f313eb29ae130ac1562cc183946af419e4562bf73ea460c8230b94a69aaa8dbb9e29b404022acf6f6457e2baf82c532663283373d2796d47b615598fd0363292faf7b1f08fc173a31af73010879004c1f963e1ae95034f581568503c5ca4d31c462fb68b151ade4458e3a42ce4087d1689936060c2c92175caa53bcb4177a318b3acdad3521ffb34f0d267f700a06568f21f1e77bae7e8b3bad57fce9ed93e5bcca7cfef249bcb5847283f7f8e74b37a92b782fdf3f6acc8e18aeba2943dc03e5723ab74d1221f40dd76891568d88ee74d3c762bb8ca7f3ccb1c2fed47d6a87871f249365d1196f0b329008cda6475fb6bed55bf5187ee6c50a9fcec094e24bdcd696c18995c4bce78f06626d9a21bcb6fbe2c4f147ce5f75538185f6911c1675d94bff836cf587d04998c18670fffa5a009dbb184da53a4719a90655baa0e86b1f44904643bc81ad745ecf8247cb9642bb1333151f882d39a6ac5a0dbccafccdd01130e722b51469f8e9b7bd7b5d2d6c0d561ecac90f9710257fc3f468d487b07af266aab315301798ffa7ba0dfcf2ba555663c8d5bace9edcec29ccbf8fba1d23def3ca41a72b027c362e66d82de9895cd30d510dce2c1fdf365f26310dee547d8f7fdd366c9ddb515508cefe1e7f1e2766bd574cc26ad9c2800e2b959ce60bc8af2a578ded8e50de320433e0a4bb1eb6667e0e7fe9bf32d0f6c41de8a5c525f933fb0ad1af00998a8d0aeded590102ca5c7b10bc7c63204b7a122f8d25436879ea487b4d337ecd3404282091de5bf9d0133e36f34b19db8c597d33b798ede0a4e162be125bdedc8379977c33eb5664d85d2b29cb4857a50e68ff2b5660bac393526362a31faf6e548f36e0e3ee11e2e785e29c8dd23974c311abd124f478001eb38abab11cc7f9e7a211da88a32cb0c23e88ecadcaacdc59664f0c56d7712e5741d18521330f515e31f9654d3e9d5411862433ee22992753f3cc38acaeae3b49364b6a3621a14e47143493f70d471de537883f0aa1513e2e856d6adbce612589608362ee1df69a735aa7952af25006c9d6429a579eec9a427339f4fa824f1f426d63046221873e13f999f3fa8350b7b93fba0b23397ad12594959e81e0888006c588cd9cc5d3d458b70be2f6c3b6ad76c9fd128ca04d9daf6ef392663cf9bed7ce41f1b6d70d6ded2dffdee6afdce49b019c76a24bd9a2b40707976e24f0788310e773b6a0730458de5886344b471dcce949632fb298f7ff1bba266e751db5dfe42721f657f05b0ab272c4431063bc8a60034894bfc32217f347b18bd93282e6720804482a373891ee24eb3279d2d42263c7e362b0db3f77319acf46fef3d682e41aae898e3bdb1f0df00d833db8e2ebd36a5a55031f6b3acad7777f6e98168900834f29207db4a176b0444d9a870f9420c6782cf7e8829183517f4835b9a4bde8057b4e6c1f27854f079bb35d0ccdaacf74169a8040a7987004a2b3a207653188c8e6c4dec4c500a802f7d9d0055e5dd3f76bf627396212820522291d378197e50102ea8b74a04ac6d1dae68ce0f669a7fcbb2b8412ef6ff8aeda12d35d137b1cbaae51039fb4a2c2c83ebd09fa7af9142033c9761c7b80cef5ef0c5d8641bee","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

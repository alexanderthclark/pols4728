<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"dbc46335f262a88a190d79f155b2e731b935b7ab8d20d1a6ce5933bb1e56d93ec7451db4cc8856b3a91913e44ae234740c322096591eb9583d9fb31e5a2f94b06674f3eeb559937419965c9f2cb395514ade48006d9e35d499705e4b5b5891f4015341da3dc58245dcea454cc9a9e401f4b31435e1342e43a3ac2ad3aaefbb795484a914386e8d9d3b7c71f781eceb517eaf6fe2c1940e92e12281cf5b61f2f91812d5e242bff1edfbeaf7c6549e58448b783a6068330a44c2d4ce37ac7e7b89325ef63e8f6964f98711c69651d165a345b3a14cd2358551b35b0995bead86fb2f2f4523be1273b6e7023ebd5ae81da0294ed67d2a93ece54fb5ff0f69408546d7b91662da40919ad8f26a54b90e04bf495a6e0a7f887d9f0f0b9f72e3004585f0c4911c9388470d479b204341e2269987978bb5aed06c2f8c520d8aeabb88ce1a9068562daf444288b89ea68aba1c8152aae93539f32965241401a4e7f6784a898ef865c1693636291ca96aabe2d5a4b1e858bc95ed4dad6966c2cd78137d23b4ffc38c8789024d7413ee149059f40a981f3e94c1000a1a7cc56115291903835f2861bfae88a91e2fcf8b9bef2d05eebd7ebe15238d4f7afd7a74dd93175daf6f654785936e847725d0977be33823ac4c1c5c70ccf1197d1ccaad2f701e967acaf859c739e32e4dd986951a7df6b49b81ef59069a098287c225c6e50b59cf2836a652e8028ee49e1773bfc9eedcd4ab3c8607a2a9dc0b7375dfa27c50a8aebe09c8cdc51460c8b14bb9feaf81931554c264de532186796b7026dca064a51b087563c7cb2762f6403789492fa0f6e2c6a93ab469deb4d1263a59c012ca7a72d2e635fd81b01457710653047fd36ee92606c21489579a05ecc119b88817b7cdb42227cb705d4b4cd96954070fddb33adcc432e6b2c6f03b8244303a7784d8fdda3a2c73bc59e0867de33c8c4860a37d0e554300cf5cd041c4d6ca8a2380cf1db2d87d55c23c2f190adb479f6c4589c47aed94e709462128a669aadfbab9803cce2de3a102ebb0ab01fe2bf0a1211e49167f204849506660bd9d4ae42c2f78ae59a51090bd4ec40f387fd0293d313b6932e89a7506428fe80fe32f626dcae8d1cc03eb5ad5df094e1550e1c15b24467b03eb83b5a850cb6752a28c4c00bb5868ee668d7b01f1aa11cd3523d2f6ab773f89ab2f5e276af332a261f422dad3f5c0717b3e16d0c62ebf521c067e6e80784bb3db1700dc1148e194dd0ce3ac0daa33903bd1de21646c0e9700399856630cf1957e7feded673acb9a7b1d4939ba75e702da59bdd17181351e5b199fc208f921abcce2d1f86630e4e566494139494560b5f4a946ac02c579c0475f8d56b8bffb0521af0e90c62a6543fc0742cba5b9e96ae9eea0de1d5f80fecdac8312873847f531f0f39b9efd6ad285453636b8aa117f2e352726918e9dd929125da1350f79a6f4174fa9cd6ac28c5c3d1ef1da4eacdd683a3345bf85627974a7ac7eba60b9541fc80e82f699c6ad967cc4c1e0a5f4636372ed5bd6c6425013c843ba4ed0b1eb35f8be4532e4b81eb5a900b9bfbf8bb008b50c0eca355af8e0eb34203d592b8fdb0429038745db58c07404b06bd84caacb9bdfd5a3af9ffb9c0891979f92aad8aa8f727f0a7ca6aea4e150aa9f1cff2fc0699712a2eb86fee93096d21c8310afcbb89b608f157d3a39094780303e54a3cec280be0ebf5c4e7d7ad53e2cd7d0248fca9a65b6d15a19024cdaf30661fb7da46f19fbfd9ef5319e175743476c20fe44f64bb1122f4aaf7696301f220d49bee372db1746ab06676528180cbc9b72b0f3fb073adfc7300d393600aedb040aabc1a0a361e44d108bda2c017866fcf43006ece591e020dc934969d0612fad8c60b6513d4dce79e197042ad999aeeaf30b78eef9ff3d8162cd5fad7db01864f8974791e47139e7f1dd91fa87ff8a8997985af99a118ebd71534d74c828cf25cab923f3207ee30ba42848885499175b09c3381b768abb8dd2f016e134daa5a28827eed4df0f54ba6cfab73260ecc7556750f01833bbaef4baf68f077692b53366cf2ab1f2b0dfc7af5089bda06209c26496e506aabddef422c7ec73f70cf3c34fede8007595e910e060ec6dc37a2ae5d78b060740b92388faee5894d3fbcfc87467da58191055c91bd2cdde0689b8280bc09ed7fee1f50e3111d8c8d8e13afb638309054ea96d3aa26b99eb2655a11c500e3730b11d6fd8a9e931482740405e83897cf3c3749667157ecc8871b96b70935b6c5ff25cfb669d3b86e3f6bc9a8f681806e56ec1061011770a1e656912df2da57e1b1f5fe2455d8b837dbfb58fa5dadd7e80a66139da873dfabb2624eee096475ff531af7a445806bb4484c761573fed4cdaf7a6082bd0e058369de0c5e222b4b1978209f36a4357b4efa3755362f0640eb1ff714ae8d8876f7344b2db05853cb358c797badaa868b920847c76f83480db0dd76c2eeebd169eeee6c9cb77e829457953dd5ebdca74a1078b885fef5771b97eec5c7dc80c6da3adafb7d8e34f4aa03bf4a3a3142cd22d235d6ce89cafe31c1f82d1f97e83a2fdcb022b7bf6ce39f43e6fecaa8412f11cc8cb729a9781b79eda3f02f7fdc10189abfb1c5e8fabb1a56452cb6690e3eb47f35e4bbf4efa593cf5ad3ed3fdc68290bb3c807c58302439a01fb57fd3da1c167d1279d6ba220f4b659e579f2090237e3d6595400928b80996f0d77d47527995fa95cacb231cd65c7801b1cc4e4ebd5a026ec46f0d2a2e3841e000f6ef26b2fc91187c02c580553aa0dd3d28aa13f9ccf9457d30fe9ac9bd1d1d8608ab8b2eaa2f987612de8201a80bc64b921daaaa17ccf87dbcd7ee1812478e2642726ad5d67ba8f9ea0cbc3e3457c9f0daf60d64017f06e8862a3270a3522a238d1174da2f6858216a2c86e45d583b268c00c68db1d771f3f7172b0b8f520cb72401a9d1c06a291b91a1b860f15aec6c7fcf0ccb839a196b57549760a3c83edde51eafad2bf41749fda30dca86b61ae2a8c1b556e6bfb0ff9e0b66d9aa1548c307cb84a3fdfc3ba686a854ae6139b3a3d732b1519416b702a24e94bed45b2b45b8df0080246d6bafb664894319ad7d868eddcc250c6e27d10f7637d1e2e1a543cc09d32a2585a3497d9789d85d11b0978e7a31fcea0b112ee3fa582d27f6e0b8d85f28b35a53ebabb17e2e62ed4b4d02620e5f84b2047dcfdeb993e4a5e8fc2d8e6443a44f2b5c2a92a6ac76a81d1c0608afca7f00b057829c2324f267528af0ade90c29897394213e702f112e5ed35ac3acee727b674058fbf892cf973d384df7912ea9571184d0c6711a41a2d2d97a8b4ff894863c47c56c722841975e6009f772b714765529611203a6ddded737e6e2560b1aa69ad895ebf31ad5048618fc6563aec7bdac6c1ac9133b4897976151786a3d4bb58145b980542faa4d75db6d70478e973e001ab384bbc6a1a739c5c3a03ab23f3c9d7dfc1bba5af16d4c668990cbc2fc79d15f758aa8968a8cdbae59b2ed03f8f2db26971868cba17aa7bfb70c1105ca75767273916417548fdb4059a59896b2f56e607c3e8a40d889939ddda8a1ecaf381a62d3a1fdad73e32985644dc02a83592c417e825b612ddea0a689270ffeb6b3d6cc261b81ae691c20445bf4f6d813592b72edd97e07de8ac793c9a4cbc19bf85c1b77af8eb147ca9fbdd81fd0a059f9bc754f0e7f0e971bc3bb214963bb388f61eb15a0af197e6819d49adb7de831f2a4db6111f266a8bd81ef6f8c62fcf189e8fc511e25e449804a368779510074ff910215e8f45bdd9afe3a9fdaf791a17cc1c00b7601357bfdcd8a15c71f98f7666ab63b7ace1f70494f05b802cd1bf8b3dedb3279c4aa25151f21e05f5df324fd3708f8ef56b36074687225f7afc155200e476981d1377294fd4373c8602e193a1d2af4a11cd7f216ed5e111c4d51571f2d59ae96f996b9d5cb65e60d149afb3532105f8d51ad9462d733af54e586bb5122791c0a1562fbe110e2aa07b1506012fdccffc29d80f3291e2014c93fc7ff8bdf31d70a4f4df9821bcb83ec7f814ec7a972307b70e564415e45c6b574a8ded68aa65a69d0aef6b296049938ec69d11c7898ec63f4d9068f612ca44c0e1d115acf5ad9f9e8bfc6855bb0a3ece86661a3ba0367a17320fccc985adc6f39b34c1ccb86edf7d2fdedc08343af7c4e0e3aef07177342e0e7590208428a4d4e9706b46466a1abebb903e2afc425157bf8c40cb6800f2156284c1c536dbee9fe53ad4794d829ba212a3ca7b7cdfcb9aaaae4a1da452a44df1289da0885347af9c724330fedc5b65268aa5d3cb086df5f35daf170163f74a94a4dbe3faf6e44c6f2b50c322cca8392b3bf19443e7df0278b72c2838319c90b07950a02e53635fd29eeef45027bde23f8c2b2b7b12d8350837b24f46d31ab7ddaef1c8c0a37fb3f0e247ffa374ab91fa4ee8f31904889c056d45e333e25866849791c4e2f327d27f3166af5a044a17d2701b6eaec261c5bac195e57ba9a1da4cf1832f7c7f591255225873ea7f27087e11c9513ea012980f8bea165485a8e70a86e476227783abd3e273ff17940cfa74ccd1e9792e87d7cdadb7843742086b94af26c9fbc3fc7a4c7056c5400197eae5b07faa56a6efe0f003fecc6dd9665df175a27397571252abf357156f3cfde95ecb5b728113d06bed862c80a12e9d53811867154584d473ec7a8efd704254431215abab820ce65b4f510b43a954f565626211528522bd4b268ee8d833d7f3354fe13ff0c1f57c7a69995482adecba78b48f7a72fe7e458bb0c3d03b106e3d9a13259b8a7454cf8f1c0c1435d54d2de7053db64374f635f00574ca826eacd41ca8afc18d6f8448099f5a491f320c694e5b088afb89c7a0ab816e1918e3f40500376c8ffd669f08fa86157ea27a7bd86fb7c2b5cda627436576604083578926ebfd9607e98d4e7b14e44416d4e023d14831c71e440d9fba56e1380fbb57f31c0a2e6b7a56e56250978217e80d588648b1267ac08bae9e0792eb38af7447ea6d217f31ac57d42feecfa81db82fa4e3c288931e3024d21daabb9fc45d66d5def86182349696df3d4aa9469732cfda682776d60c1ac81b7019319500fb10b4a8fa42f71f50f7837cc27038f468064e48f9b29c535ab67e99592572cd883e9fd88129c0e995f263b967211ddb3f30abf879ffa52e62a5e2658b965875e8b7b9a230fbb6b015b982940e33f4d1134791dd966d82193db42884312e09f647f3405500ff6ff902da632f7e76f0aef15611de716a49ed283022310a004f1f8e8d0b5642466eb4ee7ed6db6bdc8642afb1077aff2e7d0b6e275864963e3da5efa20e604bacc030436075d5b578cfe7128c36c39759b8b3370d4a862c1e2d7d673dc8c02adde972a341641e7a3eec879af9a77260c51d2518d2bd80760f7b2a78375b6ab60221100ce24db801252ce19e8d4c475211c8350f9ad01c6b26ec1668a58db4f75e7f31bdba463d9a4a5028c169f1427e7aaa139cb812b48c6b6217d90ea917e5a90749d3c9a0a6b7a13145a0a400be82b02b6d6aaa4002d505938e094e3cc92e42ede79ab265b5b13cc0f06a74be74d16f075d9ee0deadc1fc2628676190bbe069980521aa71553e35b3fb68f7375101eb22107550a565bde61d0f3c4d781672e081e101606fc56f86a4828e490d93492aca56a0e89f6b12744584a273ecd840ab6883dcf9438ba116a1320c0368776a7c2555400ee322736b9d62aebd3df5b9b14dc1f8bb793bbb089e201b36c81074b1f26513ad8ff85e5f078b0dc2a399bea196f9ac3a3b64b326216244f743ea2194601d9a3622714f9f8ed095f7ba7d5ace92dff4aa0374fdd8be8198218117d0eb72a273dbf1592fc8a799a9e6efa46624a0b04f77412d83f677f6117620221563fb97014364b1e6ab9d1e262b87ccf0a5e5b4df7dd139719625587e6d8fa9db89e199504d757ad456ca558793f9418c7d02146fcc42d37b508b48c4e7ced4456d05cfd5eec602bc5c3d44748e23dfc83ad750f5fa098efaca5139162a2a5c54a226237298dc06f4a6755c01013f27c035db2fb83f3d1a01c1ca3567d7197626b2bdd57c759cba128693648a082ae9c0ce2b949820ad21c43d2434897c854562a341e9283b7eee819619e3d314522a56a197f84fac8115bd561a06149086fdf668557c2de1a5d33919b90aee9f4f8828f7018dd89e62df82de2199cd04bb20fe7df32b5c052bd5d37373377e9c93d5bcc63f0923276d28523b2cf24fe1a823f5b8da6b3b83031eccd4f5abee500b03a9b11e1840a044ba2334348c180e0b195344ad034487f3c56e3e03fee7cfc8e2263ef28917e1eb798f11ec121196cbb1a0cb10e1ebcaf98f9e32d2830b82f615f5d89677bbd3385b0b7c27f7b9700077648eab819af105cb8c20c7552a7a2ae15490701043c7d237a52125c1db8ab537fbcf67afcd7ba74e7e80e7dff0028dce4310bbc02b5af87165e5515a6da9e910a512c2e200d96840dd89f5a048f40f49d1ea5b54be5484f0c3f6e73a069b1757a3506f4685855291b29bdf0ec724dbafb2734685f7d435556ae61ffea35cabeb38f70bbea04fd9a7c9a36e843748694b80ede66bfd3b559149a9717ffbed5f04b6004cd9eb2573a15e49e6e3aa6a94f887172537337523375456ddd8a9c1f131d0a18a57029e459f8f8aeb4249fbd177e68354de880915197f08ee182fcc884aeac3440a72eca7844d60ab10489fa8966f4f676e12e753e6083169aef6695be9d00b14ada931f96ecb253017a7acd902f37ca15109906541eec986f7b7d31839e5622371637fd6133a318c819cb71f88c201c31675dac4857026822241647c9df764f33a20df0e1f22b5b3abc00a17929f9a6104839377f609169af6e549881c913d88b56d199729ade683d9c4a1cec1cb019341debf0a5ba5e429cfbce2fbede7b1dedebb6d65c7fb779dba6a0a7c224cd0e444b72c494301c73a4aef0d1639c62565462ab00617627b4d430e8df7c57f42e5a607b82ec9b9075439d25dd7ac200f38c7f4ce629f9a4caa7eb022bd9c8f8358cfb91f46d5bdc945909b1acca88c7f775f26c14c80265fb60914b4416ea864a577cf9694b832196dad22cb86271e4e5be6ca145590bdd448c2bfaa3212019664beab82a56a98d852691ae13a70ffe776b748293893dc7e0c9307dd4b0eaac8d4d23d5d47f458a6398ca76e1c92c7df5f4786f4f2972b158a78e0d6404bad8bf494440f409d116e183188244f58d7f937f0c5e8e9c10a4fea8f453b36e20495e38cf5cd39a22ece8baf15e6f94fece24e7c243ad72e61a97fcbcccc1abd49305306f2cfd20040fefb382543e160e7d000edec316095fe4c3ac6410d2993cde5b8a92eb3571b183a0dd0b1f1da55929f963087a999fd829be7c95247a13182edd761a2511bf3602ab8d925284aae2e8d447f974b1016462c2f4de944b9426a6505fab6bb34f6e863492f3f76752d1da26737fe7cc2cc7babd39d9c1e1eacc00127d556ee7df934d32aaf5c05418f9f23fe4ca0ab22e433aff7c1fa26606283bc96b5ce5edb522834cc0859f5a438fed857c52f1a53694785de495da8bbedf8aa2834a2e5ced5fb289bef66dc77395430ed4dfbe1ceb2bcb2494cf4bc6a3d63758097d2af6aceb81e8663f32878ccb945d4ab72978bf4741140f9163494453a1417b66427cff185959413ca9c10e807424d67e2e9063239d63e53b65186f9792dc0d16d27a817478b9ddbad04b83d81ae6c6216d0dc6221cdfb58cd90f364de49ac25efffe3f97af09d501e957d939ccbb40f0db21c3fd5f13bb69be93b7af16ab04bdc2a4b866480116510427b3be3eb711ecaf37d3c9499e29838c6f6abf271f6130f2fe583903028d76609ec96f63b11f5e91aadf7db100e229d7eea45fad94e89ee71a17b7c3fe9b925fb9e2dcefcb9bb990792365f685dfc7b1899c701a67c9a2f02bb1b9df12d83cc5800fa6c6ffce6f6699c5ee9527fd23ee8dc28f1a2957d9ff08e7f655ae0afbdf00175055058c5045eb6692b95b2dcba5d3556d2e4f8de843c01b26da784fa18bab44e298ddea8acde872f0c4620f531c00405bc84cd7e2f424f71e0c0cd4b03bae4aa3b5ea292503d95276b6b0a1fcfa7ca6e85340bc2cd2b8d0503f12fa585c83f1b2db98830cae193b986286158db33ae9d5f6a1a426489a3fdbf4f5140af82f34324915649670962c5d57e50b117a711f995987821aa4cf15e77994fd389e8fe3dd9798e392b70cf1d2321b643c527b40fccaaa15de0265894f3b43e6858a7d5256183581e7fda004ba6edaef421f6740775b8e5f10b259356f61471da445ec7169b774f1e3b4a2d559b9945af67d787cd3c5e23f5585fff6008bffb4b612bd51c5808a1be47eddc00beed90f6eeefaf2a6e517e8c03d047ed96ecada93bc5e0f2504e8da1bffff45179744a9b6e198447687a23c3e357e55e7840f24c054e17988499d8bb3ff9eed8f3b0c8d1e281bb88d06ab15e03455d26caeaefa56096b8423fd727938d0fbaf05c6a38dfe648422a6d03778f53c1b6ae16e714e2fa4827e77259f0074e0efeacc0ef71ad52346b4bbeac1b1c71e33d6358fa3f5a5ee2ece9d342b11426060f024346e2de7cb4e57f14cc34f1f3afa372bda981d9199a18e8b45725b36ed11b2209f682b3639f6d6e92ae41ef4fca168443cbd70bfea300795e71f614399f16256006813451cf781fe67bf0af467bde54c7e74d65ccffabadacca73aba95b98eb0f3954b5ac106b9dc7f8741522b62c546ecd05767380ce4d836426f5d18011d9420fa3b19959e848eceb1db72c956672a73cc995676207d630cf9fcb3f759089dac4c1f37c8e353ee45ff81ff91f5db8c9bd4cd73df2c7c465e1dd7220fd33492cfb5e5d5d98be8ad7073f4dcb1ea24d93c92350a9f14015858333b1aa7c3bd5c2f947dd47d2edc1050b8bfc003d7fec458722eca99fe7c845448e0d0ff6978137818c426dd46197f9c854e2910bd143620d15c5a38f95f6913bb08c2a24707f342d993314bff16fc75dfe085823e4a99f4e56ee3e8cd55e89b51a6728ca6f3bf1b2d90448d077f4fcc686b5d25b6cb94e1a236d6b664c2ab0d929b3a23ae723cce16e1d66aa084ed4861bbd21d104f33df9409df2d6c356ca02a2b278e79e43ea06bef6a4a73818d7a3b3e354bd74008cded37496467f035e06da9729ffb18e8e35add499f662b7e43bdf025ecf65eb19475627c45de3f6cccd968d01be880b00f8f5564a19162bfe028769741b00da54fb641ec3b465c1df9e1615df25cb189dff17448a7fc164c499582be1da071ce9c8146581c551819db58511fd659eb2167b8ed70ecfdf609580d00da4104c2c005facb15119709a93c70be39e873a9ae0a3ae976c799033e93f6ea74e1c2322d698bc830e19af90563b1e16767ab5a9d4686ad619817aea7d4dd6c76851b0d883d649714d84dd0752b67e0e8d99060198e37c284e2e2ce6ab7d0084486a60d127499ddb10810d9ad44260ea5c85d5820d4309b9b88f40021da3be2fc30f994f45385b64a285c9e371cb460497fcf56bce2fb0a873f2b2796cd0cda61112cf55ac93f2df1ed12e50d9e256d2ac8cf6a7a6eba8c8439e45304a17ef4f4fa677a36281a18374e35df58644e12c2315daff30d6aa413dc9dc752156be447a60db33946f67cc27d09dd1dc526d9d8fccfc8b1c7bc44cb9f1ec5011de5865ac279dbecda5164b8f6dc4324250e2af0b183c89801b236713f0a85149b38117d71c38eff2884eb2cef5de64dcb1e13ae95c2a5cc6776dc06e646c1988e46259d0ae232625e527c9ba5a23b888ae74af60c8d849b82509a94b6690497471fa924fad691239e07cd4361c12d693056add1454e2afa221c3b2cffb4cb640db9a8bdbd45d046413b65bfa268966d554df41ff522a91e1840af9c16d8e12309933733e8d96176e1edebc8ac359a410d7c1260aa5ab35d78eba3c09a8e5fde40db48d094e2992d8b458a7b767567b596384fed91463a128e8856a3637d3bb3da9c8f12009c829e559a2c39c5aa1a7f1ac1ef51c024dffb25c56c20f6c824b8321fcd6ab648234983a144a591647c2452c9cd9ff51cbd0c1f6491692417d0a8dfef59462e7959149808104327415ed3d6203a33d4e7e5daa82074f25190abebb4e94eb0eda752e709b127f4b40d8ace9d37f64d3b553312245a0f4f127bd637c07018415161e30c39e536fe5f8127d5d41220a602bd371ee462d4e061db008f1e6765b475c0bf9157c1dc6f9856064bfeb88242099a247ab4493114e2060eb14faf702ab49ff241997586a697e689f62feadcc6096829503cbf7198861eb0eb88969c9bdce700583692b9b308a8b18a2de70d44cfbb69997c28b35c544df40d590adced34ea0989218f3f2118c818e98c5b348ad28645d748e7a2956952b8d97e96eff9172ab47d20ce5c65ac916f933791c4c2d5c96e3949c517e3281d3513e20ff033c11d3fc7a2fec782bf728161d58cf7955cc030bc40ebd2f15a4dd7f92628745b743b8c12caac242d4e5daa350e5ae9268ebb07466357c18f5b2d57fb28a5c813b3e420e4c5d94a1e247542c01074762cb7d0ce55e3fa5cee1274aaa8233597fdff065d4782b779eebe999ee49c93ed411ff868086add4613b3932e2f4292c3c4d7196985226190def4a17d8b271c9772b4c7cb04092ba65529e63220bd1796f462a6aa0a042f0c8e9afb3705d15659c944d17fa545334f33f2f7076c31ecd2db1417c54b877fa186ba82dce0dab3f6388deeba15459c641757e47b2db464fd679119bc9fbb8daf1f547da669902eb9feddffbed00f52a79c7cea13561a43a9a7bcd01220e352d98de1680b07ac37724db92586321a043629ce5d2b059b8d430446fb2198376b47090d517f5f12e2ae75fe2a96e963b17f5aec0e450bf8040f2d2b0c90479624c3e4b4490776e8418f90424b2a2b01789faaf8c8b7549a07dff0115d80e1e628516ac6c0be32f7f585fbbddf61248da1da13a4ff3c816b49c3a7cdb7cd21490992159f65519f29645b2a63790d73bcd6ee6e8115de7310bbda7da9f2799c095eaf4fe2c9163cb244062a3b68b48aba365b76805bee7c68f582e35c61f672142264d4b7e5ef0f039d867c6d8adfd5804e42fdf1b57cf35398ec64195ae01b370038123964490f986d2bf71ec998b6487bc9a8a2609c08e8e6e8bda00baae212b4cb81541b393e5b6a2ac00c0c3ebb4847697d5ba1d564f510e5beb17b4eee742e936197260c205e06888281b1f6b8802e25de88f3d4695a503da8f42bcc82f45ee1e9870c3a26a16eb86a614a22df4e560f75967770eb6a951ef638b4d41924d3d8639b7bc14c60fcb72f637d788954f6bc901c7fa9c05815ac6ab7c0340687d99bdc95a94d3332a5e1a133350018a24926d79f57f5dec51231bca6696299dc49c4f4345e470303c4ea15e8d8a228b1ae29594bef7a8602686a2df815d0ccf144bf8f1f712279373055b29e29ac4535e34ea8f3ba9a72248bc4385b4b8a5cf5addd46b9951b551f960ab3553d75938516e44455471fcc7ee33242aea95d359787b701e5f09249e83be351067781be1be3c4eeb180d6ea2d7390d120cd6c5cd4cecacba21d4bf4c684e4c81bcdb08d06ac65ed631d534dbd1aa5d7d13b4e7211f9d7e63489b6621aac8e80a195498e8f2423581d7654ead2def44b132cffe7af4c2d02a3d73bbee8abd53ab79656797dcc9920d4aaebc9db41b6d6a5880686cc2851f0eda9cf82a305c09ce6a8c9e83a12c21859120ae57bf0243190790855193432e096da658bd5cb2b1b6715260bf0204c71c8a8ed7c15d3ba33bf9b3993873908dc7115a48a6a05d2777719365b34662ec86314514076743e84dee4cf88b3cdc5f4efc3e761719da450c562ba273b53cc558248b33a3e0bdd2bf2b9d2d9265231d94d66c7d12aa20a74e7f79bcf48e2efa3e43b01e2093c793da3790953747793ad6b3fd340422a6a403a83ff13f408881749d868890ad153c4b02c363f31a3d66b4f6eeef23e7d4776f75337995e2c27ef8932554ed9f206580f98f7ce975697a23903c510e61151731c0a3e7a8bc8cb5180ec45adb4b5dc3c4a6f4edb9dcb611bd2245991e527d33b7e506fddc99adccbff585af1a634521a8f42c40837fc1936f5efe38bbf8b7cc8657967956f820329da1172d6e3ac46b265ba490ce52ac4140de910b13bc8a156379b0a9196d0ad271b3e57de6eb3c403bdeb351d1532aed4106944e9ce381f07f61fed6e60bc986b8239d97075b1848c3f6c006729394e49b18e782cf0f070d5c0b70147660d6e80ae771f27a4fa2cf94d2c5163fe1d9114dfe3935075bd06c2f289d3a274d3f2c307bc0199473ec41f53889599b2dd23193c8dd473a35964a1a6108eaff1cd1e220c51ac05871829a81ebcd31a8b0566213769ad4000ff2fa6934728227a9767bb6c0f7a18fbe3c78e34c542759acf859c6caf431602467c893567c9b65f1237c7d45701f981991d32eecf8dd8fd63de98517d2e3bdac7c480fefc91e4b252664fb9a76ad0693eae7d718fb7dbd9862a091e2b0307cfdf9cc87a3cd7c78207fc6900c0239111ff773306aea2aaa678ba9f79f552b28c278fbfa99195876e5417b16907312aff36afd5112fac67cf7476292c1a9b2aaf92daf098762c187df1f65c5a14631781f6a4bf5cf52524a7328543bbb51aedcacc2f7d8b1764dbc8a3232578e475bf2ccfb7176ca18658b887e7419fec61bd867858203a7c3ac106048c9cf9b36962525c19c6ae91b9930cc09c55cb4ba71e0dd1cb2f7143201c791b75727635acc9e49e176c4dc44384b861b121908216a577062b2247bc1102abe313ffede991292e26cfa1c7f39e95802e0897e0aa02346a448db1efb1ba852ed44ccb0d7af73a8a19f2d3a1cdfb6cb1b3f8ab49ff1dc84e96193af4be4b4e59c84bfd9bd7c335d705b63181a25226911270ca032b7b1066802e847b6c7c3812b511064fffa1b8dddbab4232828b2278b7c7d2fd16d1a4ce0a1c5eae4ec3db39f58a40d98002d3fa1a489119ec2a35b7f27b76f6d180170c13028574f8c31fe9c49c4ad97e58da10cb4499e46eb4eefefa5a4493e47b6e21b585a80fab8ecbf7a08da8242df5aaa11c96c9ace92e4855428f649cb5b4fd9ff7df0a5cac45e452ad949982fc0607d2e3e205be19e56d4bda21127e021c8c7571963e93d4ca096668ba49ceedfe25bf854a0eb0d76a836c55cef73e87290232182640571d1678a9513b03d45c5a26c9d6bebd7d38466bc4f18f5141ab04db5677966423c5fcc6e4d94f33c2c153803e268d8b6fc3b3b6395f9e18ed5c748fb89a01e26a35f3e0aed796ec8cd8a7d9e835654f09168173ad4cc634d233cabe387843de3f1dac12032b3fdd25fc4a918723d05715cecb4abcb328161b628c402164bec2a6361c96fa0060f4d14bdb91d3209111798b36cb951d3a53b202ddeab29932efe0fa1cb1cb6337ab604f7ee4873d8bb81f154e93214ff34a6f4f1b99e5bf16d7d538faf9168fff929e1afefa07b34ea427929502f2eb12f6c5f034f11de6c30812eab55c7b87706a975940678b8b106e24189e19c676fb740c39d1c2df33ad1d3f376dc73341e92bb9f9ce8ea1d1c9ee69d7e181b0a2df01d0f9c3fcece9eeacbed26bc9bc3350878de981ea453527dd7f4f5a974700771856746fc04cade2e7084cde6202d9265a45b5a3d9d4848dec3c4d2a87c588fa1394025530d063d13180d01534fd47d99293c887f2e37f0211871f1643e29a26ec652ff5eca9c78f256d0c0a7430fff9b5f9eb740ececf80b0e56ce3aa70f3641661d525627082bf291f3b8fc4fd80c488ead8a1c61f33008df774d8058ce31bea1d510310bc41c63d105685f6bbc6a029c7d06453ddf2d15355e10d4649c4bc043ef3189ebfd42c9a8cb94aec86b70b9a13280e6e501ab237b30859bb7ea79d9b29ec85f4e5b7a07de3cf5cc114cd3a9022a7025ce5a0670a429589b1c2d61b6d5674cdfe2d8b02aa166c7af69a367e68c951d586c0d390d8288302014428514e3d57d546e2b1812d2d4f489cdc6aaba865500d579c2ea05cf78b44bc173bad1f2a813d7fad069b2c5e3669cc0592ee3df6c0a89dcab1d979500be3f2e691db3e0d9e650ad91307fedf1f6d684e45877a4b777a66d44a3cd7623ab7d57b15c424144d0537372deed26ef913c011d99248ffa09d9984c793052295022bf008a4bdc5149efe33ecd320053b819a4535fa0dd1160efe21548095516927b9c97b4a3592624b46ac132bd7a12b0b649c7dc7c16fd9734d59f76c8b09f5109e996a44197ab19bedfbb866fc6ebe9a4929143fd5f85832911cf65a50abd677d0343e1191cefd95ff1706955ee32a78b48f79fe9494ba7ef2a52f7cc7ec634f24212b48e8cc4fb630e318adb48a2f378afe1389d28d1262d6ecdce04e4b1b88c35d89e4dce1df2e678eba9f0309ae1911df38bbbd73b86ed2edccc7c9c0473f5614197c3868978f1db71a0c43485fad245aee960d058983e15ec794215191eb59449e2c687a488bf75aca944c77cb94f9030062029604fe871ecf080cb4be6b3f20c3f59e7169aa5d4b5d0546405a79bad00c6c64cdf55f9a4f05dace5fcac207fe5b20cbeeb39417fc5353ff5d29423881fade4a4cb8ae039cf733ec364716620d4be1661fb6be31f1aab2a0f0143282a2f82c2227fea57cda90cb5626dc3474346f9c3f533725ed2659a1d4f395b888e7ab1e17b1619a878c0fad5e0734c7f10ff47d0790827ebc7487df3a4f3cb8e37f527deb007b1952029330450f84acbe0a97e2e39161277358af15df5b8ac2cceb51ac829a8f8928a45d092dd2d0baf161989ae5ff6df062abc122ad581f78f91d4d6fb2d6fb4fc070b1548b695f161185321de517b011138e220ce9c88fa7146e0cfe2cd6fd827ef2942ab4e5c5f1ec263b57012773b6a84653acd7d9b67462609c3f03804a40cc8f38a63668bb5ab10b1dd762f5b7a4652ca035cc49111716b7a38b001d2df7ca141d062680fb0b1527d83188789d5dba4b0225baf74791400a6d880e5b53e6e6b4612094d2d71db56c89cca2699a0e710b6cd31a9e17e80ca72634d64f93a4dcb00c36b660bf3e59e1786295aa9205133e13f558b6bb76f8c0d2a8bd6cc2ab7dc8a5f1d2fa828753faf9652ee7f3929abe14f5bf0dbdef9fc2e169e2fca6d68fa08f37035685a4d6b84f2d2bc574fa58a00eb8a141d6007ce6574d9cf0e2bdcf96875ca38aefaa1d6886bcbbe8d632765c2edaeea0230a46450bc2d8b0a3d7672bd04a78b76ab230488eb60b1555b358f2098389c5c3e2b707aa35833e57fdb1ed203941f49a5eb883d26da37dddb82ff0c6ed26aa7a34d81c48539a7b1a05081eae342e4282d97a97564ecda11241df635f3e3679f8b3d4fe3f09a4f4ba3ed98eead2562ff5d83ac9980f213e8630415120a16e93f052937a6098ee4411299c8d4e7bbade3b6b97f24a749bcfaac1f0320e608e5cc385d1b796dd3e65ac8ab521d78cb0c0b51728055cf4b181aaf7bbf96b84ed459032d9168a6fa98ed5c06775e887879fffa1568d3df9d5aaf8b82796a981f3b33edef39a3bbf9954e2e0929834f05035d06919249a542fc6859696dfcc5c9969675b0812d2c45e5169d0bf89f218ee67ddf18745491d3531d7404f659a937f32ee213a294103ccd96ff4dd5c0451e3cae347093e59dbadc7ab240f3d704766bb40f4866d0a66f5ee60205a328e7c50faadf82e0dfb587a4d4eba3cd1c956c59f1daa345b4b5568847028d8dbaa60950b8cb7c0b842e17b25d3f7802bb690b33db6d6fd04088f1ad12e48972dc9aa6fbb4e6e9ce17da36aae40d52239a7d619c6423450edca22bcd16bb2b0469ae6e2f5698d0e8357a449587042d6473d6e91148272ade8616d33bd90298943e04df0495e93479e63f0b1ceebdd4a2b86010d08a97b13947613cdc905b399f5f7f246bc49e4f53cc1e86dd100488d986ab53e86c987fea9b2691117488a467d304d4d349b68f6b1953faf3ee5bb34fdba4f2ef9706fb6593440107b43086cfa690e5fd5ae093f7cf712985e12cf0fcb91857cbe1e07ea7f28af6c348f7d809bc76d7e73882b894a1b15d19ce39a0dd8e4a6619149e7e03305ad9efdc82860a96aa913d961e9e377d4e08e5dd72289e1308b35a6b5e851de19328fbba88f19ed52eb86a88330e4ee8868992c6e65ecd298f2c4b8fd095f2d65a43065c14087156dd23edfbee032e3d21e017edd75f96d0e2cd37cbd97b0fb1a436fce66a1b68f65fd869d5541545c9151600aa9152ec0f5e5e58e36d6ef22cf7d30009549bfa52737b0d4988b23e4d687d0f0f9bc880d6ecc5142ebee7b97f1c94715f2b7635c2300ccd1717b9f8a01d7aadf71f2bf640d54013e98270f73bb69fb2f820b20ae3283104b7cc8163994b6e4c651f9d32331810605c7bd33985a809a40565044f9c000a6d438a497aa96ba41f76b0a4e8e326f05395c605fe103ea4ce23c81426f57d6118e49b1248330d2c4953d7869952db2326d445f95fe8f539c0ad27fd8304b8f802c4faa6afcf22b138713396c5f792a4496b2737303e2415552de63dd28f5f13a12dbb17f0b8114daa921b090993d855ffb703a4b58f45bd08d06d0a10cf4a68c6be861bf880ae6f7a662a2ace442b1d9d00ea52be3091dd0debfcbf5c7e9f3c9386a59e2c2c640a4910c9e6c4c0be97aa364b7b57083bf6376b28490559df885069e06c7e794ed2dc62b63f84e75c39c8ea10d5e4399a9d90d3cb6bf379fce28cca5d645ec44482a0a5a55b9931d8b891c03bf846535b4f5885ce0d53974b7a2ddfb4fc25cb865a22b105847a5a345ea12aa37a8ab9c6629ba67574ab0cd94481c56a926ecbf89af3795db1a0c4eb93c9cb815c884806e166a5ebe6486ed4782246844ac171f37479feed799b8bb9501414fcedf19329f3396c56f2c79bf643136f2dfbe4c41ec32f24f287b922d9d54f888b5b8fa8f0cd852230fa4fea1396829d94ba2232f9fb8821c29170cd0d001e06d822d85f0efdc1b728b96e081b9947a2de0a5ba229c584d12b93e40b6e2b21e95c4822e3b5c88f44d8095f6902dcab7b3e9b70ca34d134d513b502a72faf517b2e6c0309a19985949e8a95d417c93014794920e4c2230170f41fffca0f6319e921f3a353bb50d2f539f8f15591cf7557253a6cc5db99d1ed9987dc7d56e436e73e3a74d316393d8a931410499eec5970b752e35d39224903e074f3b36d9a9879e23f216de837594e6a373edc202f5961c2382b0d09a323684c63f2ed8ca65f3c000d8a1644f2dfac5d325d7ce635112204d6788a682009c2a41957cead15df4ec6c1177fa45635fcd8db3070047e116ff1f9333704b50c6bb877d028172c954817b7a40a5ea8f10e50f747ff9f4ac356ce2d88b38a6f2af7ff83b42723119e27ff63262b548612b122c4e590af1e74338750a400da14c6c0398a02f52da53b04871fcd371d24d90c8d87a24b67aa94675dd87fdf1bd9c85d04ebefb2f1fb5c549f056b727704b50b8dff45cbffb12200437d083760bc3e353e318a2df5d401d9bd4bf03ebea6dbccdececad627adf60364bcef89dd6a37f79a2c7cb7d8ce5a22db3fa39b04cc5dfabf9290e8116d73751afc8be797645453871a9f366d3d54ecccd5bd7c5bcbfec06995dfe65009bd984b277538b8c5d3b3561da587a1105da9c653f9139b5df3c69496e6e07123f33a19bbac464fbdc98bc924c27607b88aa472542ab96721cdfb9fc94645018622010e5f3ee34590d574619768f76342ec37b4ebe22e964453f85c363e1e8400398a505f3592e9e9dc73628b76dedbd3c40b39a5597689dc06c32a7f52c7990911ef77018633b8a6019c80ebf64679a35720cc0d5c030dd57428e307db4334413879353e3767b430cec143bcf2ff5a99f21dd9377cd62bbcff81b45384d7fa3f57efcd15f964b4bc864f1ccf366ae5d394501614d428a6cfad4649a863070b4be76d892713cf69c21edad5880801c055d08283b336d77e00d979acff8e978ddb81dab519ea8c359d0171365afd38ecd93b6ad201fd6995bb9d8443588fbe1b5f6232cba5a81f944ae5b1602ff70c29d0527ed342374c8067e1ccfffca51b876c1e239ab650996524f8b6704ea02d1cbae106f0cb74a10c58f81eec004c45f274d2661f8703e7cd5994a12ec7bc75c054d0e1a2d53bcbf768ac69bd9146daadce44038949e8f349760c4a1c328bf202c299a94449963669b19bc12c7f7fe5b624ff3f50212cc21aac1e3aface9482db127a919a6ad700e092825356beef3639e703168b0742cf998acb6412269b99b7c58dac6628a08456ab6351fba530e98c2933b37a8b3530b5f1013216f952db3b8390634f1a8c2611c6d2ef6ae10eaedc1770e73d74452e45311ad0850309db3983bdcf27acf1a58df2d6a7263ffa2168a30e3d4c34daac4ac4288905abac367feb67aa9b2b41db756c3a69fd59414210a9bf3d84a5efa5702719f87cfc8203f6a8b09bdbea3e204ecf8cd5fbe8ae7c45fcd21602d9c86cbac23c1abff3ea65bcd4e6a37fcf2ec4939089b39a37bf6e64415b0354bad80a595e3e7eb0af8df8bf3a7c8d2c929986662deb47a436afe6741ca85c44490e06c74c764884fdd4f2f75a550877caafb46404a8ce86bc4e8fbc77dbd53f846d1711f7d8a1ad7a71b910678a36c166d7268545153456b98049a36e0bb6b3cd49791ba2a83e60d524df941affae702dadf8f841be6bb825a0d917499b4f41b697b1a20a823ea814a320b39712544043212a16ad07cacea4a8683580dafb6dd78bce4d5fb9feed41f9ad6cb3c46f28179fd6391e4e5b13add4f759a73ca71f50ef9b604107d1b542032e0e3c1343039c1ed72eb24c93df2b71209e7e0686bd24868107bdb4b0242a4646e6ee56937774b3d3073ea8c598a263880d97ee6aa721292d1fdf6bbacf53c0c7416590b62904b244bf9a94819ff59563481a66b8c9e96cb58b795d0a70fcae72e07bec9366477cfc948f08db8dc6491c879c28e98b0f19adfccc0735307b5da625315cb740d5b0f4ca4e860fa0b9e39fee427a33742a9a7be48cfafc0ca6ec4aa1eaf023fcb17db7a1e4d12db12dfb1e9d377a9bffcb4ae59adf73b406d4cf629522cc37ae74dc56dd31b50744062a732705d05cca937a69480327da88ebed13809fb6c467725ea867f3b1c117e6012df3eae25fa5fdaa2689ec90004dbf2b418310cc92be9db8b78061ff59efbaa87c1cb37aea15154e35a079891c84e8af4659a39759e0c14c251766e00b338859ca348285d5f751d7079c261140df426a24de5d539d5a1d7a5489894d22c6ca14b66bb61ed7367c5cf6be77dd2aceb0eb17b340884b3ea2b450ac8d946c728c1e4954b907af0068e071bbbae60ee355754d4076d2768441c3760cec5de90acd6efbf8cb2d27866d1fd45e48511cebc37d99c918626de0fd94f6661d99f062d827c0c539d3ba71d4ba546e95d6e609e9a378a1061ae38bb2eb8a7e3fdce694147f093ec1a4461a189a6905db3cf0c5fca4503dc7c8653bbcd6d08e9d05a7f0712f2b358cca7c0cbd1c0f389752688840c7755f460eeb16526c8166c2a0fa043a3c37c781553133e5a70bb7e781238abd0bb1a0ce579a23bfa0444fdc7a7a4f8bd8b45d02b2572c4a55ede529af107892f79c543ce92f6cb61317f07dcb236a77d5af2833f5c3851e1cc695861d4321077ae78a25844eef43e67b1120a836a1550c2c0b982e1817dcf982e0760a2a370951959fc6e63452bb6b0f26e34187115a0da477d79374c4e49abe10ff30de3c532d54db89c275eea0aeae049d1cebe6450110a7aadbe97bd362acfa68af882975fe72f71599c61403c5d46f4e932a3f1a10831328b1f68cbd059e8466c9087e6054017bed4a4fe9d560ddd1b0a205e740182260b98ba64c3ccd0aba6743b8a3647f6effadb5af0ee9e5ff84467f7e2ab1d474607a21671499411268d2370334a163a582a90ec30a6f2d3c6fded9f35a27f8f5cb5335be3e263a951f437e887e746b930ca824218fc9657ed1a6be3bae293ab98c900495e18f7d7a12589b574fb59b50d43e120976bffd6938855adec0115134d040ede9c7456e30b934b9209519608a67aca321f3f0fbb87bfdd6301848aaf8db893295873128241294885fd9752acba0e9da0ee98db965ca457c0be0602cf967f3d8c6b82e5a96aa91da16c250f2f4faf88bd3555feb8bfa16e4c4937f200a7bf3bd2b0124cb2ca2bc94158e604a9a085b6c37471dbf3e547576a2fecc3403c39743b41d5b874efc5099bf1ac112e7e6f82f77297b1226dedddb54ffad8465072f71433ea900eaed78a7d76bf4706fe910226055a893275aba2e886e1573a2a36faa1aac9f47fc94572162ab25b0d882cec0aab7c8f55aeae47173e92515dd2f58ebbc668eb95fb4a125db809b45fdb9de27f033028bf93aeaca508931fd1e21c7aa17c8e53d0d000e8d15effce32713740b4cc52e8afd726c090ab5c5d0a296bba486226db38835eaeac94b13b9547739767d57a5525123ed5b06c33e982f1f9990e483e29982a39a2718387896af15b41","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

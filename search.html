<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"eb77ee6aac0afdf6d2e586c9b3904e180627773604d037d9d8130228324a0b0da9c9a0172252373a8b279e16624c557f89cc5ddf36d1a022b0c13253dcfe27aff8ea6b09448e59a2a77a21c8f1495c80ab244e613a4226ff92f4c8bb944b39f75f291a21a26ab02ff0df9a088e75f75cb3a4e9bf652bf2588029667c984175f5605dc264a2047d95544d179c8e4a85b232e9621fc9bbfc814b69e3dc2d99eae31066e839de2c91b82272324a7101e4f32ac7b5faf9fbce410935f68fe3725325b414e6359e4d65b4f3462c0a49bc263478d5aa74962efae45df299dab3de3c8bac38b2933069b51654f09dc482fb2f9f1f09f5467111af631acf2607afc4eac5037bf7f2a528e184047aee6e7df48d820e23819c7fb1009f735af7942a8f83259300f3ea4355f5e1e02693ceb41112b2dfa7b52f198b5d93f00382ea32f66529811e208d14118aeb415bde8f735c109c196f583d6e330afe890ac9364ba4a1f22e0e75cc4718a1636ad887a295666f698d63e58249a2f365ea0a855e9ff4b5a073eb6ab87184e46f232f6f32b699347d69ab0828a01f412726c13be364a706abcf7ddf4ee301375d575e03357b8c7fba5c549d580a727a8e6a7b83ff81ad2ed2cf2c5f202466f45929d739765e63009ec566e931118fd81fa49d48a4947a80e76f0c619068203e8b5032451f1e59aad6eaaba5b35340fa11e7bc20746c5001fdeba0f5e873ddd4be9c33dfa0054f508d315f0ea6dddf1b7583d570abdd8ca7d28833139199b1fb983b034d7c1345137615f26c11a3273eb84a20d43ef14de772118930e2dbd17be0df1c7641f20be18dea91bae2ed1679848cf09b0ccdccd02e15e1bea763b3b1d9cfff041ffb6eb1218831dcc3a0a946020c3b2c95b860d0298e66a966794af9b2d8bbcf3c9dc79a41dbe7ff3a9efcaabf41a7f2f41fd4e0dd5df7ae9c192452211e5e698b03676ae396d17024d728ca8dfb43619beedc45d00382ea0b318fa0cf602450d229db6442c19288b1801f8aa8a5f25493e9109850c901307a55a7d360c787276d585ed360e56168cf65257ebeb88ce17149bbdf97dd3c32ab67c2443287c63cd9b1ccd278ee4f2ea8568b47dfa7f1fdd4e763e891cc210a4dc8869390fe6cf58cca733dde8b38772dbcf39e399fb4f0cb1ce2775a63e1342ec74709c46d642711045e8d1dcfb2ba2c777f52a74f0d871c85c654fe8f50ff0cda9783e5554d2b223b4b87948b3e6e2b4b428bad0f570870613845fc8802a5abbf453da418cf6e7a1e0bdfa3bcbf5c4b3e055cb14e5c3404d6bce6f5cbc00adf9e84b8535140e722cd56b431af71e490ea72c05ff731fd859044ee08f61e54f7a4f7b3c3b575ff16a14db95f0bfac7f92f67ad83a50a7db92eee781f0e2424c06b8d7b208e267d545042eaf3a0dc24d7e54b9d97b13ad1b134a4fd8cfb295302871c4916643856e5fb95242fa16238942d0031de5039cb7a938bbfceb463d75a72a48232f6f0952e6c85cebedcdabcfd4188063fe1d4f341df51b5b50f5d7147f7afa0ddf6128656c5e7b8ec9bed3531cf643eaaa9faeea4e98d0180e33a9cad1d5da048befa6a81926b4b5e37fa61cf72e3161ff587ed9c7266080c2b93406761ed76b30cd6ae3d2f9e626a927d915b1a172d5818979818a14ad2c72f1b931c384579865bdeb04f50713c8bac8e7df731cf8d8337bed3815f90e701096c1b305bb88595382ea4e747c49abc8fe0b442353d826b97c69a9b100607a6a157825e235bbef325dd31f56730983a078b8a3e59509cd749390d15a3703ad1532046d8d693711b97564bbf20d395393b4058d89a07c783799007a9537f20cc94a193318b51b19f410fa86739f5f03f4431c657cce8a425e7556d1a00c4f7984f73a33a9d4424e10f61547aedf113c922797463270c8e3e37a1dd909a28185723b86be5cf34ba9cda810f639538f9370cb2bac129d85bc16a97f192ec2c4095a60c0a150a9d6f5b00d63cfd58091a3e3684d288529c2c639a462fddd68951ac2f446126189134e1cee8be726da8258d04a87b0ec120a65d36d95edb3433a928f9f2d02ae3c6186922afe0f578b8834e2a997f3cb4804dc7e3bf19cc5107db4fe215d1e9dab80e2adc5e8c0566a4d8d4c5e4312dd057b782b14dc50a31918b1f4a095b862565a2cdd65208b575a347391765743fffce1010c8576153686d3fff7642b661da97984c50bc6774f949eb06ebf1ff03c3f4c46d765446cd00747d308ec4c1eb751f5153917d2d1efda284977a469fa493b17d6f05c92412fdaad1d975737023d3a80a545071647c9fdedd6c02759ef3244266cd51e74fd6fc27bc2d430a296cc865232f574ce4210d8e9803ad511238b0763afd8b9724a81469ad08a2debbfdbcd054f7938057b627216028c07a1dbcd4c4b9146eb28d8a402c62a5ada9084f1373f42ffffd317c345ffc902de977c6dc0f17717604f0bc5d39d77beceb4aea2adfc06308c799b265a9eea7992663552e831ef2517ab36a977fe123ad40326f6fe680249a20240c151110e943b0997fb26593415836c74110ccefa3d489a12fd4b086b272d52df67a2e0effb99bf0ad535504c704c3b2648697d0ce603c13b2f278ca76949642789e85d96ea8815d8a579204a28a6735df7491eee59ac35b425c27a182a8bdb0c70285e07dd7e261b745d2c77aa381f99946fca2965d89439584bbe0f8f34e0a5a7faf3ebae13cb65eb856ecd0e0ff27bab473bb676aa9a88d8e71e58056fc6ecb0f6c02aa70c331447cee050a2cad4d4b9de8b5db4d61b2f4f700f83a37051ad26669723fd46a8fee963d335638d7b00f9264b85f8dabfaebe00037c3e0a3c5510696161718a2370e5cadb7c7352de9b7c7947155561bb086be8643a237dc504be14dec718d266e3f3594ea11c463218045c8ce8c7d99abc39ad123a736a09fcebb7325b9495951dfd18ede1c0dbd7a35abee6b8cdb2b313c5051adceac0052653c976537c719b46d95fac20c32ad676a1ea43122300511006020a3439fb11f855a044a1cef635d9db82f3717d3d859c71a403affb9118edaf0cf9641f7570ec54caa1907daa49a02ad67c30db98ebcf6378ad539953d52c13eff7356985102ba622cbfbe0285bad2381fc7ffecd96ef818a7e785bb8cd77df17df0b9d5be312e2ad6815d4500f744d2d99f709d8df38d2ff73c0f099fec65556b2194b4d8df226c3ceeb39fb01b54611739576b0f26f2cafeae380caef1cc5fcc6801d0421fdebe7c00624a972fc0bdb54159d43691be2ff8dbe06e855ed18b321f0c85162437819be2d5f2bc85a929344dcb5467bf746ecb1e7751c62a586add73378f8c181fd49d20539d4c40224ec8f2af4736c8d7c707fe8dbaa6b22a52e7f356fde6b034d15979e46725a4a319ec34d1df8b3c94953039a97f1f39dcd8d8d6e8e8ecbf2f732f7a16794573902ee3891112e8c84252d4a2ad9feb650a1f740ab09a27633a533fe9ddf9a5d59378f9615b82a5802c170b3675dfcbdd5cf9f017b20d5254a13691a54cc4c187f8db876b8d889ae62da1fd6666185f4b62a2445f2c8f006c46df04baed55165234e3dd935e3c40e6d25d0e81ddc987de7df8823c0089d99e19fe683fadf3675467f2297b214d46cd802b7bea01898ed9d0816ad2e2db64bb8d99327258c711b25942793862e9ed084085711a19d7abd72ca4ec2e21a3eb5dbbbd222955aafe7a09de247fca89fd48ca5a18ebbff333aa65160354043f4fe9bd4fece5431594e340f7edd99117531ed78aed385a36b56ab02d9f735dbf5759bdfa3d693de0b1d4067896a68d2e3cae0d4ddc9d83b998cfe46c92a49496b5defe253df799b1b28ac5a3b0eeda49deceab2a3442dd4ae20f7f823d9bd8615b39c3d73d552faa8d617ccd3918b9f988ae52ede5d1dfd596e15d3b7e6709f59a486bc16ec068b920e5599206fb30e2e925a523bd7199b5dc65e1de16681560affb1742d2145d57f61826a6b79b0da0e9d4ce39ddfdbd5530b7a755bd1a7a6f4b5eb7e4ab7a28af90e6f4da0f87dba5ca08d3b72b481b64df2a209055d4347a65edc46c27c216cfd8b244d563baf3f417c5b07a04d9181cd92261e7327500663b29f0003359797d8206e27feb75b5098018920e2c0e6bfbba08597953019b7c96ce5e6d99346018d946a1c079d285f19ea5ef30589ec50fbfec0e5e124a24a6aea4328d70f09961bc4c5ea52618963d9134b08417568079c04a70a07dcb3fa230410afc7759bde75bcfd8c2c8cc57c7ddd38714da4e87c232f4410d5cd58e4771f291d420db676d05d408560d1b0401b25f49fc7cbee1fca0fb4caeea0545f7383ca0320f8114c6f5b3e785085b4d8bef651f6528428eb8431ecdb42496b67eb9be53fb4393b6cee3e5dff775f771c2478c034be4e5242d96223d32ed1173c7af2f47d74e7b8d04cabc3b3ff3dce224edf7794592cb793cf45c8e45e0feb4dc95daec31fb9fe5eee62b3502dd6857cffa2fd2316c566f5e5317154ef403938bf681561968f158896f8cadddffeea5d71801fcbc3d2dad1bb70388d467e2022b903f5b6ce92db61e64cfdcbf7f4eea6ffae61006a391c361d323faef0073cc8724e18a4ede29d14a9ea38605c267b263a599c8cad4a45e18eab57a3f017d9fc1f0d8843d8d4466419447f9e3a2b86f2a452e1bfa39a5969f3929b1534b8200383046c37d863cc5a9777edb5b1b445c6fe4383399abcb5d129ab3b6ba6ae42c15808306d59ccae5908cf455b1004bef9a4fab76de3aab21a3112a286fae7b69df232fcab95a9cbfa47dfcbac0e50c4e0c6119115c3a22ae2001e7a72a310e5c7dbede41695972e32739d8ade11ae349e990077608d971f11d9c7ee4e8827e1f01116d7ef6bc9266f6a1c4b3265dbaf34c47ad7ab0a16f8a921eb11ccef0324b2fc8a840391890a1e4d9b1ba3f020d196ddb0f202167b78e9ceafd3fd5ba09aef47ac32fe2bd12b57da3ba4f5ea261a90952603d05685d9fce9811215c6c2e84d3186f7b32f50af82d286d45711d96eef3c6361ecf466802b8d969ac73f30d41d10ef285fd081cc1ea028b1c5d19935b5820d364dcc68d897f182ca2c7291ddb5004a82ad180f796ada08e13956c6ebd7146d17c2d9fe374d5a08b5f61d2312bbdbc0852072acd55c4f90b688c7b760743a33ed244b1e083d72e16c76dedcfaa6806ffe77512915151aeae8fd7f2bcb1579e0ad6a8cd27bbf3f405cce71f3928d7f7c4f25af6504bc1b1f4a64f90c8286c134c0247fa4481e49d87a0dd3ef61dc80e94536124616c8c94d8263ab6f503827809d180db924fc249c9bcb2728cf7720c3bd63d4943d4ff38f35e0661e62c83208a37f0552480cf6099592be00945b7cef5826fbb2f62e3df8c4e52604afaf28068c61f5347516bdb6c8ff7f6b68854b3102a21214a1b37601a14775d9da1377cd874408a55e396b325e033f0647b846cfd03adb34691645152c07dc2f42232b61420b0e69fcdfaca766a33d49526118ec7ac598150155d96764d43e2f01b5a039235bda67ff9856aae85d03240aa86db4ea7202605ae0e6ff3a7d7d3827394926b1bab38c877720c29da7ad85485fa50c257dbbf0be3127e6525e5535c1fa5f716837524cd3a18bdda968688df9971de8c6ce0d57a3ad5962615b32cae27a734fc5639f3a367b6d8c33bc7296c7f92320a31bbb45494778f6f0d6aba28a1a2e43b0aec6e0c3ba86f6d50ff662e95b74c00a2b6de1ee6a327f6426581852e4e2460fd4e8c9f22cf576654c3bfac94deb63442dba5efbba55278d96bc645f7f8d974e6e866762214c05e38c0bf945e828fd65f92e0795c041ad8dd15aaf4e58e23aba788a8ff32d6b5e1099126b462661dd02d82a2579d91b07812563eb0292878f3952c2d707c100d9b154bf5f2b1b0e95b5314acb00330b464c3b9e092253d4f4660fd2e484a0d8aeccfcafe4d48ff481a599a758fafb813097de32325e2a5d054b3388ca59d5d46597e6e24bedcaf4b013d70cdd25c65109149c75a7811f6b6d271721d40b9dda922f29dbe610aaf94dfd80b3cdccebe52f5ea607a961b9ef632b36a40d5c043bebc7752fd73192c9425cefb152b5906d8ce91e1dabb184778ecf49e40d94a903dfd1d1298718b4783c8ba113655b17bd2351a2ac1d26b5151f4fb1be2ffd6fd4dc7e50e314ae63f638560215590824adfe4de8fe0de338dade789df949a2f8b2b5d4d7a456eb9b8ae728e2a8f7f9b8636cc9596616c7758ac50d7d3e61ccce51caea33937f8c3b5825c05ca16a2e1714e5f8b423f0933343767a836fbc687702274bba380515c0e8fdaa6e22693f196f3090fcc65a6bf4883aa07e8287a5b05174b6db107c8b912494c06aaf059d528e0b2b4f912b0b10abdb286032fee2593c0b1920779a1795fb62cc6ce16f6c30944391c30adca387ac43ca09b0b545745edfaf30fc7163e0839f5634049447c1b52fc7db7d0ca8e4b4d22d947d34520248fe6aa65801216147515b4cabbc49f4190963b1c334382a1071aac7efc63ede526ed9c992456edb72c3f59c976477021b76df85421fdd1eaf943c7a1ec719bbcc1fe5cc9533ac990f7735c91ebc4bd8d5ccfd8f4c6f6022fc75e43fbd513a4a88e968374d2a4d526a5c3fe25ef99aa088677fafea86e5509992972c52c2cedf221426a88f1a7fdfb5a31da457292eff36f2fcc059997d4ac0b1eaf813ef4b85006ea261c9b6eb02d429d498973133cf8a552e689e3e220963e66fe8331d6cf1929405db8a6c008d994b3f9e715004765f0ecf8158312315603acacd3db7847726560e7493d439929e32ae5bc2300a85cba2ef39c91f7ea6a9d3e211fe25aeacdd04778667dfff2931ab39eb6c0d2dad726b91a6bc933e4f268a5e15aff6a9b015b66a8929125137623d1b9a1dae2a6ac4eb598b44f1682436b4a0f83d98b40e623be43e4faafb89abce225219a56a70b13c3346706b417b53df851a3f7a1bf6d9fb1263dfe47b4ab94599f0c0086e5e7a93822bcfb6bad9b1a4ab36f7d3ccc897bd56c49c0d4ec243c82cf0360e3452db45ac15f5d75232d6d3eff13dd53ac800d26d546f81d8881bda388e50e009df21d585b2eb396ac31aca012f694e262a267fdea65f76847f612325020d835880efcb6e97f23b4c75cda12ad6a313f7dd5cd3e451390cbe1eec671252fe0a482d86139f9a0f6175c5231897e07cb4554fd9e89dc3f44c67fc6143328c41d23046537e5edb6b083a38f5a4411aa14c7b6177f0174d58b39e3c7973f031dd5cb6e064aa2656a88e7be0bd2615e6b72db3facfd547ebe185ca7c28e7a1d9b63668e57c4e7aee245d33ead64f9270bb9caa38ca787afa2f6e41f02031a88d9a00e2ee346a0b6fc287203dde14f8d912108f6ba35af1f8a7e2c1c76d3a2d90ed0d5f6fac14c8d419bde8b077ad76cf49e19ce07b8bcb2901af0eda03dacdec7a579f53e176828496ee5f69cd9d79a012eb6c249be91b9b1d165434774405ca701dd5516a529ba119e85120e62f90dedb060245c691e0c2ef28638c7c9ee8ab21954ea6ba4aa6199950cfff3c4382a758c68c59c5dc3bdd761de2d82f81964fb2cc635f62842ad7a18ba7856d966c9898b2ffb61fd5ffba66aae1cf09841001fc9b6c82d52e5282482b05b34cf7d08cdd6108de4073420a6fb64756851eec970656527c1a15cfd28542a5d855c767923f8b910a5f96c44afac0042c4c65df4e37352c5fe2b2d254da8de29f55df432d9c1c460c1c980eb09990605791f3d58974838841eabd8cace0a7a4e9030ab27320b4ef1b14a473bb2fa7209da7ebf16e1429808446a3fe0db909c26de87dac7b36e238d6cc7ad56d82ab2868b006a85c5fcd200bbf006348375d7cb303e05d0cccf5d2e37c6e522c7fb669226387462fa0cd3072d04ba4533f38deb65f678f6beb63807d54bfd011e94a90e1bd96229f068b7a218eb638bb43fba5d3e900840506ebc7598d8c34d38d6528f1fe2d766012f0bac0397b301575160d09c5e8215ed1f5235bb8f65c3fd993eeaca1e0f10396d0a0088873987a151eeaafc6189cac533f2c950fbc8267306d3b8897375890fc4a9575c16111c9e522a202c4dc936ab25a881b1b41171cd29e1e1e71f80738510e8fdb930d6e37702e0a9204ffe3bf5cebc7db424347e17ac07589bcd9ffcdbd0a6865d91c07f2b7e33b144c8e4aa3e36027a3371c5f3435163965c02ff6c47af542eef3429fc12f74ac0b17ea29c7fe0f5e3c980aa6c34ef6c18bff9da36ea4573b9906a0e745cc810feb3a8576f41cf55a1d9666f4b2fb310e22c8c7ff2be5bb099d5aec6dedac3b256258c1d4168c855e13081e8faa1ad49e83dbef34870163f081b58fcf39ee973b6b133bb9d0719e0c365da6bb51c4ba73d149e50bf8f861668965016ececa66cceb69c669c28a8cedaf569a3d818a832067cc1ca9b2ea5c3569822103357a8f8ced2b44acc1208092374072d485e870885d81e4225a8ee8269610a1c7364718ecd67d79754d0dc72f11ca23017b9950a4328701563c1056497b57a0378a07b0bd4216df5a88023250872c21111d68de64db80bacc2eeda4730680410655127357eee2f85f29c337c40ce2c7573ba08e4227ac90098d7fc800cd1695f4f948b6ccde801087390345db23ef7fee836056f93e9d3793bfdb80becbbf9b0e14354656c92d627138ed45cb15c70d3613ba44d621f8b00537f2105a74bd9035e415528b896e343acbb58c0162e90239ad5903e5baca164c41bae29d73954becf9a25d5e8eea7092cab29836cab71751a1502bf2f113df0371672c89c00c7a27d5886af3c9c6f488240b162a981ac4def284d6455d6cabd1552ae9397fb90a1610fe5578279f62134abbabf82e4595979458c662e6bb73c7e28fc4d892322cfa25935b26e2d8b205a0a0f826310e80c8e3fed9eb85c20105997595b54d918edfde7b02ddbfc37dc48ae16e8b786ea1fac57bfb0d755995c157ff6335404d8317bcdd3769d4adb41b6d15546882170d2b7ff771aa7b96ddc00415461d2f02307fb3a23a113549eb9218c027d8c0acf4d9533a4a5fcf4ec4d8e39abc6516286f0ef95fbd09928bae5f6ea0621f9e467465e63be9a882af6ab37e476ce797414e4c2635369abe1dfcc3c84346c63e1a6b5fa244aaf8f9109ef3795fffef2e98ac51862c26221ffc10fddc91a697a7f0bc36a5b1194f54e94aca252274a8e000de5ce84fdeb991a3e27a60b6f710771749aa6920e8ee2e2f8f4969860eacb283567a381f81e3fd26a5cd514a672c3d48f41b858b7dfcebe92794b39255e465df1818a79903a4dd1b1bb984270d2f0c2b17d06791ade8e3d219ce9362831c0cad5e9c412565a276a74e46ae7aec42a6bba7f9b5cddb45c277b8b41cda90c99cd4f36ba6425a9264062872253527738832ac83ef15651b67ff1b2f9d98275e972d6bf8a38cfdf220768e62bcb8c70b8569f07469a522a9e576aded10372f2afc2ba20087dba5d0623d87a9ee542860d98045a8ebeeb7c94fa39038fd2172cb934f879c621566e2044e4aef85366f1dd2557343d15cdd50075698683b77d172e9dd55c988261c1741bcf2b5e073909543b4fd15a079397e6c2a2862f7347d2a9d024abf33e1a885c9fa1873141ac35d9f813a33e29647767b84d1dc7a093056cb72d6d4e6e9c0267496e0956c425a09224b005009a52db105966d66ed7e20a3bfb03b7faf7287eeb5c3612b69e90ca6d4e21347ea7808b2c25abc7620a57dfb554e03841abc15503bb9684c582eaba45953762a895c380ef3d92b2c8b50abbfe43340307a07fba148ffbae9bd849b1f46c7140e236e31f4afda32929b97c4d19a6f78db2dfa8c82185683dacee6d9e84e25e534504da368efaa8588be2127e49c9d090bc984274cf7e750605c166bc1945934bc00dd573b6e9fe61459063f4edfb4c4645f2fc8d178f95f9fb1e4862242cce09a65497e0c3113b4ed02cce46fae438ad0dc69c8d367ed97990747aa991e09c3bfbc8d85e21503a1c66cd075fb72b530709f345c0f7cd5f12683f873ad9f2fd5f5c0f851ff2daa7caeac81894a4a7191f1b1ce74df7362891e8d6201c7e5889dd1fdd5122046f8458feb4fd63a4419e72fa4d9f0b68ad5bb510f44b2bc7e7eb0053389d7b5cde70d863e8fd6e3bc39dcbdc1225bf844291f130c13bc0a8e2c4017c8a00f90cf7ba49265bc21fccb97176f22826c197ced84f53c84a0527336bdace19203c6ad5dda40a18a137eb9e7fde042cea9160c6502c680dadbfa8598da8aaae8a4be829281bccd79d9cd60b88b9e24115ad5e13f563f79fe544fd28c1ea71335d7c2622a51b9a734d762e72fbff8b2591a8188774218b2d9b099bfd5dc5bbb7063004f163aed81fc93bb3443f42623c80a0e7156a8b2c25b891d17239c8b2037d99e18f2adf0cf4446ca0224d2c744f7cc921bc6f1f50675679049180d7df19d94fdfc25403c963e71a155c2959bee267d31e30d5b7096c1e08733faf53425ffa29321fa5f75ce2ace0d62f6394a1b32d7a855c8f009c67dfcf97ae3d9dd81a08f710b5e1ee2c336d8f50f3a34a416b0425278342409eee8fc5eee98e6ce1e0fa0845f1af5b19b30d0093b7cd3e60bce0b40f3c000d8acc78c2741bd676b4df828e6a1cd467dd381f3c2de0a7fa86017808f8ddc407abd39c1270abdd3beb3ab9057114b069b79085e96233c9fef32fa4d73bb1c7f931c9c2294720b14fe66fd506326a8360e04b2304119ac6d083a4f2cfca7980c8f9338681e4997e122657fb75382f527d95ee71afaffee25d94dccbe06e3c04aef0336fbfe7033cb5df86ecc19f2e9d9bb260dce85d69963ea2bdc6475685bb1891786d4fec077593ce68530213c80cc3cea69fd5c5a1024f80960ead2d8b6592a42f4de9001f85905f9c24e112e21a0b800d18025629837c55f67d4059f1d239b3f7022d6744de54f52fbd29fc11b70bc229e97f44982936665a0b95c5a354af717981715eef139c7d5bcbb310dfbaadf60b0eafdf416683dd99af85a4c13c91a9705fbf8048f797d178eb36d7781256f08f9b0cd7661c1dcaf27e2956da14137a7d8d31db19e2e8b2f6e275bd1e4f9e4f7f70a2615d9787f27b16138c2cba006a26b01a5e9ae2ccf1db12bda41f2758f4dd589b17c7507d711c005ecb166ce8e05a8e52697b0ec9ae611c5361695c778354bf8d9bd0eff908b0db54365e95ce794f8af0d875b6b0d3bfdc7ffe4b88d89a3db58bfcf69a47d9de4c06acd14b52fa07ee0c943d61cbf10ffb621dac2645a10040b386cd193a7c7cc7188c1a26e5ceeaded6c666535c388a99cae5ae412da0004e3e7377aa583e25d018a87153db0eaeb6e41b234b968c8ea6a9b87606eee03c95e93f31b2441b15593151b61beff93a09b6e1cff9f19f08f77b0885edbe95a809f11b985c1c4e9b7ca15b84e5bf65bdf94354a5685c78b821c8425abb08eda4390c10bfb94075ba31fcd311edac2e4153ec37253fbd47c59b71f473376828f24ff6f996da5ea054cc5e302ca9123ec5f1bf3f2161f39952175a8dbc298cdc2446cec421fc04e797e4e6f2a14cda141a82ae9adedf505999ae7e148524d7124b753fdc1988ac57e905654d9a8df6e6100455631caae7a019b5ccb8697804b4459e673e3e2ef7e01653e0efacae60d926d64195526ca61816d8f887da9eaa38ddb2f6c915c8bf41534be8b3673e4efb69482646832d6d709d9d58484537068bc807775f9e8394e2ddff6cdda17985cf39e2044e24db79cbca198b1774478c21d6b308b14d264b38581cb56b5e42e3d7faf5af824d5b0165355680f4468a5620dce198514d410517a8ebfc0d7f79015cf221c0927d480c86abdf187d50ff938da7e764e8af4f51f4daa89a5a10ea2d021c1890e899401e6d8bcd65190d16309b4e298cd9bc8c991ce1ee94ac167268a08da2c0015cfba1d8cc41d8cdafa95d92fa4ee6051b19fb49354bab41db5d01636c78cecfc631c31c2fa3d8d10e133d1d16ada7a17350b55ee1a4149d3e9d9a887cc1bb61a39f86c69ef5fae0fbd4a4c81b73d639d6a9572e4c3fba0fabd34aa59ea0c49da37dcc6d2eecf54d2e9f17e7abe698d8611d5983f4f7901c848ccacf6712f49d2cfd728cba262cfd26add728092da3af56ba5166711b455ace798e0292e0368f154e7c4b31ee4e7812ad58f91cf5d32b60dabfc0cda02f2421d1d378282df910ba78dae89665c1bd61a926a94bd682f78ceb67899a98533bb6d92a29b50a2c03f2054db02629d77f7dffb18bc04cc85e5966508156f1bb47d6ab2d1732baa16d816d3ab3858430e4e853103410642c628e57afaff12ac17b1db8bb43c17736e3bdcd06bbe0dd15551c813bec2ff936abf17ff5753d1df4719fe8abcf9a2a4555ef49d3ebbe74b1d0add0236c1acb7871ec1b7edc5c298184b96fd8649379a5a70d6605ba662541768ac4b254ffde3e4eed2b0cd6efa5ccdfca6a024d8f9219cded06de4e4f24d762fa82053fc8309409cc61c1410456cdbcd22c7fbbee3907b0002492276b3a328350e5ad639012ebdf3bf0207f8fa76278ae8ea071f05f201912f8c4b4d61a29bb563b29d1cc7edce931304d7de5654e61ad900e73a410c421086985f0cf15b63ece18cd42dc755fcd1fa42d48011f0982fd80b7d70a2695455a3c4788a5869af9a247236ea4679d17979e2f4487d3d2bfedccda62209b2a169198eeffe15961236cac6864fc5917626d928c060800281244026806e7972a788b1b436f974162ec7c5981bf08370c69d41db4b6c28adbb870fa0642e099af991100a2a7f91586f478973b9f42daf033dd938bfff0a534656e24c3b941e830646874fdc58fdfa488032625be220c5a476e686ff52b38b286fa6fb8b91683a698cdd607d6b5fb051fddf2b7ddc5e3defbf7ee35aec6e64f06e06ff064085c236e7de05b544b386489c4589d1d85649a31c4b781274f2dd5fc2b9ad083e52df73c1e8022e24cd73087b8f4d5bada7952a016e21f7b6e921f391716ae87bc123671bf893ed2a4c1bd60ebe45b1ff02485b62ac446606692c1f8d0914346478bef90110929a45d6e2c6a5c4276d07eeacef4ba891364c6eac86db22b95c653a4f5e0ff8902637973788ad1714cc45ecbab0934ee9bfac63fee262362f24e3a391e39d3947e5e6a02024f1ac40dbe1ec2b16c7ad5bd0628034f8a356a81c300c0ea0bd0fb071c5d3a24d36c0b279ff1cb644ccc93075fb53887e70ca2a32a0dcc908f0627882ef2720845dc1ebdbc3646401bdcd5709652e672d9984ca27b66d1a2329a244f0b831046af6a959125d2fb57ad31ba9dad5216e690d80c4b4bfc54ea6f9c5a02fed76dfd8ab6291d66e4e4d959bfab78774b305aea0d79e86518fd606ee01120662364481a941ece39bcc27c55337e15183ca6b24ed1dc7bac183d78dd6888af00605c71cd6fbe4ad986707666494a95d498f74a68af082c826ab49431e3155cef653c4a66e57110275859629de250ab829581bc0bd75b6772e2bb24cecb6ff492e770f8448e79baafcc3069c4907592b38a4cd95982741fdd6bb7c1a82af434de4a03f2bb45f58726d72f29ae04627535a946305f86f45cd538752d10128c225da1134040e593cc03a3766a674b7ef5592c9791a4fafccf3908d586f1fda15abecae4d6040c18773737fd65aac85d013a4f0dbf6ccc0d6f1d7790665e3a2daa270a5c9bb7171ec9ff4b8eaeef7cc5bfdc8c32404f4a75a421734a703d01c6398be4b5e164348c981718e314045d2cb27fd55f29e1f3469b35f9481e133d02b49bcfe9941cd0a322ed6323c27473190db61449461a13cb6f0752a30d47c14795bcbfb9d5e353e809108b961fe274a4dfe862da335ac5c668e55d46035bd28a68c9696e2117b1d30105bd794e39b149a29b8bd6f0e487d8317cc01ef3145b7d50b1d682caecb0c201d5f61b8f9d06c5af285207b61b49370d4d4c2a43fed8fedb2eec6086863b3c6a68b108e930046bea4021df11c230e2b25679caa7c0d22f9322fbee5404b17fed1dbcfd24037746cdf23627b030e1774034888db1aa83efd09a0df07bb6312ba76f34694b881ba0cc61133f39947d3e3e1d0190b6de14d6da2dcc514e4f4853624d480c9e502b4ef4a37fb6af9f88a28ac9af1945b99ab0ef7a7ed40c117c0559820b9a2e1f3c15dd28121919d5b20f84d58e654ae44d0426353d10b8112e3f36f7024e9054ef83e775f342f0088ab6fa72d0d082006d216d75fdbd125bef5718d007c6e3777cb1628cd4e9995d2e54d2b15150ed2e6285fe779d338a5874327c10f6b2e39bd575fbf216023c0ef63fdb2f3cc0aa39b5f689bd54288133e874e8ce7e4ad082fb8a44c4248d52befd796c2342fc382a8dcf5bdea8377b862195872b9bc1a07b49d0c7af41a005a1bf2e1d25147ada1f22c7b92fadfb9025403108ee3d2b75386fd42f58db872c28d92655b241333ba7bc217ce86c6c9e6ea3640dd63c64973621416ea81f117224f1d537115cb2426156bf64d4917aba2bdf270f46f9da9f4609b3cc21a59b696814d59a4add40737402e6197b1a60cda00b3de0f30af4fc92deda6fd251fc3e7d403c42705d870400481708760ece56d196ced63406e4a10a698cbd7e16431fca07e38354ba7b2db1978aa8e8353f5621a8a60747efa5574f9ffdf2ed62501c839578f7c8e8d7390e7f4155e1e54cdb8661839659f4910aeccd7a868d1df5cd4f26d48f560aa8553ede8bad1a84684c20447ee421b25bea08bf45f4251d024053b89a37bc5edc825a0f5707c585e5b418ba813ff0ce2994590274dfb64973c5122f929402e747a8830aed7c2c3411e803bb64dda1c21b090be6405c0ce1388a03696a9ebad33cd6eed43ad844aaaf6e45a98197ad3899805631c2432ee48d7c88984720aac3484ebf1420d1e03f95d9140b384962f54c5473a50582e9c3ccee9232687a09e85e15e586f12f931c80d83018f38148c550273af08a1a35dfe3f002f4505cd2285999005b5d82bb3c95f91df7f9747a2b3fe3fc513842dd8bcb79507b56cb8bb353f8d4610b985ce72a91f49b470d5f7dc4bfedae883fdaf3dee0bb4db03f6fe72c46ead597358fe0d99621cc69bfa8773b194aadec0d66e020c5ae24c0c798dac5900d840530404b107ba7fd0131592cadfb8f3a97591f0bcbbd8f986c306b3702a9f670e0b0f17518bf392b44f0317436e3191439f0295d737b537d6d9029c6be63e137b016d0f79d38227844192e57c8cdb8ea37d00ed2407b9525bd9ea6628eba8855f3d24bcda2acc47a6f7506e404927cd1e4bbdf96c8d89134ec49f80f6e7d310e40a421d01cf757f50cf195c32ce4102228196470ae503f78ec050087c5272f110212beeea1d02bd6a881ba8603ef73bee356b9c774c18c17a4c79f4210d328b885c8f80bf585465a6b8603f4f8c16c09acedc59d3e7f8e9da5bc8fce745ae36d7043338e115393299a05ac4346ef18b20b8053e8bc3aedc2f386473af24b6ac0551d5fbb6f07930032b7f363455271ca55d6106629a139e44627cd31df805cbd152ce853e93dcdf15514feb23b8d021abbad89188e178fb845b983b998bdd68a2ed646f28ceec3c871b3de6f6f144f8225bccd5c3b7b8c86a01f7a03338ab763ed933b5e4a0a1236e5d11ffb8f0f53f52f4f7565a070d764cd0a8569425e8ca21914c172494f69367f6c759d464d95c8597e5a74387b150285188772d97395e845636ebe1c428e4851f0d7fb556bd76374bbb2b68bb9db295eab67a240f0f2cb60cf2dc80b10a7b49aa4d3af7c7f49c1a9d7aed37598972bd442437977d34b074840ab4ca729073855f3ff2abb94bfd62adb8606c4adb4cb37cc8f1e307b111fb0b83adc58d5b3c7f6886f11b835df2ad0c1ef4326c0622fc568275ed3295a2a6ffd1e8d86e2980778597476c98d8654b5d43870ff4d131dfc6b8badfde44948af777172471df805ae6c88ac4d3ea0202e60e8985ae35cd5c2e57c7840592700c4f32722c310d5dc14e7f55403413f05a4410d692cc7daedac31aa82f566782097f074e46094e1df4930df5d5effbaf83396cc773e3509b262a81ea6908cd4bed4b7ba9b9233ca426e042e071bd496f29fb10f973feb3194969797a90827cc1483c9b1a4c7d078297004c335924cba5836ea421a7c4e1b47b6dc655b1eb944c310419ad691e3f6731695132278a17ee526a0c0d2a8e13afbbec6048f924f0f04ab1dd789433e12e86a5baf5daa9ff70c5938391ea5b3b18c53ccebafa67fc1751bfbd70f436a2a5758452309768bdc99a469640ba959b8c7b159511bf4d0a475efe333aec634b161575a8f3c45611095f1dc4e2853b1740f06db94d772284b46eaf832e160273b71a9f291511420481adebe28b0caccdf6f2c43bd8df018ae087b6337f7626826954bdb1ef41d3e471d5fdd6c76853e9f176527222e029ea803ff2dd8a27f59ce41e74aebf1e3b5fb56cce38797950aeace6c69e0100366a9d18d8d4215d5c13959098ff30e9a9258c97f0dd2e160a28dfec3007f77d2bd1ae6195d1b12d44325b5eec8fad83f377fecbae30cc50f1fb326ffa52a7a573e72fd47316a5cc068511669fc8633ce012d6c03b37a580d2a625e7479b6f06d43bfc4275d68bd9022ba669463148048ab9d46ce8e81905b836bb65124e4d40e86e20f12b493f0f3f780388dd20ccaa6d8118325c9e3ad3c42228fc4aecfc5aa11b73b4735722dadf7327b423ce6e1421e06d1a0a0e9f0f8f539db4d296ed894d36105d6480885cb43313dbe51cc4771b52ae13fdbc080c9130b0dbeda952c8f6db8934e7f624629ceddcfe568f2240a01678d8e2d4c8c425847e32d5af395fdad67792ec66d0e38a6fbaa1e5ab37da8dda5afa15d0503af874e5da19b889ae1297670f0bd2ecc9afe866f0b92f4c05265d07637f065d5114dfde8f20a2a5a47826e374a313928b0bf5a056ece56c7e0a9dc463cd0f68a0d0b6604a2e6555d527b84c119cfcddd8b0a4527e64191497ca5177247faba24aafc9047f8b6ff94edff00a909eec4146fd88408da8778ff8ce36e85ef2ee4ea281d2bddedbca19af648235af0f92b0a0a2b38279cf5457da0e472455ccf95d1cff34a4989cfc1a6f5924f3e781813e9d0b1f52362f0a28303b3fcc4aeb07277cc3341458bf8614d3b864d954e97891ea2818e6a314c22483f00037497df78409007689c66d69016480711495fa82f16fa2c9318953017d64dc7b474176f12510eb9cd6633b14022842c8b2b36e68a396828d15ae9fdcb2b773f359f30f726a2be036695f5a8db62917cadec90366e176e5ca94030acaf933349f137906cc0105bda6a158ed2c6cbbdebc47e6b85d8670264f39b220770217ac0549bdd347363c9019ff980c2970ae0537def732f528c7fb9bcdb063289cc640ed034e736561ce5b8b32d359f1f36f93bf9a2179a266796b73910b52810b2cce3b474a5d8e9806f66313d98a0f10b466966f7c6f3a0992420c062d973ae3e9e56436bf1438c3d9cff181f90cafa7fc0a0b84fc3c984779c619150ec397ac32636a1ed26712d7406059e4e941f44fb47b53dda2364c433bb92d29164fe013b313b97814b461c8264e66b041e9effcd3b393cd273c6c24ac027b10cb84df9ec5b537307445972ef5fb5e8a88c8bc7f624821fbdb9bc174a18a93670378558b84b3772d51ee81996345ffa77f9ec161ea3bb7ec15edf9e5f45380764cbead895a70bc511a54fd9e07558d674dc5ebfcda6285f0db51477ec4c86dc527e123352090a8933c10d0abc52121c1f8c89f3d706b980e94ffef8042b044714541f5e3c48fb7d1b609fcbba9bf8fccd0295ac4e8efaade9cd48385dba0411b7e6d152a24a2f8858970c3fb3623ceb7181110fff2850d39a310024e872c397a7df5317197b02af8fcf2cefaddae083b011e5778911a2dc8efb70b3364ad793d4b2ee135c90fbc56c0ecba1a981285904f6e836919bbadb4eb4d2df2eaddd26b747bc8164c8beb1fffd3aab11a5591fc94d58735cbbaf14a4c011d3946bf1fa9fe99fd1873209ad4a0c8e030f30c87b96ab5705a22e983ad0148391b905a3b80dfcb93160e830ec09fa8da74764544e517e03a076561eb8e663e557e46252957807d1fef7c1a85df9a64ae7fd3392fdab5860e7accc5dbc7fe465d47690ecda9dcfc2a934dc2309ad42182cc297032933c6bc50c523712030469cf694d9ce4c44533827e15fea74c06829a78bf0020e870b13034f63f92a102234b3a4cba58fb08d1404dbd6ac13313e271d5560952ef7a3d2e3fa7862dd4a77b826c46ca5870d3e8f84f087e589e2eaba6e708fa23866bc8c92989495e0748a0a5156039433cd00843f487e862fb704c2e3a6f2d1ef14d81bf2b4fe36e176a8489f7c5e76dffac3f776b3a27e099604c2636cab961bb7333172f74911c11b6f73d06154b6bf83825b9e437600aeb6f8aaf0318130cc1f2a7c8f1de50a52f47c5243c9810c2dd1989c97544a33d506c89a4a4823ae4cf2e5d06a84000a414847f1f8f9a39ce756bede8b3afb400f9e9f07e0005781ed1182af5afb6cf67497a0763d2f7f7c285b1d7eebe32c8e3d6f0558d4d2ebc855e935c9aa8883a9b4fb880f9a68e852e7c7ad0d2eb3a279786c4ba1812fb16be4a7186fa775554cd4fd203de24bbbaa1ba7a4ccaddc26108dcbb30f386df52df737f6f0e02ab5fbe33b05bd8b90283e5da154ee1a8082dd6eeeb51dff7f0aa40535b4144b2c33ebd1e66bec8674e17eb1b0683cc57cbfbdcbd45e00eda570168b682962e058ebd84e7d5e0263cb2473735219a76ae7a7fc3a774b0051858a8e0bc4c191d103bea63460675c73dbd8be80b59683fcf1faa1392d4d4e9d9b5d6070d1416df92fbc4405260d11f32103bd8b3c469e40b6acde71ad8f7ab81a13c848ac5fb450b009da777442511c8c316f27d8d2342d29a432b45a40cfd31fe9cdb3430f0f15f8ae693c41d50fefed92f3b420a60e5c9241f774ad74a2ab03f4d5a81071a22b78bec2b9fced81b244db43fdc2c35c887b81b69714a286a86f1a23208adaa39bf97cc32197123874ab309e9b620ff2de465f500811b0de17432cbe9c86a7d13d70702c32e235ef1790850fcadc1de48f551b18e671df3168febae868fadc4bd84c400138d9cc1ed0180a6b327467895dc6e3cf9fd6d47e58aabfb396b20841ff5815abf4988d9646d005c9467818eb0e4ba15b0dbd8be9ad104ebb829f58a73edf2ae58791b1c4865e209c4e330f6d4d610516ddd3542225905f92b904aa1f0f64742ed58777dfce7c7b6a3b7cb6884d53cf99f743cb4be917bb3fcb201e09de0d17149771ba2d8d27784bfa40a0acbd3727b28ba14ba426c9420f32705f85e5149c18535d68b656aee88f4ca9a45374d517c77df38bcc6a95d1dcb47b828847daea3717294081d381c4b93da62358a8f3de3c676d5fbabe9c46b43b5af5b61e234529b77a31c0fb12931d7751accc556274d2bb7342f28f9ea00db627828c5fd630a140c8530757450835b3430de6ab07940600a9d9bf5b4651ee7b7d039afc0de42c82ebaa5396b24710957fa12e79b818332b9bae7e076bc50f013def5695782810ec592c152c21f7e3731e5ef07db4f9b3493d255fe1fdc1b2f14c8490df508dd7e7cfe4b1f9e445150892ef23334044d897d78c152a749902ada39968738dc698656eeaa7c235bd40b1cc7979ba3e651fdc295e468e0bf5ef5da88277e0bc0339e8cf314e9bc75e97e57105b03cbcb5f009e71367db0d0637f794dac64f56caacec6bcf91e1e0b62679105a682a9aa1656bc3c42ccc9c009c3f609cfbeca84fa25dfc56f4d50ebd98a8e9798c657f4d534aa88e9dc23b0439265728830b2ccecedc2cd32766d1828e0abeeda8e47d2d570f2b2870b14561aade72fe09db7a64e7508150d60eeee67ac1268d2f06d03dd8225bc3218faa77851f1f5ace8d6de03a9ea2e1e55a56c9ee110de28a462dc8f2a8fdf6e2f1b2e637f757f21f1a82667df044cf8961b919415f5477772a40cf471a90fd21bd92a07b79419c93344c2c42e828933222ba4ff4ecfdf2d834dd53b72ac6bbe9dda1b79e828956f2189e80eeda523047e91e97c013444ced19db765fab9a7cbcd133873afd8d2fe99a059d0e67f02a190fb5266d4681046ea38c6a05e4c507c8a594e73c3ef13ba8e3a37981f7722496e1e8482e89fac9529b9c19da826ef939e88631bd27f025a88b51e13baa6483ee2b37aea54cbd50f7ec2d597d1c47cc65d36451fda139d531c6ae748831010e94112e06d680d8dfb8dc7b931094cfab12e12578eb924f8c03ab40685136b41b21eea501f9c72776214fa51539c033a43a2ff7eac7bb46dd03524d7f6158f7b0f982581cc1ffa27dca4f4f72b852c2b775a21ec545ba6d5e982055c4cca53b7a05f5054b9da73306796c5f659bff9a203a72abdeb5b33468dee2c515f5bf74afe1d04b5e024d7c16c69671834e391747a210c46cd5ce35a4c91d0eb3772e092e388b30c8d8b5a8f541175af2a28bff5d83dc730ad4dc88815933b7261732022ad438eb1ebf7dc557c6136711f0fa0e79377389891c50de7a99b8ac834e882b4f8c6422eaab799c8c09e88bab158e","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"eb7382aa3d6268cb3485cf10eef782124905ec6a87be7f54de48aabe14ab215d29a157a688d616801db3ec38faefd961598063b0a3ea0238ee8257222d0012cbbdd78d8a514d8975cfc3f88dd86f625ac2dce1755ae034db497e9063a4ad3cf0c760c4789a91dc691b958994e20587fff5aaaa6135dcd7badfe7a0076107a986e7dc51b3fa7fd62e4b8998dcc1367be03c6cd8f0cda6b722703ee8090e5ba468139baab5a6cd1851de8a6fc67c708957f9ea08e12cd7011dd35f59411f95707a5014861646f7bb4f6543e51cbfd21838c209e28c12154ec91c3df313716fdabea6af9b90136259dcb4458aa593cb0d304350f8ab2efefd33a8980f7cb652e56964fd5a2a56c818e3b7f116a9ec0d16362730781c744ebad381eb19b53a12ddc49691c72008be9d8a1df0ae0dfed1748dd9ee9bf9e78a36c6c46c10695469fd565f77725c780c2c2a970ca2d65f2db83d83c5ba1e8abf3335d95ee371593e7ca1464ebac4b8bf083fdc5057efc0646c8b33cb496338307d4b2c0365c045490b67746299192104bc2b24ca82eb416d6886f54790d2b799cfb7cfea54283fff2ec9b4a4fc0010a3b3afd3fe8706fb040bb442ceb35f4cf405735454da7232b4e432eb4dd8115b66e95be700f67c14dae4750192bc63b4a7e4c07ed8f9608348c99b16e09797909e1c4abf5c31756e11312249cb8fafa5f1dfba805cc36373b5cb7edf6cd50e8abf7b051bdbd3a501d5acc77d035fb6472a50630c46a3814332e051442d0357726c16a616a8974f9bb4d400f6a5e947036b6cc092c4c6352ea9b9cffbb93c64d27b79814e2c118ad7f91284f5090758e9f4b7fcada9f5dc55d4ed7e0f99f89970b156b34b9eb0314e4973377afd4ffa421966eca5b4084ffa21ba19c7e1d62858c15986c8ebe12cd20fa5069c2fad1ceeee7927f2296504b731c785625fdb2597e60f79fe9ce697a15b1d50e991fee103935ee0077a8a22844b2bfad02392f2edcd46064c178bf09e2e491774b5423118c2c8c1034793a348b039bd7f3dfd48bd3f8c753fdcd50fe7f969fd6c378832b0c0d7f5efd45aa4a55475bdca6bb3d4175025550d12c0f09fb54d8f38de1740107eaf342bcc6fffee65225cb74f03dfea594e325a22fcb64ec245c2a6b0f1b0a35622e4436b62c35082e2c8fc5052f3adab1fe6cf943a5d6de058e2813899478449ba7f6caeafb0456dcae6c185a42e837214ec093dd5df1e214eb409706fc3f358e20fc44b401456dbdad00fd011f1ed0e217d36ade5a5979943a0146a0ee58f69d7a58bf200bb43827e55abd40125fd1abc7c589eedf9a81c233e478edc4dfb5683e50dd1d8f3e374560d1777e3a2396ccaf882bea7f2802fd9d133854f5d89f3777057e7978c2b08dc1c5bcc97744e3a9cdff9a471b7036298ca1835cee68d3214d8c5a66f97d21717f6c2e8642a90a8114fe6a355910b968c9497ad27c74785c0a334bbdca3d24f945b06ce91e36a0ba0840d1ac5033fe13f4fa819b7946b8421afcf0bde4dd4d6d8dc50e2efc58f2fc2c83475262a475cf5fc8272dc6dedb5d8e672dfb8c11e1f60958b12194dbb306a1d01709e6bf1c3195259b6368a7bf1683aaff2927fd9e869abb2d5ce62b988cbc5cd3b92f2c211abf52e36d9956d45b57e74adb941e16e37fcdc7cf4be5074a13e999316125d7993601d448bcff78a8bafd49f66712db134e29d6e765e8c24d7c52bc41d3618b4276c30a139fb92008f668151852232c2d86836eef0fb3dbb49a21a138e473ed0d0ce7caf421838962bad12ac66571c989eae20918937207ce2ae2d346910e2b5f7d5c7ce1ddf667ad1d6fd8644e33e6454a09f4f5270bef208026d3cd532b00d3d91c1035bcaa259a0e0e321279126e05fb11fde10a09233e9eb10f9f20819eaee53b5302a86d9e025ec1fee7e0f9db51b72f5f4d65bbb406567753b03cda0978a966a06a0be02117539b7f23ea9797e437db03349305f0859c733136fd9be7ef919a425f55afa4cc00bdadca38ce4a132c34518f05153043a8327fb8d2861e9fd990383916540ce331852a480c63608c095854c5b83716a08d97ddacc3b782b2546adcb6d4f8091130109899d26b3ec2c315d8477b2a6868c924fd4c5683b0556b87926efe9cf7c4b3f84911cb67de6d5adb93353eb868fcf07f25922cb95382380c573c67e54dcebb8b3d12306fd99edf4665730c611199422d06125df458e891498dc2fe5a6681eb1b243ff52dd4ea471ebc85bc46f1564b60f08c8ab8562465de2164f06210c129e3b23ad502e76227822b3e9670248f8780d344bdb0ad497f1fb8c8d1168d1e9661d41a9c9cddc2e8ffeb74373fd5b2029adb6eaf39edbe199921ac279a5f7fca2d0f3bc199a4fc2825824483433402fef12b84a49a8a5ac3a53adfdf58b61db1dbb9dbc01097f0a786c1e633b72b1324cd6f8d75069f570cdd1a21ac5baf390db1c30d2b855fb2dd9ad7220279fdb464dd6fd5edb968e307c4038d6d969900d28e83d062ddd075ef9a888ea6749cc295360fefd8cd8df65ea314901d77ee26535fe516ff59ff81dc532e4f8708a12f9b0aac6da22c744d31ee47b06c418868d8b152f7570fc5d6ab4fd260313091b1c806b8e752e4de958868c397bac8704ef31423091e8242ad540bbde717d44ada0e0ee21f448f3e0cac4aa1b89781ddc98e2e43e565efcdae4e6407ab484c7045b59560c35f5d853d9cfa7a27156e59abc78b319a86cbaaa638ed6caac642a5827b4c58ade065bb6c1db37b6f97af526c1de26faa31ff5aacecc022313554f5b39f4b19e1484abdd00be3d36d76b8fb63c3f85d23dc0f0579106fb7855ad5e7846a874305348e0154ebc096b6f1b2f0a49f4d8043c27afd2b54b0364788b6ca6011bc20a78dbd8e8baa16a3f75212a79c7a5a094190ec66f47b05edff805430f56805c858a694de1ff64522d14ca5b0df335aa6aa00bfc048bfa9af40c5a21c9b481c9106620a81ae7a2ff810e53ec3ab1b2412891e056c1d9238ed977668bd10f405bd843c343d6f49cee6ca533b6d2fd338d6591509fdb9a82d91aaeb1d4aff0a07898bb4af49451e9ae29b58f8d92fe81ab449a7d2727f08aea20889877a736f384111774110f677da281895bccac995598ba060b00627c6b47a0ef1767f01c29ab7b92fdf899f1cd44bab60e002135ab057af3cc2b2d88283fdb94fe4339b5d607ad10bfb9b3e63929cb1a01c03929b83aa245b6f0bc26dc78f084fa676e56b1fabdd9b71005aaa74c2cd75182b0c5a46b3e1ee4b21c98ce3c58444f88ff1b2a3c283a8d642715887a9da7c652342370037e5750b3b3fc47ecc8b77c00d7797996d77583c4bb8d618c3d500170132b34e10ba6188378d8726afec026a9d79b6c3805dce1b89644e4c06aa77e0291bad0fd2067b393ce760dd760effae9c4d4d23ae71a13ff33a43d4859dea0f419ce30f81ee93e65d3ab5ad90d3286c026fb2b9d872a532a3e92859c5b407746fed48016ff27d184f48ad2a867630584e2b6e137d2175490a7e85ee09d2c9c4b7429e2bc321cc9c7006ad3bcb676f656dad6a3e7a9798a4dbe2b997697b2dd13bab623954a4ab0ed1ff6305bedd8db1959b27982fa73bd915078df37f3f1b8c7f50f35b1610ce80a8a24ff3026034655a343c87bd5ce4208401879aed2e5ced3a98e785221722051ffa3e83f8a251ce0751a570aea6e1c1d2856a1cf65969a7cf9deb750705a2f2a5280348a7f7b0234f5f6277341fb19a1551b7f965a11bde7b87824c1e1473505bb683f92b52952dad84be7cff0b1da3ea1d779ed2bf3ac94f38bd38f63db60924ab0531f2558c2f8bd72a882b944d89d71408092d853c9e5ae2914c4a778e21a96cb359693c207bb5701f50f7eabcefa9a55542504ce91f47a9bdab30553211dbbf344d3cb501f6732f03935acff34c6d6f786b509c4f92e7570f441aa31d79db89895fe5dbf4ff2152854d31cfca5c93c1a60055510e6ed0c7dd6976866291b4c3835d37bfe0d527cd1d22915bf1f9b8ffef6b7dbdf34c62fed02e45c8209d8bb4bad0f34246830be4b0a54efb59c9e4dae6bdf28655cfcf5ed15aa90829fcf885a32098b7af0cd1c216503a3740be76281620b6e5c796967dca60de881e902fa667b2438efb5358377ef74046f0a4c397d8f40315979eab4ddc8e3b8ad8a7778b31b62148a22c6b380f7ee11dda39d2403571f5a8ee08f0dc9d68e3a367258b04f6a501522dc84c06b78db6344c8b5c61f96427a4c74a8e0021d7189498c38d687f53776d46a60c63491eafa716845585e7bee58c836df7239441aea29868be34e8802cc1bb4c67917f5edf391ebf1b73ede39e0710b8f453135d2e582e97165869a2633ce4dd4c32522faafadb86ddb87b24cca58458c5cc69e80e7e2413c76602986c2ee00ed8342f5e3d77d9ee819b6e5b7bcf84a8153dcfa786f790762255a0b585e4df554bfc99559449222e8c0cd83c145f66ed32b5319b228f021fe72615f699e3d2035b28b2392a66920ee407e536339fa133b56c69d710002cd53391096b6fdab1d1e81dc16fe76bbe5d5c799da439bf3db099f1c9aa5414ca4838a0e34683dc8388489b5c932311ad301270cfd16b919462fab138551d64307db2ea29c399765229a2e64f5a132b31ec5579c9253051b63b4df7f6b633996670967980291956f0f2bad44b26f8dc0bac8cbb424fb2d72077cbe6a0881c2c7e536c89dc31d323a894a7f51c388fa24d81bc664260cd1510a298b130763c0244214259852eebe32467f47696f1442fb3d34bee4d87d822d26dff3bec6df6bd8719e341db741542fe7a373b33b318e8b4dc41538d00430f92cb5acaef648cdd14cd8fac8c182b5123c75e15f2ff88c58d2ffa6ae02b1d0eab8a70780ac8c168b08b2caa02925f38458540774483db2dc730a6c0462f13b5499876a0e78ca86f5673d6866dfed180daa9d707d39f80f450154f7193d1806e854689fe2a2887f3a4cfcfdaf4aab0fcd147da9e2d1807855b098dccdda9f122008758c163d88209cf8d8b60f9f9923aea7fbe8ec6799976efa14fe747318bdf87b3fcd5c828f6e5e112f61fdd6334d9785d19f914e389045d7d18997ecc1557a9daf5f9bcb449ee500c7c68b235bb949f13952332e54f002172aeb514d9ff6c550766a8c87947b748e94e1f20225b61e5bbd1b70b1947ed08505c078aac84a887a7c43d55b44c9df37e3f6f5daa811945e853a504ea826bd475591f8b664dcb62335f4733a9beb9fdff863976363df175ef751bf4abbeaa9a3a1003dc36ee025ac57e16f44f5a6a8cba0147213c44e9213e8567203cc0de6901760367c188957a70068a822c8724f074485a55beb761837ab7bbb7246381710097e90c3759be5c2b0e3ea415e7feb492353410ffaa671ca80e8cf85519694c40e68adfdc61f529311edf2754e2dc44ed9751c5b4898b1b0bd81bb8a73394b5c34dd0923598629a0307a8cf21d0578c19c8db13530932734bc1060d630e9c384131a3b0e39d712a2126b26201697f6007c2c8ff862adb3f803e62f8d6cd56df04ca784af02e9acc5676142e36df738243ec591bea7e989c0ef10ef4624c6ff6a40a58332e15427ebba9ffcf6b985747f9143edad646172b323b0ed73d2340eb348adaede77b5dc4b0bb61a4793d9ba1f21f23e8b273059a0b142163e61a292ab7b342871e4d635404340741daf34802528e98eb43425ff2160c2712e2d9229a4e0d8acfdd9ec5c48cd830e7476eb060584737bfb3c5f05fe7b24d1ba805884f70a0b74497bf20e4785c7422224e4fed756a378e0e2cd168ae2cf5ef84cf309a430e3e2ca6917edd6f44d18d3081bea0a4af39532a7f1dfa33b8415e9b932e7ff43da4ccb0aec2f907bd0523bca089ec7f047dc6b65b166b18532d71ad42c97aaa811855340f59685d8b3bc084dbf8e5a44dac89d3979169a413eed8d33aa8c3f81b3761e197abe3345d0530e3c7e4be133618f19d7f1be572ec57f475e45f0c59bccca5572e1ce47192c1568637ba499d8eb479465677c6ae72a4e2542cc33f057d30180c7176a2b408da058440849252401f676633a34a13d80bab538889547bb8e8562f3771b12f8eb329190808f26491de25ddd97ae107461effa2f895f36e69b101f2169e8da812ef982a9baff91c5925032888d605c6d547ff269d0cbc24c3c75630c53a639a6a2e5067e1df5076c196ce8ff166a2a7287e06c72031f74262f9b23b570527e75daf6249ce7a34a9f00fd4cd665b54937f26378ea6ef9b38976117efd194406d84a1b2331f38c1545680795e62f7e7543be2df55321b6f852a9876c30349592cd73a4a4a2f2bf510d8138235e4b52f19e8b629f394c32e8689e6045d9f13a5e3e7e97e5a19ce1fe4fe8821c846b99f107fe8d82eaae0e3c2221264a82770112b4a20728cce83de9a904af5c29ceaf646a9e500fae0693237243dd9f0fea7637f0a0c6f67f1a524e29b561575f5186af9d412851e9bd2c6b0877cff2fc47a0529c31ccb4708cabacaeb3e975fef40847e491233d5d39e4aad3666c249558e0087093ffcd2d0ba1b7895692527520db6bf8e482328c620d212bb27d32f3467985d79da7672bd5342537fb8224b94891e7ef51a8f11e4157d8f6a198ebeddf715eff5cae6a5c3077420b63859245b2cc8371261e634e808434af1147ec4afa6048bafe3c74363bca9c823a9c4a64d31a490cd9d7d4341da8ad00c7e1605d271c9fe69d4b61b0c592dd130810e61731304a64d5cd11fcafcee933146ce7d7c920774c46a75fd506c51d6ba6f3068630d8dca76930034f05b0ad26e42ed76f3cedbc65b2b6cd3969dd53ed3f5ffccaf6044d1fc7ab5984ac1c295ecfe70f756a756b2471b9d9996bde6de6024543032be360e2e0c2374e6d8af1b377600fbc978bf18765175234e32f13ac4681ba0af5c7373b61ba439542d527a4efbeee4e57c11809881c6d7d5810e4812511847a4ad367849d116206efb9ce6543040f20addcdb8a50b7b6476e8fe80e28afe2e419284d73412f6f9bbfbf8100cab3aab6af00cb8c2e196db81e6ccd7ec47ed8c1534088243a1b9196b3649b732f7cd5075a03420ea6cfed10da830cfe1b326c327c138bb768e5fe7d27315936d24417e84b9ffdbcd85b6f462e75f0539ce9a8c227a65e6b4ec4f5201667e23cdb111d8bfd74af573b06ff4eee6e9189bfe3b28ce59b6dc7151fe9986aa8e9c393b65a8a6da8cbd41c36ad7ec6c806bc07bdfcd83e30beb6e915f6793b52a199d8686307c8d0355c84abdf3333aa7f573b7c9bb7da3df2d217cad44fdcf407aa532f39eb7684771c2db49fe384391c5bd7586a5002be17791823ba471eadd2292a69357875da7cb35583a5593037eb16fb0c10ee9a9a36aa58c4f909a4826b8c2c888c1629d6cd653645459945e4dc25ff69b4ce647bc5f9b46b77f884596054c925c71f63b7cf2d9bcc834dbb5b167f87bb5795d3f76389a93fd4c37e03d68122d6bef322c40b2c2b0747477a4a9e5497c8a7f15849c377aefd495b1dce3b42b31dbff792231ead4aa271995af6f28980e46432d339f6ad91d524c7cb61c18d5afe0ca3d481300b2e7a0c94dcc236084f91a08c7fe511d180cf81d974e0fb03f509ab9f4b9dab9263e225332c31c9746ae209098525077983adbb4cbf327060bfc96caaf13a9d46aadd66255b8bf6e5136c82b293a13285b492d1c998b13c7492f7a7cecb8a491a8633f6ee853ae16fb3582dd7ac259403a4b9d730157172d5cf6ad044e202cb38aa48923288aa87b3bec9253fc2f0b49771a4be5d26b1e6ef2c4a7a575ef9b8e74b501f9f223bbfc2fca082ccfede6beb1b846e69cf3a25c7383883497f47c81e4fa824c5d80499452ad213adb7a24a7d2b205bbcf569cbbe9e59c66e87d87e8b04986bce2e4b3f7ea49b5e8d935fd7fa657b86fe34ad205a609c48fe0e4c0cac0f4cf39481cae931b671ea3693f2b20d384b1ba5e3fdaea7286024f9893054a2757c1f4b08f14f559ae4ab85894beddc864eb9c0d8866a3132e35ea25ac7a7823eae5207d54589bdbdd8b8d3117fd9788cbe4bdd700306b4a1591740aa69a6a6851b99fc747fd26c39835dfb220a88d928b420c1fc3dd18ab50825f258ed1991fc9867d10194fa065a82a3b8077c5a1c3aca774894ea9765598e44d0a120216bb18a76529cad0f978e067ba685af84e03f6c5abd66e488f9692b92279a11d9ea68099e7590a78f7cccbba835957e9c97cd40c8ac620730f77de0cd5b45a7a8431b8eae717efc394e323d328eb5565671c1d3c6afd13c06b6b2c0b584472e59ee7840197009e8366b98f51f71971b3203cf57bf480621d2f219d1071d17ce89ff311df2846b4418e915579289ee1881f891979a44d1f4aead30271c56c19ae4b6fc30815e7a5ec7e58e7a0e67cd7b4331509cda99011301d378408e73e558926c17175fc7cb979c5d084f1c7996a28171978133f60fcdcaaaa929df0585b142479c41eb6b4e6bb7e0680fa12ecb4281906598539aa011e9b7a5a420e9271a45b88173efde270659b3e779063d43fab2adfbeb845283475ac108336f14481dec79d77d061a6eeaae960da2b4c41705f01ef8c031a9a71c1d3f3732f4bed699583cc23d7dc542684cf9f32064435bdfd68b6d931d8acd2e113697b519484a4e5ee6cbf4dac91b95f812d9f50488b5d60bb8eec5fef6ced6f92bff18f9b8d91d4b549a7e2040d8b80287f12e6617e08cd1345f2d852a16e51b9491b21a08b205bcd846eacb3c7af326e3e18491850e671120cd37d1b0b020cb0033d3a2254fae0096ac1540bf8b9ff42f7ed56896d3ff65a582f3d6d723142ad7d8fc89c95658662c087dcc77d1dbb5d8a38624e62d619dcad891f3b1f82de07b7e84c2724c90af27129dac95f4d81e17c43ece272b7ed5b54dd02e561b3a30b48be863b2e225b93d4841a5043c36f458015136845c5c31c688df7c3815e898777cbe970afcc145accf5972af3602490e865ad109ca838d5e8546d825871c2e184a0918038776c3e7e06761cdf0cb70f22afaf154007d9aaf26bdefa1f1003bc0df0bc7ccc2d09cfe78bd0dfe98ae82d2a8c4f4f3d487095e7f6625fd812efd037a1b1aa1e94673a31ad00ad2efa7cbb7066c4c7df9e84918797b5722af03721423532336a4677361af4424fe4ebd758e117eecb9e3f4a613de259b2395378ff42f4884e94be62bccd3c38fbf8fad9f5e73a60b672182c7562957872a24c487bae1c8d75635dd22c83b8adaa85f0fec78e00a359f3a3d5313b72a3f658044ae0515149789c43d07b706450b1a65ac06f1f0b70e9d8fbdf4c289fdd0f5abf8d4f50b8e51720c341a42e720ceb8c058ed249f7e177300358d12aa62cb050450eea2623cfad4b536b79e17940dfc0edf750dc1bfeb4cc6033cb246381ff32a6c41b5a22462d9d66587641d0a3cb83a1771e5c0c552f7184924d9c6aeea315015ea945bb7d0b5a93d96437ddfca98527ade9527a8d3a5c0d8f8c624c49e031c7c78dba45d219f5c0dd8ecfbd8e726fef00da846a3119372b268a09fb4a6aae0d81ed1440634d68b550f22f195fd312c8c99f561b6d509cd614527836b21e60e50679c700c83ffb83f4ae4381918a8a753be229fff7f137f54b0916b46926f616b14058d37be6135791b85836abb28aa5579f24b6bbd9fa538c85f69111b003e343a1239f79b3f73de06434fbfa797deb687d7c81684e67d65faeb58d2af08cbceaafb61aad9df62066522148a873c3d59cb99a2ad1fd448643fb258909e635b96513bef0aa9b3ce63e9da9bdb0c9515d5f151e9e30801cb7b41247069af49ad53f4e3f957309d0fd40170a28778e9dc9430d183ce45364692f23f281b799c41b899046e3a2badade014777a790fc548d7682e6511e1e9f429d7dd57a71152d9e539fecce8419f940c5082ac7332cf5bc78970527ce54aba966856ecc6d9dd502c648cbdf90f9e822430e3626b268e0442c0c76ac8dd18ee9b695179ffdb90c28590b53b38f050cf4f0047c37c429782c302e240760ec51ea5d8f4c0628347594891032b0fa576d8faf5e539b094dd0dc72bfbd2b3e560a60fb434cdabbf1ba7c8321fb0f577ac24cba206be044caec6df72842bf9f438e556fab226331a408434a4868dd5785faab349553e37ac0ee559ef8cc9d988324e2179ccc41391fa1d817509cbcd2f5ab5849e72274022b594f1ebea00f8383630a416758963b7545c7dd195c522447e6ae87f29402fc3fcb82f50dc9e769ec15d7df42640538ef4fe24c7894be3825078014dc420f1379deb068c465663ede1ee086786fa72e99933e56e0c106ae07a65167d8cb8a02d6e109dd643c957c08b28673a006178052e11d4de54c584d3e7e7da75c43f893a531e6f6f488e8cbad1c8e8463eb0a2b571e395238283bfc0d405893c04904c6c97b48bcac0acc0a7891cb1c6b950ddf3fd3d30e574f13a91359a2bddf1fb6e97502b80cf9988f6f21079b6851fbd1c56f169c0b92c231b78378fd6b3c594ea6f571c58a9c4bae502c137afa70c20eac157676cc378a14b58003a514c0710b26622205b0410c8b71afbbb308541d70d3f0fa1f831328f8286c37cdb56db92726b5b2a80364ac623d7da83f045ab779f9235bcc9fbb80a02e5279d0a6db96866e2b11c485be808def802f91a39ee9ab99ad0d9a34f53c570c4093cb5deab9d49d41395f09af37ad9e158551fb1739b65cfa7131b5ac8e4aa7e2f2a9a1affb091df7e3e43b5628dc2130a7c60469936c0937ee7a652f3ff5e8a469a4549b634b678fd5c7f818e1f0389c5ce66fb766bb169d2381b6fc523f3eca812d6cba574d064f20dbe5fadbb862edbdd26f44cb196122b39bca773e5fd906c21c8fe74370e787cffda44052e91c377ee9bbb7da155ca2e0d15c3ff48d804add687e3fe11c2056d1bbe3cabebcccea54f07a7910a5a7c8c4782d646ebab34c81bfa1fbb13a25651dd724ecda3d606bc8dc5061e1fe4de687962f938c6956eaefe995aaead2eb35ee76770b5402cd8459f924e2dc6d37361b6a1484f03b9873ea34534942db5d29e2410cc8e8c2678f9eb3658471f3216a2a1d3a43ea860c9026d2327dceb399cabea4d6e15c069fd07ccb0505da087f29483a64e0b9671bc5070594a7192f3e60442e7e79e747e28c1dbb062093c3e5d22ab3f3ebf0577cb144d18fb0cd2ae499396f493d16e9316d1da5384fab3eccc0feee72ad5f7113550bd5104fb25b75e16b9a1c1ddde9571b2e2c32dade570b76ed2dc2095184948bbb977d206feb2c0011c07a5e93b2e7fbe0fca09307c58b98c84d0d87896f8e0ec6aaaaeafb8c2a1fd482c8f5663b7c1d3f70c5e6cf1697ac64f8004b68296fe020c92db4d8246d869c595f2721d0c6e85e83e90c96eaa6b0f9c6bfaa74f4ac2ddeb6ab370ff9e031b81ddeb094f1b3a4e81490b1c77d717a70811feb57a337bcf6524d9ee73acf26a572b23172aae51b28ebb6dbe4e96a0f1a8afcc857ea1f022ad7f98521552a44cece9cd213444b5401420ceffc7c619ea8f82a4e4710bd2b1279555c921ed282454d16fd2218318ad0ead7f526b8c5d212847323d585b85f88a9e09f2ebc7c956ec7eb042c6abcb552650a9a3b86c949515cf073f939eb4a96a85028537e0833007c3bed39dcb455a453122d96a1ab10827f957178c2f695f85525ffeb6d54d667b93bae29730ca6a5d69e11ecb997a299133e0c1b21413655c9cf27151f171d0f7188b3fd0b5f548aadd49d2904c722f810663b347794a3b9736e8208a0acd5642b5529314c89a950108d54adbce57d80ecda144693503a464eb357a9de72b20e2107093e10850ec2baff4fd4af1d8268b410c2fa9b728e1144611aaab642cf77f0efe3741ab18e6ad14aaa2ede0d63e917ed1ff8c7e6e3fd2320ff51b896582620a171164d0feb31d5ddec88a3a8200511af1540f641eeac363f426648eb2867755c2490049f93c6d34e6909f8f26d3da447e5cc3b73b2c98ec7dddb4c8e666d69acf27e7a9442a7348a9a66fe41299e4ac8fea8e1370ef931d929b0dd9ab2a73faf540225a6f25458622f59fb5d1cdce1d0d5faa0748718487f12ef5d8dd789d81228d468926c05db6c72c3cba81f3bee8e34156fe46a2ccfe56459f0b190cbc11d472c7e54a26efb5a00da9629a107eb50417b86ecb324539fe484f3579dbd7e396c2efea745b6a842ef338f699aff89fc215a707bd2e23af8ad9c4f59d6364a8da4905f7599420ca6bbd29ade3579e10862a8c15fabdde346a15086461e9861af71897b5b9f17ecf1b0f7274dc5985afb2bc1edc834acf25623719d06a82a6f7a49dcc8085a1d0980d209120580011a3d353bd893832de07e941a221ede8440c640be766d9e9f78a0da34bf13bedb8c3d96588ffc6f7e48e500faf83e237a7a77b4c5747840488d548c20f483017bb2de36ba7b25a7cf4b871ae727f41d85a975edc303b47e446609ac2f5a8a1a3930ef3e49a8f6e81af96925582185410ccc808f0e03686c1e3876b7f8b03ea0f03b4a3f9787a0ef21bd397f2e210d777ef3ea85280782b1ba788a9c0b496de65304ddffe6a1a13c4aa0507322643acc7ea9b58dbeeaee29ba50b7439204939e19448f2359e408b8f4553d3e474402125c3009c5058b5a298ff3b0157e5a31c701b065138acda6b38caee5a44795d77b34db5e9323ae21fc670e6cdab78a5f0c186e6cf3eacb01a2a732a8ca83a01d27e2f0ed7272b6cc8dbf4a54f10af3ed4e66cc985677f3004b8284dc0be728717b4f31e0440988e9101a9db5f30ea581355dd1a3fbe567800fae45439f7f5097cb2eb229d3f01e8ad86a99337d15007867ecac074b090c528c63879df33f201ccf36df52e8a875ed2ed96ca71eb0b984ea6ecff65d216dd54db3a09197e9daeb08f22a1d0ff06b49a2741509ec8101f030d265e4091f847f2016bbf565183dfcd6202252d327d28a4e4ab01aded46c213e7dfd5e467c28adc70d84e66e26819a7b4d9a5ffaf6d28020a144f0c95fbbdb6e6e844deca406030549c56a5d6a8e8092e13559949519d288fe3537c7b17238927fd6b818d6cc1cda482b3560b37ed60fffd3562e41b3158aae6325608a6c1fc09ca166f12bf3ba72d30565143af3c64e830d99d81c550a7adcc7c8aec5630998e8aa731f26bb9fd8c658ce51d27fc584238cc140d457eff1ec1584e43eca496e010eea42bb3b7e72a95eecc70efddb10d66a56e7aee884711cc3ef6775e3aedbdb813e0696b334756a63ee21d3936267ccc257d750462921aedeb6bdb84d3de8fca40153496b54aeb5f6148822fedadb5fb45e11384ed32ff7ba9d099c503586c1cf086bf8d858d32dcb067c992cecd9cbb35dd03c8bd73383b7af062523f99a1123a55b2774e80d8fd5d8305f624a1f6059e9cc5e8e86f2579fe63e3899182e2c82e03c75158bee3eda63637fcf2e1f39d4dc59634d51b651c285e367b3e4d0db371f1cc8569306bff5eb5c7ba7970b4970f99a52151b0b75babec674e30618947c3c552b46c0e06fd9007af321dac266a26eb8ee2b42832962c9146420da6b60dd80ebcf9d9495e335be444c50cc0d413b7ce05c4b72909dd7f7f87f9938c30199452da40dc85ab95d962d841ae1dd69e9c57fde7337671e4f5616f6eb3a669e4abeb49dabedeb2523b1f89a5a99e5ebab84b15993b340ad7e98583785ad67cd582d5bd19ee9c2fb1bf762970f382d29f3a11888b56a3b7d4a21a1b12dd461c71e5685005bcaa54f30fe20d5462e701791193fdc3a2537e9af1727f407a70198593bcbc8ebfe12a20b59e8a9b16dce1d806994c48bf16382faf3896cc80bc175a904bf59965c6284b5f6a3cfa66fc27a13ed9096c586ce596489a507da831bde7bf375fe0e80d423df09eac784eb53fe26196f63b86662917149a22727398b9f4463f1373e634dc7a0e444d3e778d04964d682d7f8f4ae24c236dc4f7d4ae04e944a3545e09c2b26ef6448cdf1dd4926e660f7f89f16897a9b7907b907891c4b223cb99e64447e389921bba3bb75c8772900dcf187183e361e9f45c99e780742b5c29bec9114e1bf44c2506aa4b38e2ac537146c4448a2618be03ebecbd681dd05cda4531726c15b682dc7981987e3b9b07d1c127ae610fb0a42d9b5696988122d455f1c945a47aa0f71464a3c9e397829c5d45accc86c3d28503973498a62c45a3b6ee8520be44f89c9009cbc52f1ddd956d3c54f215f7617ae8f2f2b01822a80ec82bad4f6e471704055834faf8d727e649d689f564aa6d548b0c2c4c31305871c0b9f0f6d20da375d5f5254defb8a9800d0e896202c9d2944be61971cd7e1ed8f809925c96da073db9b0af0666ea3094f67318d643679fd60ba061b4cf798eaddb013b39b3fbced5787cda763cb804a70cdbb04e3d074013931cdd55a0c231473127d1455dc5725f866fbe1b16719c0d254edcf8b0e02afd608adac4f5713f61b4d71c8e8ff35aeb3ccc35c8837a993d2bfd7c348828a5845751cbb97aa270a619aa4551a739cd6c060a83fa12c913156f4a78f1e355b6d3d84694a5d44434cbd2935fcf75265fb422f04920cf64d0fceb56bd308cf6a0e03764be4b51b3b6d9162fa6ccb4cb8e71398f501c3dc20955afc5ffc55762cc3aca9be32fe1ec253e82da4d8863a9bdbda75dc647d009152f2e9e64464c1b8cda46f48e8ac2531bd98abce52a5e3eede842188ec748d2441c1986c6066deff07908d8bc7d55a043ed06eb3b24cca760992fd5aa35575b2d4755595ba197ac7f860be29a1ddde950b05a7b3761ef51c05b333d7aa040760947411f50cdc8a120e4bcd4eae61e8d9dcfa71bf8098cf53d033ce419e0809a28b9f1d4ce14f921f6c958b185f36096fd86bb56c00e5b9ef9dea7909d7ad05f6770a605fbfba28a265450c2cd1edf674db3d82fa6ad68e18fd2073abea412995750c113e62c1a8c821700d963397668c9a1feab8b05e6ed4bfd3abed36464e9ecf4c82f9f6462553900eab1ccf688b2a448af306200603f0f9716d5f4dc073ca0681e31952828c69f68d2227acf3ecfe2f0497d4aa9e7ffaa856b4dae1b089586c66077fa46ac66f3b7020c49529f25b44fbf9394699834fb8900eef640c0ceec559f4910eb723118d1e02fd199f85e372c04978f214ffa15f99ec7250fe6e02077733e824f1e97f641d20d01d8ac9e57350d04d5d79258b23f8851d2574546744e93b4bf4bbcf269cc67e1e28dec7e2c65d867cd6dbcef67cdf28b92e304e8edae595bc5544f6e4d119bed6ff337f70b3d45d2eafaf31d6e650204f133e3cb81e7c0d6d867a143a21491cc749e3c5fa67eea20aa4a8f96095302306b47d929d11bfbf5d0396a440820d87c145a9c646d669225724053b2c93b4c52eed1c11c48769e9c9c299ca1d61bf8a04f344992935a03b4334f296ac366a213cd5d58b424c5c2e11dbbe6921f392ae57d6d26b9b67df9307a3e900a74cdd321cc225940ef52b4b7375cb76ca154aaa3474a42cdd61e1a59ee5c7e1b9c37e4567cc62cfabcae8d0aec77b711b1a5478a7e27937a9891904869a3f234a5990597e9add5ac578f296dd2694d1edb91b2db954ad8a2debd8cc963f87e866282429871c2b85814f5259784db993096a0d00ff37eb26623db242f7a07488d3d9f1b933b1bc5f73c30db024bb38c2ef5cb7968215c973188a92284f905ba88168b32da4869c9706651763c38c986559826203ee04f43fdbe68e408dcebd5ccbaa0a63b7cc9b4281e14c0fe383d682810daf22f9c988bbc87e1a330d7d99e28edc0dd81a35c3c4e8617b8bc01badb2780f948010b3fb6091c48503b60163df1c290df0eecb29cc28121e6530211ab0b592f96f148469a5d1989a44d99a66a8cfed690f96bdfe2b517470ad26ac69cb71f6ea26347eb3c8635a0fd843da8391112ca0d0f58d658c4a7d39ad6e2bc44b0cb36c706c6b15b6c0096a31ea595b0a54fe816c29efd8a338852866a9648e34b16458297846fe2301905b8127c168edba87a2c99640fb98bc327334ccf29c58837c1ecb2503aa07ccc3cd7ea88a461c7761a3dab72ed0c43f6dafc2411cb2245aad5a76411c989f55252000a3f1aea81a927d1effdefed1e35f457bac8fde63871760bd7d047905336452408647adf7cc9065e739faca96a76085e1ec2efdea87d0036a7fffeecdc0bc06fd3e460121ebb521822486a5d5b628beda7d8780dd3cf464236a3837b150137b9979d8651f66e3cd63bbf04d17483829d5e70ad81f37c436fea98af02ff781bfd75526d323b612dc03951f047338debddacdb2d2b7ebd84deeb1b246dbd0c11811e257ce149e6cd90818cc9a7e202fd50aff5345bb8550d22abe72d97ad278ecb63982a2981430365ab6b5189ea3d015e1449278641005473fdbc98453e70cc477a5fcef137cb792f71cf51e9b0a5deb624d23ef064b9fe843a79d1d989357879e9bf146d888ccdcc94e97418b2fecef7885cfa2089a8c7ead978bec70b4da786ebe733f5e5093299bdf92d29bc887c90e75d193f64cae320a455c97c81b421c499b6c4f9f05a58eb42e59fa4cdf5b7fabae4400244ccd7e0c4c39309fef454404de70fe2d9ae1d50c09a693f1e3911163ed69a90347a36a11e6c4c58602388fcc872271a76aadbed8ee3b6d17bf203c705534da7fff73d62085508defe3a35e8f97efb8d7caf8a720ef3dc7515902018edd258ff4fd77c146ead99e0650fc27ac758fd8e930d8b9577ea2ff417b7ded1450a2a6b0767ed1db70975de738f85623f517d94b9ace77856c38bb7385819d5594b2933953a338f6fe0d038477f2bb5c2580ad374ca601c99a8166b8c8caa47c59262bb2d318cc873b061e107229fd037e14a40dadf76a3de9efe055a20320265f722583d234bd48d57b3f98314bf7403a1ef047bef6bc78bfd4f25265d57b3b054547d14b021c7b9b5eb8a2f8ba458bd58533f65ead1913834312910dc8843256146cdf86897a13923ffbc8222b1ebf867aed4be62460bdee4ca6a2b3c20882ce8566fd557a577efefb58a834a2f4f7349871f72e9c33547f0ac990f91cc95d783a55c368d0df9c97b3d0d7a360ac6fd046eb13e2b5543276d8be5335648689d35802209a3df36d2566477fc6aeeb0e99df5437dc69a197cf0cae2e0c5512d5ced230b813ee221f549c68aa4c9de78a65d512033c6792f38a4307a6230f5975d76b436de20812948fc29939f8df6712af2424f0648b80e2acafec1ae013167651fa3656fd364818ebb8fc54e380a9b4ca63dafa94b88374e5cb27b33fa57a8bbe6230dace84d9ac82d8377dae81ff2f61df81a570b0996b57c750eada3c487de1116db125f1e3cccefb4dd9052183d287193c5f548f38dfe8b47b24bb4c2dd3ff089d2a33d8bd559ad454e6efc55d21626a581d6a3f252d61273848c66478810ce3887133375f5057273ff7065c7f2d3f6fa4c6a25796d7178f1834501eb51a25dd214ad485bc0dce8bc11e12b3914ad4781387557289b9e11bf8f7e274f97c469d5c8addf006e61963a09edeea0c9128853e5f072f0177978798bfc0b72679eb9aa41b0c41d4ee46d50f75b31aad2cfe47c6a3faf522a2d832618203ff98bbcf00596fa7a7f6abbdfecfa3dd2d04a21f6499c57851b6189b9a4fe7bc9220dfdad170642cd901a627164ac15bdf7dfb170b3d4b16cecb075e12a3582cf52955985f9ebf5ec8f172cd5216f624d21c7d91aa5678989a9df4bfadc16914753a5932542e53c807698f86730c17d9c7e19c716c9def35739d04d2f9899e62a2165e1ae4988cd6b7cc663bfdee529923157eb293e7bf35b586551679352d2308b175ec9e96bc11f167cba8ddb335e31fedbf63fa5577fd799379c31d547a0a24c345532f9ce424f911a90a1f73a0b5af5b3dd0e4d743923ce096c7a6a32b4bdd7dd35765a8e65c8dc973cb00aa65e5630aaac32a1c90619869217967bdd3cc70e68771e46fdc5c673f3e81654f5b49012035d209f7e5e95b084fe2e7b6a88de867bebf5e113502770f2015cbc1e407a271fe4a64ca8c152eef7cf0c6857e8ecd771041555ce3535395f96b2be1c3de79f3736a6015e93d8d56d362bf85680c81c336a45e2d8771079ccc695dbfea69a58d0d0857134621e58654fcc43f528b63de5c9d22a83ed4d8c93bb0fc9bbcd56346c357deba6478182a4ecfbe4f6e3f451a5ee3cf49c65c8b958b8402a2cac9fa8415966f728b538c3f9453fecb0e79604dc0d79e362123c691c7df53ef7987cf5a98e06d42b12c8e2d44820a583c46f91145896cb050fe0646b14b215b4485cc5ce2ab0a2b29b10c18098caa30758262c37287c85333984b668aabbf7109418ae5fd3aa32d04ca2295780534ea94f986865880e6f0f1781d9a13b22197b64e30b92a72daa6f5fd5679a36a0a2d132b753a1714ac3277e2c7dd54a763067874bba082d5239ac983c59f369995d336d30951a76f28a0232b52cd330f9986031363c4574a80e99b6af682bfd5fda553f9c6b480b2c3ff58040fe75c9d84bf44ea4a34d5d1218ab61a6aee74feae417e3cebbbc2728159dc7aef604d9743ba1efc262e953fb18940f82c95284c0f4c702236b5c5dc78d067eadb1284a44fa5e6ba1e7fd56fa4ec9e876c59cc04d803cd07803668a092e4deea1986b741511d821f01707b675b1be4287596b6e8ef16eedcbabf68aefff5690dac00b33c5a6eac9035fe1dd1f2731d9483b72b3f602c7f8eed16eb811eab372264189f6bcdf0884a778f6b75b6f8a389a2463addfa357e965e1151e9946e06d301ac7b19ae4ae009bb50408e6be1628e37124b7d17c045f788debd4bbf1b62d4f0bfccd3b4d5e3d0c0ec46660509890df8bd0a77c5356272d69c996c1f099cd3d7084c3362137ca8adcdffba4e78b535ffccb437b43b237580325d626cb499a5a2c06886c9ad66a1121c5cae0ab40974fb55f861893e31cf46fa67ac5560a33c3483cc7fbcde845beb34f4758a899573b6e4c842d2be67e2b806b146c2161015e4d95543ea537c7eb99a6976392bb2e78cbe0eff6f2ee12e17e0449def3c9edb8f937657bcc7f9b6ac3f622863884254eae7ea77794d1bdf467db87f36e5d5f012eb0685c7d32c3ff14a3c1b67e572cceff7e0c87c1782212741ad2de9361e273c588f4acd72423d19362e07f7ff28c2d611225afcd0e3670325e5868a2ba617c38d90f9cfdc98b58333bdfd43c1356ef4a9d02cd3ab1c3f1ab51ef7c5659f289217ce9f1037c42bff9aa5f0c2bbac275bc0ab2d5d59f2fa210ff503f13f4996166b12ad03d02bcebd1f5310b3f387a8024902179b2b034f8d9a46e5a3f71b293c3243350d093bd5f1a4b2fd01f769a070d8d12db7e338e5ddbb256458b37ea2d3344854d9b5763e64c455ceab1a1b991a99a3184f8e63302b1f6a52f0f8bdce0c411b95130ee84ed61020dfc8e8b67aef6d3f908d677aa94624e985782e1482a260beec7ace65855305e9fc7c35e026f138b28b75f1d0e213e9858efacbc672f333b0785a72c2c32917aec0fcd47c30048ca2e023395ca00e3234284c4984deba2e7937373dd1e9bb2df2b05e50508bc4354ef53002b5011bc06ac3f4e21d2c9f665fa112a7631a18e26e6ba99b79d1c3341a8f2f851423846226dd9ec9c188af6e2a34e9127d68da9ff574f960c39e8ae1a24affe345dcb4d60c1222bec52a9b5b98555656da5bdc6821210adf6c8f9718bca97b682e2beb2e49c4380db6c2435788d97f2d6d5d7c4e5da36989a135548ed06eed9381c338a27806baa0f7f2db8c721257bf199b40d817208722a968fd27115da1ad67d6fcc18bdda5aeb02bbfdcf8e555b105177aa795b4db7faa02ae05dc490b0ad2847e11a889c07928c174dad166d3f234c2ebda632231f2939143314a2734818ad750706091ea8870d2b20a04a589d8fd510ebb91bf7200852b209d84d6f7d23deb4e3722cd68c75367a1aa501b2250efbb8113c24321c4adb75b57bcf708209601a12741a3eee0d90c0369639016a203beb7191a2e68df0312ff48fcb1430eca6e71339e0472854c951af8cc043a3c93ae024084edcac08f78335a76a15909a4cb026871a1f2f0ca56bc77825c11999bb719d96b5393d37b048e5b4c3faeaa4638d0cfd96e8eefc41cd61a9c16442725a13789c88febc20d1960f9a9e3300312bd743d551ab6a497dfe360e73cd4e67996b3c120d0ed77299df3c5fca0cf6307044ef9058f8883eb8579e7d6f4849273c0c7d78112059002d3ea5b09c5a95cc45f7f160243652b85e0dc1479a87d2459a7475528863ef3aa89a480ade21f6f4583c12e5570dd5f9106f4bcbe25c3d940569413060024a92dbb489ba2d13bd70b9d6be3f6e1ee1a635bed3b9cbcc8770c092730ba668fbd3a634f5e4aff4c9929da06c796c9240fe843fefa678db068002372fcd2e1eaa6912ab4b2ff919fb4b5e0a1eedf6ca90dab044da9564c9d82034aefa963c430b63ba68b1ac1b1059b05581c4cec5473be19c87251b4b79bb74b9ac8e2ac605f3632530c19b6e1adbe58032b319788b99baedbbf643aaedf94e448ed35238cd84c35d4d66d15d968c0a82b91e70050771990877fd6e0583da3c8d40b751f4e968a1","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"535b47a77ee84ef933a56d7a374c1100f5a91fb4beb9279fe6fcb267d60189f67674001ccd0c80d76b19dbe87fa58aa0ca5127a950c6fddc37430e97f235212735539faee7040b5ca2e0e4310b11deb0abe262b03f44b51a84c90d8014c341116570eb22e7c99e97a14949c60207f234ff71304d628f6ed37425dd79ec9a9ae5a67a7036faecaade20c47b3e33bb85db123540bd9991c189116ce35b05a985af0a016c4ad0a3654a3d664f6307bdb2cea1849fac8893ca5270d44eb6397e1127d6eb157fa36e00848bbf94ae52044e0d9ef43e44848b630ba4d510f29358ed3d98f8bb8b441b99718a191526be10a9605dac04e172f72bfcb02ddecbe1de37962d3edd44d743a632a00ae724237f585d05529567fd1be0f00ae92f78f1e6d09a2eb673386abda88060624bc86513746c9dfb92c165badc338f76058e6c584e8607798f577c82dba9617d13902c1e6df1ea24bc4dc83859c40c3290da9e5786792a0a8917eda0257acc351a335c0cc24fbe12bb3935f4bd5bdfbdb99e163873e181d8eaa730f05fb57360870de80b0c46a5a7d3893c33cc2aa02b62f2d410059c4290e03f8de08a7e9477afecd54c3be952d553ece68411e041a16f4f7882b8900db4c851e2f896563250364b3a2090dfd8ab42f5da21966950af5fc9b2ff1d69d798e61667c3c3210fe87a00996e855a1008b75db61f1a8d9967160ece3a56a26237cdf5e265e3382cefd56c21da30d527276de02cf3f52819b4f13be2db73d26cd42386a8f51c09cbaf62a0821a926dff3b474d3ed066db5dbbb96654426d0066de71d10e1142b2b7cc0a1067064f954328d521828095f2107eb5fa9750bced8c5beaa89e0336ed6b13bbbb55e78eed58bcb7c9ccac04a5880bc025b1908b5f7ae9c473fa088bbf3ba673918a37b711fb4c139042de008ba6946bc8ecf247cf2164e6b1c96d18be4ecc069812cb853f5a987682fbe8380f56733ac71e25458a6528d840bbe87bbdb0328cac4883f951d2f2dc9d8de100c7606f9bf60d930325e6bfd818f8917f4d61d40cfcbd136a6277eae45d995c6a30c300a5a283fd1f121829fdf1568e00b8e82c93bd664ab3f00411dcc595a25d94b3da3cd06b618e4fb0610aeb9ff362f990b52462251fd49b7cc3f3a658e4bef9feb88873f8d099fd7de4644606b90608ccbdc5968768bf07ac1784628e69aa68650cb6b4612171c3923e89c42b16eadae3512a1fb41ae12adf9eb102f2f8e8f84aab5004cc0874a5e74cf57b4c75eba2324ef1c1ec42e0c95526636a7b848f62ddec394e5a41615b25215955a881a7233cc98b3611a23dfa5fcea891d3fef80e463dc42ddb15c2cf72af14884ec999ae48c2bdd6b8a422c733b0939539ca72d0a95f727b869f7aa3d29e97394916042a90438da2ce6b20fe9bd2e95a1eae5d85516f4d0ea26398aff560b197b4482bc9d201937e2ebba2c1ddef1a29018235f7ab086f72a1cb2a5ff79367d1aa10481c947684180c5e5caafa140b61ff223d8894a00a2eb1961a559be17f541b69c3c25239480975f96c181efa5de398b72c5b55c32aacadcefff98603c803b689240098b5c2d826dd4d5e3d47ed151350d5596bbef37f5ebd6bc43fabe307be7c8cb762b762dd0f925ae02d3b50e76ead84e1a15acec6c83893a9ec563fd7a0852c17701c2de4284980b760f76f31273df7b2f85d838335451b4f7c7f21afce6ba8d1c1dea58ad2df2c8d31d8f94c0a1009421a02a6f3f311a9812ea99c3ffe704e175a4ce31c4cbf4a775c322c3bceb2c93258370d43a096073fb8a8c06288788a7ee88eb259e65f612a87b294ce961fc35bf793c7d40138035270279141b54cc96d14a99517e886822171092b6999e2868c6f3ae3949ff83771cb76d1f33bf906e538d94f6c1e118506f0957ff56a8d9976bccac1cf3c54a33ab07af9689ebf35435daa528e99470fd36e1fca86bb0dad0f596a6a9a3a08fbbcea1267eb8ec08122ee031618010506ba8d47b13b87809b79d3c193153e1579b820f464d63a8594cffc3e2ba32cb336b562df1252e7fe2d107686183121acdc398cd759e4d08535eb103dd04901862cdf043d9f4a2cea63cd3ffea0a85bcdca31f1fb7e7d78deb4ceda2bf6e4cb1d5e1c33a66e04ef780a778706c53db66996d61dda30008dd1c88c653397596544770e9a6e71c9800cbe03bab8343c007d354380e28fbadf07bf9751bb4a90e066febd4e0bc6dd1dafa1c555eaa1be633f556b5afef159542cb1cf75819064faeeae5eb30a1807a276d0275fe2e7d1529d04eb639c6ab3e632bd3b98a32399aa2a797747de24d94c5c8e2e7522f72c66fe0e4e29c09e3be5faffe933b9e6daf6660eb6fa899d5f761b7062161882dfe78e5bc9b4fbf9bc1129ffe364a1af69f0a8ca013326b0ce0d12c169670de64f7afcda12e6853019a90837ca18ecf6402995dfb956b56a1176b6bfa7dab9c2c61a772afc70b53699a1ce89f23939bb5c63f441cac3478c29692c726e8ce262b773bd439363560e9bef2089c47c061004c938a8fd119f56e364eda92ef7cbb4e8c715bfdcc8a4e64eec844aef3d191d78f871b50200d5bbbff15e365df1f1581a2026c5c3d73ddc40e47ca4410ce2df7479c9e4ed90dc0b039f78bbcbacd6dbe63b29b18074ce9f92497738183c45067771e753e73ed06e580c1804a4bc7b7cdf432c02389e3d2d3000fcf86638221745a0f0bf0fbb4c24125b526b6e6a4d04a9583dd39812d45724780f3f4e4e6edcfcc0503287ad67185f85e3e2ccdba90b796df47265a311f6bfb0983fbcfd035b45843578bfb0d71f738e802e1ce2673de7b9e1c13454e86f8dbebed88dc33607dc041e68b24fa04f0d1296038952bd8130b6ce9c7c71dc717d427c2700f21ae2083cc72cddd096f007475057222bbd95f20d50970d928f705d6f9f0fff55cd8bf6361e2ed036a88a4181911eab8ccab19e432ecbc144307e47ba7be0388d244be7a64f1ad069ce0578504b4db94e1ada160fdecc346dd8b37c549e0cebc22fbcb7ec11ee6d0e012f4927e741435eee91c1527f4cff6b058556a8d2aeb5859c5b40c5b1c85fea75aa19a000a907a7ecefd6c2ce0b5692d2c92f95c26bcf403a9d6d9b2a9f143fe058a326bf58944c3ada1c7024575f325bac047041fdea638d7f473a5a82a4e83e56014f26f6c772f310fe15fb63d2395e75f5e8201753bc5236e8432967867682f983e1a5694ca7a8639b1570ac21a70d0f9f4c753816b216a933ba963dfc504b52041a45963f66f69ecc1293eb4c307702763d8feace7ed3229b9f5162d1565882e5689264211d774d4d18d470b1f0844fa38eb75bf4c2804f463a88d8e940a72a357e6299e7f6a44eb6d5911d302a2a5f9ba8acb1b40574d07a8a4a7351d0fe484a96db4912ee425b42df58945b7561a48db1cabfa62e88941f15ccc0f95c977e74d7d0b1ae4b988fded71aa4e407bc72a029da4152124a0c296308c03b9de45e1412e266ce3a410d3774a4f94fc5dcdaee743696f3710645a217bb46a1300f5e459fa4a4d36a04d0e915f9426db8a48651db2e43fad51194f68a9915295f2ad4d6a73022ef3e42de419b74ad73eb42ed019235557cabcec44d6f392fbe97142d3985a591f41a15976b5d682773732da93859f93eea82bf90a658b43d9edd58ee944f1de74b1dfb261553c4213324b92a347de55bc3c758c4d41aace9ee592209616d0f1b9b16ee28abfcdf75546e9e978383e9285d3a108d8a83acd166706fee643f419d923c9032638e14edc598f630510e0736c39866b71631831e1f7571ba10910d857d644c2db921b85240fee00354e2a0aa8b114513f5795cf0d53ad43d9021cb695ae1dcde5bb9fa52f3853d6e1c9dfed1370c0c3c321bbd4ef9a4c9bd074df4089d148eca2542e31b11a498c52842e696e4f32f7bd4dc9bbaf40ea3d5fe7d070082542ecb33ebd8e565c96614fe3d432e02ec77869e67cf8381a97c87d1ccae554ce6bdd32ba6fc1ba98ba58e5987eaca4aade5ca2a38400a2168daa75dc193744467fcd2419b07111a6c28cbe2c8e5c5aef64c2004475c2b726603c6e5983e2a77742224cae2f3982c4e04ea4858f1ec0ad7d0684cbad05c1ce9fef7e2879687f92a32a76d61a28fcfdf0c954552daabc767df6e22f675e24b726bc103aa583ce479e09d918a5a2864ec220e691944ee89fdc14ab8db49a3d0c7d1e85716831e3b3cea5846fab5fcc6821b32e40e985eaa2c529fe81e382de5365ed611e3af0e1702bb7d3fcbe62e922452c7c59f7fd91d62b4492700c6091046e6aaf64bedf19ff6e1bf484d8650b98ebdf5ae94a4f9f00799b2210ef3eed10bb009161d5e252e4b26824e98ff6f107ac4bbf9405804db5562d5179f822d31e2ae4a86cc594972cea751b67c78b7e74a87f6fa2bca37f0c3732b69d5498ea4acd5d9322fe77ca26b010b7e15a90f456a294d37f28caf1e8595519164fc9b325e26dc8234e8f950326053e42fa3296152ec6a9f70d7699c3eb8adba72b710eb95e975bde080d4090c912058de9b2f539ced7d01519272e39bcd59896fb4bd6ce6e1ffb6e59a544f30088953d503267cf23825a3cbe310441f4f616f4c1705f18ffbce03c5552ce2c58f1855d429544d65c3db4daa6f9e0976a755b3cbb6bdcdca3b6fcde5646b1e1f2730e80ac67c2832fdb0fb5b64e7ffbb1d12ea192ac8226a3214ac2bc68ed9732f72fe58efa550aa88a1c1607aff3cb1e6f2aba5b08a25471fc6bfcf126a211d0f73722ba1f78f1265b8377c40155db5a81cef5cba941ff39e50dd878d43dca9e0d894b59b2078e0430810a62d9ef597b8a18c08eea8981c48bd94de669c9f9e436a54713c530666e8acf289828ea132e3be014ff645b2392694cebbfe6d253cd22abaff1bbc2d22c4c204322040bd32298105fa03334ee03da614981ec4ee83bcadf5db776f4c2d29f48d84fd708ec4ef470ea03a54abe75662b40806388b6e56d86695ee6a23403baf76c32a515391eac08842006cab17fd7d238f342651c1658fc621d3364ec3df8c83c5f4d20550857964323c9e9164207b9b3d17f07fa08bab2159496e1d828ad9480d6151f5ce0cf20b0442831c9ed3fa60b35984e2aa8e9fa5451b85e6c9961d0c353b1c56f553cb1cc5bfb7427220095b76461d81266ae0f1d12c3e13df860f1543a692f1a2b25272c084d225d02df4d5181319b2aabf431c3ff32691923ea0f0972f51c5ef54934b29ba49560525dd17d8642429da73c281e3fbfc51601d91b944947bf4ecff2a337d00c3181fcfb97aaa30a366ccbc59a5a57dbb8ac1f6b49c31e5788e533b902a1bec09361e2438492e0264f6a34c11ad897128e85be78fba2bb57b68fb6d0ae9ef5b0bb2aaf73fddf316f547768a80ddf77f20daf1c67941b2b9dd00ffa916b4b355da395cc1f0035899f034672d89b072e19574172631a0616a3a31006896017ea38cbb126fd95233d189ff9e5c0e3e76dfc520e210931083ecdda3b65dac7ce90874738a1987afd87571f40910f8a9ddfe4624c9edee92c808523e25be7a0c95f3163b88674004f185059d09530f4b8a84960ecbc0e5b479ae51412ec23b0a806fc68f2e167787944b90547b1ba0b6eac77cb7367401c7d2103e27db0b1cb171d18ecf6594cde7c2129eb9f18040d179c1502cd8721aab7a52f35d40db237c84c2997e49ed5b6890a7dfce16727814218ef32fe60f42f0648f0a48446ce266c650efe91c669e101075e59be620d113b57596a160d27928c76c9accc90908abcb442fa561003018bf8f4f275994431b749b765287519f5fb258fb28418601725d3e2fe169f7c33dd4a85c4ced2735c890a4d1ef21d9ab75794c33b42f6c9e5dcb39f6cf54f0d12bd4e1055e8d66109d3eb145f454575f011e33023382314e884e9fcc7ca804e57092ead777c70ae1af83c6db7903689a538a875f75c73522cfdf0cf705defc82ee652edca73e0f66cd1085074ac9e600c0586a3644eb50526a2bc91f8b8268f2f7d87b22a7131421a04e37c746d122a16cb64a445a609f41552405fe22c62fdbdaab5d8794bba70a695e7d2cd2a6fda44fef89c5a6bbf11a36a66f1bf8b808c618e1a931acdf38fea10ff54682e1dc175210d35845420a2e886da83679515726fdba788bb9bb4ceb75b79496295336cb1cb0ab05b772d750b860018ebfdf459d22a23f96416d0f3b602a1846edc65700d4fd5263ac50ee939012712015743d9578ca1955f053b9794e3d51b6a5b703e6fd4190cb4aad2e272282a218d020c6f859ffdb843205cfff14ca0ed33f61bd762f1c0bd1da52eb27182757f9d7fd6078b8b7e7dec6bd3157e86d7d7995a701483fc4dd9fe05054dc4127b1c423be9923c24b4b166e155e1e80ee1464a1e5d3858c19849b1281cbe1caf46df1e8092e65ec7b312b55b1f02bd131f1e786a835fa62a928150c9e28ed08dba614689fdd4fc528646d047bac03ae25ef78a40ed9b7cafec32f4c5d690c4ad805bfe12156c2eae840fb027178283cc046923a58e3cad8d33fccbb41cb9cc3684e70cf93e2a0fdd14a61c74076c4dd8b8662d20fbd0a6388dd06bb32cfb1ca71f964c88115767d80a0cfada8d43009dbe7021f74e6fce6447e2b8365f5658698dca3d87874906c908aac46617bffc8c3878991ea9bc511a4f94da0559a7d21aa03a7122505bb21a0b38fae34d44996766f65930def04ce52680e4bb6fea8b4562c54f569cb87685a320367cc9d7ccbe6d3d7a0187127d7662f2491ba97f6ac3590bfc173fac9b27e52ac7c71e97c3d770c1b1748737a55d41ae9fea4581b457641f69bf612f07dd8484e850d78dd57f91e1ad96c4614895a326c4326f50d6546aa031c91633df0cea100b46ea247321dafeb711dc281128cca5b787e7222ebe28a9df624d1c708809565a002e73b7ca743909543bd68ae6e263d7d1cb9df0954816daf557cea69bc7016c0d2a3e7a22db7cea75ce86067070e8728cecca18a0af74abc3d2a69c1b22c99eed1ed394a12896d1de0ffcd290fcb285b8487dc0fe2405e6fa3ac0eefa5109931a0ce2714bbb7755ec69db8b869b51252fee6ccb994567b3a07c88b3e3ecbf966751bf7d74b51e6481091efb1543310424e2441998656c34835794458fad15e82a8dab6bf80506eaa36820674b02300bdb91ff8d955f0c8af2bcccd7062a81e857c84f5daf3a3140e78e540b9bdca27f5a6de472e7c55e6f237874ba8a6e94c72ce04680da9b8e8df8c5b65b0b3491984869a3620e2c3ad22f83f0173f4844c999a1a69fafa97fb389cb17670256275cfa09d970fd6b7bca06507b7758b9ac6347b3fdef3c36a0bea7624d8b5ae2a1049ed897ed414826e11d767a59359101cacee9ca3c9df0c135edd3f1c5d4c4563361117775596ecaf1e8d05a1ad80c98bdb5c7e98715a5e4f2190d3e96ca009df65e6962f2da5cc569fe7ac42d733359d5c6c1fa48dbfdaff47120d2e8ff200f11616cfd48bd6aa01cc225577ce689e86095fc768303ec0116e3f36da18213b969292bde1737003ca5e38ab1334b2fa111780999ab9ed7f419cbb52f525481cd7923b457606624cf8909b4a25e4d75924cab4cb376a950c6705597c09bbcf31aea78bf103232571bb49fe2a47c4d989afd3f4b5ceb5701499d80b0b249b496518edb3cd9e4b11f6855b7c65f4871a2dfa3e3e34e1d259a1c90d72b7d5847bc836909f9c10c5e54a70f279749dbe5b0aacb97cc352150ca24e7ec12c27ea6f41c7570068e36390a2244addecbb5cc5790669580c25bbfa94ae06ed15e5a0ce14881cb47506cee06fdd27e9e218738484e0b6cb4a33c34e4d864efc33ea6004fc1820bcd3b0ac73a10f0b6cc11b20a28583a50e7bc1cd297e3aaddac41309866ef63737ea12916b97c432c449aa83a550529f3b522dc0437637698c1e6a6c0217dbfd08198339f93b7993b274b27e08389ac13dd9a6f7640fc54d04b8affad4276eb8df312f93152486f89a2b33c19abde87d1d00458c2317a75265093d7d125dc31501d4077d1161b7db014ed96df4fbac08b87beb48e98ccead9e1c358d8487800278e9c71866cd13a9a6db024693c9debb759bf0483553c1b4ca8fe12ddf1aa8add93e054d8474570d7537c1924a21b9082b2229ae8368ab28a00145a2dd05aed1fac51319fdb5b2b9b85af328fbce41c50b88837b87d0616118e50ca74be645366e022fa209e6b2096541ae205d1d5e947161216932e9562e36ef7bceec174dc8e638a021cadf04fe18c9ce1212422440c565bf94e79b25290618789a7afe04212c1c13692e2095219a07d97a9018a2600c82d8e911c71e577706405a67f174c2443bdc7774444fb7ba20caf42998326bddf2b3024d40f9c6e437a7f6f99b34dff3367a1780c3585ef1635b1fa88984eaa014f3d98c6b5ba31ab4bb11edd9694bcf5b248509fcb844573d8877ba9306d177ce89cb438c80be7ea1bf063d8523732194551849e03db35b1be365565851e128a1a7343754dba465eed4b6a49db1a97334b2bbf45aa9987723c293175da64daccecb7fc0f274b43cd3a24b59bae2610641b0172c479a285e4aa5dc0ad390b5e0ccd1d494af37aa241469eb011be9b81b59314a6300697f0e38ea3da1cca86991d0d9e5c010a4791c11c54039b7ae91752aab1e1faba0dbc5b38240ec1da78d536b1ae4f570fd64ed33068b02666cedc2d1c562d7ac819279a46c7de523b280dbe2eb67e719c16e0827d3c314343f67b706d071ffd904e801c3ab6b3a0737a9376e12fbc6c66e89f86173b0956ad92b563f1e8f95dff9a8e69f761edcfaafbf99d08a1ea18fd30008501e8bd64ef9c71988fa4f96e6dc032bca91d4dfb750b556926893e70f386b1fa4b9643b6863084205d83322edf83dfe8c7c538beac4e131135e180d519d5d868b8af40c6c3ce2ddcb627108996ef5716fe45dc7314cad378a3291d628dc1c0e6103d06264ac1fd055dca91deb95cc529039c4edca5de03d29c587fe1a64afc44317b9a2d2b315188ccc8de868ef5db41c12e84952976fd37f81269ad6e6eae7c774690c3cfc53bc437a5d1372ddf64949536f2ae225def1e477d45002cbb020d16008931327cae6cbd983ac40ed2438e52e5d6c3c2d63b65251c39f172388380a41d1c0e9af93b3e54cc1ac3d89c82c7080c191a63d81ebc043cd155452385692c29f007172470afbaad6490b4fa3b103f8b8cc8a2bd3227d82109e2bf4a3506921c7eddea1b56e7b192f13498b8ec611e66d4f3dce467cd9e3d1557399f3650439df5f0ccd7f89e30ee4dc6caa7f350b47a84785cf6dc95eb24668ee8f0661a9677541e5ef537943bbbb3cdb1cf1663a22877528a0a7316861d12ef0f1b16a367bd255dc2c3869237eb426eb3b5cb959d7a5a36c91ec4f83897d84de7450db0928bcbce76d984ffab243e51f99d7f616946b99af117e93eaf18bd0db7fe73750847ce582f8824da4ff4bd9592c3b42715bb64e9214e0070d010fec5361113ade384cba63e883348235189290c5dd90a1ef381990120ad590320632c01460c8a168885d4b50e50b1c05020e715252eeb4978113f051a02626005c89bccd945295fde9bb086a0fc22a5b1113bd98b7729af69767ab593206011987604bf79cb28b911bcaf655bb6181dbfb5d9937b4edd5b219798341c31e5eadf51f0e9a4e9d05be245b10182617d7ac413fcd66425cb707777fe7642d03f61a2a5f2c21f05989b380f6f73e57a7ac9e7b2dc2b44b8f4e2c5a1f9ad82af2debc87d0604d31319c3d4ed7bcdc54a3d3c8ae5d5f6bcd897121980d7b63aa5f3d8fd9ff0f33175ff409848df824aa85b0dd699c9893d4251b63b77910df7493315e72167cecd6cf3e5c2f037364812cc2f47828f559d63f649501bb84a5712459c7f7f527e6b4c23555245bfec0c03527d4e51195251d04a921b459141f1d68927ef5416789f5df6e58639aca9a66ca387a77622d876eceb77774f94786a53a2298d7d76ea2c598178e8e70c1af4f7a1b8a7a1824935eb37e04a6f487eeffad3de444ca820cd22304328649220006f7a607287a5dc50f2094d12f1bab69612292177d44f4b9c42cc58911f0a0dd1caaa09da78eaaffa732f9fc2bdb59cee77e6856e97c25029dea93a98dfabb4f6a23c6802c382aee488324729f9ae4d32b82f894ab87db7f14c7cdbe5e48816e48d0e05a64d2c6f44f55794088888cb1962d01ebad590ad92f8d4a6e624ee4f2cb62ef8547a77cf3ac86796a65d06d7e2bd9ab4ff99d07f2a3bc00aa9a3ca0f0f20b938246d322cf1ecd3c9fce3e3f825bc0eada95a892ec44b2b6e128fc8f68cd881c5ee05bf25ef99137fc54875ada40fc1a353ef5a32589d92258ca942cf1ccc08772392309b2352e5d5971c1010873361619f2aff55f10bc8bdf41c034ac412fc4ab047fece1847f5208a6ba6c1f8e1b7a5a6146fb34851762cc14309eff284c2a9f08da86b79e172cd2583007726cba87534ab3fd331e48159bc01297253e91d3808633df815254ad6fbc05505c8a82b9420df0c41c1c780dd0d65e22a6b771e1df005847278cda7bbba7b539b7d8849a4d80765df65c895c3acb2b2e526c10512798a97fd8a68c465697c27b359537af724720ae00f64679a9255ab2106517153c1b206be87701be06442796387150989a1acf56e92d33131429e7e0141c3c92d32e94fdeacd49a0dc9c6790ef5195b9b6d3223c7518177052eb02825f08782358b4391bca78be29ebd6d44a6f320b79eabd18ecca39296c0f9e64500039e1a5ec8b4c50ee14f687b0961761eccf47e9e679fe78fe07be851de9b9d6cec9f1ff6bc3a9481e3ece048b5420f2594b29acf38611257c6711695cebb9c011592637d2969cb7575ff8a3d83ffb18a535a015178082a55c4f747de362c50cdd470c68c3d6614b3da6e92183d5115b5980a01a2dd849af38651f0393dec0438c216d917f38d58aaeac669d772a5895f1cc38d5c11fa271407f67cf0a35af74af8f465ae0903bb3db0d8b1f6786c4fdd4d78a135c30827c69e470a36f53ea34355598b2a9466a005c404516e7c070b5310e3586cbaf368d04a1500e81c26f087ac9101e7624541aa91e5dd03640a709983071a190c67e3fe6f36701d4129bc262298fc8a2c628a5d7f445078da4bdb4acc705640caf8ba0e445e9eafaf3562d3bfa14201cb1d1330a9b99ed3753ecd743ba98be4523676fa4eef77018157f38b2a991485618d6be23fb57e5efc0d84b9fbd4df4cb4e82b387211fdc9cdb8334489746f411969b9af01d688211ffa1950c68e59163eba8b3d95512dc5cf8307779214483219f433db0442881b02d34baa6f4729031c288e10be372330e35381ceb9ce03c667d909309466105e754a5694a41d5380d56d4d33b853b898a560700c39c0ff5ea6b578da447d9491342c17768a4b3c4afd255edd9046c8eec53f0e88334894f53efd04c5944810dd025dd393c71a0ff59fa93c8fbb2c89335620c82047c5ee49a8de4ddc2e74831cc1afcc0a225576150f0afed4bdfdd022e1d318c33fc4ea3654ee56fc1bfb2da74da4d8533ec58e7474b51afaf508969090a46a281d55744cc37bd83a3456e6c6daa94c8003f0678849617fe2397e123936fb7d3041acf0ff3ebd3660acfca8389465c982ddba1f1956121b3bfcd6773c29e157f5590f12e3a98a227f03f6af17271bb5add7809ee21f3a1c8c68da10a10d8606a626b381b34e0cb9c9806ba47ae2403e8316606eacf14c4afffd7b2e22dd1bfa72fe98a628e7f06f9afc382eea6597d98e62f502aa230838be0f31ed8f647e0e01b31ec87316eb771faf156089143f5768ed4447319c796e5ca0c563347ae871258b0a07d552211656b79ed632ee1e221c4ea51ba87533db118e772b90e542d2559b92262a7132c5bc197d31c0710b02fa7adf0e6106932785770375f2995ef6fed138aa457ad0addd2f243e4be0b5fe739d0dc8350229547dfe6dc41e968774a8340f56bdf49edf2441f42ef12debef9785db1247c8b0d3017ffe1806d3d0998fe99ea7e10bab07d186b10e57eef0131b39249c9af58f0736659ba127ce288f1cde25747f9a1a4ca35ff24e80a416dd973991d804f237da61804a84f22bdf88a10e9e06c8e78d189a58a47cab6fd25b5b8ac1ec998bfc83dc72fe987ca62e62fc9a2aa370bde7c5b8d33ad6a32c9c4f7558f76b0717d0392793ffa073c41b1d840d322a02b9537f68ec59e4290c9ffdf40b4fe3cd4b30aaba1c9e70049d3cc43b70a8d3a3dc7aec654f3ba288dd3bf9b03fa96571384c9407f431081f8d0606de6451c36a9f44cbcc9c528e09a756e25f1f813982c414b924cca079d0ff235b08a2e4496fe8cb8601777964731c73f34e58f339c35d016f746a250c0cd8c358cc7d688479aafaba25c67aed314b525b86570e06c9e92cc64f51f111365299cca648b141003dbda8a5f11884013d2afb86ad1bb48166dd29d2e68ab7c9353dc08c76228c49aae446cca1915341b822fa5e27673f656e22981180fc50c6e3bd2d709d45e59bd9389e4c7da5a31168b6dd843797cef0e97d2ba4be06f90b65d850cf2958a8c827136a9cb5dba65b6f11cddb00f3635eb2e7054b269321130eb7b463e26877ccab69b5d2124a40e0ce97b39eb3ef2aa2424c20750b4eee6e5cd1e41501c3b48363ed7d343f8a197782656f3d1d439f95aa0b5b60c67056c402ae40869949ce554672e93b7dd1ac3025e7bbe3e26a28a5f9224309b1ea8f5db27c459794108bb821e100cfec5d4edf046bf3f8a2b71ecc88e77b068f54e41adaf644c30603326569b0c3680526922db4ee71b11a0093b78c7521ca439e8ec616f7498e189a6ee4837dc6141eb3aaf1787d1b6920b035d564386d0f65c4f8a9ff2365c303e56eda1f70d2ead1caeb6026f5b918305137fac95af9f2d053f20cd3e90da23f5444191bb49e9fa600f3696784984bcd1e51fc03ad185af549b03848fbad3dd2cab070a5ac6287353d24132a4fc48f3346033f3031273566c4ae3fa6a50fe68d88578a5a815a0c151f0aa2397c81d67f38e1f7c8a0d8a806d551544f2592db6d91150cfc252bc497d54d14f17f30719d9e3eda8e04b760ffc993d84b380b3faf0994cf7babb0072909adc571c2d09670ee4e22df72fc670400f89cbc229ec8c52a80efc9e7c86ee51589a3530e9c86c8a2a1e20be6ed1674831655e3284f70bb2144ad12f64f43ecf209d21740907a08604fdd5f13812303dfcb4ce04f82f4a64d4bcab31a98abe7b3b68b62cf56c0aba8eb5dc16dbc3cdeb518f0180788563be761ca00cb6e3d244dc9eec329faf804f37e23b0a16b7db75e4270a7b7561e88dbdf041bb6b1d2ceb0d895de3d2b3deedc04c763313277dd273d5b24bcb46274ae924e94104360ae9483159d6684b5ad93af36fa0d8c17f3ae4d5a24bb508e5daaf9de57bd79767d1c4a255f5e4be511227e33df60f79d6670e9dd021cf070273b383950a559eab8b2e9b1a913c8fe97e33c36e04c07dae6e9d69ac23e53d940718fac57388290ccfd9a2dcc09e2e04c18aa046d5c2c2e8d5fd5246e52cb96b6b9d7dc838dbc9a2b8a34a8af0cf8a0a387501ba74cc9dc483b6121719f72847aaf99c99cb0b4c083eb17c6e7fa2b784b3cb8482a8fd63368bbf92bcb93119b87b0573f6a170027a62b8f020dfa341f4e0afbc7218ab11ac49b6efd7ed3ffb69b0445dfb3a11e22b2fbd3fdd8e0b6aa5f754c5825c8573122ca278e31f7c7fe7306fdefcac587b26f13e188b320f2750276f2aeea9a4f2df96378225cc02a0ba009f997699fc02faadbf84194ba7f2edf31c610276aa8463ad9d68ba9bf6cd9aaa7304ee7fb5467eae93652a80759b681e02893d02387610812f0e3e484e68f5d0f847130dc6ccb7a15d24b3a2bd8b92b941de99999a89901b982116dc008911168787d8c993bc83d521f7a4aa1fca9a3a636baa3af52d4970f6dda0687a3a386933dab9366e9edf9a03dc4ced5f86627c792196316c92d4d2e4a1466a2a4484633d460e101e9d20335b2007cbe6bfe6d27582a7af39c7554f9153a9425790cb8046d1969313a986ef6f7cc825ede3219c134d960530fdde1b19ac0f78a7df26f73ec77ad619ba2cfe078c0a39921fc072c7cbbef2879262d1075ae039f59298cf95126a6f4a8bec41217e1e0cd7956931345715c9999e0a5634566822730878e3f4de197d5ff525b1ae87ac665b40272536e1f4bf6a775850fd16e3eeda5a3d53cf84f4296a97d3b5992a49c682565dacabca8650738918cc8417ec9b2e217e1daeac08ae4f0e84ce404a83482087337db8058fa1bffe96cf720c7402413a8dc96e0b40e47e0fdb03f39b6e3d4eb5b1411f6647670f6cd200e53b7454bdd4b2dfc294b5a9d28f4a336832ecf26b15d407be015ce986975c751cf60509fc087ebdbe88a336cc629b4b14261adaa1cac677731c1e6ddcd33fe6e8ee08403069d6984725c6a1ac4ae98baf840ab37e66ca9c2c24dca5413c75c111e0acdbac343ef0ef66f14c798f1fa15aae5ff2b7076959fe46744db62bb44dcb7d9711d3bf91fcfc9a02f1f311c9f76baebd948cbdd41ab2575e69922d306f7f20e12b00977e315b3395b3edecf97f6f357ee44aae15f50da017e7549f8af639b045519906277459aff6e5b28b72459384a8946828e0b3ade85acfef16c7b672b70811da2003c13872669fbbeeb58e682ae95ec8552c93166949dde3575e0ce584d7f477c2d9a1f7d2560ee6b1dc5fcdc30881aa9db6c2dcd6e5a07abe94024dbed5e358c605e9aba51cf79a560901ab04d4ecdd8043bb86076c55aa132d02f191729a2748b22a02bf91a54e7534c605a0495045ae86ffd2c5f49abe8b57ad54c37212aa025edc6ecebc6c736ff0cc34ae088417488a896d87c57012d1b5ef283b60ac3f6174b19da9c117c1932fbf7840df8ce2aec8136cf90e95a27a68ef185be5ef687de96617a71c8367dde2e4f7616a8d20d24ff54c94c68fb78daf08b67f791251ac1ff068cc279c9135599b2323f6f50ab2b69a44e25ab37750e5152a932f86cd2460b7ec264504ec580e020e2da75f0efaddeb7ed4e38ba2f710bbe8884238f8e758f3fdd39f20355c3f161d59e72ea92f5cba5e83d2ca0f13205629439808dd21ceb0a2d3712c89aa48864bb8e417cf513c7f01b9f2864365c8da130abce2c70f0f1d2709bd94db43ad1e2d1ac4541d57e73f8e7ec855a5c309a0e15ffb165f43843c40298df31c2c085ba2ad5dd0a5afe6785dadaabf75cbfa4c06ad3242b4b1117a5528c66f3935cfe85afb962a1258c34340606b80de5de6f198b8d6b2249e04090d0e428190006a6427ec6491937d7b77a43d9fb822f13f49e8fc51ed9bc47f35a137f4f6075566c9f0134a438f5f417ca2f1699e88757b6c9fb0bc0e699d16f64cfcc4a47fbc9612158c103f0bcfa877433dfc0472cdeb4970291eeeeb386253c8e93ce56c2d77de6cbb98f4de4400afda9b92a91c2b52fe8361ac45a7670bd211dbe6cba594e46aef3988714e208ade88df08e035689352472065bfe1b47323127799f9f10d619c89954c3e0866b454e7a27944df0d05a3be892c1cc12a3501925544aef72f6f25014b9c48b4d8dbfd88808f0b82ed93aff302c5468df6c27419e64b78ab66c7371afbb98d3ef33ff80debefeca32f4fd7eb9b3610202cbdf81e5be9a4f32591e19142615ef3db19b8f6473379cf84ff477d3cb78053cd15670437a571b87e5d30a17ea24457cb4d479e1dff34c2f220a27c2ec4db5ba48a67db12360b245b8c9851715875c0e51cbba7b6f66bece7f15c8e93f6ce517b871bf9c4ce83cb90acb8c509e2470900f02f5227e2a3dd9fb184865856170b47dcc9610b5e95994d02cc31fa2d9cdc039a6b88018264e92198026c8fa8bc9324409178ca151f4e4488b3a9b6a8a537f5a8f9e6b7fd4aecdc43eadbc4ebb5cb7187b980ae6a065555664e14c143c75c47744cdef2bd0f0fb4dee4b8c9a7ef1ebab4bdf2f67ae1f97fd289fd0e0353423f98c001c024f66a35ca642d04a1843685e2af8d26d186d0a024b37650d79f72c968faddfffc38729252b6f655254874ffd64505d6bf3739ad048a68739ec77ab5462538ecc00f74f48d8f6675993239f4576703449b75d58c554654aa6f16386dd0e099b7b38c94305d40dafe08b20578ab35d7594174066aa1feb1ef9947c4c3e10a7e3dee183f95d693024c6431f7282dcda77010097031a3a01488b29bcaee42604d9ef255d6d622df30719a0e7ccaca9866ec5d88150d75369ec2ad7bcafcb09201fb68db928cec6aaa48faa820a1083062064772b6549301abc3bd9504aac40b740a9bb9459d49378c87133e8da064148ac8fa8dbf2696640b96dcabf05cb026e7680ff41ae11858f0e9511e9527f77f6690abf39b6c7a7dce24e5c614bfcb4271c87a469b4d629bbdaaabffb8c0fcba372cf1dcd7bf6589b3c75b1d8f210247a8aef8ba93cb5ce66900d1a39e684cfbb76369612816460c165a50e24477a1f2eabbb4d81f1d12bc0d7cf29b8679c83126be4a7f822b27b75e4906bf8760f2f02c70a94e9344deb6cda3d4eb0cacb7115394a0860d71416a52b015e5caa369caeca35c7b988aee989b0d33658834bd6dfbaf5342574be583320799f266cb3ea9fd980b8dbd21291b04c9a5fa9677d9c989e53fe34a749f49ffc399622ac9dbd2fd2b393b538ad6b4f64fa6fe01b9a6f82b90b3d00f093ca5d7253a4e2c4efa5d4263f7d85c3f4602b211094f9b2ac9dc681809f96647ed34ff3104fdb782fd6905e509efd162d63855f5965514bdd3e1d0a274202b09bd0e755187e8c4c46834c28632f60b15a34ce8bb2dbe7a66d5775f8921b4b4055536621d165d7c6d11ca7c4efe54a327c960dad8c065b42a06c37467a43a9248cf6ba18d0b765a8dd21830081dda8ce6bc5e665f508af02032d8d2b833aa8f107eadc9e8f296e5cfbeb5bde59bd4a808cdbbb45db90ba4653da8189a300b17d4bb916dae38ee5dbc61cbc77faf0d92362571bcfff59e478ac8460e04a7315a72a7cae66af68432aa89eb4e10d905fafac37bd94da09881c0b8b136bd9b43652514234ac4dacbc37fd64aecf7c6e70bc3583cc50305a3595ef03824c9b788d4a8b3df0db66e0e2a7a346d5c2830ee7c4c93c75e7928206ab2eb2cf339afb3af6def368b5cd46790318fb46bb3f2c745167a656ebcf8dc109297b0bc1f6576f7fe44ce9b4c4ef35352e09c979f84e09372e38a224e18324ac6f1572ff5faaa5d406c31c3fb6f008598233b8ce555c8663fd0074b973dfde31bdaa98617d31f3b2432226b8618907492f59531b1c43cdeb85ec426b4ad08c0a32538c1bbd5573dc5c0480e35163c43ed73b55d4da032537b983e609a3e1068a4a18d8612114da59004f07a0738c7727ffc0724e890f9a83648011cf06cb8500c9e611674b1e1eec62077e75a6c64f92d894a51ec6264699e5ed11021e60fbbe60c1cd43441b5c644c029922d885800ace30fdd8c399e0b4e07ff9bbb05154bab2affbc40182774228aa3f1b060bcfb842e0369c880f47a3908c7f58eac985a7d978346ee72e7897277a8a9ba2b2b972f86388772caa60b82de30b82b9a94f65b146ef4b8ee6b526d9bb6288920310db61abe15ff07830c2d9efa30f8555e4351691f3d65b22b288997f736e04f6e96780a271e7796a8a060bbc01e68790bc0912cb0f934a7babaeeb753ccc984d1c2caabcf7703cfb45b2d0414ddc87206923b4600fb87846a5227efb7f6baa4f9b9d2533a22cabada959dc4c702ec418c07845bb91cee4652439c728013a54247f1cf71a0313cc24005576ab86613af10030c5b7a52563f0f35bbc1b8dad6c51c0727108094e101099ba8fcb7851d3f63749da2f8b766037e6276350511ded154e2bea5fc7d0dabb69fd05a7045c01a1e0a95425fcd844903be55721dba948132686a2a3527e789be086b26a33ec7593cb57ef7edf7a4a97efe27bc4daa519866af2d58f7e398bbefe6831b1044f54edc60b4349bb2ff5733d72cd7d81b6d044b45babde34135cbd7b20f8b62151976e71662add2a1a0f4a13007841a06a95922b330a45633f9db19cea24cb5f7fbe8b946ba684961827705770b9473f4df79d3a37edfb0b09042ddb79c69dfa6095eb15b0c2d6556cf9b876cf1cb11047bbe59afa7866967c2b3dbc0c52f8d42165df3d1d1c9b60184a237c8f3f00e2d475e25876b4fc107a64a0f79f790b565b149e9d47e805744812a53ad1cb0a5ecc90cd1baa725d481979b70af7558c8d123daa5a71eaeaec0800a6706679a4edc9b5bad92a6d2315f0f8dfc6740a0bbb9b8de0efb7bffdd4f5894857d4eb231ff5130712ef00a73e2cca66723fdd7c661b7ea1efbe4d1a0f04ebd08571e793d91e0561984fd21f7a1ca79a081056fff929c86730ec1e05403bc13d54ac6226de70125172a310f71a185b76ccc49ff3f290dfca614db3a820f365639d7204bfd22c7a531860f0b4c7bcd22e62a4d7da5cf89ffa709ab4492c796e1da4d92599c9a1a3c6f4714070133a78786a64e460be6077da6150f286584f22ebf34c4303082c65553f913688d429cc7b488201d72128fd9f8c743797abdc9cd6d71d956015e3573718b2ed04322ea5968f3a387fb90ad0a9776ca3aae74d98cef3e4a26b8e445cffcb8d7fe13d21f6655808f159acb9f3629bebbf3abac5d7ef71df4bfc9ad81bad5f20819a90c84a2f27624d79805bd6f913aeac446f05ed5b86c4010f280d83e7fe3bfd4deb023155231a57a7265a320b104ab77bd02c90389f546b6a78a6792acf5c879a0da636717cbf890d0fe7cad0817733ea7bfb7c94242ded8f24c66aecdf15c11b6fe81e72ea71675b0c327430c2eec536e07e9303326c33653e4b79de5bd739b77f383bd35caba64eb2001da2f12dd5c3b2e45cdd7bedba2faa0d54a93c0985614b9eef23228bd205db1b575cd9e36a55c1e73ef096a8cdad61126087e9bbc9af2056270c971b5e0e54af05d99a6e6f6bece5209bbf1bfe6807d62808b21270ea883c30abcba735ebc1843c21d88b4baa67fe5e9984714ba48d4f255510e944d6cf03cb458345dcde825828067d5add43d0f8fcbe63220673b3150281371f734df29162a979d09c6f791268b4597fd9da2218f75ef1990550eb0c0075a845f224c7e1371368cafbfdf877169fde37fa5fde652ef66b1e83c95b61d6dcaf932538a0e440661b3bfdada00a54af0ce5a4b7c501789d73fd32f80d03a11146d6b67fd572c884e67fa5475a138778ad220504da61c3c5cdf041d0a74bfb1b325af55a8bcf0b1a75bda56e21c7ca9bb5668c3161417c5bb2101acebbd7e8f7edefdbf01821b3e65b5d83f62525c6b9d98f7c98e7ea21c769f13d394dbb3d3a559c1565fde54c7443497e0a85da5c697efe423d9a8e2d7ece0a325f93dae2a8aa482a898eff336db9b1984498dcaa49dc343aca7b60d93143f68c579eeda0a22710b2452ef855908b21ceafb876f2a29b3b1a183fafa8936a9443695877a032a6563a7306847e6ca4be33643eb7479714959c9d7ef130f8cfeea218b093e1b3a5732787fab899d9c931c8bce0e434a73f71adf567f6e3f737527e6064e0ff843b627e13c83e625b76bc64df264eea1b1f00416430979fd2d222ca11dc94638dccf83d2a33c688e071a469cb20b43ed60b325aa94c51d41b9f4a12e7532982909123c7cbf149c25d4a64a0f3d60312999a96150f5e02f38c9e147e4ab8e3264b091da31a076b1544047cfe5e4526e2b0c6f97d9a88d132cf33ef2b6f9897e98c8a6fef7eb5b8e9b697e81fdeda7e91ef3697357e6a06827cfc16b691549f472619ca06935a5197b2b1b25dd017c2a64852139f0bcd004808fc72d90e1c491b4d22383dba86bff5b3bd2f1e5a7982a0c471e0d050b403d486046db6ff00f29b241f500c00cf7e10a607608fe5bda567e72a32cbeb8dead40aa8e5fefeddd692258eff7dd6f06b53933c538d6850cfaf2ff1179f35cca2e156fe20963acb45667ee7799d4950745bde3c4540578c6ae0083f775dcce6f664d13576e2e83b34a08c68354142892a40ee0f9565ccf2f9108355f8b8d68ce552251846741de9175fa1c56b6b72b70835d9cc7a8a06dcdb8c7cf7021e7d7eac2005bd7483894d6edec86ff62787a7b8a5177ab8bb68a54dbdbe07a345f06fb0404934dd1ed9e4ef8d4efa5ea2f0a679ffb07178655380b56a40ad465466d84b99a998051afc204fec950254425fd2454b45fc76768d864d4bdf9a06ce56d289380a7cdd8c36b4b691cc567a91879428766eaadcfc2b95d6cd1220193ede58b1730ad7b4bdd674fb4259c367d5fc65c37b55f05e967c9143e15b45b1320947d260c0daa9ce117e772a5c8f3d74f8b6b9b789315e7e72e9b3d62d5cd523162352dd34c243d311522be194f9883387912e7f876a294b96331263bf3659026fdab1b83ec5be246072f2222d3e4906f593c0c72be4873e7092bc2c863b725f550855216cd053f9f6e5b27f90867c117dfdef35257f16ad9e346ae4cc45f3993cb3966bef85d49caf803136a2f36d16d32888e444d4628864219695ce3d2d5c1cbfed9e393dff8a7b5","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

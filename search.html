<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"1de31c23a52f3691e3f4c382766ec8f626732bd3cd5029a009e4b43398528157fda39a1e7fc67f57d51dabb4d1805b9ba82564b4abe796dc462895f30c50a8e57a38a98970f2b479e57ec1a5e14ad7bd283fda771d78c66fd2357dfbc39fd94c1a913268c6a20ac21b671b6e6b51b4f79282ce0691be8fa05ed7b3db24daffabd8352b9745222259a0b7ebf777852752b672992b8db8f941777b3bcf95a860db90b7523f9c150c853f891327c7eee064dfb9da700ba2bf4a82e456ae60e6d906fadbcffbce4bf2621c354da4cbabaf391fe125d05d2bcbd413bab4a7f2089bc675b52473740ba18637524bcee41c3ab29d99d609d79e76b9da917747e3e4c86d87d7f03eb786641620ca1b8d04461d235f5cf39ee34a26f030fb9fa9110214fa288f44926b11403988db0ee30b248370dc45f218b358349df867ebfd3f3c6e80f0a9065cfb6de8711b0204ad2f09c406adfaae65d64761c7e03547024cbc22a0a7d2fb0746aa35cbcd6820faad42cd718f644f08c46d718723fdcacb0fafee6dbcbd7929e9a32cc5c73f92a867dc758001e6079d3fd8abec43b87a61d0aba6d8358c95955bf8fc112e0c2c1b78b71d4f97bbc42b519af89245c0c77b4ecaabc7860d41b7593141465bc538ba6cadf85870c5280f113491a0cbe7ec06e80880f224bf89ba7e53fc1b6ae48596bb5a7cc8c737890a3321bd90de2f8f2b7c063e41054ed984bca5fd3431d298b27d6a42995ef40aeae670966037675dde13344e01f2947fb7441881c2f419d6f71159af1acf73fbcd312a077f1358e36e3a2b974e4bcb849b0cfcb9f03a464dce4aa63156708ee15b8997252457d3b1396a72e2d4e98160731b63d34aef6d8ad238282d8eec1cad08b49165383f4d988669d2d8af4479f3f1f4abd9be1784f39599a3d802065938faf88e1dee64150293f8dd7c135b37ad16e800de7fa580184a51d23bed45570d07a0a5b0ad199625a7f54a6a8238fda262ee65feecc64ddc07606307fb6e6251ef0c9c0d649833eaa2c06ddd0642c6a0b4bb14a20eb24d9d39b35c2005a92d1e7a4d7e8c3add61fb3ac04620a109e7d7d311b79f18668acdeb95671b2d8cc06646b7f20a25361a4a5711779cd5754482ff93b57810538e59e0d00e23f6fe986b0a594baedc261dbead2f1f0a46dacba961a4dfb08e44c9cfc5944dc952bfc159eeff5113e52d951067bf34dce5419ea74309aa700683a0e31af360a57462d0980a27994f4afe1a16902abd2df5b23fd439d66ec0e692eecdd0e7caa9ca338568737e234653514f12590e7891f3016310bb972b4c3180e0ca8dc845f80349a1e8ec7a905d2e1445914a604bb9f7e508d0dd4c4b1e68057bc1cb350a2903d30e3a92dbb7414ac34c0f2bc3271e8a5b105aab8899d6fc457fd39724c2d955ca8d9f1e29f0ed948eb79f569838eacd4358838105d071e9133649a431e39cf732cf210d7a28e3a760fd01d704ed98b4d3f6a6f1ff510b4b2711b2cb30f9038793b3b8c40ef9f4ffe174d382cca15d404c4f9d7e714467ccceba85b8116e69c8a80e649de3f22f6d9df4c2eb8fc102787daebbc229814aae0487439339508669b71da5847e1fb3bfcf09471b17f2f23db2754f379991000bac7e8860992f8108d5a9aea3c58584beb1b396f26c46d3a0bfd0d98e375cc086941b98cd20a4aaf4d6a6f37367fc888c63bcb6a83b97d115653b739edc856c3ea1ff6e06cf20e0cac848b01e2c4848b9551851081fb5a57dd341f899f537c88dce0d9249008eb8a67e211441721b758ab63621857551f25a4671867293a68cc4b2f132d8f19accdf755bdf45d196033d033cf6c42fb3ba211c821aa881dc8024626325eec90b14d16d87bac1827b262da28a99f65ca5810f64a7086c595d3c0b10f02b7ab089da35e998aa095993e3d5ad85beaa5399c2bfb7d0ec2c4a2fe0ccaf00acf4f6967f067f519eac94978e91bf81a7ed790c732c007419a8e618e4f77816a4c47dfd7848841c9b7eac98f43cc88b231042e4389fa4cf495595b1ba1427daf8c20661a99add87e03886332e1dd0970b4200e145b608a226e025355c329f22e91465a18e0c2bd7bab217c7ce2f2c5dc5a3e5e39bd3b35d41cd40235135d17d3d0afc38520c59bc41fd0f63bd3987b77a4c5c310c985cfe6d9f5e9cf00e85608882aed1f8d0c60212251e5a1f109a9eb5b8f5f3adf42c7b1192bd6ded700059a52f2c86d94aeee8b7f0b71c6c2a2a9bcf697328e465af277baba13ae8027c62f926708cd55d3954d904058dea9be60794400f1b82237ce924c56e71285cc9194d6fb7d1606814582d787bc19a650f379d43a33fa257b1ee8c99e38062fcae771eabed1066a39e2c234e2bbf3f134a2e9ab443f54df3dfb8771a8990193a8ce89cd116e8f9aad7cf32e2ca637c8bbce1f5e8abfda8f6529f84a39db0421f919cf92ee7d0e9cfe153e2a429f26b8ad589cc2f8eaa328844bfcb19c14c885428336c3caec6d978c8100228f5e9aaeb3abe5f936639c3da44606b9c3d357473aa56f6dd7c1cf931d02ec96f30b1ff1b1ec1255bd7aaf16fc2d8af1b0f089563f5ebde01ae19a7861050264822db1bc2ddb4d091a164b9bd958fec9800aa9c3ba4b8faec4d5018b1cf33a8fdfb6acae409e51f7b83559b0246451200af751e07e384e75af881df2e120e85bf8725fbfa15948d183a0893cc6e16866ea4b8f2134555ddc480d100513621cbc0df9212698cb1e37fa608f3c5de5b2e519b756a001ba6e9453702eb0b9c8038b88bf49c94b9b8d47f446746cb275e9616466a99a63113c99b8a6833fcaf9fc9e501a0edfec58544f3bb6167c3c4c8e8d757a427180b9e2d82f0566d202cebc7f2a4d35404484a681b89e0145d730fdca1b7ae54e5d35cdd7471fe2945df055aa5c56457200133bf9aa5a93927fc252bfc6e8a20a6e1e14ea0ab2b0ea568436b71b582b2a141716200cd6148027188f5f5ced548bf27574db0a37157a5364c7892dc75492aeda3999d29f65093d306c1f25cc2bbb1c1e7d2127228e524382c98c44a614d1273439e8e4edeec03fde3c3f79d5fa8268c293511588d61efbde721bf9beefbc78b90e40183f0f246b8f17c08ba1d151fddc1743ad222fb95957395d21ce378ed6386fd0d8ce518dca2b24ae757313185cdffe05a3bc613097fc2b7a85172c6795e93558616a2ba6005aacdc009750404b40383bda564d7c4aa74677d7c4c058513e18b0feb8fa030ace59d16d56cfdf1521fbda9e86ccfeaf323d7cb6b625425211f80377f99b95a79ca32af6bb0129ed5a8558a7b25f3aa897621779e24d719220e1e783c033a47b4226e19f6920c211188f9b299dea81dfb70f72731d66823b71174d0f44e9316df727b9247067b2fa5a7d5efd8626dd46e40a90077d2270a66f0ba8db27d1b73f43bef6a1a186602128f2f027566f41389070f2a98ef021b337a66bbc59ac2d68a04cf6a2ab2cdab647bd2af813c44a602618486aa20be324b5ae868ef429d44c354abce153914291b6e6187ce1147c14d3efcf48cdca50edce7b27337a9de37e202290b5415ab1f690b47ecc6af1f4cfc686db4bcfdc2ebda3dacab15338a9d7c564c60ed68484380900ac602f3797dac8cf21885d8f04f231be940ff3305896672b3072a929954baefb63c9328462c3af985ddde04fa0dee636f6f7171bbaa33babe0203a2c03b91e99184efea95fc5a4f75f92a32aec9c74737bf41e90793a98b7a81a6d10c971d913791911c17724bccfe8b24277ea2b27f55b1edb0147c1bc8d932c4df39c562302e537d0098b60b29e82674a61e7da3c89e5c311fa3ca8c457136d8dba68bdb969a8ba2d89f052406e9385ff663aa437d21189a73bec7e16b0e07e9c60bfd1d6dbf09441698ce0e87aaa6a53bdb81da6207e9859ce0e8f2dca56ba723248dab54bef4adff1c234c1a06f7a2ad696331182495b441a6afe827bc4c21c7a23075797592edb76347fa113a4827dbe0360f9ae5b16a11c16756b4da96b7b39bb95deb018499c13f925708a50bfb95bd837de4c9bb0f38683127af799281443b8c3261d0c734e86f74aa5882f42142040746faf95ed95c60d060b2de5e10e0db50cf03886d7ec6d86a8b89c54684a89e5585e01b14defa84d6501fdba92ce5fb851921cd5b88cf78bdf57f65527e68f8cf9abff59d7d033eb44d877cabdde314bdc8d18052d37e4926d4e5780ba15bbfbe3406849b38b3b215b4d18c4e2f2a67dad3f215e8de4ef7a4a2ac51334a0658dd2778fda3969022a6ab815371f27eac110a13a9202bf90a79a77ca34d97b730556cb0278f136fced6331c772d22da8c518952f6aad920f7866eecbdfa733727111fd5002ba53051305daef75fed2d429523830471c1edfb386f306665e2b08ef5202c22efffcd67cfaacf0f33a8aea9c638444cfdb9a6aeea02406d83db43161fe94addd3bf74bf3adba7f13238f944a8489c2364249c0c62f08d0dd8debcab1a16eb421a32a95932c53cefef697a264de53e7b653bb05e326391ee070dd1dd37d54025d47c3cbcab020ed632fe352c8c186a2ae944a73d9e1ad22f5486a262ad5db48802fc24409b1a0924bd808e93d67854bb69e5e3b93df330ff46d7ce01bf176e1116d7980b8c812aa557c7e0dd925f1c809f55dd93aec21d725e6eb7fc4db5a9cb2818a1c4ec6a253eca105fc511ed397f0caca546b93d99473a057f2d8e8fc2e999f198a22f740c038d8bf3a067758715e5283311b9a60a6f28cc9c905f8d4c9b98199723176fcce9d9476b29ef7145212970f1b1893b11e243dad83614f54b698ee41405094099956cc29880904b1236ec98c9c962e086bf7506dc4d217ca94b59f2bcdb809bf36d45ee44abec1afa1e03e257e08797e5dbf7c2099628eaecef76095bc0784c0ff3b48ccc1d81571698727309063eadadd6c57050589bfdc8be7741812af671a8c77c4b1dcfb6a7bd760455ea0daa9f018bf40f248ff1986895174d6f3f58d1c37ce0c87f4202aa8d8c550ec77df3a1a63fe824c71b7a3c891fc0b1ddf5df1c247502cb17d8eee74c8b2afbb6652e9804bbca0c0e653ecda3c457f241235087b336d93202fe1e0d1a3d89896f2f5469919274e79d6fcb759660a638856d385072aed54e41821f99f923d8c36d249f2ba238858ddb3cdcaaa2f0e7beb6f53b22dc2336ada1c6d71eccb569c36f472775479f26f7dc309ec17551b022b38890716bf650791bc5a9187a56e4db9f0416e536fca811634bf6cce18db9a7432f0e27d5ffb027613b810e870701fd6f6fa8faa10f9ff77a74253a74ffb0186b47dcaf15016b8c54398c8ad7b052c6feff3491f152c7277cf260051076dedce58db11a1902f5c0a56aaafcb797ef9b61edb40ec6603f3c164a0aca0cfc119a0e0166db34746dce62698d7089fa3fe7495aacf43a835ce86b52c3cfee824b4d34fbb56fb84e49db9a0b28401f8a75720651d4333ac6de5f84291de24a1763106b706dc41fb929b86f4c8d6879c0dc77e9fe4718272b869764886eb25ce2b5e4bc86eb6b7107d96ae8e0258e1ff27ab49d3bf709c0576c2eeab7daeee3993a8c560c875e31acb98a1a81eb9aab0944b399fda3f4c8909e926b740dfe846864161842631103f59b95143a75e16c555abdbed655f683bd31b59680a5d39697e2c4d941498489f690b228c465e9399439ea2a76307c8a5f6fdcc630f794007e8381a755bb07932decdf8382d826a3cc6a0f0b42546c0a28bafb545479be06bf4f8e589a1b88aa1331862f4448f0cb9984eef66f03383e7052d8f3884947387c9c0db75bd0ecd43dbb2d6b850508be0a40992d3ab03284e0944dd64b9b9a0281440e8f7653ab672a7b2d3492194bbbf661dcbe2f4475cb4e57352c1d8808dd66523a325a6a0ea2cc4bb8b917de517f5405544a5fed705e964649654f92f69f6375a925db2d41f57ff9b4105ac3b9054976d95edd3690699b43a1df1db897fff7bd123ed6f4c6af2174ef0c7c318b3b92226f6c5cd7dab828788f6787f170882f69af648a335543f06bcd23e4d8a20865ed0f81267a7e2f02e4593ec3b4444ace6f6be8f920723140a4f1ad81461699516bc65c271c73d7a1fe9142ef3fca3243a0716bad70ea5554badf3d551811f12d34e8d183aca9198472958370e0eb67a3b0f638b0097d533e78c2ba6b9b2edc51dc72fee9c7c591b3ae5c6a8c53512c0c25f001c9d19a361f88c437e473a04b71d7cdf07a5161d6e5e16c62d4875c5878a2a8ca8da4487055301673d2fdd24b698aab106dacbb9640de3382bf36020f1b8e5b3148c36f1e8a27db22d0b2cc4e87534dde2e1f479b9de33ae461b717130a06a3edac72fdc70214edb02ee2a9d26b477cf4793d28baf3f97d64971065a6fca559a0ab1dcf65d5567be26e868b7e7514f329f5ff1345b954c4ffb50d6f610bb6d1d75fa4b6e0afd8b7edb18b6dfd7838baa25a1950d2ebe96a6511c6ede205d47ff14d8af72ee0b7ef917c3e752c013ec523d087e150de318110a03efd05dd6b09ea2d39ff23f230ca0c6c5931c0f29a81c45a13227a252dac3fe1197c1f12a3a4405f28e331fd998878aadeaa8ae593859644c7942f52e80f84cf7322daafcd63ee8c3e77d612b7fe8db84bd133cf17b1dd7817321208ec382875c69525caa0242d7f843a5560316cebd45c0b0fd5f85e77c38d6379d8e62dba3f690f2077e5e739fddfed533f535b06bd12db24146bfb51ec49d54471dee8c99390e711abad5ed56e2dfd5543b4c1d231073dc5782f1ba67fccba3556c76da27749f7771fed91c3f7694f586907d56c424a959d2ec6d1909c863f681658b5887af7853f96689b2e0579120d087e87866828bac9587fff8cf828ad1f4793c533cc3d39c3642fd0a00c1f7a88d9330478d442290d59e25f2c94724364c0864848d832eda67a463e1b5fde1e339e0861cfdded3e12311bd67a0956221d58caffe09a8df096f2f4d6b12e11d72f8636e806c12cd30853d8549371087f8ca455245648d3e5dfc690700b5c4d087bd747cd2d5dbb462c74190aa583f9d3e6ec0d3f64a8a68bde2f6e1c5e9b48ec677bd029c8364c8456be929b653b10fa93517b3112ce3cc7ef072b6620efa10db76a2a847da06183887c3e977aa78917cb167f2182b589132fb1b6b0fd39037397795a3d9f3989aa0557c43f86465674d5ba3faf8979d0ba1fe66f85f878f9ac3d5f1755c41b95355994f91e75cf07b59fcc4153d4e4b9a009a23b4d208054b934c1a05815b708f8aa67d107a0b834284ce6cec1f28ee5a541913bf595dad268d4e2ed5fe57521023dff0290a49ac642fd482aa06a6e54fecf70426222cd88a5f394ee581c13f8a05d7fbb3f862e87c7aeb49a5e7200551c65449cb6a99db5ee480dee956753d14ac826924a40b422d4bc97202809e2bc00aa10d6fc90a1fecab260e603e20b40b7d057598fb3ce053fa4e50a65a65124affa53350653f4b93477334d64bbf347502045e7bc18fba47776811e7b955ecedd67cf663dfb28ba7ea7ff64a3bb16117def2e23f2e73e7a9a097ad9b3005d48c133c36bc4075605b9ca9d91c910202b6ca423416fc4eb499d442bbd2d83c7d95331d1c2aafcc5ea3d126983943d9dfe254efe0d06a4f0320219daed6b525518236b6fb108f11912352ffb2978514acd429d7a194b52a06d3968f58f8440baee20936b841c11e2be2fe64231398c3a4ae37ef046fd61171e6740cc04f8807d0f898dc8fe6798ee90be1c58c021665b34fc17af5a4e4c99fd39dfefffac9943f1c2c83bc66ab8d80f0858b19611a3574e770641da13aef02667345db77047486296c90662382d07415cbcd41ac0dc9e2c91a0a9b7aeb1a7052123133586119ae160b2e59306d58abbdbb3828dbd57a33f771dafdb0cd5c6336c2ec4445e72e2e4125abf7149071aa2bb2b9f51c60f134afb260fa584c9aa70984a1032d6926dbea1e2499352cef6b93663ef2a2524a92928ed5048a9a846532025d625bf2d69d24f500f9788b24645cc9b9b308a77a92765482a231979ebe371b4ae3a611c3cd66b1397825ef58a6c979a89b118b0223e5486bbf92aa174f6bf73d66e017aaf1c91e7cb6f2eabb581278805887d66dbc811a5cd60e8c53a16ab4fe245b23acea5730dbc1e0f4f780ecfc1de5918f71eba92ab7a391fa9531b2f214288ab4224444a17b96ceca42ec26a41f0a8abde337cad52205fd94c88869dbcb20c0355c9bfa9909526e0e7017ac95bb045c5f8b9be220efff8c68a902aeae29ec1e343b02bbaa5d45eb60fb59421af814d11450893327cea0b4cd2fa991e4756b42ebc5a02fea29c4f07967122e33cd3a82ae5a305de3535d5cee1b780a16c011bb4b607e4ef63cbf16a493393ac60ed2cff82f8a8be04e9ad091f42f08868be464c07cc639aff8133def0e01fe82bf5202fffd104c5d1aefc4e93762873d6680b6bff5f394fcd8b48363b214bfaa8f30b3d595ae3731415146ed4457c5e1826c787776f8679bb4066c5d95f91d855c09947aa1e6d34d7d87c4af4fcde61a8ea14b0fe45d528561f119dc97d653d389b39da28b38b6908c68affb94a73a77767ed4cf262527eae8c59d26f94d053559e5a0b690b998338aca681165bf5be468bd2a81a4ba3c7ec5b9e2c38de5964c71daa2d8e4cf271811a712a95f2714608e8fb86a20488c7f139eac2df9b8d29ec42d09745a1e4773853d7a7a89880b1542060a960150f5d42aa92b232c2c4c86fde53d94bf64e06d7992fbe7eb26ade2601d4638514e852c7dad0b768d2513ad6f9bd8e7dcbf565d0dd5cc84e0dfdf5909edc621b0b871d09abadb8a6e97996ddd1a40e7498c03c5edf0f8ec82037108ae04f1de2153fc43b8e47719bfbb8e32e4adc4d102436fdc673329ce26e337b45da00115d179fe334ca399149082a351d64d82e35267a4cd47e1ef7fad8a51656a367bac8665cecd80844431db24857fcd0deeb78ef5fed71ca91dd87153c49145c38252d6dfee6ef44e708d682e0ede3908d14bbc0fbff04550542ff6c6d97f7efc67bdd6aa49ad29c2516c97e87d117e15cbfa0fccd995e65327087b78e2b140be463c37d72192db07e7027e9ecfcbbb1d22c2042498d9bf3f4127d880a70ee4a86bd26ea560bd3724b097cd8e71b19c0330a6c323318f8ff40de085604cfdf6fb3e8fe84068ab2d0ef96bc78117fc9785631b6778e18b78488c3b7f75f135130882f2968d358aebe4142ec976889cca53f7153ff9502446806f5d387779492add783597dfc1a925698136e2ccb5219074fc79d25eaf8709c4c91df9ba539c371ba2c2a9c42e3317ac18e46ca227f69bccdcd3cb982631703deea61cc780c3da083c505af1cefc4e170803085012cefc9d729bc49ab3b58e03d0790c82954ce97ed7390a1a33fe721f57907678f3c55dee00cda257d7a825c863e3c3fcdaa21339e89b2506fe9fa0023d59a4b22d8318e7bcc9e36f93f246e332b7e0d91198b252a72093bf3750727345b23a3f21d86cb42884ce2e0841325acc176dfccc02996da966969d091879bbead1fcbc43faeac312686633307be4b6662c767c54267cab968dbd36f1da0f825f685a4e90b95c68bfbe7581fcce6a122d16596b41db08030daae3ebd4c7a2f8e5e478ff91f30842b906ec3ec5882c1bd52d13a6957a62c61f79090f91a385e77e084fccff9f004e165d2992bb42333348beca4c7f00f97a3cb27f6f9a73ac00befad91f05b20014488f22cf171c39291c2c0b1b0ab9ab7b713e86fbcc0c0916240ced50256f4262224c862c3bc91c856d9061e6fc8ece0c99b213caaae779a0593d174be351b41701d697a063096142d5f3b93800f442e8a34787a3c483128c9362108eb0ed2d8efa5b3eaf671d156857d58f56147f641b23430d403bb49d3d054e035d33364a67dc281dbb72a47522b68f7b0a58c5b6ba2c4cc90aa294688135b56720af31eca0dd9f05a61eecc19d3031f25304823ad0f1c4179bcdff357919ba0d778abb7eb7723eabc2ba2aca584ccaad83bce8bbdef9c38cff89986eefb9c2a693900ef1beaa9374798a7a3a3c73a6e92b18390af8a76143e06cd6b43ac45fe82bc30b5495ca0bdf4e72d1b776de2c02c5ad838ee75633d6c1783b2d90e3f9f4bf175a3c5351d5c6edb8a3e561587867646a6791603a1a940fde8042347475b065ed20b0b5badb7bb3c70e3b0141375262f8b89f71afc3ec4ffe295f2b8d214d7d66514c992258d4844ca31ac61018efdfa7eb6dd95af3b80b3cf373d41c2a14850a1159391cbc05b554137c51c35e759ba86f22e3c9a562909e97ce2816a603bb78db58ad70a23361e6e5bb977aaaaa50f8ae5c4cb982770abddedbf3e39c22246780b66c76227a844e66fcdd7fa7d4883d672d7db1160c584e1a3af242a7968dfbb3092bf985200b0e3060ce941cd9106069d779b533f7a1869f277fb4a1647c38688e5f9284c352fc158798026760aaee64eb4cdf77e15944a995acf8866c8fc7ae6033e2c07f2d85d05e5f5f801e51e39f89b414a8a1fb0e9c76c2a7184d4aa5d37c38dcf4edc67c0a63678c0cd556192a0793cdb5c26b4256d7b36a638f1d567a4b4b3e09cedc0da0ca81be1b645d2e04385c74d7ca688252af633a4e5e7fe66cce1597b895b24ece9c55f7a741b0647eb2796a11e9e60d14144c4faaee5d5aee3f76b79a3bda4cef49fc0e77f36ba8c77804e02fb91c8e1411918d8b3c01d91fd188a5fea1db9d978fb2cd3699b515a1ca94f3d7569e8409bc1fab5a052b4c087b86992a3ac6ad2f70d5ede1e775a9652b0299be2b871e0ef11d12a67c0e1e29867a982f793718a3ae3394a21336728c89adc07e4ef5b19f1d28f495e5277fd4d8ee00fd8567e06679d7911266afac9a0ef2cde2837676f5ade51bc7ba8c7237dc78d4c53e24a133f4c8838ddec8d7bb63da049c751f6aa6e6e57da7fd9610f7d15f2a66add31b41c82909dffd7359bf2a9e273cecf49542f0f31c6434b5a7fde0941e767bff4fdd1b9c7f68c0356b959ceeab7f6fe090a6230ce8de7f61532feaea699dd4734cde0ca6f4e3dd0210eff5db0fca5b9f31c774959f6b507ac38e605dd270cbf26bd4b7dc0430dd7f2e3480211fc2e2548a4c0b7ca9d8e3f815ed317d9f88a518cfeb42058e8f66cdb62d6b43a4ec12a533b39be3f893782841aa40bdc8cbe4b7b91bd421127c4e3154aa5372ea47cb414f6a2294b7a1dba1ca3c5e400a2992a3bfecfa5b07ef9285e0eb958db2969d38ef2b56381cd7b31e4d0fb1c47465dbb0919c29ede500bab97521a5abe73f2c298091d758b0d441332ec5cdc2f509485006335b79a3a7c5c246aec611257b4acfd730ba99c4cf0c9938eb8662a4ae10955df92c6fcdcf9a1eb8cc10d894a66f10d515e26480817e9d74c190c1e357ffcc3453adc115e73a42a8f53fb4a98725e2562fcd5cd6812119ab2d4ca0ea709bbb47674db3e4495ed8670fe773daded2f025e95fe78efe7a364a9c2d154b1b4ba624a5389c76e14551ebbd7a9bcd40cc0b4af0942dbba7ad48ce3eefcec1e3afd9bf2ce05aa62505790732c256f50521e99dbba3ea62b15da9c8997437e0ae5071429fcc7b90796f8ade086c59394744b0cf89632283262a3f149588a48c0fccc2004364294984a42ba7c14c7fb7797d53ec777cc3c43504a6d9a608eb09e4f14053365078c5e86654520a305341bc3652831c86132a36b2433e4717cc919aca679b56289bb2c2ffd293b0da342a3233c9dc001b9c0d2966cb3f57fbbc2f47b7610c954485117b87aa6057aaccaf8d61939f40a7cbde52525f02e5c988490f756277b17a9ae9186225e0b1510736c67542f7a1c4449aaacc6fcfba8a729d83bc02b356f25b6b87d202e10b7fd9ac08be3ce3e2f564916bf5235edcecdba6238e00d5b02675600aec8337f3f7ee86a3bfeba85b4a95a2286897be53630af84feca4aeb8722a25136f9430e2f1c9b9e4258aa98c4a26c1f6b718bfb6615736143de939772da35a53280f44e9c92ba40187226bd8100a22de36c2c2fc199e90ab1a77623e93f44fca5a98e5536959dd7ab346ca3bbf3ecb1b0203776c6496722ca3fff0ff69b2eec655fc071f290973689fbe48a1c82be08f5653d08e6bab91a6af10bf762d26ed90772146373b88bf29e7d9ea86518e93d95de9a5db288cb987dd8ef907921c344662db388b466f786780e6565d9d1a588057bf7d92718681a29cc18fc3e254aa23fe020b6ed27991d4f4ddc4a890e1612bd357166ecad3f1518f35416eacd9e98bb8edf60777116d9b0fb56e4544e8e17126aac8fa804620692eeb14e04e08b8d3cdd58975df45bfe1569ba5504de7ee10ae7c331edf3ec2273e20af1f844c40909e5856bfaafb25e4c2f1323bf90b9bd7b30843d959a6ddfb1db0894e65d8f9149ad69bd6255ce96e522e1cb83602ff7003e22225bfa0abf7b297e10d0aefc29fcee3b0ecc0eb50ed5b487d89004b2c216bbc50fe0a4430de53d4b3f001d973f771e0ad493f05078391de341ca0bf7228013f5286fef622485bdc549feb6766b76144d1bc0445e8d178b84c6cef63547f151b86b607ead75fec7c1e3dc8ee1d5c815bda4ee5d9ff35585908db286095d7e645bab25d4074b962513c8390d45db4c89b9795996196082a040a4785a186f4ca9af9fc07345e260df22401cb21d74cf63dd2cead60bc12f363c2ee41d4a9b198a9f2d35beb34fa44a4001ac351039a08d6cb65db25fb647c1c5936a086f7d2af834bb474050a64e0b19a728e99e2eb5a6e26bc2c28c8f235990f1e22250854a827314e961a7bcca4262728443f5517503c19625032f7393d9a1f91eef83bda9e806b4b06b9e59775de4ebcc124669f84fe5a58c409b0e8946178989097b1c7449d5e90b7f3407355f239ce3b250a66ca20e74347595589b0b83022f13258d26a2c46ba107592f84f197adab174ce7c5f527283577d02649cf6cbcf99f2a44930b4e9474dba129afada001c400a28c43441467da11c26d45d8130c45114c4b6feb0543601c43dabe7bedeb6045c44f5cbad2e0c65bdd2663d43d1d8bf7258da9f469f2a51cca31a0abb02f14daa78fd2ca9e5a6bdd985a15c917824db362f993777131a050cb7b375bc9e83783ca0b476e106fd21c7e09b2d2d2d255b4108522f91b7cf6b1d3de40a2ace0d8fe673c710648be915ea1cf26d0753e3ce6f21d0dd1c4dae7c364b81579cd77a378b25084439804c737cf6ce5f507ac13489cfbd10d44e676568ea31465395e8a4363503cef1cf3fed188667488a0c4f991bbc9662d7586a1fe028a2f5fe3eee9dd81a8018a986ccfef895b53c9ad56967746021aa737adb5bd8757261418c79a8f4cb33a3d06e21041ede4af9438d90a35678dfa810f7478b7a4307425183178f0640c2def431a476fabdfdce6b18392d09efc0cb57fe754f77d3f2081be1cf8aed658f6ba1bebcbf8541d5e255f676081ba6e982ccba2e0937c361875a14575ab6a0ee2b4cabfffd87cc07ddf1554f132c7b8fa0bce06faf4e0f815163ad3aaddfe4d9465fda3c8c08fefbd0fbd0d6ca695a3d0dc9551692cc093bc98cca5a658bbf53279b27c45dc9e6256a1b42fe6e6691055d00e48b635addcae111026662f69d98ae432f028ed0710f30f70793d5a72002539a0fe91489f844ba29f6c1f3793ac221db29495a49105f5f001fc124a7403c01aeb9f0cf4489850f866f83cead643f97e27bc8e50e5cb69f4d4f374fea9aba7ffba9eba6fe0c6e6c132380478a66641d8971b7ed9d1d674750e98ddf0f2168f0bba8e8aa2defdb7b3d1f58f94e276ca808c05e9a36f0e7b981f87c68843169cb8dd007ecf14480d4947d93c53f49d01ecc0ae78d3d22a0c796106cd8eb1c79736db94127b4976d37bea3915821bdc86c024fd98cbf653f62e99895cf632dd07e10c859908b49bd960ab91cb3330e5b87f9657b2c356a25198f479e4f4590b54154a0bfdf9fe123df34ff6d8992d79970657f81c2c2e576b3f5fc997ae1f555c78b566aa7062d12eeeedf537b463e6570328d7d8dfa5364f57ff776037b7b88ebdd4fe8060cae59e0a03db1fb7309945f50301e300d7a0f9e04c6d3e6c64383f382ec4592dbf7a92753bf9e4e72cb2361ec93abd5f9e878fc6286b07ef48dc7367966be18d6c6e652d6922457ea4fded15e159c27e275b6e1d1bd9e6241a42057e72ba01d647d56445e86280ad3f8d624e6497b4bd581e05869ffa1950ae62680b5d30054e94b69606b71f946ef3be2638728097852680852eb5b1472702f652b0b7892d4fa2d9a09e2275eb8e1c0a6b199ff3a3b4ba4e2286ba055876f4d1dfdf56719dafd0eba42f6077bf6dd82704e499c56c5a13f6475292f36a5205a0e32d8e92018fb763baeb6c27b35a50e9ed5c2d98194e8205d3f7c5edad68e85119f1d03c25ac5dd6e4e6d480b00933a5a23ec9e5fd921726b14ddfba64ed52f724f3f844c1b71673c96c8c2abd40a599528b4b5ad113936b382b2e40459613eee05b4db6bfbae0c2a54d56ad25cfaaf7393ba1ba9f16d759fe328652839481d7c6e7f681588027cf5d67a57a1de92db15a7295bacfffd113827f756a0be41a94cc97f209e1f446085f3307879c65191ae8ad9a71ac98544e2e5817aaafe4550e9bfff932839a4fa857fd71d7a5969cc1a51d9ef69ff2f7e78239163cc319d516104cbf00c35c17903ffcbbb7b5b31d0985ad01e6819b2f6568e41cbc0cba0a64e3e92a8f642538d939009c644a0c24108c705ca2b9d2616886bcfb2d151e784a7764a5cafabf6ccbb1dfb0172c975a46c0b12807688e5fff4f6b329bcc454a541fec7e0dd9ee55986fb3b7d3933af4054e39dd30b6395ab52c0f8442da3bd56e9ff29233ac4cf08aedd290bda0ed99ed9d24f75588feae91d63c673ae5ae85ae0506b781c40a851ede08fdd8c7395dfd3b0f0496d44a83d506f35d9ee656f99412706b7b908c37d92c48c010d0d884041711e51e8b3ab6d1ce499fe8b7e0d1d583a78da76621821a01dacc3f3d1ff583de434e1eaec56dbf87d25beafed85caf5fd4ce6171ef03aff6cf39e033480ae8e7be95bf64f8edd32567e554b0899b433bb710fc21085404a80e33c1ace28f378eb60c9ef7585d2f3e392c6089c6ee0a05f3d89c9509d186ed30fcd5f842a0b46b3c2dc5ca19e63a4a78676bccbcec79c585fb2affce342e0adf80571f1d6539e8d06eccc6326d6a9c3d7d09fb0ea5b71e416427ac4ae8d4f7373def4c0ba0a7b28715e7307bb8d49d0cf5e88e556cb88eab503367fb874243f0e999ca36f71460a069ece59f3efd82aacf4de973f347102a69670a93d9fad8da2ec4fc50b4541db51948351bb8a272b8eb45b3352d417626d238bd42007caf8949e1d36acd6ed553561aa4d8448752d359a2a26a9ca800da4de611adb33bb4c2942aafee544bba8a6d4f074d9ecf24dfd77a1e34aa6c1ed9cf9cfbd99ac47a8fb6675f7c45d06c0f35b81ff5f5556b96a2cea80c4942ced71e89239ca2e756531a016c97095947403ac94eed64edecb095005556b60e5fdc3e27b5672a202c9eac25d30f19003e286a00f10b7ce38eb6906a11a52f6d9bdd56de93223ae3291bc59c3e7292aba74ade2908c1a40da30e72ac005726bdf707ec2b5834a08afdedb81d7c3bd7d5afb456b184ed0babaead7ede956e9b861682a8031b3a60041cb215745366aa3515eba402846156e0668f48fdeaa28f3af5186ab9434bf7281c5625cedbd07e6d555eb4e4d6c22bcb8f4cf5bea06e297926edfde8840c49d03ab107c82ef5481b9d6dc499ecb157d896ec85863e395b7c09d3873b2a69a21bb1443300489d70c6932d82e491ac4657f521941fc5cb5a494d30b5a54585c6885d18be011b644f8fb8533b21b02af656a449da1158e045bc8ade4e58ce005cca7bb00930c57fd88634c96aa9af63b850e1827a0a06ca6b84602a98d85001f6d592cce8550b336c9fd245207697f1d947c0841273629eb540e2e87f125f0d6bbb17d2bf072be5d41b952aec48e39d8e1e593526715ab50f816da64855b27540fdb97cf0fca006f847679e3a8fa78aed03d27e96143aa5f58e5b1cad1acad5dc16e12925cb9cae88a8246480a989a322944440d3eab911833f03faf5e15ab1ab35202b00108418bce8237f4064a3daf767edab2edb9084c9135b90131759f90a8458da00e3da4c7a789c931aa08f402911989e88d2bfa87aa998b69a46e63e8f500a57dc4f2fc237e181337ba425f13edc0b6b582efb21135959e1c5f50dda2a28990ef8aa1e2c54742af6ae044fde21764ee1e27fb742afa8b0781b403167aa444167ef8a11931ea1d77c6c2a831b7a0a9272d754c3588ac04546e7148c07147cccfcd9af5eccbeb7a122c06d75cfe06adbe2ded344c326fd94163d25a1f647a7b566ee263c07d29ecf5f575f485fec8efef52cd9c321604059c7bde610e70cb2b5916733fa904eeea2a9c315e2f258b76b781e1de324b0453784991030737d50e9a6c948ca17530cdb14fa15540ec55977d5a065cdb062af686054c8f176045a1c9d9fb5ef687aabbe9ccf047b48b53106c7a2c10789ba7a71977e25b25cba6b897f3b468338f7b49209d744e2fffc5d754fb3947bde08900a1f2d3c68cc166922f2cba77596130e73db5c0ec2426820781eaee13141cc912590355788fe4acab05247ed573eea70a26e08c2c9dab941d0b7161747ddc0854072f8645203c924822a01061592bbe756773d6bc9a4b0a346bfd0e601a017258dd9cb408cf90d9641086af580fcefb9e007e099200564bf89efb243fe7d3f2340b2aef5d33f538ac0274c89f33a3eddf123300418b2685ea79c2009cd390368c76e1eda17e11f03474e5d77c1e76ceafb8bd9f69c004e4b36c8665530335bc7c12f068db5a2244f2d1507fcb051b0b27f715191413e70bc0ffe50b3e00de043975e3fa83cb893ac708126425dddc2e3606443bc6e1cabebbed5fad2adf8828fce4c383238bd926afa84a7c56ea6162d7634f6fe0e80ea6dafe5ae0e96beb90ae2d4ad6a8c1f39da32d355edd58bf736a26fbe30550a85cb1d93f8bfb374aea9ab737dec084d84c49bae83b2753f2a6bfe831cea0e5b95b15bc7afafb226b0f94d960690f3a131ff3b7b3bd0b07d1a41fb71c751aad49e20e29360a51cfdddac2fc951cfca3e5db926729e817880831c12721a951868330f94b22e127d811a676f0630ace6111fd25f1eea2e039512995e28e9d6366d9855bcee9210438fb8a16ed5b5e075280d28c6b6883619399f9aeda78aeabb7b8714434b2828dfe7de2fae8d0b0310145c03279b0413b1b693d3f7d6d8c6af3e29365a219375e1a0c8421dc0c35bfc4c13ca3aaf5d799b2ccc5db4af84e181ba74981c84454f7edc3719235d928f343a4525e08fae228173d3512f8d236f7ed440aa310202f6ae4b61938375ffb0e5e7f30bf6d1e55d4f649c7fdae39e0c8e55b6b345e44271cf1663a1760d2411a7e610812fbc953e22bbf554105bd4eb253e8a78cd685e59d37d616dd9d911104fc8b5577418c5b060f454264f3935ae7adcd8b1e610be8d39c5f5583bbc5e68bd24d1fbe7bbe792b64671e2df00d06ad17b3c9909930558021a562f608907e86fb96f278a092c3bf46a281d707c22ff42e53f021c1111f2b8ce9df7b90d3fc2defa900f4cb7233fac228abd725628297c0d6dd0a4e89a8b0291138890fcdba0af7a94c876c5424628ec0d2071c54f2b8d4d8c25b7e21ec6c34a4dbf53b7c3d6466e6f75b3f1e6699177f0c78fc985ff2c5a519aebe4300291c5c1465309fde77f476546b624ec8f414e3e5783ff9ab461a567b45ae82a2cc6adaf83742df0361427fe4d36ee6be1ecc0a52985b1388b4226b512d484719fba0a0291f4c915e4d9c42cfd50ceb3536f77ce035e0f436842e55c8a97694c312835cebe0f49843299a675750d9d60c36ae0a20b6c9073f9dd5580d2ed3f6d27b38d0bf667cda467e685d9b26e2b93b6e3fdc9777ed4fba5b49b4b0e18371ad1639e199577bc7e3ff2b0360c621edee2ee2a0d35756fe9ddd1cb3ba0851558b885a97afcaa29121c3ad35930cda85749758517e07bb98e70e6aebdedfa0cec4596f488455e6dac0cd93554062354e9e3a433d7cdf945d300907f77dbd9c38ccb9dc228e08938886850ed218f753f4a237fe95e8a85e07a35a35989c128d7fd05b7cc3d0c92763050bd494d240967e8a889e07483980ef9fa01355943c4fafb51207e1c28df2b6510d5e052e53c7f6cc3c574ef105808c499fb16f703557c83ee8d426592fdfab1259871c5fc835f9704a9f8ee679195401a025765dbe18ac2b0fab78c62bf2cab4f9d2d0b0740721078e80826613f52f80df650888d5152e1207707de239ae4948f7057f48e003649d938cf760d6c01d26cedfd36ebffe8515757adcdd1bd062d62c13e51e3e4c6439f7b8a37113fdc4bb58d9c9f860ef499bd52ea344945c57799758c0dcf0cd0dcd3d72ddeb8da271c115339ff77dbb3f20bf99ff136332ae1e3da743bbd6721e64154cc8d217381ca90993c752516f12ba2d9da0d71fed4b72dee9c44ee1dca80f2524823b20f384ec32524ca053069addb286838c1389bbebc00bc59aeb6b043dfb42d149a834c34ed90304eca4c3e95c92e6d831ecc596188be2a9bd275d57a42f66a147cf20f4975b0e3d5b26872cc910dfb4a4cef8e826757dbfa091f55e59527e0297e25fac5206cadb24616493fc003b5efd50f3f9efeda95af2341f01db26d0f53de716e7f323cb6507c801984f1699db34fd953a2bed0f64445a91561957b3a1e6e94895676303be41bbe6cd6ede7cf657d9b270a272084e9c726455c18f8cdf23046d659f902b171bb52c12492d50531b07b9b8a98d08695195ceb974a50b586cfdb3c03951ceeb5b7c3aa9e51b8b2b4054472fb4bc9a8dc28f912f8be58646819f7a15255007742cae1b1e0086c8d9c97b2a4b6582e2934d76816753c3d10f4cbec2467b3104b0cdafaff1c6bda50ecc9d9d1c25e6f2b1cdbfe44c87adfaf5b6a8d10d41b59328dbadb7d5b93f38c965253bbf986809c38c19f9c40858b14235ff4bb2c5cd81cd7384b86853ff81acc48bfd0b7c1a098f455332f22e0006a29a12b615c26620a26ccbdbfa1e10407e964f10e6bc7d69935db814dbc37bd911454b8984afa735108ebcfccf295d4dc5dbd06d9abecf12c0818c73145b135dbe950051100efd06770c841ea7b4dd76fd28fe6eb8bd8fd80ac5e64fbdb180a3b2a687e3c13436f05f15b8eb9436816f79f795b0aa400e7d89d2544817a5a68a743f6cef61a727a7cc07c34a20ee77b40a12400996d2ce0e15b993cf47c90b04f0fc0702af4ca8d01127d16c98b34fd9f7b3e55eadcd59713ae2f4e3d5be92fcd3def3708842c49c98de60edf7171fb9f5e4c5b2f55581c916fa2dd0ad6a1abb278351d97f6f0960babbcc3b85c5cb3f00e72fb8b442fdfdd5f1aaf2709a3ccd9d28ab8f96e955df04206061d3f30323a7a8a9989d12c409d0acb6f0c9232b868188586766971d186363bdf886d50b4d7aacf4bd2a778fa986de878b97b275a10d4246f5e30c5f7242584d8fd79ac317a233aa7b37185675c24993700c6aabecb1fd00ae968907f547fc36d6fde01643ac71f0b02ed9c96cc1be5e918b92e0ace68b8f8b7ea493632a1cdc0e49bc663910d56ba94cfb119ccfe09c987a0a9d1060eaf6a06328236fd7f1baeb94927a53616e433287313719973ec68e49613bd89183fcf6882bcbcd5a09d5458be25574fcc4e6a8e2163010899d1f398b8d5e3f6f9bd053cfc063727b49c570c5f7b6acc24459e721fd711a87b4b79871093bc9325650751f2629627f49a9d5a8a68142848c54e6cbab2b29c47fd9cf30367dae9aec3e9ed287346b4d797849090872ad48843d457ac55593595a6bfc8dae7b9211f5962eb46eb4685e5b274c92b58abd41bb7bbac2463ff0bb58d4ab42183edfd135b90e9efe5ae1e2a8bbfda7d67d85526e198a1389b3c017ff1170b1bc8b5217696048b8c8717a702fc64faf10516fa62158ede37aec63e0812e486dafb1f50f4b215e1be8597a878d8adea7e84b1451a3974b39312f735352f1774bf37cf67702fb45cc40e623e982da00e2ef46ce2c9d70e39cfe3a3c00f6c2c9ea5a39207cf2a73683f273e3ca4e24395c6b4d1e892c66fcc288ced003dd74bd89898c9886a49b90250e958b15656c41780c78b28bb4ee05d3231540dcf8227f8d5774ac58f6975dad1251ec9c249b924351811581a9a8b7132f5ecf9e5d1c72d446ddcfcd68109c848f43a05aca4cf6fa6c9f9a87e5c6d2dc2d6105056beeffd86ac982276e2bb8a550fa1a43d39d1a6e3cd661725c5a0bfadd031c767ef864792f6d94395022b3e15785d819c04bd7187c47964a9b19a5251cc483deeca1a2facaf2866275355e1854fc0709ac7d31fe7f475f4be1c89128df43ef3e3cc76a0a8c8f63686ddea0f30034ac929c6b8ac86305b6c0cf8cf27ed898462c67f05695cb9a18e0bae6f6babc03af9df2b62a036c17dd4d087c9e6a9c234788c6fc8f854b91c4bf56adbb32549963493cdb03910acf92ed116129c661c78ba6e27f2a38ea4e26e3209c90a56ca4704aa193eed3ae31a0f6db2452f660db1dba4f0f63e4fc02a1e4aac281a4fdc335de6da793d9fc3c5447a6d2bba136ea93a51c01d97ede5c5fd74f8822b2607b0c92170baa7c77dfcd2f677f4ef5107adfd788b7486c9f8ab42001b375b83145705bb6ae5869381767cb365dc6b77701ab7fda25e96f6cb93fb8c382ca8a8","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>

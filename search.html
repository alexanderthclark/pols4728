<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"dd9ff018adcd0c64d691617a3d968de0489dc0a50a02757b76dffe92e3c0512977e6ec9a98a86d259a4aa533ba0056bd575607ef7992384509cb99c5c538d4af796e41fa6e6e8fd7d4009412c5f32ede5ffbda16375d1c88145ea3c34dcc70508140c00c51b71d3962a22b04df2cf8618ae988c6b5bcc683a449d0ca3d86411bcfddc9f722177247eddd89d373a44adc81e85337b6e55f72a1a3887d6fb69b9d38c59d76e6baf0f23a89451ba083729977e11257c73398f2641c5d867da724b7b8020b95a21c36cce9ddae8a94c60d68a60e2cc218557594caa65acd4ab7267ad7db723caac098d1f24ad143dc983b418c6514b4c14076c278281d76fb5affd14a261d622de3975252e5774415aefa517b67df30b7d5f0c82b5c631bc0ce6629ce83ac3cf87ec794bac635b002b92a80f6f260fb29b52bd74c2adfa5b1f004ca1cacb9e71f2e7d2aa48996fc11b82277b90c450b79b0318d027ba273ac7606015ad9d2463052826e10ca1b09ee80b38208dd4557357c7a03aad8e69269afa2ecc5841cbae0e7fffee9116546bf40c0a59af49ba531336eafe2d132208b2638c794d62f3b2f4d40dfcde6e6b5a8329ff3ee34c5d3ee278b8d9eae8b9e710cfe4de5ff0daebf9dfe97cef166878426a48772c17cd98931586786dd5a35f2b3823d9a7de71582764334e7dd92b106bcf2f9be70beb1fbdbc8c763a4f58459a10550973951b731115553e552e810a03b6325e5d5ac26577d9096ab6cf9520673ea66f2dd342230ae284a533be95ee7eecddbe5896c6bbf658a561034ffc3599e18b1dd19add1d54eca5352383ff7d4f74dfb582872a6c9e27a05246d39f877791721791d93803598bc82789203751b41ad82db07680a56dc0fa34ad832121521bc211ba0d669c132e1ccca5629a91970240eb3f9f666bc1482fadb3b7bb70a20fc9dc1fa98012a2c03f4b1773e2b5ac208970f5574b498917dc4135d852d2aa67d7159f70a680fa13cf80bba6f9fab20fca17c6bbc19eab47abcc582eb4fb11de797a2249bd958cdb0128db0ac37799219534809f705143a820c23357d58c1508cbb62b7a4441811c6571e838693cc670654ec8f744ab2020fe8f6cab1f805ff25544e871909446974a6d95983d2e2e32257b1c7e918a15a5af6b37bf30f6eeca7093caabd2479125b760886ccadf157047a62e06717fc8bdfc10fafc95006832c43a322b4e126338ba84219508fb211e780b8d7d4b7d32411652c25b998fa869a471b0b5e3cc47401f59da63455738388b4711fcf8000d9a581c2f51bd59ef7a459086ecb103955d16386191d5afcb019071bd1faad729dd3ea22ebccbac5c2e4bcda4f3ea34dbf62cb7258c7b79f5431396f41f25b357159bf0733b645f0ca6de0825d4177ae3b3c3d327085530eabd2eb12d44911363e27682cab470e36e09f5f631f0e7bca9d7a982f7506bf6fcf9869406df8fbd511a92a50da5cbf0282ea0897f0c6d946ff7925a61a2d4b8fd22d4b2c559fe7a6dc53dedc0af2b01e0d7ec7c17db96edee13387996ec38258dd5bf657110c97cd949c573dc44544c1d904ab7b86d35e33157bc830c67eb8216c8e8fcf667585875946f455c4e4adbd3cb81a7aada95e9ea98221367566972dfeafaea1055961c04bd37fa1fc5be62ffe9b137444dbf4efdc823c473fcd76a6b36567aceb21c248372f67e0310b8c4490a62849513f0cde4f7d3d36bd3e343bce6a9bc35219c68b9290e746e29951c617bcceefed9f0b6953e1756424b2090ff6ad3e8d4404c492d59c27290207dd9c0c44d20f96a10271f4e89e7ac8541a4260593a6a3dc948780b15f8fd05bf30606bd0cb1cdd80182f26ea2649899f413c1deb0a4738c072356d94476c127bafc7bc4bcaf3065dba2b9cc71174c0111744ffad6152136af2d147d283251d78ff7c024b4772a1b2982e1b6b1bb9d134adcf296fa05895a0539d3abb0d2d4ee3e65406dab783f2c3049e44ccce31e4e1b68c384464b6f6281a841a35f98831f08d3306ea65540f457fb8d5fabe9cf039a6ccffef3f68f2d52f16ab9b3aa7cba9ae6acf48006c35a6fa4bdffdff410dc09add9f53dc6cd5ff951d999e76bbd1e74a835785a87c7fe7be7d6929e5a97f97223aab2974844194fb1c032480f2f6116ba37de019a446c928f92d0c76306cc76a54dc87d5f6da5e078a4af4e51e4f1cee05717e813c87a63a0739cd0a0fe2f89a84dea063d1e418a311166409b15bd0eda50e45c4a34c6fe5aedd6b2fecbcac0f29519192b6f77833a096c27e9447091ee84265ee73ee3c35ee3697c6eb2d4926fae0429e4f10e7fa8e8eff8c924beba3e2ee739dffc63eea904de8df47a160bc62a12cba04c6af0e57fef80780c8c1196f9538ae5a24a82981f1fa2e860f603ea63f3709ef4c2eda5a01cd660ab3d9a938a558c6094f9579ee0e5f6f74615d30b0136859f80c6bf6a8f2155e76de0ee5f0aefae478fa04e9946c38bc34232f6b4fd2f01d5519d61b3422a5ca93242f44d1763e79a342493e473caf22087f89efa2781dae6cba5198e5f2f54bae95f1590572506ea72127b1a73a6d9aa4d10bb03deb1d4ebff4d789c7c4017d7bf149de249eaae2d0469d7d497b3967dc380783dcbf9b3b99496c15991a5cee1826a42647f7fc514dfe8e18ed919fb836a59142a2f65bac17a10bf843c713d2f375824ee19733ddaa508067f1224c593d9206bbb38bcf8d0bede40ccc4d11c2e86060beaa7c4ae5f8b6ff470f24271b1c457ae02339c2c51f3ebec6f72f8a406969e59a3814bed6fccf49406ddc27bf0cb544b1fdd3e45d9ca2d549f76d5ca961cdc8f2b7cd99bbc82cf9a56b9d59c57ded877c6fcfc77fc55fd7ec8820e73174468895edddabbf6db15f215fc08f008990fdf461d0495c7d8383f87028ae1207e27f0e71fc84cb3a8530314e2945d18aa7a3015f72d3688c13ed4802fb72f5cd3fae8c139df414abb047ef685d4c8c623b72eab221204366964386688c75621305d24c505b2e045f9a7e28dfd04f4598edddb5cfe574763eae92ac094f767611a9bfbe618ec26232bd1d8216ca42bd5c2272b8a80d9fab1f89cc7c1f83c91c46fdd75574427e5fbffcf01d6fe38815ef6ff695947d691a9a060c7421ef906f2a7164ba510b09bed3189d8e408c54bcf3bbb7f69e9d2f26f2a4a479f49f6f7ae0857313cfaf09dde09d0603ac0d0212ece667137a3a6a44c3bc54dbdcb0ec1e37cb122938ac45a1b649414f2f44ffab231680596fb68868c5aa01aa1ace9dc30d7a6e168112f2c4d2867741072bcdb23ae5a73237e8a7ed1fdabe24e87d61d1d92a0fb88c0b9ba5065b0f0957c2e96e81f0e48ce8f27c01a1613ac2595463cb9a69221c0646b0ca681e91caf1c7a68d34fe0b889f637d40bf9d8d3bcb9a986a42465f9e9b43962009825acea9f07e98ba8d3b2d84e947c46060dd2a8972302ea8bc18683684a6106635181fc3f373b8b9b99bfa85d18456625fd12187c7a278de313a7ca8d725bf25ea565c21e9db500147c352c406261f06269f5f8d3535b856cdb147947079222158a1e4f5c4670750331b5a5d56d5c1d044eda4cc3aa7df909026280aab46aca89109b893c4d2881ed4a838b9e6381a47d5c0808ee293cc712bd14aaf27da4a44909f3aa0eea4a93c50ae24303ac7c426ef09366d5ad49eb426d52b79059305303091b3a28a850f2492bc1aea69d83db3e03c70324d7fed2ad557ca341da4931a8e93b436fef45b75a777d11e36afa69072e548d252144d263f5283d1d4e66889bd1a3d6f90a7a3c0452da70106a7d3087b98760f093affdaa1dcb4b304323af9d0f1401ff5a27e1d7a5b70e39675e4b898c0a26ac23fc86fdd575e8cf40c884b10fd400c5a6c6eb3259d89fb32064ea8b22b9af2c2696b658ecf2d33e9bfc467d0eb534039f06ba3910cf309f2721bcea7fb638cb429b9a1a619bc4e32bc756fe769cb225be0928f5225d499698917ea27ff0be28e09d74dc7b37158cd91023f7e9af65766f559421e869488e226edec8916231e71dd271c28afcbff352a03b7a8199d0de3a46b112375066b91f1abdf1ccab0a59c4cd567832b07a62f77ed0cc5e6788bb8e0492616252862ddec1ec3b00c9f9aec839702a70519a6a0828c71447634590e740335fb85ed392278874c07f45c3f2aab1742eaf0cd065960a3f5a093dfb55461145acb7aa2c48f29c6661f28d96b0e4de12257f70bbb0c00e5d65a7cbe47c0c7f4a5545d162d278e7f07623e7934d78392bcc4ee8dadc6b39f1352a648b39494dea294ef66fbd5d0636126691e40f6b53a3e5797e6cf54231aa7d1073750c20cdc1379dc2fb68ac58f7011fea89b796218e0688ce04fc7cb99cf002f6c364040981be2a570f82081e8c5b3b7311cc7f8dda60d5cd980afd1d4384d1522a59d1c4b4685d95dcb89ab76539f2579dd87af921a14d38b995dd4c2d46a9593a5cc0d24b2f49324341a1f6c6eecbff863891227406736d03830c3cb670656190b0407dd3b79ca779f0ae44b95af8cc5cf4bd320922c7c49d184e2492667cf8f5f041fd50b12a48c540062606d978ec58837360d33594ccbb66251dff82f51c99150dee01685bf3e226c2b4e32409a63d3d848ae6c60a382b889224aa850b11909241bc9942da006f1052e88e8bcabd429cae1eb2fcb6981258eea67571b98406f59042ef5af28ba62d73077f4874291b6a06d1fe467c8383b58e2d8b8ac6301e5834b7d6be13900b8d6ed9550922b0767be48863e315f7434b8075bcc38dd8bc1ceb35dcb0f1824488e6dcf6a67eeaa3c7e72b9813d5a6373dba6831e8e9e0609e62d4df4b8d71732b387b9f0e58b6bda72dc62322a4c61fe692fa3d304ab1dde061dd02f4e30767c07dcfe7f0e9b0663c6ce15048b2262fb6aaa1af999e1dd7e9a4bf15e989505b98394148249d104b2605f4ed570d1eb9f47ee19f385801e8d56a31457aeead3d11036835182a16c9eac35f3640edea11107672ec27c018875e9c6d00ab1b6278cddb2116739736d57c6fc35281538031bea7e10f55666c7f0fd9ecfb0a04ec972d58b7e4f7c0183594070d56442df327c5047970079df8ea62d0f1bf4885e72b1e15e64a4f9e3f9f8d87fd88fb89d03bab1ceca28947d4ae9e82f4c1c66c12e995968232b9d3f0569ce0fa21295dc3d7136ddae5b4ee65743a0472600e26947110f28162704ee65c4a35a46cc62175b141e08991a1e71be6cb0447bebb1e474d809fcf695103c3cf9006af3f349662adfdfd12d74c34ee9e32da4b7d19703966f1bab0d88bcf5caa3585c2726af91ee66002c2b03872ca45f37f89506ce63a65c342a981695dfdf02452cc693a00a85b2262ad2baf3db47d25127f1b233c29583871496a528951484a89730b72790d611b3af4ccf3daeb7fc831962001edfe063816f3c6b43035060d64fcbaf887f124316a85cc165c7f108d455223e029c0861b7d89ad04dd0f3968f007299c70a5636a4641ffbb97b5c2a87593cb547eaaa3fd1b6217bc696bbd2f1eed2a4de301b83af23d87b4ddf89b477053a5c81b96db59078155e1db43d881ce6ba48537ce640035406c32dea6b5de1667418e58ea60742973f8edb4ff78e3ce8f095a85e0a7f49266c375a04fcab86a1ca2fe7e312b63b1d66d34676739019ffb542d230a85cf15a06fa9afc868c4b3d144166b62d8f0a22f813a5d842230268d0f3a094e5b060780162a897faa9240abe54fa6f3a304e9162a5dc4b3e25cb18ca167d195bc4b1c8c0ce34770eb1327a96e84ad15fec5668621522487e08608f32699047cfb7e47b3fcf887f4e6c5fad16368bc6c0d91df9535c3292b00f8d59623229f3b016a857f095894e31142cbae76e637bf5d99dfb7509ad8c044a2838d79e0104b1c8fee57232030057f9990e2587b5a21fe62580f57fdf9ad136e84bd7f90a0a2611656e252e4018270bb37d250e0ee841b675364389d1bc6c3861efb9f7055efeab8461ce5cb848f277952cbcf4a91d7e2bc9ccccb282db4f7b7f6ddc5d0cfb9317c2bcf2b4db7cf367af5c5b11d0a43cb7f613f689a9506891052b4a1c68085d6fccfe18af966b7c11792e252bfdaed713a30b22d393e43b52d680fdaef35a975ddfabfae05a20dc2c7eda89edbac021781cd11ca1c4a1ec8a772deaadf1142be987bc9cbff7a064af204fccecf5cf565cd875b0d45ef60750b1911c3f9db87e22ec7d5333919621584f34c7451eda80cca2f0501ba7206f6e69dfd22003891d55897d4f0dbb6727b7b2dbf8f947fb78b052c20916cec1c4f0d4f49bffa94045c4926350b444b78fe30f6094de2bf26bd1b6ada3a2801257e210e8277dea2cb50badba08e515bfa7cae00e4cb3bcb2f75eb8cef96f79a723c594c57335fa11213e18f3dee06cc1eaa599205eee3e8990ee12e1e382c3fda1c6361f4264a566c2d11f519c057581c45c3e19933f772306c3e8833cd8e0e48eeaf0f457728f0c0fa9cedfdd524c1deb16a40542c750036b662fc01ee4dc8d5765fe40a5ac021fd2065b0ff6e64716139704eea3c4a2f29d836748ccc2ca2b5eb87194905a78adcd37b72a41c3da3d1171888c18e51d0c2a60b83ef995e08da071edd6a45c18625b4ba8064de23dff95c312449fe5901be0c8cea2e27c3479a5887f0aea1dc189e73b9e95dd4e0bb0a2e282cc98c6e7765e1c0404b1b9dadfa67af9f8de1c8fb54766bce103e232d897d686704dd423b1d2a2532fd920081e12728822f47027920b200b92dc7fb344a8b0580ff3ca1a241ff9a00cb26f142a29a9c860d58b02f1f04ba7560b44873854418355d5c275b4cd0ac55e1b26d7637197c2da0064d3d2af66ee8fca5d5bcb252b5fa0f254f26a02d0297def59cc7002f2426da969e29f6a99bb39e104d54b4286b64870d668a187871de7b03f56e633688f65c51790f2f6ce40e637be35376e65c5c6b5ce8999627dde4c45b69ea5518892e6e485eb41f567498f22174a39acc95adea023084a6636fe87860d21608242de84a120a826ac2c4e713b4492f28607fd629c034b66734e6ae270066916c6081559935765d6ddc2db2177fd020f2cf21d4d4f0df0a7830186851b3b209a187bd88942efc07b6e823799cf44545c55cbd2a0738f4d23be4402ecdc102633faf3665a6d95c7036bbc5001c3ad5f9aa23c2ad7d54e1b83013f64494256608423c85c4417d8c8314191bdbfba265cc5d87408138063b0c4fede94e21d64a57d7d6b0e4906253600f8bb7907d6522267a2cc31ffc9302262d60de95a68c55e18beadf3d1f74ee2cb7b3157707359befc0311f8ea176ceda9e60e63ac978b449f03476bcc0d6dcefb0ad3ecc408e92198ca7ded109f6e8748ffd1bda0a75d5a34110fa6c158be401f82795da514fb2006cf675a8b0309d14afdb73163590ee32d80432303cc292980cfb365390f26b4804de9939f2560b3d13c28a9bdc98c878791f35e76e8e80a7919d2f49da8c1456a1f5aaf4c543143bd46ceaedb45abd17801c62405bce34ca599a81ac7d66f7828f4264681ce4bd268f8102bd56f648e65995fa890357977e7918332bc0182edcd82942e7fd8835c994d442cf992d75f4ea201c7c297d8489a38fa60d31c0f4acc8d6d48b531ba356f36219ea4c5eb9992ffde3242a6c10895ea702f8ff0e62be970d10f2970101e43fb0b98fbe4e7de4a238b15c62f7989bb9dd7936587b27b22b91abbf4b3209e3eff9fa0d40281b82665ae493612fdee04b5397dec20f71e8c9e768b97e9153b2b7cf49be8b373a9d104ef4825c4b4cbd27c3d7ea5fc31aac9372d5f48c7c24b5bac5014c1c6054fb6ef4e2963a49675a3f0aa14231a120d49cb24e784778d806118aa08c7834f3aba3c6c39c73fcd552082d37c96d2850a737e41b5116fd6d4216abf022fd07f317f7895aa54bba80a68b3760ab8daeb919962abc1617639f6da41f9a2caaea9e07cea4f613efedb3660e2dbfd85901387a031b486bedd3e188d01916cf775ca6d0f8a52b3c916a321ad24cbbb1900670606cd59b797015137cd209806f63477b1a77dfa9a1b6919afd3f224e7e050127fff3853749fc23d928a3ebe52c4834ad539c3788bf68f7f7263b0d83d7da2cb26d825634fed9ebb0579eef4fa2e18f9a784ef02eafc67dc7afc5cff36775ecc80f7416da95f3aff06e96c99bd0cee02747c02f746b046983c06e44a55fda1208a45a481198c12ac851cd813f1691c01063f16c0fa542a8922d8740e0b1a0bdeff56f5e3af843510b7f65c636d5f321cd031363d8865f0cdc339ef8c07848e8cf9bfc5884a58431a9d6aef8a078b18363f3248f6b0a778c5ae6c55bf3023442ce84dc5fa0406b273298e07a4177458c89886eca313c717d55035223106d30088a8bc4096c4499a73b67b4e5c451dca930a13869bc85a47eb0f8455e147f4390183beb8db4942264549e61dd21a5a16631faa5df569507b39f0ba2fd30b7416817a8e2d2860eda0e29646543ab8a4a63dfd57161352a1808370aee9d52db17bdb574e55184d2274cb02cde66e9791c72179201914e1db15267b672c92652e44607fd316e49bd980efba63eaa109d0e3fdbc3ebebb2746f4e534f7b0b0ae4c92ca243d0902fe3eb3a6e91fa33c2561c50469682c6f0ce69521376bce5d62d2b047ddece3ab8e74e6b41181c2e3f93edb376160261e6e087174af17318309ed19e51627b9c216b8a5439ec511668b4efe00ef22b2a04d1963678cb1490292795a94a20dcce8e9a7978eefa071ae9f590cda748bf2d178033e16c5f99fb6add37256a9c4a529c660e0fd4e208aac9db52c5d2c08d5b8b96277d64f15d4315e65e6a451d535c0445bd3c65cbc6275f60ef5eb49bfc389409f6a1d0ba8fa851bfbcc893ca5e4db2ddf1122b0e31b19ff8f7260386c5d315a7eb09bffdf0a7e05e647f9daca3bbff8f64ffc762c45720a6e324455c1d56237415be7b83825764cd47f668cebe8516283ead74910109fbab49ef6334dfe8d9f6c19b60e0820ab31bc28abcf62667a324f248d43ed0e557f3688bf465810dbf5397f30e3c212198c6f7348d781fada78aac7ec4e9ca33fd6e8542f9ae4d9f04bee4ebffd8cde5b944a2f351e2a5bb439cb156c81ed0b05d793bb4ab0c081bbf16092e4ab746901e55955a5c3f422656a919ed9651fd5c05aa90b2128e61ca2bb6b1b8f98787b097e825c0b9e263e20b672a35da68d16dcda5d43d6535cf751c215ec6ed78bf69c33d61ad1a8c2ecc2a5664ef55052d11262065d3c8a96a76063b53c1f074bfcbd99c14e02957c8bcb34a41a10115352b553e88ab8c44bddaa3f821da77832b3ae324b320868b8f813b0b6415f187c4150fa5da51e8abd3d8d58e449e0b052e6a7f49fd4f1955a4150689b934f811f4e71626593b8ad796369c65dbf83d765364e0822103d1b277b02220b5019ce557d8f06798f944e9ee7d09365c798ece57c119a5dfe60c9968917021ebff81036dcfa2080d81cda9510b63d1525eab20ccfe1902c0a7b31ae21ab099bd08a6c874598eb356732efb58c0b57e109139e73084c5d5da0b60eff64d16cbabd4b8a60c73cacfe9e213e6033a2fdcd43f171b73f17a0f17ec7c27342520dabded060e36d87c2f34786ac54e9a82402f31ab692fc3c25df5d16914627d78ce566cd8dc19246561c19f80099a1c47e6649718a38e82513ee706514dc269f1d0da2859b3301e432879d51e7cf802c5eb67954edc5a6fc1f32a1e4f322e09fd189ff27b9a6a8c3ed2ecd6061d3867ac424de1d0046f21fac49f8d046628c808c711474fe0a3b3e99f653efbaa9ff0150a005aa46c654ae5299d334c96cc930773b2eaa322dbd6441308831eec7bb238303a0d887701b068aa51c5f6b46c3753698bdda5a00958482a0bd947d63d72ebab35749d27d7c3166e5c0264aaa81972cf9317cc077784ecadb43daef57745628e0217c1708704f7f26f2e416067799794c2dc01b05a9238ebe85e37b92ccee792576e94881bf2f0ffe8dc8eacd31d9c0795b12843517cd6eda246c04207f22dde9d2574fab07330911375e580884d17dd75357eb9be70d257b6028e5d000c0b91510346862795e6855c8f583604efbb4b35f059c3c4e5be41413bde49b75fd048a015535abd84e655d849655bd8485b92bd1fe008634f5e7f3f0be8c1416f958797f1b9992a185d739ab45472cc4f643c7a82c3306b1ae1bdf3aede9b054ad3aae90f3fbd3e21980df4ad4cb69200f2689ca8a0e18d41824040b43dabd1f0744c784087a1328f5434d6d33ec5804e3cdda945c9bbbd57200fd721734a1884f67b50d28da87ca6132c30a177afa4ee3bb7f0b5ad71b79657bd9685989e20ade0fe1a622691a4daa1268833fbdea1ef167570c0116e166ba818a5ce1777e0cef7f7c2d9f4e490ebdf5f7845fdcc215e93c090f50a66d0602b7f8b9c1f1391fe335001cc645385f2c30c32294344403f17d9d840829f0cbc5012d0d7973cc8ef16d4e4b8525f6908f591554c3336dba76ad09981e02acfc8fb5c0ec646ea21f8947a58f8d7147074e321abc79a722a069de4652f77ee9e9550961708a57e6781da0b53e5d3817206677e2a570d82be7522aa3da4f2b21cd120d76fb2b65357c47bf441af2de1843e77e9637de017a316ea755e6affb1b9c792a30a2a6a57864764a0877772b78c3a7885c2af38834e1f4438790b839cbf00a5275c4d9f7ade408185600bebabfb3b1d3a6048d3005b7ce8fe662d3b2d5772f59c72c471ae6034d9bea67a7677681fbfb82e5c07caec18093a08a780500afe22be4dd4e9ac12c2b619c8a49e29daa53bfec1ae2e8f2a9b71f98e3e7f3b601293b7b6cbfdf23727006f21a67c573dce32710ae5a68c2c0d32352bd962a5af1ea49fd16d887252fb6ceba868d360664093b90c7e90859f39e399327fffa8970dde6190b1ecdda13eca5433b8be36a1e0260195323be7ea798fb07e0129c4563d4ed3e17a742ddeb4112eea3df1cc906c29002ac1296184c540967f1d0c2f3e4b686b13cb4451b79fc77def840ba70ddd74dfe53fea1b32ba877ea747334fa9ed749b186e3d51ac9710a348fe210a6e8a9ee96cffede76ca13bd10f73eebfbf48f476bdd059a1de4b29649a6d99b1e10d87040d899da98206f088d672a0fda08b8c75d8a2d09ca1dcfaff5fe39fbcc1fb6a3c0236c8af8ff1b3ef91914731de5e4db9dc7912b728acdb84a462c701e54ba9b5cf84a9587f4860f9be51c7f53e55972488a3d2e44bfdbc58e553e32fc20ca78b92bbaf1b56f0688441d9cd221cc56d4b3351685ec4e2508ac7fbc02bfdc18ac37e04f3107694af02249f98500cf128ca6b1cb1d20ef78e31c513bcbb23bb667e405514e29969a4a23c462182f7c1cce1b617e614c812dae55b1f289c7529be4718428b42205dbc606f6b976f54d6ee92773a99646cb8719dd6977ded60822b2cd186b6ccacfd943b63ec2c21328cd5ea4d6e94c5a3f8bec58c0264bf0c1a90da23b2f50e96c42e956b8756872a3db336b088edba48d914a9b39cfcee419f3ab4e3bbc997ec70b43d68319af8b5ef43fef62169121b2a926076d1ca30349689bdf4f9985c1c11cfdbb4577dc804cab9c3e28e145d83bf89fb7b727e64dd851ba9ec94e0c46ea65d5c301ce2c5e62cca484f0540f9afc6ee299cf1ce123f2491d4101fb32a095e65cc4d498fe80eea6a33bf4cbc4bad4753f892daa0928687b5f4ab55dfb50f0f76f6964afdd3bd5a42facb44b29f5a3bf63e6159cec939aa16581dda94749bb9530e8a5900af72854b6bf67ff2a52d2031fa602fa38c3717c6ec43fd668deb83e0f11219b12682ad7ba7f077dd749fec6170877bca412876d66e5a3d875fe85ff6693bf727522890c5631e8e23a908b2ef95d9a76fee20158b13d20d74b5fb903cc0eaf14b8145c11d391ef0540fbbc1f8e2903f63988ed3faca0cb9b3e633d378a495590232e1aeff9c5664d2ddda3578191c5c26d85c3fa63bc7457fc7678ee0e985bfca65b9e3c27d54906c0b1f9b6234431dd511ee7f61e1ccaf86db2e16f9901ce5ad0f9b56c68c128e74cf94ef54083ede01e55f6138865ed0df93666cda621f6db197d858da443529daf341580cd87a0226087c61eb468f0b630b1b8427568c93bf80680a8f02cba79a2d87e95c2c959131bc50d3fe662a371353cfec793067fd42965750da5d15344c1ba56a8d6c8876ff936d95b0a0d5f98a3d5e86ede67198b32dda2e99947423cc3375072be28e997dbbda62edee8e8beaefc7b8823127a6ec234ce24490dd86328fdfdbc40a5eeb95b92242ffc6590e4c5ab666a87878263e9bbc6d07e2b15ee11eb9d72aa7d274d94052fe39e144d7902d963efb30593f189d4189bd00d4b28ea6ec9818b03c7e43c5543fa1d1c32c55c947a7853d1c9a5370938b33b541635748cc33d2757f178b10eddbb30c496984348f4a4f5767a60322dc4c189a749347c48d6480b4b70358d12bfafe177cdb3c1984daf20bdaa5190caa465f9681fc6da1d59c9337084c4203e8f3c9edc5c451a55e2bf291b10a1fca06adbed50d1e34ad5bca58a6113f9e6ac5f913eb5e732d16422dbf5f604bfacde5ee64044ccecf3d253d3a4fd106164b428c45759830934465867cca198d0b7e5e5ecb9fe07b77e4eb034ec594f3ba6900f1048fb4b49aefeac27cbaed00c0e1f92a6ede5b24ba444c61defc3a105a68ab4570528ba73198d3896e2ed2184c02045ac8b2514d12a8ced1dcf253fb7ec14918bf504cb7d5eaa5142ca6e35d295538e39cc694e50ad50d632c77b2ca8e2032b154b6409d263a020c2c29589dfb099b0bac0b8af02fe5cee9f4aebde812351d234a6dadabd9f4ed85051547f8314dd9a52de2bd796631a02d8d6933532516e3b8bfeee1a798ed4e63aa469863b371e1438dca387519f4beb0450e823069340dbf1505d0f7ffbd18c26181a95d1a063008837b6e22396bb3b3832fa732e03c5627c8f8097848b224fca1f474ef82154f8de66d20a23fda52a3e58091cd6bfdeab92abaedcc5e4b1c84e3afeafe9c6782d0953390fadc017f90309e1c3673ef7dc24cc0af3349fcbf6cf84549d4603ecec390c8c4a8c2ddb3d9b92ba5552e8173825017abc2623837baf49908194b00e03fa9e8868152a843abd30938bdc2e83973644b5523a0571741e00262fb2556bf7b95970eee7a075049053f96eaa23cf69f0669fde64758b23d4985aa23cdc3375d405ddf72ff3b9233bb968f7df4d65b01a68581c7c9a3c067a0de6615ce3f49e79a42f0924c1d159ea1adf0d5002be57d7a3238af0863397184af7c57d838b0a0ca5b14090b8bf21c0563b2770879305cf79e8c1c6eecf6161d9a2ad9ac76056ca9a8d13d51231393d6b6bbd617537fa76c01e0245daab51cdebd294908df1b90854c0330e73717b4a8358c2a3b1faff15eb0a29355a1f3981a0c4e5894fad842f6f2a21ba8de88ea795fd17f128d760804ab098e6f58e60c807bd59a6533fc7bc3ad5fbbebe11ca784dac051600dba7fd2b621c3644728fa188b53777ac73f95332f5205497a20d8315927d0baddbbf5f6eca79c47fbd58252f1cbb0094f74fd605f50e1db8986a80fd2651453114ea643a572c3125e2cae7cb3bb2c63dc4a9953206291edcaa3bbf11ee3172a18556797735a4d2d5d73c1b90bb539448ac3301c21aa83e53ccbe039bae1900cb52daeab5669ea232c1685045c39abfdead4d3ed092004f9e67f2bd7cc8ca6814f5e9c29853829c257bf1f76e191c23288558e3124e902f75f6acace8a89b02a468f1ba1342dd74238b9120e935a062f66db8f8690d1328c779495d2affa5582630440e6e8220539675fb322aee4f0aa2d7db95071d565b9862f40e7e98b63ee42c33fcd81522f92195e84b29b15d0ea456358b0f91a97ae28047e22c1aba8b2164b7e742859d680b9bbef0caaf077d22d9c93f472f755c712f56ed95040dd2d153ddde9743d6c1fb092e1a72428b14aac1bc63661568fce5ca471a823211ce21ad25965343294be9d58d4f572403f9f7f64d001be55367ba58cb89d76018045731fa7fa627dd38f9260e5ab58b5d96abf43851222405c78420831ab9f2c7c6867bd53b0fa78129ed01a074e3651ae3e7a26cc60f91b44524f1d84366fc81e803c500623369ecb7ccacef8afb98a923b926091124c5c2acfd25a584eb26aa6f4c8a096a7a57288566b8bf0fc10220188b24f4561cb4d2b9d2217f061dd4866b38961a604350f2ca869e40429cd3ac964809ab6399043dee6824066302fb4b0bf49ae560f73ae93278d65a0a47b198bbed9f463d8226fa9e229660b9b7c4b71bdce3e2d505c0bca427eb5af48440a12f9a869c615767e6d87817df703f78045b71fdf6d2c0972b8d49523e5991627d1872f001865b0df5d3d119da770dcdee342c1711f370bb621e70ea5bec743574bab5813989a8878cb4c1635cdf32da6145c444ed9f7b8f886d514d04f0ff6558e1f2fffb11c1c2c23e78c036349b96135930781b5a46140ee811550fe0f2476f84ad6f53a082dc603a157ced34924b93dee479e9ffe9ff60c348a6267d63cd11decba378aa7053a2f37fa9c8a224d29bcfabeb20e1d9599c1b674f67ecee6fb819a5e8dd2f76c4206251f78ba3bc5e00e15977a238433a54e70537c255f4b257967a18f6f2b391d5c318e039de750e3d13aa1056a1ffd58f804d5da9850d50f964070ec384fd80501eccd1e90a6d1738b8b04ccd169cad5f09a6f693e4dc5f74a3b908a307d7d222f075950105fb1087fe8e5224c45694c86c8722e092f1fc87b0ffd194aa0da8f0a9b20e129df316f158d7ce0a39d1dd672646d6b99d6e986e2e90ff8ec9eaaced890181ac0508fd19cedf632c50b31656a527251007fbae4a31a64134d1cc1be04277428508033fe950ae6584ee85e48cfdce796f018bad871a90781986770d2644149277abde0d31d1497beb3568517a699d8d6b3225fafa50138f16183913c76b33daf9606121ab6ecd940d396e19ac8ae5bc9c417357a6c81a4f914c790a0c39f75126a0bbdf544395b353faa2960f7f5e747744b78f394044e2935ad1475e83f90480d85658b80a40af17a406fdcad166be436050b58014a2723362cbbe3c3047966e95cef84e5e64eea7bb3f1e17acd1fa3fb2ae32fc5bc9c8683fbde7925ba0eeb2b696e238a8dc2348bcef235ce7a12105af759d20772856e7a213ec1531e922ea00cd8a5347fb708e4309a624a7ad37012053ee5a7ff5fbff1903ad70aaccbe24ce28b8f52eb09976f66df52aa3ffc7faec8686448349c39de9664b703bf116d885b863af8fefc09881ac09bd99cf4096af730d91a1a588da559288868e4966f36368c96c4a111d05e0a9b4f96b621b37b1a1d734c700e69ef30c5e93a46a4a6378b3a683d6dc462a7c3b548b28047adab866d165f593a6beaf67476567e0281fa0da8126ad0a932646ecc5c0ce32ea99f38159d501207748558a9df7a50606dd39f2a8e897d6f4732fc4d2605eda70a9f94261b024467259bc5d7226f23c28951fdea2734e913641f1e4046d2af98345da70991852535b95d32662b2a8acbba87d911bcc48408e9b5dbb0953e32aa0d833b7e9ae236efa56c890575ae8caf410534a4e01bdbdc2a0f28f6f696a8bc74cde250070fb09576af9c6c89afae9f8e07b665e82f6ef58cfe9ecfb2c60c0583dbb777630119ca69bc48e5fbd0e946fe993e86545eb5edfb39398ea7fdfbd98e411f9e5c83e1425ca3c5ecc49c868deab673b83c754af34ab6c3d565d8152b4ea3a261a316d8a01547e55d71c47c5261fca8ac249f58639e90865a62a0f2e04c62e8417acacdb8f8fbad1c1ff60d53f0e09f15067816334c3a47e1251c3fa0294098fac79e2a59a6b9856205c1e487953b6cde3ad5cd42cd5fe9a4fa24458b677cf01112c25b785fe3c914a891d76306fdf312bc7a03567373411ce5c132d47f78bf127a87afc74048a2fd344aac30086fda6710075515ae340f5567b0f9e4938d30fc18a71730d8d3b8929b0307981d4bbf508d908b1b4308806aa30c4f1fca1775345449d3f44b20e4f0b88209f396f1150e7ac2b246e5b9961d9f92a0c5fb13b94ee89b32ea6ee7185a6161d55e574475bf1f06abeab941931a1f3c2259b24996efa194358a1212ef48bdee4068bfee6fade35b47080441f6d7fdb0b74ca155744c5ae7f9ab5176ad647cd828159fadf07d5dc9b6751f73038991979ea6141e75eadce09592990ab837b3f74c705b05a9a1ff550532c669f107a41dafd72b3951d1ab0664c34f3982be3cd97c9f436b9c83d3673c01994a39b9014c094ba0bdd60c6c941007c0ed0d5bbacf4498d6530bf3459337ad63c20c206e66f431a2dab324d42c01c740117499bfcd89c599ba0ab82ec56ec0154411022ae4f2963efbe950b34caffd85f34c56cb0458fbb43e3b63c098c5afb3825f097b8640ab096b999a1a71183fc08e4b709778a4c9dbce45c5c2ef16d4a95ec39fef98ddb359f066dbb614c14d865696f4d8625d35811790a1ee632adc650fb2df158189c0668c474ac3d1f1e353cce72d761ac23d4d46b4ebd09c697400d40f696b7a61f9cf78901504aee1cc15e77d03d52b52b6e2b69ccc9d7896514344e4bfc4dd51e02ff149544cdfc2f53c694562ce98855d563aa27c8c857faa53a28b27c2dcd162cbda891b5e0f6f47696467a529ad21db03335ff8181830afed55c801193f4706cf3d4bb11b8223cb96ac98401792996d412799875a8930fe5391073b3561d621e2fcf9c413cd78ef82868b9da127200718c0bac6a2888f9dd3cbf6227d9b908cb8b2512423b544903e8dd4e4bc5f14c51baa90d531555a9f54b13a8bf2ddd4069f234bd21578bfd636fcdf80efa67b522497cb985965b4b727ece1e87a1aab92a288b4071e8f3d0a87d31deb035d7afedf21adfeade6332b8e37b5ecedc993646da440a550b485bebddaf8828d8c5035fc9adb419122ed4e93c8c6dc2398b597b6c28c206a7f0882753ee709ab8ddd81b2698d9c26263bd9cf91c7720478c27132811e29a47ce518bcef233629f7fded92d27d3fd67c03e9e6fd7e5bfad82c94f45f36e80bff9dd9474acda6c04ae7f29e90e12c8c7660306ae62d61215c465cea7c42067aa0fe38c9a2286b4be0e9e49041bb3be4168f6ce7ec6bc1912c237d763cba41bd9dc43276a2ac312e6a632269f620975c310e836c51051308f2c83e7f6a956403e69cbdb3afe27bfb2a33c599aac214a44b0f662059ccd2d720d6270c8ac5728ad90571f687c96814e4f7d40e9d9d8369c97135fad496f4397d9de9e171f774ecb31350169f676ce4c0943aa21f123084c30dec48451a20075ebabcf038af0b02a416dacf9d4080e8280f9e8d8743e80f371439bbbd74ee0ed9e1ad07032fb4f010d80a6d16e0f4ced7fe93d9a19132fc694be93d9989e182d2d6abd42c0102bb5c4518bf0971b93767a68c35168dac65db5b988716307dee5458472e13c404ea4ad68ee8bb3ce3d90fea6e562371072ff5f91fa0e6ffd0d681c1dfdf305362d08e3da50dae1c208c7f3396ca5df0207b80c1b41f1aa646014cd8079f73128fc60c45514681e292721bfd4fb0adef073b15f6fd35c6eb475a2fba9239c44931502288591509836a69ec2fe8465b08f6f3dd51c630f62dee36aa88feccd83bcdd09389165c7ea2ce6eb906ad9e41a13463b33d4306736aa3cabb97fa1fb028f1d99248355c49f6aa4968d9a83e714ceaa6cf5c3279967d80448fb9e4934c7f787dd1b47e1583a0c600f2ca8d342dbb934a6f0d258f71c2bc1e1d6052523d8fec203a44c8644349f2016c69a496e3fbd3548599905baf45133f2ad881173f1893b7b594f015d496b79b52dadffe922023fddf8206f0d940d43c5ec35da8ffa6d956a0abd4022436ee11c5d53dddc751b65005d4452d9a1eca3c58ac5a3e6fe174c8fb473a1fdcaf3a77388a2969bf40cacc66c16209837f75277eaba6c8da9cb746b5b58fc60b327b6a96c8180ba6228f54514e8b99a8c8168faba6000489c36271e3294a617bc202df068777a0f08b46734c12f1dcd6165caa0c721d1d351c41e088c5bb908d0e65cce2937975a8394378eca62d34e04a495f746be2e829161b894792a17ebecca8ee61491a69a38e1c86e8ea73ef98825f7db0d232f0eb3b39fb14f62ad3cc2ad95344ebc2eab82cee0599682fba108e8ecdaf22149d8919b9de70628053f5354a9eeec4d7d9028e56e700b7595a53aab3d45d768eae8282bdfaec642b3e0062c1b51850e18043be93605d801912039c32a7dd64d0624e149826f6e41ac092e89d9b0934d7bfc0c917fbe65bb48e6e8c514f34f4c3b8e889aa74d244d55c50453d4ca09bac4c845b4f0a9f8c3213a71c03bf64dfe26872bd87d5fa303e2c05037b70c38930c92fcc2bff51689ad8e2811427ffd1b19a08af9cee704e8aa17118cd90472b06fd587ea771347d3b06d34f1d914ce0cbc774818804818a988bc27464c40741c70a2d199189a111c9351c950af48d6cd79e0ea00cc6fad1c02aea535644d2c05aa3303e80906a10ae84d5e737488a5252e3dec8757a49bf1d76d3ad00bcee1afe34e723f78eaeccc9dd64db049bcbe757c32bf43fefb3b790dcd4f0706e8eec1e2b1733d5bfec358bcfd83ad22ce7eb9c5a8d72551878d65871bb46e787607d2b744cd27e69a65d410926dfcd7a4c6fb79f39ce055d259e22090c913cf5e30e6bebd8f1218c6b56ea6331ee38630505260c3f979b113caeab3a58f209bf868343df661c60582d67f14a5b9c8eec02b64cd17e14e6574bed6a82ca5f2acc9e4d8fff867591addeb1d37b75a4d302e8a8592031dd8d387901ca8a41109cb45c9d7d5d4bfe6b9e3aa9b1e551af680dddab875b6dc80758bee1a08672ae833718b09132cfea649c0f5c7bd6dc32fd3b1bd2bac38df6015482bc14965d99fde7cc561094a43e3c9ea8aded51621fc46cc207e8e670f46603292d4353a568fd05cc26d9c8b10e8645c5c7fe0a82091f56b104482a97574953c923bed4aa33c3ab7c17ac3d4c920149b7c4ae31b2fc32031287c5384e02704829a288ac31ddbbf32be056cd159eeadefa2f1c18cad17b26435923cb9e2be95315de061f58947f31125c8eaf8c24efcda30598ca6e813c106f4a26fd73e2071099ddfb57df4976b2336ee8e41fd2c3be598795b5795a4b9dfbff954c47893fc606838a0f1ff2d86e58dd65ca01951e0839d8dc243b1214b3e6ac035441a2ff7fd77577813be84b865f1b02cf230105ca1b983c226fcff25b3786041be9cffc1b5e5ccd98f1bdd104445af3a848a6ffd9f3e00b578d1ac754bf15ab2cce568f21ecdcdb109945ace0189ac4d76fc6a4eded00aece357a2cdc5da63ee9d5c7ab58367a57196140b67b61aefebe9635ecd292ffed8109bfe28c94ac47eca272a1ec77a1971ec019dbd1d18d6056cb1f362bb9e3920dd84d72d99435c2923f96e06a2019a13af2e90ed60dae5dd363eb6398115653278f8986ce862405766cde6e6bb4e39c9436f2fb5bc92d972dc4600734a4eeebe91093086103b6690297f99b5a188cb599aad4b404cd1d6ed4225caa4391be6b03b7cf62fecf2ca9d572de656555d1faf7a786c1cad55d5a219fb2871bcee6b62da9fc73ec105be8c4737c69b485b44fa10278f7af14fcc2f7ac1329e7eea1b55575b085ebfda81e1ab1edfa0b7fd9ca9185cbbdcb6a4b691ac6fc857c8dc10ae8ded5692c14eb3a8f16db7c4502d40fa6d49ce3dcf4e2f95d118578d5c1ff5973a189883b251fc6c4c40b96a573ce08403ca14aeda7d1acb41f970b01ed9678b88b2714851af532fb9994de93470cb0b30f02167d8bf12c4177ae22a5ccbc48126d0cf842d55b4d78c9b3e2cd1f5dd97279c35150ee106b247b0414e82563f6b4de44afb94b0f8895251a6f749ff7a429624c573a137f452c5f2a1301fe1f4d0b1fe91c5d98a2771865ffab1c8e2b2681bf41a8a2690e8f32203ad76f193f63a7eb8f98759d142ccbc4e41c4ab292430762d4082214b30678644640c0f1b4075214e19a9e77e272ee035d378eb206bc09f993b8d1fe8fcba2df254463c120d114541b759db5fe07df409b4e3efebb7a90f496f0e0126b48b36068421bfe20ce6b01ce4630a967708242850613071c0c149c591a99b20f8780b0d3aaac5889963ac46771bede478d81edb1bbf64e0f7b43f60ccbcfe9befb9ff86ef22c1094da4380a4cda79834218a0c47fdaa6d3b0eee53b7fa22fc766177e3978271ec73460b2b2eddad802fa5f3a7344939eba3ff07bca4ea45b11bbe86d37cbc52490e02c37f2e6b0575bc5342d69df79cca18f94bf7b69ed9fbe3c068760f376034a8478fc014f0933b4bd25a2ec4b55e73258c01cadb01d177109a0b218a5edd8c8b001efaa615c2371a2ac1682d475f3f1b13bd822b5b0992f3418d798ee65a56d6e2c71cd3d1a304846c3ca0579ee4035a40ec83397d01ca85648e4d2c892a910b0ea8a40b9e9a134c0f46e3d54d4871fa7da7815b7689d2e449d91d6038b7d5380607d54118ed846802b0cc0a1de3855ea34ec47d36d8061af7bcc7d8915b7428d6ed2e28ce7dea261b20d2b9f1a195d998e040b74c1f1","isRememberEnabled":true,"rememberDurationInDays":120,"staticryptSaltUniqueVariableName":"022f7031796100c2f085595b3725c2b5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
